/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/read/route";
exports.ids = ["app/api/read/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/.pnpm/better-sqlite3@12.6.2/node_modules/better-sqlite3/lib sync recursive":
/*!****************************************************************************************!*\
  !*** ./node_modules/.pnpm/better-sqlite3@12.6.2/node_modules/better-sqlite3/lib/ sync ***!
  \****************************************************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "(rsc)/./node_modules/.pnpm/better-sqlite3@12.6.2/node_modules/better-sqlite3/lib sync recursive";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models lazy recursive":
/*!***************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/ lazy strict namespace object ***!
  \***************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

function webpackEmptyAsyncContext(req) {
	// Here Promise.resolve().then() is used instead of new Promise() to prevent
	// uncaught exception popping up in devtools
	return Promise.resolve().then(() => {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	});
}
webpackEmptyAsyncContext.keys = () => ([]);
webpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;
webpackEmptyAsyncContext.id = "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models lazy recursive";
module.exports = webpackEmptyAsyncContext;

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pdf-parse":
/*!****************************!*\
  !*** external "pdf-parse" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("pdf-parse");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "process":
/*!**************************!*\
  !*** external "process" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("process");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "node:async_hooks":
/*!***********************************!*\
  !*** external "node:async_hooks" ***!
  \***********************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:async_hooks");

/***/ }),

/***/ "node:child_process":
/*!*************************************!*\
  !*** external "node:child_process" ***!
  \*************************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:child_process");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs");

/***/ }),

/***/ "node:fs/promises":
/*!***********************************!*\
  !*** external "node:fs/promises" ***!
  \***********************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs/promises");

/***/ }),

/***/ "node:os":
/*!**************************!*\
  !*** external "node:os" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:os");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:path");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.2.25_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fread%2Froute&page=%2Fapi%2Fread%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fread%2Froute.ts&appDir=%2FUsers%2Fgongzhen%2Fcode%2F2025%2Fhzm%2Fstorytelling%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fgongzhen%2Fcode%2F2025%2Fhzm%2Fstorytelling&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.2.25_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fread%2Froute&page=%2Fapi%2Fread%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fread%2Froute.ts&appDir=%2FUsers%2Fgongzhen%2Fcode%2F2025%2Fhzm%2Fstorytelling%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fgongzhen%2Fcode%2F2025%2Fhzm%2Fstorytelling&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.2.25_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.2.25_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@14.2.25_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_gongzhen_code_2025_hzm_storytelling_src_app_api_read_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/read/route.ts */ \"(rsc)/./src/app/api/read/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/read/route\",\n        pathname: \"/api/read\",\n        filename: \"route\",\n        bundlePath: \"app/api/read/route\"\n    },\n    resolvedPagePath: \"/Users/gongzhen/code/2025/hzm/storytelling/src/app/api/read/route.ts\",\n    nextConfigOutput,\n    userland: _Users_gongzhen_code_2025_hzm_storytelling_src_app_api_read_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/read/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4yLjI1X3JlYWN0LWRvbUAxOC4zLjFfcmVhY3RAMTguMy4xX19yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyLmpzP25hbWU9YXBwJTJGYXBpJTJGcmVhZCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGcmVhZCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnJlYWQlMkZyb3V0ZS50cyZhcHBEaXI9JTJGVXNlcnMlMkZnb25nemhlbiUyRmNvZGUlMkYyMDI1JTJGaHptJTJGc3Rvcnl0ZWxsaW5nJTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmdvbmd6aGVuJTJGY29kZSUyRjIwMjUlMkZoem0lMkZzdG9yeXRlbGxpbmcmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ29CO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLz82ZTFmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9nb25nemhlbi9jb2RlLzIwMjUvaHptL3N0b3J5dGVsbGluZy9zcmMvYXBwL2FwaS9yZWFkL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9yZWFkL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcmVhZFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcmVhZC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9nb25nemhlbi9jb2RlLzIwMjUvaHptL3N0b3J5dGVsbGluZy9zcmMvYXBwL2FwaS9yZWFkL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9yZWFkL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.2.25_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fread%2Froute&page=%2Fapi%2Fread%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fread%2Froute.ts&appDir=%2FUsers%2Fgongzhen%2Fcode%2F2025%2Fhzm%2Fstorytelling%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fgongzhen%2Fcode%2F2025%2Fhzm%2Fstorytelling&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/read/route.ts":
/*!***********************************!*\
  !*** ./src/app/api/read/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@14.2.25_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/api/server.js\");\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pdf-parse */ \"pdf-parse\");\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pdf_parse__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_rlm_reader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/rlm-reader */ \"(rsc)/./src/lib/rlm-reader.ts\");\n/* harmony import */ var _lib_deep_reader__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/deep-reader */ \"(rsc)/./src/lib/deep-reader.ts\");\n/* harmony import */ var _lib_prompts_rlm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/prompts/rlm */ \"(rsc)/./src/lib/prompts/rlm.ts\");\n/**\n * 评书改编 API\n * \n * POST /api/read\n * Content-Type: multipart/form-data\n * \n * Body:\n *   - file: PDF/TXT/MD 文件\n *   - task: 'pingshu'（默认）| 'summary' | 'study-notes'\n *   - mode: 'deep'（默认，精读改编）| 'skim'（速读摘要）\n */ \n\n\n\n\nconst SKIM_TASK_MAP = {\n    \"study-notes\": _lib_prompts_rlm__WEBPACK_IMPORTED_MODULE_4__.TASK_STUDY_NOTES,\n    \"summary\": _lib_prompts_rlm__WEBPACK_IMPORTED_MODULE_4__.TASK_SUMMARY,\n    \"pingshu\": _lib_prompts_rlm__WEBPACK_IMPORTED_MODULE_4__.TASK_PINGSHU\n};\nconst DEEP_TASK_MAP = {\n    \"pingshu\": _lib_deep_reader__WEBPACK_IMPORTED_MODULE_3__.DEEP_TASK_PINGSHU\n};\nasync function POST(request) {\n    try {\n        const formData = await request.formData();\n        const file = formData.get(\"file\");\n        const taskType = formData.get(\"task\") || \"pingshu\";\n        const mode = formData.get(\"mode\") || \"deep\";\n        if (!file) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"请上传文件\"\n            }, {\n                status: 400\n            });\n        }\n        // 解析文件内容\n        let content = \"\";\n        const fileName = file.name;\n        const ext = fileName.split(\".\").pop()?.toLowerCase();\n        if (ext === \"pdf\") {\n            const buffer = Buffer.from(await file.arrayBuffer());\n            const pdfData = await pdf_parse__WEBPACK_IMPORTED_MODULE_1___default()(buffer);\n            content = pdfData.text || \"\";\n        } else if (ext === \"txt\" || ext === \"md\") {\n            content = await file.text();\n        } else {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"不支持的文件格式，请上传 PDF、TXT 或 MD 文件\"\n            }, {\n                status: 400\n            });\n        }\n        if (!content.trim()) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"文件内容为空\"\n            }, {\n                status: 400\n            });\n        }\n        console.log(`[Read] 文件: ${fileName}, 字数: ${content.length}, 任务: ${taskType}, 模式: ${mode}`);\n        if (mode === \"deep\") {\n            const deepTask = DEEP_TASK_MAP[taskType];\n            if (!deepTask) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: `精读模式暂不支持: ${taskType}，目前仅支持: pingshu`\n                }, {\n                    status: 400\n                });\n            }\n            const reader = new _lib_deep_reader__WEBPACK_IMPORTED_MODULE_3__.DeepReader({\n                task: deepTask,\n                model: \"qwen-plus\"\n            });\n            const result = await reader.read({\n                content,\n                title: fileName\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                fileName,\n                contentLength: content.length,\n                task: taskType,\n                mode: \"deep\",\n                result: {\n                    outputPath: result.outputPath,\n                    ttsOutputPath: result.ttsOutputPath,\n                    chapterCount: result.chapterCount,\n                    totalWords: result.totalWords,\n                    duration: result.duration\n                }\n            });\n        } else {\n            const skimTask = SKIM_TASK_MAP[taskType] || _lib_prompts_rlm__WEBPACK_IMPORTED_MODULE_4__.TASK_SUMMARY;\n            const reader = new _lib_rlm_reader__WEBPACK_IMPORTED_MODULE_2__.RLMReader({\n                task: skimTask,\n                model: \"qwen-plus\"\n            });\n            const result = await reader.read({\n                content,\n                title: fileName\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                fileName,\n                contentLength: content.length,\n                task: taskType,\n                mode: \"skim\",\n                result\n            });\n        }\n    } catch (error) {\n        console.error(\"[Read] Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET() {\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        usage: {\n            endpoint: \"/api/read\",\n            method: \"POST\",\n            contentType: \"multipart/form-data\",\n            params: {\n                file: \"(必需) PDF、TXT 或 MD 文件\",\n                task: \"(可选) pingshu(默认) | summary | study-notes\",\n                mode: \"(可选) deep(默认，精读改编) | skim(速读摘要)\"\n            }\n        },\n        examples: {\n            deep: 'curl -X POST -F \"file=@book.pdf\" http://localhost:3100/api/read',\n            skim: 'curl -X POST -F \"file=@book.pdf\" -F \"mode=skim\" -F \"task=summary\" http://localhost:3100/api/read'\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFNBQVMsSUFBSVQsMERBQVlBO1lBQ3hELE1BQU1nQyxTQUFTLElBQUlwQyxzREFBU0EsQ0FBQztnQkFBRXFDLE1BQU1ZO2dCQUFVWCxPQUFPO1lBQVk7WUFDbEUsTUFBTUMsU0FBUyxNQUFNSCxPQUFPSSxJQUFJLENBQUM7Z0JBQUV0QjtnQkFBU3VCLE9BQU90QjtZQUFTO1lBRTVELE9BQU9yQixxREFBWUEsQ0FBQ2lCLElBQUksQ0FBQztnQkFDdkIyQixTQUFTO2dCQUNUdkI7Z0JBQ0F3QixlQUFlekIsUUFBUWdCLE1BQU07Z0JBQzdCRyxNQUFNeEI7Z0JBQ05DLE1BQU07Z0JBQ055QjtZQUNGO1FBQ0Y7SUFDRixFQUFFLE9BQU92QixPQUFPO1FBQ2RnQixRQUFRaEIsS0FBSyxDQUFDLGlCQUFpQkE7UUFDL0IsT0FBT2xCLHFEQUFZQSxDQUFDaUIsSUFBSSxDQUN0QjtZQUFFQyxPQUFPQSxpQkFBaUJrQyxRQUFRbEMsTUFBTW1DLE9BQU8sR0FBRztRQUFnQixHQUNsRTtZQUFFbEMsUUFBUTtRQUFJO0lBRWxCO0FBQ0Y7QUFFTyxlQUFlbUM7SUFDcEIsT0FBT3RELHFEQUFZQSxDQUFDaUIsSUFBSSxDQUFDO1FBQ3ZCc0MsT0FBTztZQUNMQyxVQUFVO1lBQ1ZDLFFBQVE7WUFDUkMsYUFBYTtZQUNiQyxRQUFRO2dCQUNOOUMsTUFBTTtnQkFDTjBCLE1BQU07Z0JBQ052QixNQUFNO1lBQ1I7UUFDRjtRQUNBNEMsVUFBVTtZQUNSQyxNQUFNO1lBQ05DLE1BQU07UUFDUjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9zcmMvYXBwL2FwaS9yZWFkL3JvdXRlLnRzPzYwNjAiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDor4TkuabmlLnnvJYgQVBJXG4gKiBcbiAqIFBPU1QgL2FwaS9yZWFkXG4gKiBDb250ZW50LVR5cGU6IG11bHRpcGFydC9mb3JtLWRhdGFcbiAqIFxuICogQm9keTpcbiAqICAgLSBmaWxlOiBQREYvVFhUL01EIOaWh+S7tlxuICogICAtIHRhc2s6ICdwaW5nc2h1J++8iOm7mOiupO+8iXwgJ3N1bW1hcnknIHwgJ3N0dWR5LW5vdGVzJ1xuICogICAtIG1vZGU6ICdkZWVwJ++8iOm7mOiupO+8jOeyvuivu+aUuee8lu+8iXwgJ3NraW0n77yI6YCf6K+75pGY6KaB77yJXG4gKi9cblxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCBwZGZQYXJzZSBmcm9tICdwZGYtcGFyc2UnO1xuaW1wb3J0IHsgUkxNUmVhZGVyIH0gZnJvbSAnQC9saWIvcmxtLXJlYWRlcic7XG5pbXBvcnQgeyBEZWVwUmVhZGVyLCBERUVQX1RBU0tfUElOR1NIVSB9IGZyb20gJ0AvbGliL2RlZXAtcmVhZGVyJztcbmltcG9ydCB7XG4gIFRBU0tfU1RVRFlfTk9URVMsXG4gIFRBU0tfU1VNTUFSWSxcbiAgVEFTS19QSU5HU0hVLFxufSBmcm9tICdAL2xpYi9wcm9tcHRzL3JsbSc7XG5cbmNvbnN0IFNLSU1fVEFTS19NQVA6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7XG4gICdzdHVkeS1ub3Rlcyc6IFRBU0tfU1RVRFlfTk9URVMsXG4gICdzdW1tYXJ5JzogVEFTS19TVU1NQVJZLFxuICAncGluZ3NodSc6IFRBU0tfUElOR1NIVSxcbn07XG5cbmNvbnN0IERFRVBfVEFTS19NQVA6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7XG4gICdwaW5nc2h1JzogREVFUF9UQVNLX1BJTkdTSFUsXG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGZvcm1EYXRhID0gYXdhaXQgcmVxdWVzdC5mb3JtRGF0YSgpO1xuICAgIGNvbnN0IGZpbGUgPSBmb3JtRGF0YS5nZXQoJ2ZpbGUnKSBhcyBGaWxlIHwgbnVsbDtcbiAgICBjb25zdCB0YXNrVHlwZSA9IChmb3JtRGF0YS5nZXQoJ3Rhc2snKSBhcyBzdHJpbmcpIHx8ICdwaW5nc2h1JztcbiAgICBjb25zdCBtb2RlID0gKGZvcm1EYXRhLmdldCgnbW9kZScpIGFzIHN0cmluZykgfHwgJ2RlZXAnO1xuXG4gICAgaWYgKCFmaWxlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ+ivt+S4iuS8oOaWh+S7ticgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICB9XG5cbiAgICAvLyDop6PmnpDmlofku7blhoXlrrlcbiAgICBsZXQgY29udGVudCA9ICcnO1xuICAgIGNvbnN0IGZpbGVOYW1lID0gZmlsZS5uYW1lO1xuICAgIGNvbnN0IGV4dCA9IGZpbGVOYW1lLnNwbGl0KCcuJykucG9wKCk/LnRvTG93ZXJDYXNlKCk7XG5cbiAgICBpZiAoZXh0ID09PSAncGRmJykge1xuICAgICAgY29uc3QgYnVmZmVyID0gQnVmZmVyLmZyb20oYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpKTtcbiAgICAgIGNvbnN0IHBkZkRhdGEgPSBhd2FpdCBwZGZQYXJzZShidWZmZXIpO1xuICAgICAgY29udGVudCA9IHBkZkRhdGEudGV4dCB8fCAnJztcbiAgICB9IGVsc2UgaWYgKGV4dCA9PT0gJ3R4dCcgfHwgZXh0ID09PSAnbWQnKSB7XG4gICAgICBjb250ZW50ID0gYXdhaXQgZmlsZS50ZXh0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ+S4jeaUr+aMgeeahOaWh+S7tuagvOW8j++8jOivt+S4iuS8oCBQREbjgIFUWFQg5oiWIE1EIOaWh+S7ticgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghY29udGVudC50cmltKCkpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAn5paH5Lu25YaF5a655Li656m6JyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGBbUmVhZF0g5paH5Lu2OiAke2ZpbGVOYW1lfSwg5a2X5pWwOiAke2NvbnRlbnQubGVuZ3RofSwg5Lu75YqhOiAke3Rhc2tUeXBlfSwg5qih5byPOiAke21vZGV9YCk7XG5cbiAgICBpZiAobW9kZSA9PT0gJ2RlZXAnKSB7XG4gICAgICBjb25zdCBkZWVwVGFzayA9IERFRVBfVEFTS19NQVBbdGFza1R5cGVdO1xuICAgICAgaWYgKCFkZWVwVGFzaykge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogYOeyvuivu+aooeW8j+aaguS4jeaUr+aMgTogJHt0YXNrVHlwZX3vvIznm67liY3ku4XmlK/mjIE6IHBpbmdzaHVgIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBEZWVwUmVhZGVyKHsgdGFzazogZGVlcFRhc2ssIG1vZGVsOiAncXdlbi1wbHVzJyB9KTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlYWRlci5yZWFkKHsgY29udGVudCwgdGl0bGU6IGZpbGVOYW1lIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBmaWxlTmFtZSxcbiAgICAgICAgY29udGVudExlbmd0aDogY29udGVudC5sZW5ndGgsXG4gICAgICAgIHRhc2s6IHRhc2tUeXBlLFxuICAgICAgICBtb2RlOiAnZGVlcCcsXG4gICAgICAgIHJlc3VsdDoge1xuICAgICAgICAgIG91dHB1dFBhdGg6IHJlc3VsdC5vdXRwdXRQYXRoLFxuICAgICAgICAgIHR0c091dHB1dFBhdGg6IHJlc3VsdC50dHNPdXRwdXRQYXRoLFxuICAgICAgICAgIGNoYXB0ZXJDb3VudDogcmVzdWx0LmNoYXB0ZXJDb3VudCxcbiAgICAgICAgICB0b3RhbFdvcmRzOiByZXN1bHQudG90YWxXb3JkcyxcbiAgICAgICAgICBkdXJhdGlvbjogcmVzdWx0LmR1cmF0aW9uLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHNraW1UYXNrID0gU0tJTV9UQVNLX01BUFt0YXNrVHlwZV0gfHwgVEFTS19TVU1NQVJZO1xuICAgICAgY29uc3QgcmVhZGVyID0gbmV3IFJMTVJlYWRlcih7IHRhc2s6IHNraW1UYXNrLCBtb2RlbDogJ3F3ZW4tcGx1cycgfSk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZWFkZXIucmVhZCh7IGNvbnRlbnQsIHRpdGxlOiBmaWxlTmFtZSB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZmlsZU5hbWUsXG4gICAgICAgIGNvbnRlbnRMZW5ndGg6IGNvbnRlbnQubGVuZ3RoLFxuICAgICAgICB0YXNrOiB0YXNrVHlwZSxcbiAgICAgICAgbW9kZTogJ3NraW0nLFxuICAgICAgICByZXN1bHQsXG4gICAgICB9KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1JlYWRdIEVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKCkge1xuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgIHVzYWdlOiB7XG4gICAgICBlbmRwb2ludDogJy9hcGkvcmVhZCcsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGNvbnRlbnRUeXBlOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScsXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgZmlsZTogJyjlv4XpnIApIFBERuOAgVRYVCDmiJYgTUQg5paH5Lu2JyxcbiAgICAgICAgdGFzazogJyjlj6/pgIkpIHBpbmdzaHUo6buY6K6kKSB8IHN1bW1hcnkgfCBzdHVkeS1ub3RlcycsXG4gICAgICAgIG1vZGU6ICco5Y+v6YCJKSBkZWVwKOm7mOiupO+8jOeyvuivu+aUuee8likgfCBza2ltKOmAn+ivu+aRmOimgSknLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGV4YW1wbGVzOiB7XG4gICAgICBkZWVwOiAnY3VybCAtWCBQT1NUIC1GIFwiZmlsZT1AYm9vay5wZGZcIiBodHRwOi8vbG9jYWxob3N0OjMxMDAvYXBpL3JlYWQnLFxuICAgICAgc2tpbTogJ2N1cmwgLVggUE9TVCAtRiBcImZpbGU9QGJvb2sucGRmXCIgLUYgXCJtb2RlPXNraW1cIiAtRiBcInRhc2s9c3VtbWFyeVwiIGh0dHA6Ly9sb2NhbGhvc3Q6MzEwMC9hcGkvcmVhZCcsXG4gICAgfSxcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicGRmUGFyc2UiLCJSTE1SZWFkZXIiLCJEZWVwUmVhZGVyIiwiREVFUF9UQVNLX1BJTkdTSFUiLCJUQVNLX1NUVURZX05PVEVTIiwiVEFTS19TVU1NQVJZIiwiVEFTS19QSU5HU0hVIiwiU0tJTV9UQVNLX01BUCIsIkRFRVBfVEFTS19NQVAiLCJQT1NUIiwicmVxdWVzdCIsImZvcm1EYXRhIiwiZmlsZSIsImdldCIsInRhc2tUeXBlIiwibW9kZSIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsImNvbnRlbnQiLCJmaWxlTmFtZSIsIm5hbWUiLCJleHQiLCJzcGxpdCIsInBvcCIsInRvTG93ZXJDYXNlIiwiYnVmZmVyIiwiQnVmZmVyIiwiZnJvbSIsImFycmF5QnVmZmVyIiwicGRmRGF0YSIsInRleHQiLCJ0cmltIiwiY29uc29sZSIsImxvZyIsImxlbmd0aCIsImRlZXBUYXNrIiwicmVhZGVyIiwidGFzayIsIm1vZGVsIiwicmVzdWx0IiwicmVhZCIsInRpdGxlIiwic3VjY2VzcyIsImNvbnRlbnRMZW5ndGgiLCJvdXRwdXRQYXRoIiwidHRzT3V0cHV0UGF0aCIsImNoYXB0ZXJDb3VudCIsInRvdGFsV29yZHMiLCJkdXJhdGlvbiIsInNraW1UYXNrIiwiRXJyb3IiLCJtZXNzYWdlIiwiR0VUIiwidXNhZ2UiLCJlbmRwb2ludCIsIm1ldGhvZCIsImNvbnRlbnRUeXBlIiwicGFyYW1zIiwiZXhhbXBsZXMiLCJkZWVwIiwic2tpbSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/read/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/deep-reader.ts":
/*!********************************!*\
  !*** ./src/lib/deep-reader.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEEP_TASK_PINGSHU: () => (/* binding */ DEEP_TASK_PINGSHU),\n/* harmony export */   DeepReader: () => (/* binding */ DeepReader),\n/* harmony export */   cleanForTTS: () => (/* binding */ cleanForTTS),\n/* harmony export */   loadDeepReadTask: () => (/* binding */ loadDeepReadTask)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _langchain_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/openai */ \"(rsc)/./node_modules/.pnpm/@langchain+openai@1.2.10_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6__/node_modules/@langchain/openai/dist/index.js\");\n/* harmony import */ var deepagents__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! deepagents */ \"(rsc)/./node_modules/.pnpm/deepagents@1.8.1_openai@6.25.0_zod@4.3.6__react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/deepagents/dist/index.js\");\n/* harmony import */ var _rlm_reader__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./rlm-reader */ \"(rsc)/./src/lib/rlm-reader.ts\");\n/* harmony import */ var _prompts_rlm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./prompts/rlm */ \"(rsc)/./src/lib/prompts/rlm.ts\");\n/* harmony import */ var _tools_deep_reader__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./tools/deep-reader */ \"(rsc)/./src/lib/tools/deep-reader/index.ts\");\n/**\n * DeepReader 精读处理器 (Agent 模式)\n * \n * 采用 RLM 的 Agent 工具调用模式：\n * - Commander Agent 规划场景切分\n * - Writer SubAgent 逐片段生成评书\n * - 每次只处理 2000-3000 字，避免长文本退化\n */ \n\n\n\n\n\n\n// ==================== TTS 文本清洗 ====================\n/**\n * 清洗评书文本，去除舞台指示和 Markdown 格式，使其适合 TTS 朗读\n */ function cleanForTTS(text) {\n    return text// 去掉（...）括号里的舞台指示、表演提示、动作描写\n    .replace(/（[^）]*）/g, \"\")// 去掉 markdown 加粗 **...**\n    .replace(/\\*\\*/g, \"\")// 去掉 markdown 标题行 ## ... / ### ...\n    .replace(/^#{1,6}\\s+.*$/gm, \"\")// 去掉 markdown 分割线 ---\n    .replace(/^-{3,}$/gm, \"\")// 去掉 markdown 引用 > ...\n    .replace(/^>\\s+.*$/gm, \"\")// 去掉 markdown 代码块标记\n    .replace(/^```.*$/gm, \"\")// 去掉文件头部的元信息（生成时间、原文字数等）\n    .replace(/^#\\s+.*\\n/m, \"\")// 去掉空的破折号行\n    .replace(/^——$/gm, \"\")// 合并连续空行为单个空行\n    .replace(/\\n{3,}/g, \"\\n\\n\")// 去掉行首尾多余空白\n    .replace(/^\\s+|\\s+$/gm, (match)=>match.includes(\"\\n\") ? \"\\n\" : \"\").trim();\n}\n// ==================== 默认配置 ====================\nconst DEFAULT_CONFIG = {\n    task: {\n        role: \"你是一个专业的文本改写专家\",\n        purpose: \"逐章改写文本内容\",\n        chapterPrompt: \"请改写本章内容\",\n        outputMode: \"preserve\",\n        contextChapters: 2,\n        maxOutputPerChapter: 5000\n    },\n    chapterSize: 5000,\n    model: process.env.OPENAI_MODEL || \"qwen-plus\",\n    baseURL: process.env.OPENAI_API_BASE || \"https://dashscope.aliyuncs.com/compatible-mode/v1\",\n    enablePreview: true,\n    previewMaxWords: 2000\n};\n// 片段大小配置\nconst SEGMENT_SIZE = 2500; // 每片段约 2500 字\n// ==================== 提示词加载 ====================\nconst PROMPTS_DIR = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"src/lib/prompts/deep-reader\");\nfunction readPromptFile(relativePath) {\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(PROMPTS_DIR, relativePath);\n    try {\n        return fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(fullPath, \"utf-8\");\n    } catch  {\n        console.warn(`[DeepReader] 无法读取提示词文件: ${relativePath}`);\n        return \"\";\n    }\n}\nfunction parseTaskFile(content) {\n    const frontmatterMatch = content.match(/^---\\n([\\s\\S]*?)\\n---/);\n    const result = {};\n    if (frontmatterMatch) {\n        const frontmatter = frontmatterMatch[1];\n        const roleMatch = frontmatter.match(/role:\\s*(.+)/);\n        const purposeMatch = frontmatter.match(/purpose:\\s*(.+)/);\n        const outputModeMatch = frontmatter.match(/outputMode:\\s*(.+)/);\n        const contextChaptersMatch = frontmatter.match(/contextChapters:\\s*(\\d+)/);\n        if (roleMatch) result.role = roleMatch[1].trim();\n        if (purposeMatch) result.purpose = purposeMatch[1].trim();\n        if (outputModeMatch) {\n            result.outputMode = outputModeMatch[1].trim();\n        }\n        if (contextChaptersMatch) {\n            result.contextChapters = parseInt(contextChaptersMatch[1], 10);\n        }\n    }\n    const body = content.replace(/^---\\n[\\s\\S]*?\\n---\\n*/, \"\");\n    if (body.trim()) {\n        result.chapterPrompt = body.trim();\n    }\n    return result;\n}\n/** 加载预设任务配置 */ function loadDeepReadTask(taskName) {\n    const content = readPromptFile(`tasks/${taskName}.txt`);\n    const parsed = parseTaskFile(content);\n    return {\n        role: parsed.role || DEFAULT_CONFIG.task.role,\n        purpose: parsed.purpose || DEFAULT_CONFIG.task.purpose,\n        chapterPrompt: parsed.chapterPrompt || DEFAULT_CONFIG.task.chapterPrompt,\n        outputMode: parsed.outputMode || DEFAULT_CONFIG.task.outputMode,\n        contextChapters: parsed.contextChapters || DEFAULT_CONFIG.task.contextChapters\n    };\n}\n/** 预设任务：评书改编 */ const DEEP_TASK_PINGSHU = loadDeepReadTask(\"pingshu\");\n// ==================== DeepReader 类 ====================\nclass DeepReader {\n    constructor(config){\n        this.chapters = [];\n        this.globalContext = \"\";\n        this.chapterSummaries = [];\n        // 当前章节处理状态\n        this.currentChapter = null;\n        this.segments = [];\n        this.processedSegments = new Set();\n        this.output = \"\";\n        this.previousSummary = \"\";\n        this.outputStream = null;\n        this.toolCallCount = 0;\n        this.config = {\n            task: {\n                ...DEFAULT_CONFIG.task,\n                ...config.task\n            },\n            chapterSize: config.chapterSize || DEFAULT_CONFIG.chapterSize,\n            model: config.model || DEFAULT_CONFIG.model,\n            baseURL: config.baseURL || DEFAULT_CONFIG.baseURL,\n            enablePreview: config.enablePreview ?? DEFAULT_CONFIG.enablePreview,\n            previewMaxWords: config.previewMaxWords || DEFAULT_CONFIG.previewMaxWords\n        };\n    }\n    // ==================== LLM 创建 ====================\n    createLLM(model, options) {\n        return new _langchain_openai__WEBPACK_IMPORTED_MODULE_2__.ChatOpenAI({\n            model,\n            openAIApiKey: process.env.OPENAI_API_KEY,\n            configuration: {\n                baseURL: this.config.baseURL\n            },\n            temperature: options?.temperature ?? 0.7,\n            frequencyPenalty: 0.3,\n            presencePenalty: 0.3\n        });\n    }\n    // ==================== 章节切分 ====================\n    splitIntoChapters(content) {\n        const chapterPattern = /第[一二三四五六七八九十百千\\d]+[章回节篇]/g;\n        const matches = [\n            ...content.matchAll(chapterPattern)\n        ];\n        if (matches.length >= 3) {\n            console.log(`[DeepReader] 识别到 ${matches.length} 个章节标记`);\n            return this.splitByMarkers(content, matches);\n        }\n        console.log(`[DeepReader] 未识别到章节标记，按 ${this.config.chapterSize} 字切分`);\n        return this.splitByLength(content, this.config.chapterSize);\n    }\n    splitByMarkers(content, matches) {\n        const chapters = [];\n        for(let i = 0; i < matches.length; i++){\n            const match = matches[i];\n            const startPos = match.index;\n            const endPos = i < matches.length - 1 ? matches[i + 1].index : content.length;\n            chapters.push({\n                index: i + 1,\n                title: match[0],\n                content: content.slice(startPos, endPos).trim(),\n                charStart: startPos,\n                charEnd: endPos\n            });\n        }\n        return chapters;\n    }\n    splitByLength(content, chunkSize) {\n        const chapters = [];\n        let pos = 0;\n        let index = 1;\n        while(pos < content.length){\n            let endPos = Math.min(pos + chunkSize, content.length);\n            if (endPos < content.length) {\n                const nextParagraph = content.indexOf(\"\\n\\n\", endPos - 500);\n                if (nextParagraph > 0 && nextParagraph < endPos + 500) {\n                    endPos = nextParagraph;\n                }\n            }\n            chapters.push({\n                index,\n                title: `第${index}节`,\n                content: content.slice(pos, endPos).trim(),\n                charStart: pos,\n                charEnd: endPos\n            });\n            pos = endPos;\n            index++;\n        }\n        return chapters;\n    }\n    // ==================== 片段切分 ====================\n    splitChapterIntoSegments(chapter) {\n        const content = chapter.content;\n        const segments = [];\n        let pos = 0;\n        let id = 1;\n        while(pos < content.length){\n            let endPos = Math.min(pos + SEGMENT_SIZE, content.length);\n            // 在段落边界或句号处切分\n            if (endPos < content.length) {\n                // 优先找段落边界\n                const paragraphBreak = content.lastIndexOf(\"\\n\\n\", endPos);\n                if (paragraphBreak > pos + SEGMENT_SIZE * 0.6) {\n                    endPos = paragraphBreak;\n                } else {\n                    // 否则找句号\n                    const sentenceEnd = Math.max(content.lastIndexOf(\"。\", endPos), content.lastIndexOf(\"！\", endPos), content.lastIndexOf(\"？\", endPos), content.lastIndexOf('\"', endPos));\n                    if (sentenceEnd > pos + SEGMENT_SIZE * 0.6) {\n                        endPos = sentenceEnd + 1;\n                    }\n                }\n            }\n            const segmentContent = content.slice(pos, endPos).trim();\n            const preview = segmentContent.slice(0, 100) + (segmentContent.length > 100 ? \"...\" : \"\");\n            segments.push({\n                id,\n                charStart: pos,\n                charEnd: endPos,\n                content: segmentContent,\n                preview\n            });\n            pos = endPos;\n            id++;\n        }\n        return segments;\n    }\n    // ==================== 全局上下文 ====================\n    async generateGlobalContext(content, title) {\n        if (!this.config.enablePreview) {\n            return \"\";\n        }\n        console.log(\"[DeepReader] 生成全局上下文（速读预览）...\");\n        const reader = new _rlm_reader__WEBPACK_IMPORTED_MODULE_4__.RLMReader({\n            task: {\n                ..._prompts_rlm__WEBPACK_IMPORTED_MODULE_5__.TASK_SUMMARY,\n                purpose: \"快速提取文档的核心背景信息，包括：主要人物及其关系、时代背景、情节主线。\",\n                outputFormat: `\n## 时代背景\n（简述故事发生的时代、地点）\n\n## 主要人物\n（列出 5-10 个主要人物，简述身份和关系）\n\n## 情节主线\n（简述故事主线，3-5 句话）\n`\n            },\n            model: this.config.model,\n            baseURL: this.config.baseURL,\n            enableCheckpoint: false\n        });\n        const result = await reader.read({\n            content,\n            title\n        });\n        console.log(`[DeepReader] 全局上下文生成完成（${result.content.length} 字）`);\n        return result.content;\n    }\n    // ==================== 工具处理函数 ====================\n    getChapterInfo() {\n        return {\n            totalChars: this.currentChapter?.content.length || 0,\n            segmentCount: this.segments.length,\n            segments: this.segments.map((s)=>({\n                    id: s.id,\n                    charStart: s.charStart,\n                    charEnd: s.charEnd,\n                    charCount: s.content.length,\n                    preview: s.preview\n                }))\n        };\n    }\n    readSegment(segmentId) {\n        const segment = this.segments.find((s)=>s.id === segmentId);\n        if (!segment) {\n            return `错误：片段 ${segmentId} 不存在。有效范围是 1-${this.segments.length}`;\n        }\n        return segment.content;\n    }\n    /**\n   * 单次生成评书内容（让模型自然写完）\n   * 不强制字数，不分多轮，一次调用自然完成\n   */ async handleSpawnWriter(input) {\n        const segment = this.segments.find((s)=>s.id === input.segmentId);\n        if (!segment) {\n            return {\n                segmentId: input.segmentId,\n                content: `错误：片段 ${input.segmentId} 不存在`,\n                charCount: 0\n            };\n        }\n        const originalText = segment.content;\n        console.log(`    [Writer] 处理片段 ${input.segmentId}/${this.segments.length}（${originalText.length} 字）`);\n        const writerLLM = this.createLLM(this.config.model, {\n            temperature: 0.7\n        });\n        // 一次性改写提示词（使用任务配置中的 role）\n        const prompt = `${this.config.task.role}\n\n## 原文\n${originalText}\n\n## 改写任务\n场景标题：${input.sceneTitle}\n${input.writingHints}\n\n## 要求\n- 忠于原文：对话原样保留，情节按原文顺序完整呈现\n- 口语化：把书面语转成说书人讲故事的口吻，自然朴实\n- 适度过渡：场景切换时加简短过渡语\n- 不要加夸张比喻、大段点评、醒木音效\n- 不要编造原文没有的内容\n- 按原文顺序改写，不要遗漏\n- 写完就结束，不用凑字数\n\n请一次性完成改写：`;\n        // 单次调用，自然写完\n        const response = await writerLLM.invoke([\n            {\n                role: \"user\",\n                content: prompt\n            }\n        ]);\n        const generatedContent = typeof response.content === \"string\" ? response.content : JSON.stringify(response.content);\n        // 更新前情摘要\n        this.previousSummary = generatedContent.slice(-200);\n        // 标记已处理\n        this.processedSegments.add(input.segmentId);\n        // 写入输出（带小节标题）\n        const sectionTitle = `### ${input.sceneTitle}\\n\\n`;\n        if (this.outputStream) {\n            this.outputStream.write(sectionTitle);\n            this.outputStream.write(generatedContent);\n            this.outputStream.write(\"\\n\\n\");\n        }\n        this.output += sectionTitle + generatedContent + \"\\n\\n\";\n        console.log(`    [Writer] 完成，输出 ${generatedContent.length} 字`);\n        return {\n            segmentId: input.segmentId,\n            content: `已生成 ${generatedContent.length} 字评书内容`,\n            charCount: generatedContent.length\n        };\n    }\n    appendOutput(content) {\n        if (this.outputStream) {\n            this.outputStream.write(content);\n            this.outputStream.write(\"\\n\\n\");\n        }\n        this.output += content + \"\\n\\n\";\n        return this.output.length;\n    }\n    checkDone() {\n        const processedCount = this.processedSegments.size;\n        const totalCount = this.segments.length;\n        const canFinish = processedCount >= totalCount;\n        return {\n            canFinish,\n            message: canFinish ? \"所有片段已处理完成\" : `还有 ${totalCount - processedCount} 个片段未处理`,\n            processedSegments: processedCount,\n            totalSegments: totalCount,\n            outputChars: this.output.length\n        };\n    }\n    // ==================== 章节处理（Agent 模式） ====================\n    async processChapterWithAgent(chapter) {\n        // 初始化状态\n        this.currentChapter = chapter;\n        this.segments = this.splitChapterIntoSegments(chapter);\n        this.processedSegments = new Set();\n        this.output = \"\";\n        this.toolCallCount = 0;\n        console.log(`  切分为 ${this.segments.length} 个片段`);\n        // 构建 Commander 提示词\n        const commanderPrompt = readPromptFile(\"commander.txt\").replace(\"{{role}}\", this.config.task.role).replace(\"{{purpose}}\", this.config.task.purpose).replace(\"{{globalContext}}\", this.globalContext.slice(0, 500) || \"（无全局上下文）\");\n        // 创建工具\n        const tools = [\n            (0,_tools_deep_reader__WEBPACK_IMPORTED_MODULE_6__.createGetChapterInfoTool)(()=>{\n                this.toolCallCount++;\n                console.log(`  [工具 #${this.toolCallCount}] get_chapter_info`);\n                const info = this.getChapterInfo();\n                console.log(`    -> ${info.segmentCount} 个片段，共 ${info.totalChars} 字`);\n                return info;\n            }),\n            (0,_tools_deep_reader__WEBPACK_IMPORTED_MODULE_6__.createReadSegmentTool)((segmentId)=>{\n                this.toolCallCount++;\n                console.log(`  [工具 #${this.toolCallCount}] read_segment(${segmentId})`);\n                return this.readSegment(segmentId);\n            }),\n            (0,_tools_deep_reader__WEBPACK_IMPORTED_MODULE_6__.createSpawnWriterTool)(async (input)=>{\n                this.toolCallCount++;\n                console.log(`  [工具 #${this.toolCallCount}] spawn_writer(${input.segmentId}, \"${input.sceneTitle}\")`);\n                return this.handleSpawnWriter(input);\n            }),\n            // append_output 已移除，spawn_writer 直接写入输出\n            (0,_tools_deep_reader__WEBPACK_IMPORTED_MODULE_6__.createDeepReaderDoneTool)(()=>{\n                this.toolCallCount++;\n                const result = this.checkDone();\n                console.log(`  [工具 #${this.toolCallCount}] done -> ${result.canFinish ? \"✓ 完成\" : \"✗ 未完成\"}`);\n                return result;\n            })\n        ];\n        // 创建 Agent\n        const llm = this.createLLM(this.config.model);\n        const agent = (0,deepagents__WEBPACK_IMPORTED_MODULE_3__.createDeepAgent)({\n            model: llm,\n            tools,\n            systemPrompt: commanderPrompt\n        });\n        // 运行 Agent\n        const initMessage = `开始处理章节：${chapter.title}（共 ${chapter.content.length} 字）`;\n        try {\n            await agent.invoke({\n                messages: [\n                    {\n                        role: \"user\",\n                        content: initMessage\n                    }\n                ]\n            }, {\n                recursionLimit: 300\n            });\n        } catch (error) {\n            const errorMsg = error instanceof Error ? error.message : String(error);\n            if (!errorMsg.includes(\"Recursion limit\")) {\n                throw error;\n            }\n            // 递归限制到达，检查是否已完成足够内容\n            console.log(`  [警告] 递归限制到达，已处理 ${this.processedSegments.size}/${this.segments.length} 个片段`);\n        }\n        // 提取本章摘要\n        const summary = this.output.slice(0, 200);\n        this.chapterSummaries.push(summary);\n        return this.output;\n    }\n    // ==================== 主入口 ====================\n    async read(input) {\n        const startTime = Date.now();\n        console.log(\"\");\n        console.log(\"========== DeepReader Agent 模式开始 ==========\");\n        console.log(`文档: ${input.title || \"未命名\"} (${input.content.length.toLocaleString()} 字)`);\n        console.log(`任务: ${this.config.task.purpose}`);\n        console.log(`模型: ${this.config.model}`);\n        // 1. 章节切分\n        this.chapters = this.splitIntoChapters(input.content);\n        console.log(`章节数: ${this.chapters.length}`);\n        // 2. 生成全局上下文\n        if (this.config.enablePreview) {\n            this.globalContext = await this.generateGlobalContext(input.content, input.title || \"\");\n        }\n        // 3. 准备输出文件\n        const outputDir = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"out\", \"deep\");\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(outputDir)) {\n            fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(outputDir, {\n                recursive: true\n            });\n        }\n        const timestamp = new Date().toISOString().replace(/[:.]/g, \"-\").slice(0, 19);\n        const baseName = (input.title || \"document\").replace(/\\.[^.]+$/, \"\");\n        const outputFileName = `${baseName}_deep_${timestamp}.md`;\n        const outputPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(outputDir, outputFileName);\n        // 4. 创建输出流\n        this.outputStream = fs__WEBPACK_IMPORTED_MODULE_0___default().createWriteStream(outputPath, {\n            encoding: \"utf-8\"\n        });\n        this.outputStream.write(`# ${input.title || \"精读输出\"}\\n\\n`);\n        this.outputStream.write(`> 生成时间: ${new Date().toLocaleString(\"zh-CN\")}\\n`);\n        this.outputStream.write(`> 原文字数: ${input.content.length.toLocaleString()}\\n`);\n        this.outputStream.write(`> 章节数: ${this.chapters.length}\\n`);\n        this.outputStream.write(`> 模式: Agent (分片段处理)\\n\\n`);\n        this.outputStream.write(`---\\n\\n`);\n        // 5. 逐章处理\n        let totalWords = 0;\n        console.log(\"\");\n        console.log(\"开始逐章处理（Agent 模式）...\");\n        for(let i = 0; i < this.chapters.length; i++){\n            const chapter = this.chapters[i];\n            console.log(\"\");\n            console.log(`[章节 ${i + 1}/${this.chapters.length}] ${chapter.title}（${chapter.content.length} 字）`);\n            try {\n                // 写入章节标题\n                this.outputStream.write(`## ${chapter.title}\\n\\n`);\n                const chapterOutput = await this.processChapterWithAgent(chapter);\n                totalWords += chapterOutput.length;\n                this.outputStream.write(\"\\n---\\n\\n\");\n                console.log(`  ✓ 章节完成，输出 ${chapterOutput.length.toLocaleString()} 字`);\n                // 短暂延迟\n                if (i < this.chapters.length - 1) {\n                    await new Promise((resolve)=>setTimeout(resolve, 1000));\n                }\n            } catch (error) {\n                const errorMsg = error instanceof Error ? error.message : String(error);\n                console.log(`  ✗ 失败: ${errorMsg}`);\n                this.outputStream.write(`[处理失败: ${errorMsg}]\\n\\n---\\n\\n`);\n            }\n        }\n        this.outputStream.end();\n        // 6. 生成 TTS 清洗版本（去掉舞台指示、Markdown 格式）\n        const ttsFileName = `${baseName}_deep_${timestamp}_tts.txt`;\n        const ttsPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(outputDir, ttsFileName);\n        const ttsContent = cleanForTTS(this.output);\n        fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(ttsPath, ttsContent, \"utf-8\");\n        console.log(`TTS 清洗版: ${ttsPath} (${ttsContent.length.toLocaleString()} 字)`);\n        const duration = (Date.now() - startTime) / 1000;\n        console.log(\"\");\n        console.log(\"========== DeepReader Agent 模式完成 ==========\");\n        console.log(`章节数: ${this.chapters.length}`);\n        console.log(`输出字数: ${totalWords.toLocaleString()}`);\n        console.log(`TTS 版字数: ${ttsContent.length.toLocaleString()}`);\n        console.log(`耗时: ${duration.toFixed(1)} 秒`);\n        console.log(`输出文件: ${outputPath}`);\n        console.log(`TTS 文件: ${ttsPath}`);\n        console.log(\"\");\n        return {\n            outputPath: `out/deep/${outputFileName}`,\n            ttsOutputPath: `out/deep/${ttsFileName}`,\n            chapterCount: this.chapters.length,\n            totalWords,\n            globalContext: this.globalContext,\n            duration\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1FBRVosT0FBTztZQUNMNkYsWUFBWSxDQUFDLFNBQVMsRUFBRUQsZUFBZSxDQUFDO1lBQ3hDZ0IsZUFBZSxDQUFDLFNBQVMsRUFBRU4sWUFBWSxDQUFDO1lBQ3hDTyxjQUFjLElBQUksQ0FBQ3JJLFFBQVEsQ0FBQ3VCLE1BQU07WUFDbENpRztZQUNBdkgsZUFBZSxJQUFJLENBQUNBLGFBQWE7WUFDakNpSTtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL3NyYy9saWIvZGVlcC1yZWFkZXIudHM/NTg0OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERlZXBSZWFkZXIg57K+6K+75aSE55CG5ZmoIChBZ2VudCDmqKHlvI8pXG4gKiBcbiAqIOmHh+eUqCBSTE0g55qEIEFnZW50IOW3peWFt+iwg+eUqOaooeW8j++8mlxuICogLSBDb21tYW5kZXIgQWdlbnQg6KeE5YiS5Zy65pmv5YiH5YiGXG4gKiAtIFdyaXRlciBTdWJBZ2VudCDpgJDniYfmrrXnlJ/miJDor4TkuaZcbiAqIC0g5q+P5qyh5Y+q5aSE55CGIDIwMDAtMzAwMCDlrZfvvIzpgb/lhY3plb/mlofmnKzpgIDljJZcbiAqL1xuXG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBDaGF0T3BlbkFJIH0gZnJvbSAnQGxhbmdjaGFpbi9vcGVuYWknO1xuaW1wb3J0IHsgY3JlYXRlRGVlcEFnZW50IH0gZnJvbSAnZGVlcGFnZW50cyc7XG5pbXBvcnQgeyBSTE1SZWFkZXIgfSBmcm9tICcuL3JsbS1yZWFkZXInO1xuaW1wb3J0IHsgVEFTS19TVU1NQVJZIH0gZnJvbSAnLi9wcm9tcHRzL3JsbSc7XG5pbXBvcnQge1xuICBjcmVhdGVHZXRDaGFwdGVySW5mb1Rvb2wsXG4gIGNyZWF0ZVJlYWRTZWdtZW50VG9vbCxcbiAgY3JlYXRlU3Bhd25Xcml0ZXJUb29sLFxuICBjcmVhdGVBcHBlbmRPdXRwdXRUb29sLFxuICBjcmVhdGVEZWVwUmVhZGVyRG9uZVRvb2wsXG4gIHR5cGUgQ2hhcHRlckluZm8sXG4gIHR5cGUgU3Bhd25Xcml0ZXJJbnB1dCxcbiAgdHlwZSBTcGF3bldyaXRlclJlc3VsdCxcbiAgdHlwZSBEb25lQ2hlY2tSZXN1bHQsXG59IGZyb20gJy4vdG9vbHMvZGVlcC1yZWFkZXInO1xuaW1wb3J0IHR5cGUge1xuICBDaGFwdGVyLFxuICBEZWVwUmVhZGVyQ29uZmlnLFxuICBEZWVwUmVhZFRhc2tDb25maWcsXG4gIERlZXBSZWFkZXJPdXRwdXQsXG4gIERvY3VtZW50SW5wdXQsXG59IGZyb20gJy4vdHlwZXMnO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PSBUVFMg5paH5pys5riF5rSXID09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICog5riF5rSX6K+E5Lmm5paH5pys77yM5Y676Zmk6Iie5Y+w5oyH56S65ZKMIE1hcmtkb3duIOagvOW8j++8jOS9v+WFtumAguWQiCBUVFMg5pyX6K+7XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGVhbkZvclRUUyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gdGV4dFxuICAgIC8vIOWOu+aOie+8iC4uLu+8ieaLrOWPt+mHjOeahOiInuWPsOaMh+ekuuOAgeihqOa8lOaPkOekuuOAgeWKqOS9nOaPj+WGmVxuICAgIC5yZXBsYWNlKC/vvIhbXu+8iV0q77yJL2csICcnKVxuICAgIC8vIOWOu+aOiSBtYXJrZG93biDliqDnspcgKiouLi4qKlxuICAgIC5yZXBsYWNlKC9cXCpcXCovZywgJycpXG4gICAgLy8g5Y675o6JIG1hcmtkb3duIOagh+mimOihjCAjIyAuLi4gLyAjIyMgLi4uXG4gICAgLnJlcGxhY2UoL14jezEsNn1cXHMrLiokL2dtLCAnJylcbiAgICAvLyDljrvmjokgbWFya2Rvd24g5YiG5Ymy57q/IC0tLVxuICAgIC5yZXBsYWNlKC9eLXszLH0kL2dtLCAnJylcbiAgICAvLyDljrvmjokgbWFya2Rvd24g5byV55SoID4gLi4uXG4gICAgLnJlcGxhY2UoL14+XFxzKy4qJC9nbSwgJycpXG4gICAgLy8g5Y675o6JIG1hcmtkb3duIOS7o+eggeWdl+agh+iusFxuICAgIC5yZXBsYWNlKC9eYGBgLiokL2dtLCAnJylcbiAgICAvLyDljrvmjonmlofku7blpLTpg6jnmoTlhYPkv6Hmga/vvIjnlJ/miJDml7bpl7TjgIHljp/mloflrZfmlbDnrYnvvIlcbiAgICAucmVwbGFjZSgvXiNcXHMrLipcXG4vbSwgJycpXG4gICAgLy8g5Y675o6J56m655qE56C05oqY5Y+36KGMXG4gICAgLnJlcGxhY2UoL17igJTigJQkL2dtLCAnJylcbiAgICAvLyDlkIjlubbov57nu63nqbrooYzkuLrljZXkuKrnqbrooYxcbiAgICAucmVwbGFjZSgvXFxuezMsfS9nLCAnXFxuXFxuJylcbiAgICAvLyDljrvmjonooYzpppblsL7lpJrkvZnnqbrnmb1cbiAgICAucmVwbGFjZSgvXlxccyt8XFxzKyQvZ20sIChtYXRjaCkgPT4gbWF0Y2guaW5jbHVkZXMoJ1xcbicpID8gJ1xcbicgOiAnJylcbiAgICAudHJpbSgpO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PSDniYfmrrXnsbvlnosgPT09PT09PT09PT09PT09PT09PT1cblxuaW50ZXJmYWNlIFNlZ21lbnQge1xuICBpZDogbnVtYmVyO1xuICBjaGFyU3RhcnQ6IG51bWJlcjtcbiAgY2hhckVuZDogbnVtYmVyO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHByZXZpZXc6IHN0cmluZztcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT0g6buY6K6k6YWN572uID09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IERFRkFVTFRfQ09ORklHOiBSZXF1aXJlZDxEZWVwUmVhZGVyQ29uZmlnPiA9IHtcbiAgdGFzazoge1xuICAgIHJvbGU6ICfkvaDmmK/kuIDkuKrkuJPkuJrnmoTmlofmnKzmlLnlhpnkuJPlrrYnLFxuICAgIHB1cnBvc2U6ICfpgJDnq6DmlLnlhpnmlofmnKzlhoXlrrknLFxuICAgIGNoYXB0ZXJQcm9tcHQ6ICfor7fmlLnlhpnmnKznq6DlhoXlrrknLFxuICAgIG91dHB1dE1vZGU6ICdwcmVzZXJ2ZScsXG4gICAgY29udGV4dENoYXB0ZXJzOiAyLFxuICAgIG1heE91dHB1dFBlckNoYXB0ZXI6IDUwMDAsXG4gIH0sXG4gIGNoYXB0ZXJTaXplOiA1MDAwLFxuICBtb2RlbDogcHJvY2Vzcy5lbnYuT1BFTkFJX01PREVMIHx8ICdxd2VuLXBsdXMnLFxuICBiYXNlVVJMOiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0JBU0UgfHwgJ2h0dHBzOi8vZGFzaHNjb3BlLmFsaXl1bmNzLmNvbS9jb21wYXRpYmxlLW1vZGUvdjEnLFxuICBlbmFibGVQcmV2aWV3OiB0cnVlLFxuICBwcmV2aWV3TWF4V29yZHM6IDIwMDAsXG59O1xuXG4vLyDniYfmrrXlpKflsI/phY3nva5cbmNvbnN0IFNFR01FTlRfU0laRSA9IDI1MDA7IC8vIOavj+eJh+autee6piAyNTAwIOWtl1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PSDmj5DnpLror43liqDovb0gPT09PT09PT09PT09PT09PT09PT1cblxuY29uc3QgUFJPTVBUU19ESVIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3NyYy9saWIvcHJvbXB0cy9kZWVwLXJlYWRlcicpO1xuXG5mdW5jdGlvbiByZWFkUHJvbXB0RmlsZShyZWxhdGl2ZVBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5qb2luKFBST01QVFNfRElSLCByZWxhdGl2ZVBhdGgpO1xuICB0cnkge1xuICAgIHJldHVybiBmcy5yZWFkRmlsZVN5bmMoZnVsbFBhdGgsICd1dGYtOCcpO1xuICB9IGNhdGNoIHtcbiAgICBjb25zb2xlLndhcm4oYFtEZWVwUmVhZGVyXSDml6Dms5Xor7vlj5bmj5DnpLror43mlofku7Y6ICR7cmVsYXRpdmVQYXRofWApO1xuICAgIHJldHVybiAnJztcbiAgfVxufVxuXG5mdW5jdGlvbiBwYXJzZVRhc2tGaWxlKGNvbnRlbnQ6IHN0cmluZyk6IFBhcnRpYWw8RGVlcFJlYWRUYXNrQ29uZmlnPiB7XG4gIGNvbnN0IGZyb250bWF0dGVyTWF0Y2ggPSBjb250ZW50Lm1hdGNoKC9eLS0tXFxuKFtcXHNcXFNdKj8pXFxuLS0tLyk7XG4gIGNvbnN0IHJlc3VsdDogUGFydGlhbDxEZWVwUmVhZFRhc2tDb25maWc+ID0ge307XG5cbiAgaWYgKGZyb250bWF0dGVyTWF0Y2gpIHtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGZyb250bWF0dGVyTWF0Y2hbMV07XG4gICAgY29uc3Qgcm9sZU1hdGNoID0gZnJvbnRtYXR0ZXIubWF0Y2goL3JvbGU6XFxzKiguKykvKTtcbiAgICBjb25zdCBwdXJwb3NlTWF0Y2ggPSBmcm9udG1hdHRlci5tYXRjaCgvcHVycG9zZTpcXHMqKC4rKS8pO1xuICAgIGNvbnN0IG91dHB1dE1vZGVNYXRjaCA9IGZyb250bWF0dGVyLm1hdGNoKC9vdXRwdXRNb2RlOlxccyooLispLyk7XG4gICAgY29uc3QgY29udGV4dENoYXB0ZXJzTWF0Y2ggPSBmcm9udG1hdHRlci5tYXRjaCgvY29udGV4dENoYXB0ZXJzOlxccyooXFxkKykvKTtcblxuICAgIGlmIChyb2xlTWF0Y2gpIHJlc3VsdC5yb2xlID0gcm9sZU1hdGNoWzFdLnRyaW0oKTtcbiAgICBpZiAocHVycG9zZU1hdGNoKSByZXN1bHQucHVycG9zZSA9IHB1cnBvc2VNYXRjaFsxXS50cmltKCk7XG4gICAgaWYgKG91dHB1dE1vZGVNYXRjaCkge1xuICAgICAgcmVzdWx0Lm91dHB1dE1vZGUgPSBvdXRwdXRNb2RlTWF0Y2hbMV0udHJpbSgpIGFzICdleHBhbmQnIHwgJ3ByZXNlcnZlJyB8ICdjb21wcmVzcyc7XG4gICAgfVxuICAgIGlmIChjb250ZXh0Q2hhcHRlcnNNYXRjaCkge1xuICAgICAgcmVzdWx0LmNvbnRleHRDaGFwdGVycyA9IHBhcnNlSW50KGNvbnRleHRDaGFwdGVyc01hdGNoWzFdLCAxMCk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgYm9keSA9IGNvbnRlbnQucmVwbGFjZSgvXi0tLVxcbltcXHNcXFNdKj9cXG4tLS1cXG4qLywgJycpO1xuICBpZiAoYm9keS50cmltKCkpIHtcbiAgICByZXN1bHQuY2hhcHRlclByb21wdCA9IGJvZHkudHJpbSgpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqIOWKoOi9vemihOiuvuS7u+WKoemFjee9riAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvYWREZWVwUmVhZFRhc2sodGFza05hbWU6IHN0cmluZyk6IERlZXBSZWFkVGFza0NvbmZpZyB7XG4gIGNvbnN0IGNvbnRlbnQgPSByZWFkUHJvbXB0RmlsZShgdGFza3MvJHt0YXNrTmFtZX0udHh0YCk7XG4gIGNvbnN0IHBhcnNlZCA9IHBhcnNlVGFza0ZpbGUoY29udGVudCk7XG4gIHJldHVybiB7XG4gICAgcm9sZTogcGFyc2VkLnJvbGUgfHwgREVGQVVMVF9DT05GSUcudGFzay5yb2xlLFxuICAgIHB1cnBvc2U6IHBhcnNlZC5wdXJwb3NlIHx8IERFRkFVTFRfQ09ORklHLnRhc2sucHVycG9zZSxcbiAgICBjaGFwdGVyUHJvbXB0OiBwYXJzZWQuY2hhcHRlclByb21wdCB8fCBERUZBVUxUX0NPTkZJRy50YXNrLmNoYXB0ZXJQcm9tcHQsXG4gICAgb3V0cHV0TW9kZTogcGFyc2VkLm91dHB1dE1vZGUgfHwgREVGQVVMVF9DT05GSUcudGFzay5vdXRwdXRNb2RlLFxuICAgIGNvbnRleHRDaGFwdGVyczogcGFyc2VkLmNvbnRleHRDaGFwdGVycyB8fCBERUZBVUxUX0NPTkZJRy50YXNrLmNvbnRleHRDaGFwdGVycyxcbiAgfTtcbn1cblxuLyoqIOmihOiuvuS7u+WKoe+8muivhOS5puaUuee8liAqL1xuZXhwb3J0IGNvbnN0IERFRVBfVEFTS19QSU5HU0hVID0gbG9hZERlZXBSZWFkVGFzaygncGluZ3NodScpO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PSBEZWVwUmVhZGVyIOexuyA9PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY2xhc3MgRGVlcFJlYWRlciB7XG4gIHByaXZhdGUgY29uZmlnOiBSZXF1aXJlZDxEZWVwUmVhZGVyQ29uZmlnPjtcbiAgcHJpdmF0ZSBjaGFwdGVyczogQ2hhcHRlcltdID0gW107XG4gIHByaXZhdGUgZ2xvYmFsQ29udGV4dDogc3RyaW5nID0gJyc7XG4gIHByaXZhdGUgY2hhcHRlclN1bW1hcmllczogc3RyaW5nW10gPSBbXTtcbiAgXG4gIC8vIOW9k+WJjeeroOiKguWkhOeQhueKtuaAgVxuICBwcml2YXRlIGN1cnJlbnRDaGFwdGVyOiBDaGFwdGVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgc2VnbWVudHM6IFNlZ21lbnRbXSA9IFtdO1xuICBwcml2YXRlIHByb2Nlc3NlZFNlZ21lbnRzOiBTZXQ8bnVtYmVyPiA9IG5ldyBTZXQoKTtcbiAgcHJpdmF0ZSBvdXRwdXQ6IHN0cmluZyA9ICcnO1xuICBwcml2YXRlIHByZXZpb3VzU3VtbWFyeTogc3RyaW5nID0gJyc7XG4gIHByaXZhdGUgb3V0cHV0U3RyZWFtOiBmcy5Xcml0ZVN0cmVhbSB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHRvb2xDYWxsQ291bnQ6IG51bWJlciA9IDA7XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBEZWVwUmVhZGVyQ29uZmlnKSB7XG4gICAgdGhpcy5jb25maWcgPSB7XG4gICAgICB0YXNrOiB7IC4uLkRFRkFVTFRfQ09ORklHLnRhc2ssIC4uLmNvbmZpZy50YXNrIH0sXG4gICAgICBjaGFwdGVyU2l6ZTogY29uZmlnLmNoYXB0ZXJTaXplIHx8IERFRkFVTFRfQ09ORklHLmNoYXB0ZXJTaXplLFxuICAgICAgbW9kZWw6IGNvbmZpZy5tb2RlbCB8fCBERUZBVUxUX0NPTkZJRy5tb2RlbCxcbiAgICAgIGJhc2VVUkw6IGNvbmZpZy5iYXNlVVJMIHx8IERFRkFVTFRfQ09ORklHLmJhc2VVUkwsXG4gICAgICBlbmFibGVQcmV2aWV3OiBjb25maWcuZW5hYmxlUHJldmlldyA/PyBERUZBVUxUX0NPTkZJRy5lbmFibGVQcmV2aWV3LFxuICAgICAgcHJldmlld01heFdvcmRzOiBjb25maWcucHJldmlld01heFdvcmRzIHx8IERFRkFVTFRfQ09ORklHLnByZXZpZXdNYXhXb3JkcyxcbiAgICB9O1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT0gTExNIOWIm+W7uiA9PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgY3JlYXRlTExNKG1vZGVsOiBzdHJpbmcsIG9wdGlvbnM/OiB7IHRlbXBlcmF0dXJlPzogbnVtYmVyIH0pOiBDaGF0T3BlbkFJIHtcbiAgICByZXR1cm4gbmV3IENoYXRPcGVuQUkoe1xuICAgICAgbW9kZWwsXG4gICAgICBvcGVuQUlBcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZLFxuICAgICAgY29uZmlndXJhdGlvbjoge1xuICAgICAgICBiYXNlVVJMOiB0aGlzLmNvbmZpZy5iYXNlVVJMLFxuICAgICAgfSxcbiAgICAgIHRlbXBlcmF0dXJlOiBvcHRpb25zPy50ZW1wZXJhdHVyZSA/PyAwLjcsXG4gICAgICBmcmVxdWVuY3lQZW5hbHR5OiAwLjMsXG4gICAgICBwcmVzZW5jZVBlbmFsdHk6IDAuMyxcbiAgICB9KTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09IOeroOiKguWIh+WIhiA9PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgc3BsaXRJbnRvQ2hhcHRlcnMoY29udGVudDogc3RyaW5nKTogQ2hhcHRlcltdIHtcbiAgICBjb25zdCBjaGFwdGVyUGF0dGVybiA9IC/nrKxb5LiA5LqM5LiJ5Zub5LqU5YWt5LiD5YWr5Lmd5Y2B55m+5Y2DXFxkXStb56ug5Zue6IqC56+HXS9nO1xuICAgIGNvbnN0IG1hdGNoZXMgPSBbLi4uY29udGVudC5tYXRjaEFsbChjaGFwdGVyUGF0dGVybildO1xuXG4gICAgaWYgKG1hdGNoZXMubGVuZ3RoID49IDMpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBbRGVlcFJlYWRlcl0g6K+G5Yir5YiwICR7bWF0Y2hlcy5sZW5ndGh9IOS4queroOiKguagh+iusGApO1xuICAgICAgcmV0dXJuIHRoaXMuc3BsaXRCeU1hcmtlcnMoY29udGVudCwgbWF0Y2hlcyk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYFtEZWVwUmVhZGVyXSDmnKror4bliKvliLDnq6DoioLmoIforrDvvIzmjIkgJHt0aGlzLmNvbmZpZy5jaGFwdGVyU2l6ZX0g5a2X5YiH5YiGYCk7XG4gICAgcmV0dXJuIHRoaXMuc3BsaXRCeUxlbmd0aChjb250ZW50LCB0aGlzLmNvbmZpZy5jaGFwdGVyU2l6ZSk7XG4gIH1cblxuICBwcml2YXRlIHNwbGl0QnlNYXJrZXJzKGNvbnRlbnQ6IHN0cmluZywgbWF0Y2hlczogUmVnRXhwTWF0Y2hBcnJheVtdKTogQ2hhcHRlcltdIHtcbiAgICBjb25zdCBjaGFwdGVyczogQ2hhcHRlcltdID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXRjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBtYXRjaCA9IG1hdGNoZXNbaV07XG4gICAgICBjb25zdCBzdGFydFBvcyA9IG1hdGNoLmluZGV4ITtcbiAgICAgIGNvbnN0IGVuZFBvcyA9IGkgPCBtYXRjaGVzLmxlbmd0aCAtIDEgPyBtYXRjaGVzW2kgKyAxXS5pbmRleCEgOiBjb250ZW50Lmxlbmd0aDtcbiAgICAgIGNoYXB0ZXJzLnB1c2goe1xuICAgICAgICBpbmRleDogaSArIDEsXG4gICAgICAgIHRpdGxlOiBtYXRjaFswXSxcbiAgICAgICAgY29udGVudDogY29udGVudC5zbGljZShzdGFydFBvcywgZW5kUG9zKS50cmltKCksXG4gICAgICAgIGNoYXJTdGFydDogc3RhcnRQb3MsXG4gICAgICAgIGNoYXJFbmQ6IGVuZFBvcyxcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gY2hhcHRlcnM7XG4gIH1cblxuICBwcml2YXRlIHNwbGl0QnlMZW5ndGgoY29udGVudDogc3RyaW5nLCBjaHVua1NpemU6IG51bWJlcik6IENoYXB0ZXJbXSB7XG4gICAgY29uc3QgY2hhcHRlcnM6IENoYXB0ZXJbXSA9IFtdO1xuICAgIGxldCBwb3MgPSAwO1xuICAgIGxldCBpbmRleCA9IDE7XG4gICAgd2hpbGUgKHBvcyA8IGNvbnRlbnQubGVuZ3RoKSB7XG4gICAgICBsZXQgZW5kUG9zID0gTWF0aC5taW4ocG9zICsgY2h1bmtTaXplLCBjb250ZW50Lmxlbmd0aCk7XG4gICAgICBpZiAoZW5kUG9zIDwgY29udGVudC5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgbmV4dFBhcmFncmFwaCA9IGNvbnRlbnQuaW5kZXhPZignXFxuXFxuJywgZW5kUG9zIC0gNTAwKTtcbiAgICAgICAgaWYgKG5leHRQYXJhZ3JhcGggPiAwICYmIG5leHRQYXJhZ3JhcGggPCBlbmRQb3MgKyA1MDApIHtcbiAgICAgICAgICBlbmRQb3MgPSBuZXh0UGFyYWdyYXBoO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjaGFwdGVycy5wdXNoKHtcbiAgICAgICAgaW5kZXgsXG4gICAgICAgIHRpdGxlOiBg56ysJHtpbmRleH3oioJgLFxuICAgICAgICBjb250ZW50OiBjb250ZW50LnNsaWNlKHBvcywgZW5kUG9zKS50cmltKCksXG4gICAgICAgIGNoYXJTdGFydDogcG9zLFxuICAgICAgICBjaGFyRW5kOiBlbmRQb3MsXG4gICAgICB9KTtcbiAgICAgIHBvcyA9IGVuZFBvcztcbiAgICAgIGluZGV4Kys7XG4gICAgfVxuICAgIHJldHVybiBjaGFwdGVycztcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09IOeJh+auteWIh+WIhiA9PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgc3BsaXRDaGFwdGVySW50b1NlZ21lbnRzKGNoYXB0ZXI6IENoYXB0ZXIpOiBTZWdtZW50W10ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBjaGFwdGVyLmNvbnRlbnQ7XG4gICAgY29uc3Qgc2VnbWVudHM6IFNlZ21lbnRbXSA9IFtdO1xuICAgIGxldCBwb3MgPSAwO1xuICAgIGxldCBpZCA9IDE7XG5cbiAgICB3aGlsZSAocG9zIDwgY29udGVudC5sZW5ndGgpIHtcbiAgICAgIGxldCBlbmRQb3MgPSBNYXRoLm1pbihwb3MgKyBTRUdNRU5UX1NJWkUsIGNvbnRlbnQubGVuZ3RoKTtcbiAgICAgIFxuICAgICAgLy8g5Zyo5q616JC96L6555WM5oiW5Y+l5Y+35aSE5YiH5YiGXG4gICAgICBpZiAoZW5kUG9zIDwgY29udGVudC5sZW5ndGgpIHtcbiAgICAgICAgLy8g5LyY5YWI5om+5q616JC96L6555WMXG4gICAgICAgIGNvbnN0IHBhcmFncmFwaEJyZWFrID0gY29udGVudC5sYXN0SW5kZXhPZignXFxuXFxuJywgZW5kUG9zKTtcbiAgICAgICAgaWYgKHBhcmFncmFwaEJyZWFrID4gcG9zICsgU0VHTUVOVF9TSVpFICogMC42KSB7XG4gICAgICAgICAgZW5kUG9zID0gcGFyYWdyYXBoQnJlYWs7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8g5ZCm5YiZ5om+5Y+l5Y+3XG4gICAgICAgICAgY29uc3Qgc2VudGVuY2VFbmQgPSBNYXRoLm1heChcbiAgICAgICAgICAgIGNvbnRlbnQubGFzdEluZGV4T2YoJ+OAgicsIGVuZFBvcyksXG4gICAgICAgICAgICBjb250ZW50Lmxhc3RJbmRleE9mKCfvvIEnLCBlbmRQb3MpLFxuICAgICAgICAgICAgY29udGVudC5sYXN0SW5kZXhPZign77yfJywgZW5kUG9zKSxcbiAgICAgICAgICAgIGNvbnRlbnQubGFzdEluZGV4T2YoJ1wiJywgZW5kUG9zKSxcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChzZW50ZW5jZUVuZCA+IHBvcyArIFNFR01FTlRfU0laRSAqIDAuNikge1xuICAgICAgICAgICAgZW5kUG9zID0gc2VudGVuY2VFbmQgKyAxO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBzZWdtZW50Q29udGVudCA9IGNvbnRlbnQuc2xpY2UocG9zLCBlbmRQb3MpLnRyaW0oKTtcbiAgICAgIGNvbnN0IHByZXZpZXcgPSBzZWdtZW50Q29udGVudC5zbGljZSgwLCAxMDApICsgKHNlZ21lbnRDb250ZW50Lmxlbmd0aCA+IDEwMCA/ICcuLi4nIDogJycpO1xuXG4gICAgICBzZWdtZW50cy5wdXNoKHtcbiAgICAgICAgaWQsXG4gICAgICAgIGNoYXJTdGFydDogcG9zLFxuICAgICAgICBjaGFyRW5kOiBlbmRQb3MsXG4gICAgICAgIGNvbnRlbnQ6IHNlZ21lbnRDb250ZW50LFxuICAgICAgICBwcmV2aWV3LFxuICAgICAgfSk7XG5cbiAgICAgIHBvcyA9IGVuZFBvcztcbiAgICAgIGlkKys7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNlZ21lbnRzO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT0g5YWo5bGA5LiK5LiL5paHID09PT09PT09PT09PT09PT09PT09XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUdsb2JhbENvbnRleHQoY29udGVudDogc3RyaW5nLCB0aXRsZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBpZiAoIXRoaXMuY29uZmlnLmVuYWJsZVByZXZpZXcpIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnW0RlZXBSZWFkZXJdIOeUn+aIkOWFqOWxgOS4iuS4i+aWh++8iOmAn+ivu+mihOiniO+8iS4uLicpO1xuXG4gICAgY29uc3QgcmVhZGVyID0gbmV3IFJMTVJlYWRlcih7XG4gICAgICB0YXNrOiB7XG4gICAgICAgIC4uLlRBU0tfU1VNTUFSWSxcbiAgICAgICAgcHVycG9zZTogJ+W/q+mAn+aPkOWPluaWh+aho+eahOaguOW/g+iDjOaZr+S/oeaBr++8jOWMheaLrO+8muS4u+imgeS6uueJqeWPiuWFtuWFs+ezu+OAgeaXtuS7o+iDjOaZr+OAgeaDheiKguS4u+e6v+OAgicsXG4gICAgICAgIG91dHB1dEZvcm1hdDogYFxuIyMg5pe25Luj6IOM5pmvXG7vvIjnroDov7DmlYXkuovlj5HnlJ/nmoTml7bku6PjgIHlnLDngrnvvIlcblxuIyMg5Li76KaB5Lq654mpXG7vvIjliJflh7ogNS0xMCDkuKrkuLvopoHkurrnianvvIznroDov7Douqvku73lkozlhbPns7vvvIlcblxuIyMg5oOF6IqC5Li757q/XG7vvIjnroDov7DmlYXkuovkuLvnur/vvIwzLTUg5Y+l6K+d77yJXG5gLFxuICAgICAgfSxcbiAgICAgIG1vZGVsOiB0aGlzLmNvbmZpZy5tb2RlbCxcbiAgICAgIGJhc2VVUkw6IHRoaXMuY29uZmlnLmJhc2VVUkwsXG4gICAgICBlbmFibGVDaGVja3BvaW50OiBmYWxzZSwgLy8g6YCf6K+76aKE6KeI5q+P5qyh5a6M5pW05omn6KGM77yM5LiN6ZyA6KaB6K6w5b2V5Y6G5Y+yXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZWFkZXIucmVhZCh7IGNvbnRlbnQsIHRpdGxlIH0pO1xuICAgIGNvbnNvbGUubG9nKGBbRGVlcFJlYWRlcl0g5YWo5bGA5LiK5LiL5paH55Sf5oiQ5a6M5oiQ77yIJHtyZXN1bHQuY29udGVudC5sZW5ndGh9IOWtl++8iWApO1xuICAgIHJldHVybiByZXN1bHQuY29udGVudDtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09IOW3peWFt+WkhOeQhuWHveaVsCA9PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgZ2V0Q2hhcHRlckluZm8oKTogQ2hhcHRlckluZm8ge1xuICAgIHJldHVybiB7XG4gICAgICB0b3RhbENoYXJzOiB0aGlzLmN1cnJlbnRDaGFwdGVyPy5jb250ZW50Lmxlbmd0aCB8fCAwLFxuICAgICAgc2VnbWVudENvdW50OiB0aGlzLnNlZ21lbnRzLmxlbmd0aCxcbiAgICAgIHNlZ21lbnRzOiB0aGlzLnNlZ21lbnRzLm1hcChzID0+ICh7XG4gICAgICAgIGlkOiBzLmlkLFxuICAgICAgICBjaGFyU3RhcnQ6IHMuY2hhclN0YXJ0LFxuICAgICAgICBjaGFyRW5kOiBzLmNoYXJFbmQsXG4gICAgICAgIGNoYXJDb3VudDogcy5jb250ZW50Lmxlbmd0aCxcbiAgICAgICAgcHJldmlldzogcy5wcmV2aWV3LFxuICAgICAgfSkpLFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIHJlYWRTZWdtZW50KHNlZ21lbnRJZDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBzZWdtZW50ID0gdGhpcy5zZWdtZW50cy5maW5kKHMgPT4gcy5pZCA9PT0gc2VnbWVudElkKTtcbiAgICBpZiAoIXNlZ21lbnQpIHtcbiAgICAgIHJldHVybiBg6ZSZ6K+v77ya54mH5q61ICR7c2VnbWVudElkfSDkuI3lrZjlnKjjgILmnInmlYjojIPlm7TmmK8gMS0ke3RoaXMuc2VnbWVudHMubGVuZ3RofWA7XG4gICAgfVxuICAgIHJldHVybiBzZWdtZW50LmNvbnRlbnQ7XG4gIH1cblxuICAvKipcbiAgICog5Y2V5qyh55Sf5oiQ6K+E5Lmm5YaF5a6577yI6K6p5qih5Z6L6Ieq54S25YaZ5a6M77yJXG4gICAqIOS4jeW8uuWItuWtl+aVsO+8jOS4jeWIhuWkmui9ru+8jOS4gOasoeiwg+eUqOiHqueEtuWujOaIkFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVTcGF3bldyaXRlcihpbnB1dDogU3Bhd25Xcml0ZXJJbnB1dCk6IFByb21pc2U8U3Bhd25Xcml0ZXJSZXN1bHQ+IHtcbiAgICBjb25zdCBzZWdtZW50ID0gdGhpcy5zZWdtZW50cy5maW5kKHMgPT4gcy5pZCA9PT0gaW5wdXQuc2VnbWVudElkKTtcbiAgICBpZiAoIXNlZ21lbnQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHNlZ21lbnRJZDogaW5wdXQuc2VnbWVudElkLFxuICAgICAgICBjb250ZW50OiBg6ZSZ6K+v77ya54mH5q61ICR7aW5wdXQuc2VnbWVudElkfSDkuI3lrZjlnKhgLFxuICAgICAgICBjaGFyQ291bnQ6IDAsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IG9yaWdpbmFsVGV4dCA9IHNlZ21lbnQuY29udGVudDtcbiAgICBjb25zb2xlLmxvZyhgICAgIFtXcml0ZXJdIOWkhOeQhueJh+autSAke2lucHV0LnNlZ21lbnRJZH0vJHt0aGlzLnNlZ21lbnRzLmxlbmd0aH3vvIgke29yaWdpbmFsVGV4dC5sZW5ndGh9IOWtl++8iWApO1xuXG4gICAgY29uc3Qgd3JpdGVyTExNID0gdGhpcy5jcmVhdGVMTE0odGhpcy5jb25maWcubW9kZWwsIHsgdGVtcGVyYXR1cmU6IDAuNyB9KTtcblxuICAgIC8vIOS4gOasoeaAp+aUueWGmeaPkOekuuivje+8iOS9v+eUqOS7u+WKoemFjee9ruS4reeahCByb2xl77yJXG4gICAgY29uc3QgcHJvbXB0ID0gYCR7dGhpcy5jb25maWcudGFzay5yb2xlfVxuXG4jIyDljp/mlodcbiR7b3JpZ2luYWxUZXh0fVxuXG4jIyDmlLnlhpnku7vliqFcbuWcuuaZr+agh+mimO+8miR7aW5wdXQuc2NlbmVUaXRsZX1cbiR7aW5wdXQud3JpdGluZ0hpbnRzfVxuXG4jIyDopoHmsYJcbi0g5b+g5LqO5Y6f5paH77ya5a+56K+d5Y6f5qC35L+d55WZ77yM5oOF6IqC5oyJ5Y6f5paH6aG65bqP5a6M5pW05ZGI546wXG4tIOWPo+ivreWMlu+8muaKiuS5pumdouivrei9rOaIkOivtOS5puS6uuiusuaVheS6i+eahOWPo+WQu++8jOiHqueEtuactOWunlxuLSDpgILluqbov4fmuKHvvJrlnLrmma/liIfmjaLml7bliqDnroDnn63ov4fmuKHor61cbi0g5LiN6KaB5Yqg5aS45byg5q+U5Za744CB5aSn5q6154K56K+E44CB6YaS5pyo6Z+z5pWIXG4tIOS4jeimgee8lumAoOWOn+aWh+ayoeacieeahOWGheWuuVxuLSDmjInljp/mlofpobrluo/mlLnlhpnvvIzkuI3opoHpgZfmvI9cbi0g5YaZ5a6M5bCx57uT5p2f77yM5LiN55So5YeR5a2X5pWwXG5cbuivt+S4gOasoeaAp+WujOaIkOaUueWGme+8mmA7XG5cbiAgICAvLyDljZXmrKHosIPnlKjvvIzoh6rnhLblhpnlroxcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHdyaXRlckxMTS5pbnZva2UoW1xuICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XG4gICAgXSk7XG5cbiAgICBjb25zdCBnZW5lcmF0ZWRDb250ZW50ID0gdHlwZW9mIHJlc3BvbnNlLmNvbnRlbnQgPT09ICdzdHJpbmcnXG4gICAgICA/IHJlc3BvbnNlLmNvbnRlbnRcbiAgICAgIDogSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuY29udGVudCk7XG5cbiAgICAvLyDmm7TmlrDliY3mg4XmkZjopoFcbiAgICB0aGlzLnByZXZpb3VzU3VtbWFyeSA9IGdlbmVyYXRlZENvbnRlbnQuc2xpY2UoLTIwMCk7XG4gICAgXG4gICAgLy8g5qCH6K6w5bey5aSE55CGXG4gICAgdGhpcy5wcm9jZXNzZWRTZWdtZW50cy5hZGQoaW5wdXQuc2VnbWVudElkKTtcblxuICAgIC8vIOWGmeWFpei+k+WHuu+8iOW4puWwj+iKguagh+mimO+8iVxuICAgIGNvbnN0IHNlY3Rpb25UaXRsZSA9IGAjIyMgJHtpbnB1dC5zY2VuZVRpdGxlfVxcblxcbmA7XG4gICAgaWYgKHRoaXMub3V0cHV0U3RyZWFtKSB7XG4gICAgICB0aGlzLm91dHB1dFN0cmVhbS53cml0ZShzZWN0aW9uVGl0bGUpO1xuICAgICAgdGhpcy5vdXRwdXRTdHJlYW0ud3JpdGUoZ2VuZXJhdGVkQ29udGVudCk7XG4gICAgICB0aGlzLm91dHB1dFN0cmVhbS53cml0ZSgnXFxuXFxuJyk7XG4gICAgfVxuICAgIHRoaXMub3V0cHV0ICs9IHNlY3Rpb25UaXRsZSArIGdlbmVyYXRlZENvbnRlbnQgKyAnXFxuXFxuJztcblxuICAgIGNvbnNvbGUubG9nKGAgICAgW1dyaXRlcl0g5a6M5oiQ77yM6L6T5Ye6ICR7Z2VuZXJhdGVkQ29udGVudC5sZW5ndGh9IOWtl2ApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHNlZ21lbnRJZDogaW5wdXQuc2VnbWVudElkLFxuICAgICAgY29udGVudDogYOW3sueUn+aIkCAke2dlbmVyYXRlZENvbnRlbnQubGVuZ3RofSDlrZfor4TkuablhoXlrrlgLFxuICAgICAgY2hhckNvdW50OiBnZW5lcmF0ZWRDb250ZW50Lmxlbmd0aCxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhcHBlbmRPdXRwdXQoY29udGVudDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBpZiAodGhpcy5vdXRwdXRTdHJlYW0pIHtcbiAgICAgIHRoaXMub3V0cHV0U3RyZWFtLndyaXRlKGNvbnRlbnQpO1xuICAgICAgdGhpcy5vdXRwdXRTdHJlYW0ud3JpdGUoJ1xcblxcbicpO1xuICAgIH1cbiAgICB0aGlzLm91dHB1dCArPSBjb250ZW50ICsgJ1xcblxcbic7XG4gICAgcmV0dXJuIHRoaXMub3V0cHV0Lmxlbmd0aDtcbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tEb25lKCk6IERvbmVDaGVja1Jlc3VsdCB7XG4gICAgY29uc3QgcHJvY2Vzc2VkQ291bnQgPSB0aGlzLnByb2Nlc3NlZFNlZ21lbnRzLnNpemU7XG4gICAgY29uc3QgdG90YWxDb3VudCA9IHRoaXMuc2VnbWVudHMubGVuZ3RoO1xuICAgIGNvbnN0IGNhbkZpbmlzaCA9IHByb2Nlc3NlZENvdW50ID49IHRvdGFsQ291bnQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY2FuRmluaXNoLFxuICAgICAgbWVzc2FnZTogY2FuRmluaXNoID8gJ+aJgOacieeJh+auteW3suWkhOeQhuWujOaIkCcgOiBg6L+Y5pyJICR7dG90YWxDb3VudCAtIHByb2Nlc3NlZENvdW50fSDkuKrniYfmrrXmnKrlpITnkIZgLFxuICAgICAgcHJvY2Vzc2VkU2VnbWVudHM6IHByb2Nlc3NlZENvdW50LFxuICAgICAgdG90YWxTZWdtZW50czogdG90YWxDb3VudCxcbiAgICAgIG91dHB1dENoYXJzOiB0aGlzLm91dHB1dC5sZW5ndGgsXG4gICAgfTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09IOeroOiKguWkhOeQhu+8iEFnZW50IOaooeW8j++8iSA9PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgYXN5bmMgcHJvY2Vzc0NoYXB0ZXJXaXRoQWdlbnQoY2hhcHRlcjogQ2hhcHRlcik6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgLy8g5Yid5aeL5YyW54q25oCBXG4gICAgdGhpcy5jdXJyZW50Q2hhcHRlciA9IGNoYXB0ZXI7XG4gICAgdGhpcy5zZWdtZW50cyA9IHRoaXMuc3BsaXRDaGFwdGVySW50b1NlZ21lbnRzKGNoYXB0ZXIpO1xuICAgIHRoaXMucHJvY2Vzc2VkU2VnbWVudHMgPSBuZXcgU2V0KCk7XG4gICAgdGhpcy5vdXRwdXQgPSAnJztcbiAgICB0aGlzLnRvb2xDYWxsQ291bnQgPSAwO1xuXG4gICAgY29uc29sZS5sb2coYCAg5YiH5YiG5Li6ICR7dGhpcy5zZWdtZW50cy5sZW5ndGh9IOS4queJh+autWApO1xuXG4gICAgLy8g5p6E5bu6IENvbW1hbmRlciDmj5DnpLror41cbiAgICBjb25zdCBjb21tYW5kZXJQcm9tcHQgPSByZWFkUHJvbXB0RmlsZSgnY29tbWFuZGVyLnR4dCcpXG4gICAgICAucmVwbGFjZSgne3tyb2xlfX0nLCB0aGlzLmNvbmZpZy50YXNrLnJvbGUpXG4gICAgICAucmVwbGFjZSgne3twdXJwb3NlfX0nLCB0aGlzLmNvbmZpZy50YXNrLnB1cnBvc2UpXG4gICAgICAucmVwbGFjZSgne3tnbG9iYWxDb250ZXh0fX0nLCB0aGlzLmdsb2JhbENvbnRleHQuc2xpY2UoMCwgNTAwKSB8fCAn77yI5peg5YWo5bGA5LiK5LiL5paH77yJJyk7XG5cbiAgICAvLyDliJvlu7rlt6XlhbdcbiAgICBjb25zdCB0b29scyA9IFtcbiAgICAgIGNyZWF0ZUdldENoYXB0ZXJJbmZvVG9vbCgoKSA9PiB7XG4gICAgICAgIHRoaXMudG9vbENhbGxDb3VudCsrO1xuICAgICAgICBjb25zb2xlLmxvZyhgICBb5bel5YW3ICMke3RoaXMudG9vbENhbGxDb3VudH1dIGdldF9jaGFwdGVyX2luZm9gKTtcbiAgICAgICAgY29uc3QgaW5mbyA9IHRoaXMuZ2V0Q2hhcHRlckluZm8oKTtcbiAgICAgICAgY29uc29sZS5sb2coYCAgICAtPiAke2luZm8uc2VnbWVudENvdW50fSDkuKrniYfmrrXvvIzlhbEgJHtpbmZvLnRvdGFsQ2hhcnN9IOWtl2ApO1xuICAgICAgICByZXR1cm4gaW5mbztcbiAgICAgIH0pLFxuICAgICAgY3JlYXRlUmVhZFNlZ21lbnRUb29sKChzZWdtZW50SWQpID0+IHtcbiAgICAgICAgdGhpcy50b29sQ2FsbENvdW50Kys7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgIFvlt6XlhbcgIyR7dGhpcy50b29sQ2FsbENvdW50fV0gcmVhZF9zZWdtZW50KCR7c2VnbWVudElkfSlgKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVhZFNlZ21lbnQoc2VnbWVudElkKTtcbiAgICAgIH0pLFxuICAgICAgY3JlYXRlU3Bhd25Xcml0ZXJUb29sKGFzeW5jIChpbnB1dCkgPT4ge1xuICAgICAgICB0aGlzLnRvb2xDYWxsQ291bnQrKztcbiAgICAgICAgY29uc29sZS5sb2coYCAgW+W3peWFtyAjJHt0aGlzLnRvb2xDYWxsQ291bnR9XSBzcGF3bl93cml0ZXIoJHtpbnB1dC5zZWdtZW50SWR9LCBcIiR7aW5wdXQuc2NlbmVUaXRsZX1cIilgKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlU3Bhd25Xcml0ZXIoaW5wdXQpO1xuICAgICAgfSksXG4gICAgICAvLyBhcHBlbmRfb3V0cHV0IOW3suenu+mZpO+8jHNwYXduX3dyaXRlciDnm7TmjqXlhpnlhaXovpPlh7pcbiAgICAgIGNyZWF0ZURlZXBSZWFkZXJEb25lVG9vbCgoKSA9PiB7XG4gICAgICAgIHRoaXMudG9vbENhbGxDb3VudCsrO1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmNoZWNrRG9uZSgpO1xuICAgICAgICBjb25zb2xlLmxvZyhgICBb5bel5YW3ICMke3RoaXMudG9vbENhbGxDb3VudH1dIGRvbmUgLT4gJHtyZXN1bHQuY2FuRmluaXNoID8gJ+KckyDlrozmiJAnIDogJ+KclyDmnKrlrozmiJAnfWApO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfSksXG4gICAgXTtcblxuICAgIC8vIOWIm+W7uiBBZ2VudFxuICAgIGNvbnN0IGxsbSA9IHRoaXMuY3JlYXRlTExNKHRoaXMuY29uZmlnLm1vZGVsKTtcbiAgICBjb25zdCBhZ2VudDogYW55ID0gY3JlYXRlRGVlcEFnZW50KHtcbiAgICAgIG1vZGVsOiBsbG0sIC8vIOazqOaEj++8muWPguaVsOWQjeaYryBtb2RlbO+8jOS4jeaYryBsbG1cbiAgICAgIHRvb2xzLFxuICAgICAgc3lzdGVtUHJvbXB0OiBjb21tYW5kZXJQcm9tcHQsXG4gICAgfSk7XG5cbiAgICAvLyDov5DooYwgQWdlbnRcbiAgICBjb25zdCBpbml0TWVzc2FnZSA9IGDlvIDlp4vlpITnkIbnq6DoioLvvJoke2NoYXB0ZXIudGl0bGV977yI5YWxICR7Y2hhcHRlci5jb250ZW50Lmxlbmd0aH0g5a2X77yJYDtcbiAgICBcbiAgICB0cnkge1xuICAgICAgYXdhaXQgYWdlbnQuaW52b2tlKFxuICAgICAgICB7IG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IGluaXRNZXNzYWdlIH1dIH0sXG4gICAgICAgIHsgcmVjdXJzaW9uTGltaXQ6IDMwMCB9XG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBlcnJvck1zZyA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcbiAgICAgIGlmICghZXJyb3JNc2cuaW5jbHVkZXMoJ1JlY3Vyc2lvbiBsaW1pdCcpKSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuICAgICAgLy8g6YCS5b2S6ZmQ5Yi25Yiw6L6+77yM5qOA5p+l5piv5ZCm5bey5a6M5oiQ6Laz5aSf5YaF5a65XG4gICAgICBjb25zb2xlLmxvZyhgICBb6K2m5ZGKXSDpgJLlvZLpmZDliLbliLDovr7vvIzlt7LlpITnkIYgJHt0aGlzLnByb2Nlc3NlZFNlZ21lbnRzLnNpemV9LyR7dGhpcy5zZWdtZW50cy5sZW5ndGh9IOS4queJh+autWApO1xuICAgIH1cblxuICAgIC8vIOaPkOWPluacrOeroOaRmOimgVxuICAgIGNvbnN0IHN1bW1hcnkgPSB0aGlzLm91dHB1dC5zbGljZSgwLCAyMDApO1xuICAgIHRoaXMuY2hhcHRlclN1bW1hcmllcy5wdXNoKHN1bW1hcnkpO1xuXG4gICAgcmV0dXJuIHRoaXMub3V0cHV0O1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT0g5Li75YWl5Y+jID09PT09PT09PT09PT09PT09PT09XG5cbiAgYXN5bmMgcmVhZChpbnB1dDogRG9jdW1lbnRJbnB1dCk6IFByb21pc2U8RGVlcFJlYWRlck91dHB1dD4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICBjb25zb2xlLmxvZygnJyk7XG4gICAgY29uc29sZS5sb2coJz09PT09PT09PT0gRGVlcFJlYWRlciBBZ2VudCDmqKHlvI/lvIDlp4sgPT09PT09PT09PScpO1xuICAgIGNvbnNvbGUubG9nKGDmlofmoaM6ICR7aW5wdXQudGl0bGUgfHwgJ+acquWRveWQjSd9ICgke2lucHV0LmNvbnRlbnQubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IOWtlylgKTtcbiAgICBjb25zb2xlLmxvZyhg5Lu75YqhOiAke3RoaXMuY29uZmlnLnRhc2sucHVycG9zZX1gKTtcbiAgICBjb25zb2xlLmxvZyhg5qih5Z6LOiAke3RoaXMuY29uZmlnLm1vZGVsfWApO1xuXG4gICAgLy8gMS4g56ug6IqC5YiH5YiGXG4gICAgdGhpcy5jaGFwdGVycyA9IHRoaXMuc3BsaXRJbnRvQ2hhcHRlcnMoaW5wdXQuY29udGVudCk7XG4gICAgY29uc29sZS5sb2coYOeroOiKguaVsDogJHt0aGlzLmNoYXB0ZXJzLmxlbmd0aH1gKTtcblxuICAgIC8vIDIuIOeUn+aIkOWFqOWxgOS4iuS4i+aWh1xuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVQcmV2aWV3KSB7XG4gICAgICB0aGlzLmdsb2JhbENvbnRleHQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlR2xvYmFsQ29udGV4dChpbnB1dC5jb250ZW50LCBpbnB1dC50aXRsZSB8fCAnJyk7XG4gICAgfVxuXG4gICAgLy8gMy4g5YeG5aSH6L6T5Ye65paH5Lu2XG4gICAgY29uc3Qgb3V0cHV0RGlyID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdvdXQnLCAnZGVlcCcpO1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhvdXRwdXREaXIpKSB7XG4gICAgICBmcy5ta2RpclN5bmMob3V0cHV0RGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvWzouXS9nLCAnLScpLnNsaWNlKDAsIDE5KTtcbiAgICBjb25zdCBiYXNlTmFtZSA9IChpbnB1dC50aXRsZSB8fCAnZG9jdW1lbnQnKS5yZXBsYWNlKC9cXC5bXi5dKyQvLCAnJyk7XG4gICAgY29uc3Qgb3V0cHV0RmlsZU5hbWUgPSBgJHtiYXNlTmFtZX1fZGVlcF8ke3RpbWVzdGFtcH0ubWRgO1xuICAgIGNvbnN0IG91dHB1dFBhdGggPSBwYXRoLmpvaW4ob3V0cHV0RGlyLCBvdXRwdXRGaWxlTmFtZSk7XG5cbiAgICAvLyA0LiDliJvlu7rovpPlh7rmtYFcbiAgICB0aGlzLm91dHB1dFN0cmVhbSA9IGZzLmNyZWF0ZVdyaXRlU3RyZWFtKG91dHB1dFBhdGgsIHsgZW5jb2Rpbmc6ICd1dGYtOCcgfSk7XG4gICAgdGhpcy5vdXRwdXRTdHJlYW0ud3JpdGUoYCMgJHtpbnB1dC50aXRsZSB8fCAn57K+6K+76L6T5Ye6J31cXG5cXG5gKTtcbiAgICB0aGlzLm91dHB1dFN0cmVhbS53cml0ZShgPiDnlJ/miJDml7bpl7Q6ICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygnemgtQ04nKX1cXG5gKTtcbiAgICB0aGlzLm91dHB1dFN0cmVhbS53cml0ZShgPiDljp/mloflrZfmlbA6ICR7aW5wdXQuY29udGVudC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX1cXG5gKTtcbiAgICB0aGlzLm91dHB1dFN0cmVhbS53cml0ZShgPiDnq6DoioLmlbA6ICR7dGhpcy5jaGFwdGVycy5sZW5ndGh9XFxuYCk7XG4gICAgdGhpcy5vdXRwdXRTdHJlYW0ud3JpdGUoYD4g5qih5byPOiBBZ2VudCAo5YiG54mH5q615aSE55CGKVxcblxcbmApO1xuICAgIHRoaXMub3V0cHV0U3RyZWFtLndyaXRlKGAtLS1cXG5cXG5gKTtcblxuICAgIC8vIDUuIOmAkOeroOWkhOeQhlxuICAgIGxldCB0b3RhbFdvcmRzID0gMDtcblxuICAgIGNvbnNvbGUubG9nKCcnKTtcbiAgICBjb25zb2xlLmxvZygn5byA5aeL6YCQ56ug5aSE55CG77yIQWdlbnQg5qih5byP77yJLi4uJyk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2hhcHRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGNoYXB0ZXIgPSB0aGlzLmNoYXB0ZXJzW2ldO1xuICAgICAgY29uc29sZS5sb2coJycpO1xuICAgICAgY29uc29sZS5sb2coYFvnq6DoioIgJHtpICsgMX0vJHt0aGlzLmNoYXB0ZXJzLmxlbmd0aH1dICR7Y2hhcHRlci50aXRsZX3vvIgke2NoYXB0ZXIuY29udGVudC5sZW5ndGh9IOWtl++8iWApO1xuXG4gICAgICB0cnkge1xuICAgICAgICAvLyDlhpnlhaXnq6DoioLmoIfpophcbiAgICAgICAgdGhpcy5vdXRwdXRTdHJlYW0ud3JpdGUoYCMjICR7Y2hhcHRlci50aXRsZX1cXG5cXG5gKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGNoYXB0ZXJPdXRwdXQgPSBhd2FpdCB0aGlzLnByb2Nlc3NDaGFwdGVyV2l0aEFnZW50KGNoYXB0ZXIpO1xuICAgICAgICB0b3RhbFdvcmRzICs9IGNoYXB0ZXJPdXRwdXQubGVuZ3RoO1xuXG4gICAgICAgIHRoaXMub3V0cHV0U3RyZWFtLndyaXRlKCdcXG4tLS1cXG5cXG4nKTtcbiAgICAgICAgY29uc29sZS5sb2coYCAg4pyTIOeroOiKguWujOaIkO+8jOi+k+WHuiAke2NoYXB0ZXJPdXRwdXQubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IOWtl2ApO1xuXG4gICAgICAgIC8vIOefreaaguW7tui/n1xuICAgICAgICBpZiAoaSA8IHRoaXMuY2hhcHRlcnMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMDApKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc3QgZXJyb3JNc2cgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgIOKclyDlpLHotKU6ICR7ZXJyb3JNc2d9YCk7XG4gICAgICAgIHRoaXMub3V0cHV0U3RyZWFtLndyaXRlKGBb5aSE55CG5aSx6LSlOiAke2Vycm9yTXNnfV1cXG5cXG4tLS1cXG5cXG5gKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLm91dHB1dFN0cmVhbS5lbmQoKTtcblxuICAgIC8vIDYuIOeUn+aIkCBUVFMg5riF5rSX54mI5pys77yI5Y675o6J6Iie5Y+w5oyH56S644CBTWFya2Rvd24g5qC85byP77yJXG4gICAgY29uc3QgdHRzRmlsZU5hbWUgPSBgJHtiYXNlTmFtZX1fZGVlcF8ke3RpbWVzdGFtcH1fdHRzLnR4dGA7XG4gICAgY29uc3QgdHRzUGF0aCA9IHBhdGguam9pbihvdXRwdXREaXIsIHR0c0ZpbGVOYW1lKTtcbiAgICBjb25zdCB0dHNDb250ZW50ID0gY2xlYW5Gb3JUVFModGhpcy5vdXRwdXQpO1xuICAgIGZzLndyaXRlRmlsZVN5bmModHRzUGF0aCwgdHRzQ29udGVudCwgJ3V0Zi04Jyk7XG4gICAgY29uc29sZS5sb2coYFRUUyDmuIXmtJfniYg6ICR7dHRzUGF0aH0gKCR7dHRzQ29udGVudC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0g5a2XKWApO1xuXG4gICAgY29uc3QgZHVyYXRpb24gPSAoRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSkgLyAxMDAwO1xuXG4gICAgY29uc29sZS5sb2coJycpO1xuICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09IERlZXBSZWFkZXIgQWdlbnQg5qih5byP5a6M5oiQID09PT09PT09PT0nKTtcbiAgICBjb25zb2xlLmxvZyhg56ug6IqC5pWwOiAke3RoaXMuY2hhcHRlcnMubGVuZ3RofWApO1xuICAgIGNvbnNvbGUubG9nKGDovpPlh7rlrZfmlbA6ICR7dG90YWxXb3Jkcy50b0xvY2FsZVN0cmluZygpfWApO1xuICAgIGNvbnNvbGUubG9nKGBUVFMg54mI5a2X5pWwOiAke3R0c0NvbnRlbnQubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9YCk7XG4gICAgY29uc29sZS5sb2coYOiAl+aXtjogJHtkdXJhdGlvbi50b0ZpeGVkKDEpfSDnp5JgKTtcbiAgICBjb25zb2xlLmxvZyhg6L6T5Ye65paH5Lu2OiAke291dHB1dFBhdGh9YCk7XG4gICAgY29uc29sZS5sb2coYFRUUyDmlofku7Y6ICR7dHRzUGF0aH1gKTtcbiAgICBjb25zb2xlLmxvZygnJyk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgb3V0cHV0UGF0aDogYG91dC9kZWVwLyR7b3V0cHV0RmlsZU5hbWV9YCxcbiAgICAgIHR0c091dHB1dFBhdGg6IGBvdXQvZGVlcC8ke3R0c0ZpbGVOYW1lfWAsXG4gICAgICBjaGFwdGVyQ291bnQ6IHRoaXMuY2hhcHRlcnMubGVuZ3RoLFxuICAgICAgdG90YWxXb3JkcyxcbiAgICAgIGdsb2JhbENvbnRleHQ6IHRoaXMuZ2xvYmFsQ29udGV4dCxcbiAgICAgIGR1cmF0aW9uLFxuICAgIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJDaGF0T3BlbkFJIiwiY3JlYXRlRGVlcEFnZW50IiwiUkxNUmVhZGVyIiwiVEFTS19TVU1NQVJZIiwiY3JlYXRlR2V0Q2hhcHRlckluZm9Ub29sIiwiY3JlYXRlUmVhZFNlZ21lbnRUb29sIiwiY3JlYXRlU3Bhd25Xcml0ZXJUb29sIiwiY3JlYXRlRGVlcFJlYWRlckRvbmVUb29sIiwiY2xlYW5Gb3JUVFMiLCJ0ZXh0IiwicmVwbGFjZSIsIm1hdGNoIiwiaW5jbHVkZXMiLCJ0cmltIiwiREVGQVVMVF9DT05GSUciLCJ0YXNrIiwicm9sZSIsInB1cnBvc2UiLCJjaGFwdGVyUHJvbXB0Iiwib3V0cHV0TW9kZSIsImNvbnRleHRDaGFwdGVycyIsIm1heE91dHB1dFBlckNoYXB0ZXIiLCJjaGFwdGVyU2l6ZSIsIm1vZGVsIiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9NT0RFTCIsImJhc2VVUkwiLCJPUEVOQUlfQVBJX0JBU0UiLCJlbmFibGVQcmV2aWV3IiwicHJldmlld01heFdvcmRzIiwiU0VHTUVOVF9TSVpFIiwiUFJPTVBUU19ESVIiLCJqb2luIiwiY3dkIiwicmVhZFByb21wdEZpbGUiLCJyZWxhdGl2ZVBhdGgiLCJmdWxsUGF0aCIsInJlYWRGaWxlU3luYyIsImNvbnNvbGUiLCJ3YXJuIiwicGFyc2VUYXNrRmlsZSIsImNvbnRlbnQiLCJmcm9udG1hdHRlck1hdGNoIiwicmVzdWx0IiwiZnJvbnRtYXR0ZXIiLCJyb2xlTWF0Y2giLCJwdXJwb3NlTWF0Y2giLCJvdXRwdXRNb2RlTWF0Y2giLCJjb250ZXh0Q2hhcHRlcnNNYXRjaCIsInBhcnNlSW50IiwiYm9keSIsImxvYWREZWVwUmVhZFRhc2siLCJ0YXNrTmFtZSIsInBhcnNlZCIsIkRFRVBfVEFTS19QSU5HU0hVIiwiRGVlcFJlYWRlciIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwiY2hhcHRlcnMiLCJnbG9iYWxDb250ZXh0IiwiY2hhcHRlclN1bW1hcmllcyIsImN1cnJlbnRDaGFwdGVyIiwic2VnbWVudHMiLCJwcm9jZXNzZWRTZWdtZW50cyIsIlNldCIsIm91dHB1dCIsInByZXZpb3VzU3VtbWFyeSIsIm91dHB1dFN0cmVhbSIsInRvb2xDYWxsQ291bnQiLCJjcmVhdGVMTE0iLCJvcHRpb25zIiwib3BlbkFJQXBpS2V5IiwiT1BFTkFJX0FQSV9LRVkiLCJjb25maWd1cmF0aW9uIiwidGVtcGVyYXR1cmUiLCJmcmVxdWVuY3lQZW5hbHR5IiwicHJlc2VuY2VQZW5hbHR5Iiwic3BsaXRJbnRvQ2hhcHRlcnMiLCJjaGFwdGVyUGF0dGVybiIsIm1hdGNoZXMiLCJtYXRjaEFsbCIsImxlbmd0aCIsImxvZyIsInNwbGl0QnlNYXJrZXJzIiwic3BsaXRCeUxlbmd0aCIsImkiLCJzdGFydFBvcyIsImluZGV4IiwiZW5kUG9zIiwicHVzaCIsInRpdGxlIiwic2xpY2UiLCJjaGFyU3RhcnQiLCJjaGFyRW5kIiwiY2h1bmtTaXplIiwicG9zIiwiTWF0aCIsIm1pbiIsIm5leHRQYXJhZ3JhcGgiLCJpbmRleE9mIiwic3BsaXRDaGFwdGVySW50b1NlZ21lbnRzIiwiY2hhcHRlciIsImlkIiwicGFyYWdyYXBoQnJlYWsiLCJsYXN0SW5kZXhPZiIsInNlbnRlbmNlRW5kIiwibWF4Iiwic2VnbWVudENvbnRlbnQiLCJwcmV2aWV3IiwiZ2VuZXJhdGVHbG9iYWxDb250ZXh0IiwicmVhZGVyIiwib3V0cHV0Rm9ybWF0IiwiZW5hYmxlQ2hlY2twb2ludCIsInJlYWQiLCJnZXRDaGFwdGVySW5mbyIsInRvdGFsQ2hhcnMiLCJzZWdtZW50Q291bnQiLCJtYXAiLCJzIiwiY2hhckNvdW50IiwicmVhZFNlZ21lbnQiLCJzZWdtZW50SWQiLCJzZWdtZW50IiwiZmluZCIsImhhbmRsZVNwYXduV3JpdGVyIiwiaW5wdXQiLCJvcmlnaW5hbFRleHQiLCJ3cml0ZXJMTE0iLCJwcm9tcHQiLCJzY2VuZVRpdGxlIiwid3JpdGluZ0hpbnRzIiwicmVzcG9uc2UiLCJpbnZva2UiLCJnZW5lcmF0ZWRDb250ZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZCIsInNlY3Rpb25UaXRsZSIsIndyaXRlIiwiYXBwZW5kT3V0cHV0IiwiY2hlY2tEb25lIiwicHJvY2Vzc2VkQ291bnQiLCJzaXplIiwidG90YWxDb3VudCIsImNhbkZpbmlzaCIsIm1lc3NhZ2UiLCJ0b3RhbFNlZ21lbnRzIiwib3V0cHV0Q2hhcnMiLCJwcm9jZXNzQ2hhcHRlcldpdGhBZ2VudCIsImNvbW1hbmRlclByb21wdCIsInRvb2xzIiwiaW5mbyIsImxsbSIsImFnZW50Iiwic3lzdGVtUHJvbXB0IiwiaW5pdE1lc3NhZ2UiLCJtZXNzYWdlcyIsInJlY3Vyc2lvbkxpbWl0IiwiZXJyb3IiLCJlcnJvck1zZyIsIkVycm9yIiwiU3RyaW5nIiwic3VtbWFyeSIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJ0b0xvY2FsZVN0cmluZyIsIm91dHB1dERpciIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJ0aW1lc3RhbXAiLCJ0b0lTT1N0cmluZyIsImJhc2VOYW1lIiwib3V0cHV0RmlsZU5hbWUiLCJvdXRwdXRQYXRoIiwiY3JlYXRlV3JpdGVTdHJlYW0iLCJlbmNvZGluZyIsInRvdGFsV29yZHMiLCJjaGFwdGVyT3V0cHV0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiZW5kIiwidHRzRmlsZU5hbWUiLCJ0dHNQYXRoIiwidHRzQ29udGVudCIsIndyaXRlRmlsZVN5bmMiLCJkdXJhdGlvbiIsInRvRml4ZWQiLCJ0dHNPdXRwdXRQYXRoIiwiY2hhcHRlckNvdW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/deep-reader.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prompts/rlm.ts":
/*!********************************!*\
  !*** ./src/lib/prompts/rlm.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RLM_MESSAGES: () => (/* binding */ RLM_MESSAGES),\n/* harmony export */   RLM_METHODOLOGY_SECTION: () => (/* binding */ RLM_METHODOLOGY_SECTION),\n/* harmony export */   RLM_READER_SYSTEM: () => (/* binding */ RLM_READER_SYSTEM),\n/* harmony export */   RLM_TOOLS_SECTION: () => (/* binding */ RLM_TOOLS_SECTION),\n/* harmony export */   TASK_PAPER_ANALYSIS: () => (/* binding */ TASK_PAPER_ANALYSIS),\n/* harmony export */   TASK_PINGSHU: () => (/* binding */ TASK_PINGSHU),\n/* harmony export */   TASK_STUDY_NOTES: () => (/* binding */ TASK_STUDY_NOTES),\n/* harmony export */   TASK_SUMMARY: () => (/* binding */ TASK_SUMMARY),\n/* harmony export */   TASK_TEACHING_POINTS: () => (/* binding */ TASK_TEACHING_POINTS),\n/* harmony export */   buildInitMessage: () => (/* binding */ buildInitMessage),\n/* harmony export */   buildRLMPrompt: () => (/* binding */ buildRLMPrompt),\n/* harmony export */   buildSubReaderPrompt: () => (/* binding */ buildSubReaderPrompt),\n/* harmony export */   formatChunkContent: () => (/* binding */ formatChunkContent)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/**\n * RLM (Recursive Language Model) 阅读器提示词\n */ \n\n// ==================== 文件路径 ====================\n// Next.js 编译后 __dirname 不可靠，使用 process.cwd() 定位项目根目录\nconst PROMPTS_DIR = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"src/lib/prompts/rlm\");\nfunction readPromptFile(relativePath) {\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(PROMPTS_DIR, relativePath);\n    try {\n        return fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(fullPath, \"utf-8\");\n    } catch  {\n        console.warn(`[RLM] 无法读取提示词文件: ${relativePath}`);\n        return \"\";\n    }\n}\nfunction readJsonFile(relativePath) {\n    const content = readPromptFile(relativePath);\n    try {\n        return JSON.parse(content);\n    } catch  {\n        console.warn(`[RLM] 无法解析 JSON 文件: ${relativePath}`);\n        return {};\n    }\n}\n// ==================== 基础提示词（从文件加载） ====================\n/** 工具说明 */ const RLM_TOOLS_SECTION = readPromptFile(\"tools.txt\");\n/** 方法论 */ const RLM_METHODOLOGY_SECTION = readPromptFile(\"methodology.txt\");\nfunction parseTaskFile(content) {\n    // 解析 YAML frontmatter\n    const frontmatterMatch = content.match(/^---\\n([\\s\\S]*?)\\n---/);\n    let role = \"\";\n    let purpose = \"\";\n    if (frontmatterMatch) {\n        const frontmatter = frontmatterMatch[1];\n        const roleMatch = frontmatter.match(/role:\\s*(.+)/);\n        const purposeMatch = frontmatter.match(/purpose:\\s*(.+)/);\n        if (roleMatch) role = roleMatch[1].trim();\n        if (purposeMatch) purpose = purposeMatch[1].trim();\n    }\n    // 解析正文\n    const body = content.replace(/^---\\n[\\s\\S]*?\\n---\\n*/, \"\");\n    // 提取输出格式\n    const outputFormatMatch = body.match(/## 输出格式\\n\\n([\\s\\S]*?)(?=\\n## |$)/);\n    const outputFormat = outputFormatMatch ? outputFormatMatch[1].trim() : \"\";\n    // 提取原则\n    const principlesMatch = body.match(/## 原则\\n\\n([\\s\\S]*?)(?=\\n## |$)/);\n    let principles = [];\n    if (principlesMatch) {\n        principles = principlesMatch[1].split(\"\\n\").filter((line)=>line.startsWith(\"- \")).map((line)=>line.slice(2).trim());\n    }\n    return {\n        role,\n        purpose,\n        outputFormat,\n        principles\n    };\n}\nfunction loadTaskConfig(filename) {\n    const content = readPromptFile(`tasks/${filename}`);\n    const parsed = parseTaskFile(content);\n    return {\n        role: parsed.role,\n        purpose: parsed.purpose,\n        outputFormat: parsed.outputFormat,\n        principles: parsed.principles\n    };\n}\n// ==================== 预设任务（从文件加载） ====================\n/** 预设任务：学习笔记 */ const TASK_STUDY_NOTES = loadTaskConfig(\"study-notes.txt\");\n/** 预设任务：内容摘要 */ const TASK_SUMMARY = loadTaskConfig(\"summary.txt\");\n/** 预设任务：教学知识点提取 */ const TASK_TEACHING_POINTS = loadTaskConfig(\"teaching.txt\");\n/** 预设任务：论文分析 */ const TASK_PAPER_ANALYSIS = loadTaskConfig(\"paper.txt\");\n/** 预设任务：评书改编（单田芳风格） */ const TASK_PINGSHU = {\n    ...loadTaskConfig(\"pingshu.txt\"),\n    minCoverage: 0.1\n};\n// ==================== 组装函数 ====================\n/**\n * 构建 RLM 提示词\n * @param task 任务配置\n * @returns 完整的系统提示词\n */ function buildRLMPrompt(task) {\n    const principlesSection = task.principles?.length ? `## 原则\\n${task.principles.map((p)=>`- ${p}`).join(\"\\n\")}` : \"\";\n    return `${task.role}\n\n## 你的任务\n${task.purpose}\n\n${RLM_TOOLS_SECTION}\n\n${RLM_METHODOLOGY_SECTION}\n\n## 输出要求\n${task.outputFormat}\n\n${principlesSection}`;\n}\n// ==================== 运行时提示词模板 ====================\nconst INIT_MESSAGE_TEMPLATE = readPromptFile(\"runtime/init-message.txt\");\nconst SUB_READER_TEMPLATE = readPromptFile(\"runtime/sub-reader.txt\");\n/**\n * 构建初始化消息\n * @param title 文档标题\n */ function buildInitMessage(title) {\n    return INIT_MESSAGE_TEMPLATE.replace(\"{{title}}\", title || \"未知\");\n}\n/**\n * 构建子 Agent 阅读提示词\n * @param question 要回答的问题\n * @param content 相关内容\n */ function buildSubReaderPrompt(question, content) {\n    return SUB_READER_TEMPLATE.replace(\"{{question}}\", question).replace(\"{{content}}\", content);\n}\n/**\n * 格式化块内容（用于子 Agent）\n * @param index 块编号\n * @param content 块内容\n */ function formatChunkContent(index, content) {\n    return `【块 ${index}】\\n${content}`;\n}\nconst MESSAGE_TEMPLATES = readJsonFile(\"messages.json\");\nconst RLM_MESSAGES = {\n    EMPTY_DOCUMENT: MESSAGE_TEMPLATES.EMPTY_DOCUMENT || \"文档内容为空或太短，无法处理\",\n    NO_OUTPUT: MESSAGE_TEMPLATES.NO_OUTPUT || \"阅读完成但未生成输出\",\n    OUTPUT_UPDATED: MESSAGE_TEMPLATES.OUTPUT_UPDATED || \"输出已更新\",\n    OUTPUT_EMPTY: MESSAGE_TEMPLATES.OUTPUT_EMPTY || \"（输出为空）\",\n    CHUNK_NOT_FOUND: (index)=>(MESSAGE_TEMPLATES.CHUNK_NOT_FOUND || \"块 {{index}} 不存在\").replace(\"{{index}}\", String(index)),\n    UNKNOWN_TOOL: (name)=>(MESSAGE_TEMPLATES.UNKNOWN_TOOL || \"未知工具: {{name}}\").replace(\"{{name}}\", name),\n    READER_ERROR: (msg)=>(MESSAGE_TEMPLATES.READER_ERROR || \"阅读助手出错: {{message}}\").replace(\"{{message}}\", msg),\n    PROCESS_ERROR: (msg)=>(MESSAGE_TEMPLATES.PROCESS_ERROR || \"阅读过程出错: {{message}}\").replace(\"{{message}}\", msg),\n    TOO_MANY_MESSAGES: MESSAGE_TEMPLATES.TOO_MANY_MESSAGES || \"[RLMReader] 消息过多，强制结束\"\n};\n// ==================== 默认导出 ====================\n/** 默认系统提示词（学习笔记任务） */ const RLM_READER_SYSTEM = buildRLMPrompt(TASK_STUDY_NOTES);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFnQkYsa0JBQWtCRSxjQUFjLElBQUk7SUFDcERDLFdBQVdILGtCQUFrQkcsU0FBUyxJQUFJO0lBQzFDQyxnQkFBZ0JKLGtCQUFrQkksY0FBYyxJQUFJO0lBQ3BEQyxjQUFjTCxrQkFBa0JLLFlBQVksSUFBSTtJQUNoREMsaUJBQWlCLENBQUNQLFFBQ2hCLENBQUNDLGtCQUFrQk0sZUFBZSxJQUFJLGlCQUFnQixFQUFHdkMsT0FBTyxDQUFDLGFBQWF3QyxPQUFPUjtJQUN2RlMsY0FBYyxDQUFDQyxPQUNiLENBQUNULGtCQUFrQlEsWUFBWSxJQUFJLGdCQUFlLEVBQUd6QyxPQUFPLENBQUMsWUFBWTBDO0lBQzNFQyxjQUFjLENBQUNDLE1BQ2IsQ0FBQ1gsa0JBQWtCVSxZQUFZLElBQUkscUJBQW9CLEVBQUczQyxPQUFPLENBQUMsZUFBZTRDO0lBQ25GQyxlQUFlLENBQUNELE1BQ2QsQ0FBQ1gsa0JBQWtCWSxhQUFhLElBQUkscUJBQW9CLEVBQUc3QyxPQUFPLENBQUMsZUFBZTRDO0lBQ3BGRSxtQkFBbUJiLGtCQUFrQmEsaUJBQWlCLElBQUk7QUFDNUQsRUFBRTtBQUVGLGlEQUFpRDtBQUVqRCxvQkFBb0IsR0FDYixNQUFNQyxvQkFBb0IzQixlQUFlTixrQkFBa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9zcmMvbGliL3Byb21wdHMvcmxtLnRzPzI5Y2UiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSTE0gKFJlY3Vyc2l2ZSBMYW5ndWFnZSBNb2RlbCkg6ZiF6K+75Zmo5o+Q56S66K+NXG4gKi9cblxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHR5cGUgeyBSTE1UYXNrQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PSDmlofku7bot6/lvoQgPT09PT09PT09PT09PT09PT09PT1cblxuLy8gTmV4dC5qcyDnvJbor5HlkI4gX19kaXJuYW1lIOS4jeWPr+mdoO+8jOS9v+eUqCBwcm9jZXNzLmN3ZCgpIOWumuS9jemhueebruagueebruW9lVxuY29uc3QgUFJPTVBUU19ESVIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3NyYy9saWIvcHJvbXB0cy9ybG0nKTtcblxuZnVuY3Rpb24gcmVhZFByb21wdEZpbGUocmVsYXRpdmVQYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguam9pbihQUk9NUFRTX0RJUiwgcmVsYXRpdmVQYXRoKTtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZnMucmVhZEZpbGVTeW5jKGZ1bGxQYXRoLCAndXRmLTgnKTtcbiAgfSBjYXRjaCB7XG4gICAgY29uc29sZS53YXJuKGBbUkxNXSDml6Dms5Xor7vlj5bmj5DnpLror43mlofku7Y6ICR7cmVsYXRpdmVQYXRofWApO1xuICAgIHJldHVybiAnJztcbiAgfVxufVxuXG5mdW5jdGlvbiByZWFkSnNvbkZpbGU8VD4ocmVsYXRpdmVQYXRoOiBzdHJpbmcpOiBUIHtcbiAgY29uc3QgY29udGVudCA9IHJlYWRQcm9tcHRGaWxlKHJlbGF0aXZlUGF0aCk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UoY29udGVudCkgYXMgVDtcbiAgfSBjYXRjaCB7XG4gICAgY29uc29sZS53YXJuKGBbUkxNXSDml6Dms5Xop6PmnpAgSlNPTiDmlofku7Y6ICR7cmVsYXRpdmVQYXRofWApO1xuICAgIHJldHVybiB7fSBhcyBUO1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09IOWfuuehgOaPkOekuuivje+8iOS7juaWh+S7tuWKoOi9ve+8iSA9PT09PT09PT09PT09PT09PT09PVxuXG4vKiog5bel5YW36K+05piOICovXG5leHBvcnQgY29uc3QgUkxNX1RPT0xTX1NFQ1RJT04gPSByZWFkUHJvbXB0RmlsZSgndG9vbHMudHh0Jyk7XG5cbi8qKiDmlrnms5XorrogKi9cbmV4cG9ydCBjb25zdCBSTE1fTUVUSE9ET0xPR1lfU0VDVElPTiA9IHJlYWRQcm9tcHRGaWxlKCdtZXRob2RvbG9neS50eHQnKTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT0g5Lu75Yqh6YWN572u6Kej5p6QID09PT09PT09PT09PT09PT09PT09XG5cbmludGVyZmFjZSBUYXNrRmlsZSB7XG4gIHJvbGU6IHN0cmluZztcbiAgcHVycG9zZTogc3RyaW5nO1xuICBvdXRwdXRGb3JtYXQ6IHN0cmluZztcbiAgcHJpbmNpcGxlcz86IHN0cmluZ1tdO1xufVxuXG5mdW5jdGlvbiBwYXJzZVRhc2tGaWxlKGNvbnRlbnQ6IHN0cmluZyk6IFRhc2tGaWxlIHtcbiAgLy8g6Kej5p6QIFlBTUwgZnJvbnRtYXR0ZXJcbiAgY29uc3QgZnJvbnRtYXR0ZXJNYXRjaCA9IGNvbnRlbnQubWF0Y2goL14tLS1cXG4oW1xcc1xcU10qPylcXG4tLS0vKTtcbiAgbGV0IHJvbGUgPSAnJztcbiAgbGV0IHB1cnBvc2UgPSAnJztcblxuICBpZiAoZnJvbnRtYXR0ZXJNYXRjaCkge1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gZnJvbnRtYXR0ZXJNYXRjaFsxXTtcbiAgICBjb25zdCByb2xlTWF0Y2ggPSBmcm9udG1hdHRlci5tYXRjaCgvcm9sZTpcXHMqKC4rKS8pO1xuICAgIGNvbnN0IHB1cnBvc2VNYXRjaCA9IGZyb250bWF0dGVyLm1hdGNoKC9wdXJwb3NlOlxccyooLispLyk7XG4gICAgaWYgKHJvbGVNYXRjaCkgcm9sZSA9IHJvbGVNYXRjaFsxXS50cmltKCk7XG4gICAgaWYgKHB1cnBvc2VNYXRjaCkgcHVycG9zZSA9IHB1cnBvc2VNYXRjaFsxXS50cmltKCk7XG4gIH1cblxuICAvLyDop6PmnpDmraPmlodcbiAgY29uc3QgYm9keSA9IGNvbnRlbnQucmVwbGFjZSgvXi0tLVxcbltcXHNcXFNdKj9cXG4tLS1cXG4qLywgJycpO1xuXG4gIC8vIOaPkOWPlui+k+WHuuagvOW8j1xuICBjb25zdCBvdXRwdXRGb3JtYXRNYXRjaCA9IGJvZHkubWF0Y2goLyMjIOi+k+WHuuagvOW8j1xcblxcbihbXFxzXFxTXSo/KSg/PVxcbiMjIHwkKS8pO1xuICBjb25zdCBvdXRwdXRGb3JtYXQgPSBvdXRwdXRGb3JtYXRNYXRjaCA/IG91dHB1dEZvcm1hdE1hdGNoWzFdLnRyaW0oKSA6ICcnO1xuXG4gIC8vIOaPkOWPluWOn+WImVxuICBjb25zdCBwcmluY2lwbGVzTWF0Y2ggPSBib2R5Lm1hdGNoKC8jIyDljp/liJlcXG5cXG4oW1xcc1xcU10qPykoPz1cXG4jIyB8JCkvKTtcbiAgbGV0IHByaW5jaXBsZXM6IHN0cmluZ1tdID0gW107XG4gIGlmIChwcmluY2lwbGVzTWF0Y2gpIHtcbiAgICBwcmluY2lwbGVzID0gcHJpbmNpcGxlc01hdGNoWzFdXG4gICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAuZmlsdGVyKChsaW5lKSA9PiBsaW5lLnN0YXJ0c1dpdGgoJy0gJykpXG4gICAgICAubWFwKChsaW5lKSA9PiBsaW5lLnNsaWNlKDIpLnRyaW0oKSk7XG4gIH1cblxuICByZXR1cm4geyByb2xlLCBwdXJwb3NlLCBvdXRwdXRGb3JtYXQsIHByaW5jaXBsZXMgfTtcbn1cblxuZnVuY3Rpb24gbG9hZFRhc2tDb25maWcoZmlsZW5hbWU6IHN0cmluZyk6IFJMTVRhc2tDb25maWcge1xuICBjb25zdCBjb250ZW50ID0gcmVhZFByb21wdEZpbGUoYHRhc2tzLyR7ZmlsZW5hbWV9YCk7XG4gIGNvbnN0IHBhcnNlZCA9IHBhcnNlVGFza0ZpbGUoY29udGVudCk7XG4gIHJldHVybiB7XG4gICAgcm9sZTogcGFyc2VkLnJvbGUsXG4gICAgcHVycG9zZTogcGFyc2VkLnB1cnBvc2UsXG4gICAgb3V0cHV0Rm9ybWF0OiBwYXJzZWQub3V0cHV0Rm9ybWF0LFxuICAgIHByaW5jaXBsZXM6IHBhcnNlZC5wcmluY2lwbGVzLFxuICB9O1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PSDpooTorr7ku7vliqHvvIjku47mlofku7bliqDovb3vvIkgPT09PT09PT09PT09PT09PT09PT1cblxuLyoqIOmihOiuvuS7u+WKoe+8muWtpuS5oOeslOiusCAqL1xuZXhwb3J0IGNvbnN0IFRBU0tfU1RVRFlfTk9URVM6IFJMTVRhc2tDb25maWcgPSBsb2FkVGFza0NvbmZpZygnc3R1ZHktbm90ZXMudHh0Jyk7XG5cbi8qKiDpooTorr7ku7vliqHvvJrlhoXlrrnmkZjopoEgKi9cbmV4cG9ydCBjb25zdCBUQVNLX1NVTU1BUlk6IFJMTVRhc2tDb25maWcgPSBsb2FkVGFza0NvbmZpZygnc3VtbWFyeS50eHQnKTtcblxuLyoqIOmihOiuvuS7u+WKoe+8muaVmeWtpuefpeivhueCueaPkOWPliAqL1xuZXhwb3J0IGNvbnN0IFRBU0tfVEVBQ0hJTkdfUE9JTlRTOiBSTE1UYXNrQ29uZmlnID0gbG9hZFRhc2tDb25maWcoJ3RlYWNoaW5nLnR4dCcpO1xuXG4vKiog6aKE6K6+5Lu75Yqh77ya6K665paH5YiG5p6QICovXG5leHBvcnQgY29uc3QgVEFTS19QQVBFUl9BTkFMWVNJUzogUkxNVGFza0NvbmZpZyA9IGxvYWRUYXNrQ29uZmlnKCdwYXBlci50eHQnKTtcblxuLyoqIOmihOiuvuS7u+WKoe+8muivhOS5puaUuee8lu+8iOWNleeUsOiKs+mjjuagvO+8iSAqL1xuZXhwb3J0IGNvbnN0IFRBU0tfUElOR1NIVTogUkxNVGFza0NvbmZpZyA9IHtcbiAgLi4ubG9hZFRhc2tDb25maWcoJ3BpbmdzaHUudHh0JyksXG4gIG1pbkNvdmVyYWdlOiAwLjEsIC8vIOivhOS5puS7u+WKoeWFgeiuuOmHh+agt+mYheivu++8jOWPqumcgCAxMCUg6KaG55uW546HXG59O1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PSDnu4Too4Xlh73mlbAgPT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiDmnoTlu7ogUkxNIOaPkOekuuivjVxuICogQHBhcmFtIHRhc2sg5Lu75Yqh6YWN572uXG4gKiBAcmV0dXJucyDlrozmlbTnmoTns7vnu5/mj5DnpLror41cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkUkxNUHJvbXB0KHRhc2s6IFJMTVRhc2tDb25maWcpOiBzdHJpbmcge1xuICBjb25zdCBwcmluY2lwbGVzU2VjdGlvbiA9IHRhc2sucHJpbmNpcGxlcz8ubGVuZ3RoXG4gICAgPyBgIyMg5Y6f5YiZXFxuJHt0YXNrLnByaW5jaXBsZXMubWFwKChwKSA9PiBgLSAke3B9YCkuam9pbignXFxuJyl9YFxuICAgIDogJyc7XG5cbiAgcmV0dXJuIGAke3Rhc2sucm9sZX1cblxuIyMg5L2g55qE5Lu75YqhXG4ke3Rhc2sucHVycG9zZX1cblxuJHtSTE1fVE9PTFNfU0VDVElPTn1cblxuJHtSTE1fTUVUSE9ET0xPR1lfU0VDVElPTn1cblxuIyMg6L6T5Ye66KaB5rGCXG4ke3Rhc2sub3V0cHV0Rm9ybWF0fVxuXG4ke3ByaW5jaXBsZXNTZWN0aW9ufWA7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09IOi/kOihjOaXtuaPkOekuuivjeaooeadvyA9PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBJTklUX01FU1NBR0VfVEVNUExBVEUgPSByZWFkUHJvbXB0RmlsZSgncnVudGltZS9pbml0LW1lc3NhZ2UudHh0Jyk7XG5jb25zdCBTVUJfUkVBREVSX1RFTVBMQVRFID0gcmVhZFByb21wdEZpbGUoJ3J1bnRpbWUvc3ViLXJlYWRlci50eHQnKTtcblxuLyoqXG4gKiDmnoTlu7rliJ3lp4vljJbmtojmga9cbiAqIEBwYXJhbSB0aXRsZSDmlofmoaPmoIfpophcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkSW5pdE1lc3NhZ2UodGl0bGU/OiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gSU5JVF9NRVNTQUdFX1RFTVBMQVRFLnJlcGxhY2UoJ3t7dGl0bGV9fScsIHRpdGxlIHx8ICfmnKrnn6UnKTtcbn1cblxuLyoqXG4gKiDmnoTlu7rlrZAgQWdlbnQg6ZiF6K+75o+Q56S66K+NXG4gKiBAcGFyYW0gcXVlc3Rpb24g6KaB5Zue562U55qE6Zeu6aKYXG4gKiBAcGFyYW0gY29udGVudCDnm7jlhbPlhoXlrrlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkU3ViUmVhZGVyUHJvbXB0KHF1ZXN0aW9uOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBTVUJfUkVBREVSX1RFTVBMQVRFLnJlcGxhY2UoJ3t7cXVlc3Rpb259fScsIHF1ZXN0aW9uKS5yZXBsYWNlKCd7e2NvbnRlbnR9fScsIGNvbnRlbnQpO1xufVxuXG4vKipcbiAqIOagvOW8j+WMluWdl+WGheWuue+8iOeUqOS6juWtkCBBZ2VudO+8iVxuICogQHBhcmFtIGluZGV4IOWdl+e8luWPt1xuICogQHBhcmFtIGNvbnRlbnQg5Z2X5YaF5a65XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRDaHVua0NvbnRlbnQoaW5kZXg6IG51bWJlciwgY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIGDjgJDlnZcgJHtpbmRleH3jgJFcXG4ke2NvbnRlbnR9YDtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT0g6ZSZ6K+vL+eKtuaAgea2iOaBryA9PT09PT09PT09PT09PT09PT09PVxuXG5pbnRlcmZhY2UgTWVzc2FnZVRlbXBsYXRlcyB7XG4gIEVNUFRZX0RPQ1VNRU5UOiBzdHJpbmc7XG4gIE5PX09VVFBVVDogc3RyaW5nO1xuICBPVVRQVVRfVVBEQVRFRDogc3RyaW5nO1xuICBPVVRQVVRfRU1QVFk6IHN0cmluZztcbiAgQ0hVTktfTk9UX0ZPVU5EOiBzdHJpbmc7XG4gIFVOS05PV05fVE9PTDogc3RyaW5nO1xuICBSRUFERVJfRVJST1I6IHN0cmluZztcbiAgUFJPQ0VTU19FUlJPUjogc3RyaW5nO1xuICBUT09fTUFOWV9NRVNTQUdFUzogc3RyaW5nO1xufVxuXG5jb25zdCBNRVNTQUdFX1RFTVBMQVRFUyA9IHJlYWRKc29uRmlsZTxNZXNzYWdlVGVtcGxhdGVzPignbWVzc2FnZXMuanNvbicpO1xuXG5leHBvcnQgY29uc3QgUkxNX01FU1NBR0VTID0ge1xuICBFTVBUWV9ET0NVTUVOVDogTUVTU0FHRV9URU1QTEFURVMuRU1QVFlfRE9DVU1FTlQgfHwgJ+aWh+aho+WGheWuueS4uuepuuaIluWkquefre+8jOaXoOazleWkhOeQhicsXG4gIE5PX09VVFBVVDogTUVTU0FHRV9URU1QTEFURVMuTk9fT1VUUFVUIHx8ICfpmIXor7vlrozmiJDkvYbmnKrnlJ/miJDovpPlh7onLFxuICBPVVRQVVRfVVBEQVRFRDogTUVTU0FHRV9URU1QTEFURVMuT1VUUFVUX1VQREFURUQgfHwgJ+i+k+WHuuW3suabtOaWsCcsXG4gIE9VVFBVVF9FTVBUWTogTUVTU0FHRV9URU1QTEFURVMuT1VUUFVUX0VNUFRZIHx8ICfvvIjovpPlh7rkuLrnqbrvvIknLFxuICBDSFVOS19OT1RfRk9VTkQ6IChpbmRleDogbnVtYmVyKSA9PlxuICAgIChNRVNTQUdFX1RFTVBMQVRFUy5DSFVOS19OT1RfRk9VTkQgfHwgJ+WdlyB7e2luZGV4fX0g5LiN5a2Y5ZyoJykucmVwbGFjZSgne3tpbmRleH19JywgU3RyaW5nKGluZGV4KSksXG4gIFVOS05PV05fVE9PTDogKG5hbWU6IHN0cmluZykgPT5cbiAgICAoTUVTU0FHRV9URU1QTEFURVMuVU5LTk9XTl9UT09MIHx8ICfmnKrnn6Xlt6Xlhbc6IHt7bmFtZX19JykucmVwbGFjZSgne3tuYW1lfX0nLCBuYW1lKSxcbiAgUkVBREVSX0VSUk9SOiAobXNnOiBzdHJpbmcpID0+XG4gICAgKE1FU1NBR0VfVEVNUExBVEVTLlJFQURFUl9FUlJPUiB8fCAn6ZiF6K+75Yqp5omL5Ye66ZSZOiB7e21lc3NhZ2V9fScpLnJlcGxhY2UoJ3t7bWVzc2FnZX19JywgbXNnKSxcbiAgUFJPQ0VTU19FUlJPUjogKG1zZzogc3RyaW5nKSA9PlxuICAgIChNRVNTQUdFX1RFTVBMQVRFUy5QUk9DRVNTX0VSUk9SIHx8ICfpmIXor7vov4fnqIvlh7rplJk6IHt7bWVzc2FnZX19JykucmVwbGFjZSgne3ttZXNzYWdlfX0nLCBtc2cpLFxuICBUT09fTUFOWV9NRVNTQUdFUzogTUVTU0FHRV9URU1QTEFURVMuVE9PX01BTllfTUVTU0FHRVMgfHwgJ1tSTE1SZWFkZXJdIOa2iOaBr+i/h+Wkmu+8jOW8uuWItue7k+adnycsXG59O1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PSDpu5jorqTlr7zlh7ogPT09PT09PT09PT09PT09PT09PT1cblxuLyoqIOm7mOiupOezu+e7n+aPkOekuuivje+8iOWtpuS5oOeslOiusOS7u+WKoe+8iSAqL1xuZXhwb3J0IGNvbnN0IFJMTV9SRUFERVJfU1lTVEVNID0gYnVpbGRSTE1Qcm9tcHQoVEFTS19TVFVEWV9OT1RFUyk7XG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiUFJPTVBUU19ESVIiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsInJlYWRQcm9tcHRGaWxlIiwicmVsYXRpdmVQYXRoIiwiZnVsbFBhdGgiLCJyZWFkRmlsZVN5bmMiLCJjb25zb2xlIiwid2FybiIsInJlYWRKc29uRmlsZSIsImNvbnRlbnQiLCJKU09OIiwicGFyc2UiLCJSTE1fVE9PTFNfU0VDVElPTiIsIlJMTV9NRVRIT0RPTE9HWV9TRUNUSU9OIiwicGFyc2VUYXNrRmlsZSIsImZyb250bWF0dGVyTWF0Y2giLCJtYXRjaCIsInJvbGUiLCJwdXJwb3NlIiwiZnJvbnRtYXR0ZXIiLCJyb2xlTWF0Y2giLCJwdXJwb3NlTWF0Y2giLCJ0cmltIiwiYm9keSIsInJlcGxhY2UiLCJvdXRwdXRGb3JtYXRNYXRjaCIsIm91dHB1dEZvcm1hdCIsInByaW5jaXBsZXNNYXRjaCIsInByaW5jaXBsZXMiLCJzcGxpdCIsImZpbHRlciIsImxpbmUiLCJzdGFydHNXaXRoIiwibWFwIiwic2xpY2UiLCJsb2FkVGFza0NvbmZpZyIsImZpbGVuYW1lIiwicGFyc2VkIiwiVEFTS19TVFVEWV9OT1RFUyIsIlRBU0tfU1VNTUFSWSIsIlRBU0tfVEVBQ0hJTkdfUE9JTlRTIiwiVEFTS19QQVBFUl9BTkFMWVNJUyIsIlRBU0tfUElOR1NIVSIsIm1pbkNvdmVyYWdlIiwiYnVpbGRSTE1Qcm9tcHQiLCJ0YXNrIiwicHJpbmNpcGxlc1NlY3Rpb24iLCJsZW5ndGgiLCJwIiwiSU5JVF9NRVNTQUdFX1RFTVBMQVRFIiwiU1VCX1JFQURFUl9URU1QTEFURSIsImJ1aWxkSW5pdE1lc3NhZ2UiLCJ0aXRsZSIsImJ1aWxkU3ViUmVhZGVyUHJvbXB0IiwicXVlc3Rpb24iLCJmb3JtYXRDaHVua0NvbnRlbnQiLCJpbmRleCIsIk1FU1NBR0VfVEVNUExBVEVTIiwiUkxNX01FU1NBR0VTIiwiRU1QVFlfRE9DVU1FTlQiLCJOT19PVVRQVVQiLCJPVVRQVVRfVVBEQVRFRCIsIk9VVFBVVF9FTVBUWSIsIkNIVU5LX05PVF9GT1VORCIsIlN0cmluZyIsIlVOS05PV05fVE9PTCIsIm5hbWUiLCJSRUFERVJfRVJST1IiLCJtc2ciLCJQUk9DRVNTX0VSUk9SIiwiVE9PX01BTllfTUVTU0FHRVMiLCJSTE1fUkVBREVSX1NZU1RFTSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prompts/rlm.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/rlm-reader.ts":
/*!*******************************!*\
  !*** ./src/lib/rlm-reader.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RLMReader: () => (/* binding */ RLMReader),\n/* harmony export */   TASK_PAPER_ANALYSIS: () => (/* reexport safe */ _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.TASK_PAPER_ANALYSIS),\n/* harmony export */   TASK_STUDY_NOTES: () => (/* reexport safe */ _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.TASK_STUDY_NOTES),\n/* harmony export */   TASK_SUMMARY: () => (/* reexport safe */ _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.TASK_SUMMARY),\n/* harmony export */   TASK_TEACHING_POINTS: () => (/* reexport safe */ _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.TASK_TEACHING_POINTS)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _text_splitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./text-splitter */ \"(rsc)/./src/lib/text-splitter.ts\");\n/* harmony import */ var deepagents__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! deepagents */ \"(rsc)/./node_modules/.pnpm/deepagents@1.8.1_openai@6.25.0_zod@4.3.6__react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/deepagents/dist/index.js\");\n/* harmony import */ var _langchain_openai__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/openai */ \"(rsc)/./node_modules/.pnpm/@langchain+openai@1.2.10_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6__/node_modules/@langchain/openai/dist/index.js\");\n/* harmony import */ var _langchain_langgraph_checkpoint_sqlite__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @langchain/langgraph-checkpoint-sqlite */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph-checkpoint-sqlite@1.0.1_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___x5mt5hbw5gguxm32j7hbetr5ym/node_modules/@langchain/langgraph-checkpoint-sqlite/dist/index.js\");\n/* harmony import */ var _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./prompts/rlm */ \"(rsc)/./src/lib/prompts/rlm.ts\");\n/* harmony import */ var _tools_rlm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./tools/rlm */ \"(rsc)/./src/lib/tools/rlm/index.ts\");\n/**\n * RLM (Recursive Language Model) 阅读器\n * \n * 核心能力：\n * 1. 段落边界切分，保证语义完整\n * 2. LLM 自主决定阅读策略\n * 3. 可配置的任务类型\n * 4. 并行子 Agent 处理大文档\n * 5. Checkpointer 断点续读支持\n */ \n\n\n\n\n\n\n\n// ==================== SQLite Checkpointer ====================\n// SQLite 数据库路径\nconst CHECKPOINT_DB_PATH = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \".rlm-checkpoints.db\");\n// 使用单例模式，确保跨调用保持状态\nlet globalCheckpointer = null;\nlet checkpointerInitPromise = null;\nasync function getCheckpointer() {\n    if (globalCheckpointer) {\n        return globalCheckpointer;\n    }\n    if (!checkpointerInitPromise) {\n        checkpointerInitPromise = (async ()=>{\n            const saver = _langchain_langgraph_checkpoint_sqlite__WEBPACK_IMPORTED_MODULE_5__.SqliteSaver.fromConnString(CHECKPOINT_DB_PATH);\n            // 如果 fromConnString 返回 Promise，需要 await\n            const instance = saver instanceof Promise ? await saver : saver;\n            // 初始化数据库 schema（必须调用 setup）\n            await instance.setup();\n            globalCheckpointer = instance;\n            console.log(`[RLM] Checkpointer 已初始化: ${CHECKPOINT_DB_PATH}`);\n            return globalCheckpointer;\n        })();\n    }\n    return checkpointerInitPromise;\n}\n// ==================== 默认配置 ====================\nconst DEFAULT_CONFIG = {\n    task: _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.TASK_STUDY_NOTES,\n    chunkSize: 2000,\n    model: process.env.OPENAI_MODEL || \"qwen-plus\",\n    modelProvider: process.env.OPENAI_MODEL_PROVIDER || \"openai\",\n    subAgentModel: process.env.OPENAI_MODEL || \"qwen-plus\",\n    subAgentModelProvider: process.env.OPENAI_MODEL_PROVIDER || \"openai\",\n    baseURL: process.env.OPENAI_API_BASE || \"https://dashscope.aliyuncs.com/compatible-mode/v1\",\n    recursionLimit: 500,\n    enableCheckpoint: true\n};\n// ==================== RLMReader 类 ====================\nclass RLMReader {\n    constructor(config = {}){\n        this.chunks = [];\n        this.output = \"\";\n        this.toolCallCount = 0;\n        this.readChunksSet = new Set();\n        this.documentId = \"\";\n        this.config = {\n            task: config.task || DEFAULT_CONFIG.task,\n            chunkSize: config.chunkSize || DEFAULT_CONFIG.chunkSize,\n            model: config.model || DEFAULT_CONFIG.model,\n            modelProvider: config.modelProvider || DEFAULT_CONFIG.modelProvider,\n            subAgentModel: config.subAgentModel || DEFAULT_CONFIG.subAgentModel,\n            subAgentModelProvider: config.subAgentModelProvider || DEFAULT_CONFIG.subAgentModelProvider,\n            baseURL: config.baseURL || DEFAULT_CONFIG.baseURL,\n            recursionLimit: config.recursionLimit || DEFAULT_CONFIG.recursionLimit,\n            enableCheckpoint: config.enableCheckpoint ?? DEFAULT_CONFIG.enableCheckpoint\n        };\n    }\n    // ==================== Thread ID 生成 ====================\n    /**\n   * 生成文档唯一标识（用于 thread_id）\n   * 基于内容哈希 + 任务类型\n   */ generateDocumentId(content) {\n        const hash = (0,crypto__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"md5\").update(content.substring(0, 10000)).update(this.config.task.purpose).digest(\"hex\").substring(0, 12);\n        return hash;\n    }\n    /**\n   * 生成 thread_id（用于 checkpointer）\n   */ getThreadId() {\n        return `rlm-${this.documentId}`;\n    }\n    /**\n   * 检查是否有历史 checkpoint\n   * 注意：checkpoint 用于让 AI 知道自己做过什么，不是用于断电续传\n   */ async tryRestoreFromCheckpoint(threadId) {\n        if (!this.config.enableCheckpoint) return false;\n        try {\n            const checkpointer = await getCheckpointer();\n            // 检查是否有此 thread 的 checkpoint\n            let hasCheckpoint = false;\n            for await (const _cp of checkpointer.list({\n                configurable: {\n                    thread_id: threadId\n                }\n            })){\n                hasCheckpoint = true;\n                break;\n            }\n            if (hasCheckpoint) {\n                console.log(`  📦 发现历史消息记录`);\n            }\n            return hasCheckpoint;\n        } catch (e) {\n            console.log(`  ⚠️ 检查历史失败: ${e instanceof Error ? e.message : \"Unknown\"}`);\n            return false;\n        }\n    }\n    /**\n   * 创建配置好 baseURL 的 LLM 实例\n   */ createLLM(model) {\n        return new _langchain_openai__WEBPACK_IMPORTED_MODULE_4__.ChatOpenAI({\n            model,\n            openAIApiKey: process.env.OPENAI_API_KEY,\n            configuration: {\n                baseURL: this.config.baseURL\n            },\n            temperature: 0.7\n        });\n    }\n    // ==================== 预处理 ====================\n    /**\n   * 段落边界切分\n   */ prepareChunks(content) {\n        const paragraphs = (0,_text_splitter__WEBPACK_IMPORTED_MODULE_2__.splitIntoParagraphs)(content, this.config.chunkSize);\n        let charPos = 0;\n        return paragraphs.map((p, i)=>{\n            const chunk = {\n                index: i + 1,\n                content: p,\n                charStart: charPos,\n                charEnd: charPos + p.length\n            };\n            charPos += p.length;\n            return chunk;\n        });\n    }\n    // ==================== 日志辅助 ====================\n    log(message, data) {\n        const timestamp = new Date().toLocaleTimeString(\"zh-CN\");\n        const prefix = `[RLM ${timestamp}]`;\n        if (data) {\n            console.log(`${prefix} ${message}`);\n            Object.entries(data).forEach(([key, value])=>{\n                console.log(`    └─ ${key}: ${typeof value === \"object\" ? JSON.stringify(value) : value}`);\n            });\n        } else {\n            console.log(`${prefix} ${message}`);\n        }\n    }\n    logToolCall(toolName, description, params) {\n        this.toolCallCount++;\n        console.log(\"\");\n        console.log(`[工具 #${this.toolCallCount}] ${toolName}`);\n        console.log(`  说明: ${description}`);\n        if (params) {\n            Object.entries(params).forEach(([key, value])=>{\n                const displayValue = typeof value === \"string\" && value.length > 100 ? value.substring(0, 100) + \"...\" : value;\n                console.log(`  ${key}: ${displayValue}`);\n            });\n        }\n    }\n    logToolResult(result) {\n        if (typeof result === \"string\") {\n            console.log(`  -> 返回: ${result.length > 200 ? result.substring(0, 200) + \"...\" : result}`);\n        } else {\n            console.log(`  -> 返回:`, result);\n        }\n    }\n    // ==================== 工具实现 ====================\n    /**\n   * 获取文档统计\n   */ getDocumentStats() {\n        this.logToolCall(\"get_document_stats\", \"AI 正在了解文档的基本信息（总字数、分块数量、平均每块大小）\");\n        const totalChars = this.chunks.reduce((sum, c)=>sum + c.content.length, 0);\n        const stats = {\n            totalChars,\n            totalChunks: this.chunks.length,\n            avgChunkSize: this.chunks.length > 0 ? Math.round(totalChars / this.chunks.length) : 0\n        };\n        console.log(`  -> 总字数: ${stats.totalChars.toLocaleString()} 字, 分块数: ${stats.totalChunks} 块, 平均每块: ${stats.avgChunkSize.toLocaleString()} 字`);\n        return stats;\n    }\n    /**\n   * 获取块列表预览\n   * 注意：为避免返回值过大导致 API 格式问题，只返回前 20 个块的预览\n   */ getChunkList() {\n        this.logToolCall(\"get_chunk_list\", \"AI 正在浏览文档结构，查看每块的开头内容\");\n        const total = this.chunks.length;\n        const previewCount = Math.min(20, total);\n        // 只取前 20 个块的预览\n        const previews = this.chunks.slice(0, previewCount).map((c)=>`块${c.index}: \"${c.content.substring(0, 50)}...\" (${c.content.length}字)`);\n        console.log(`  -> 获取到 ${total} 个块的预览`);\n        previews.slice(0, 2).forEach((p)=>console.log(`     ${p}`));\n        if (previewCount > 2) {\n            console.log(`     ... 共 ${total} 块`);\n        }\n        // 返回字符串而不是数组，避免 API 格式问题\n        return `文档共 ${total} 块。前 ${previewCount} 块预览：\\n${previews.join(\"\\n\")}\\n\\n提示：使用 spawn_reader(块范围, 问题) 分批阅读全部内容。`;\n    }\n    /**\n   * 搜索关键词\n   */ searchDocument(keyword) {\n        this.logToolCall(\"search_document\", `AI 正在搜索包含关键词的内容块`, {\n            关键词: keyword\n        });\n        const results = this.chunks.filter((c)=>c.content.includes(keyword)).map((c)=>c.index);\n        console.log(`  -> 找到 ${results.length} 个匹配块${results.length > 0 ? \": [\" + results.join(\", \") + \"]\" : \"\"}`);\n        return results;\n    }\n    /**\n   * 读取块内容\n   */ readChunk(index) {\n        this.logToolCall(\"read_chunk\", `AI 正在阅读第 ${index} 块的完整内容`);\n        const chunk = this.chunks.find((c)=>c.index === index);\n        const result = chunk?.content || _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.RLM_MESSAGES.CHUNK_NOT_FOUND(index);\n        // 记录已读块\n        if (chunk) {\n            this.readChunksSet.add(index);\n        }\n        console.log(`  -> ${chunk ? result.length.toLocaleString() + \" 字\" : \"块不存在\"}`);\n        return result;\n    }\n    /**\n   * 派出阅读助手\n   */ async spawnReader(indexes, question) {\n        this.logToolCall(\"spawn_reader\", `AI 派出助手阅读多个内容块并回答问题`, {\n            阅读范围: `块 ${indexes[0]} 到 块 ${indexes[indexes.length - 1]} (共 ${indexes.length} 块)`,\n            问题: question.length > 80 ? question.substring(0, 80) + \"...\" : question\n        });\n        console.log(`  (子Agent开始工作...)`);\n        const content = indexes.map((i)=>{\n            const chunk = this.readChunk(i);\n            return (0,_prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.formatChunkContent)(i, chunk);\n        }).join(\"\\n\\n---\\n\\n\");\n        try {\n            const llm = this.createLLM(this.config.subAgentModel);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const subAgent = (0,deepagents__WEBPACK_IMPORTED_MODULE_3__.createDeepAgent)({\n                model: llm\n            });\n            const result = await subAgent.invoke({\n                messages: [\n                    {\n                        role: \"user\",\n                        content: (0,_prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.buildSubReaderPrompt)(question, content)\n                    }\n                ]\n            });\n            const messages = result?.messages || [];\n            const lastMessage = messages[messages.length - 1];\n            const answer = lastMessage?.content || \"无法获取回答\";\n            console.log(`  -> 子Agent返回 ${answer.length.toLocaleString()} 字`);\n            return answer;\n        } catch (error) {\n            console.error(`  -> 子Agent出错: ${error instanceof Error ? error.message : \"Unknown error\"}`);\n            return _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.RLM_MESSAGES.READER_ERROR(error instanceof Error ? error.message : \"Unknown error\");\n        }\n    }\n    /**\n   * 更新输出\n   */ updateOutput(content) {\n        this.logToolCall(\"update_output\", `AI 正在保存生成的笔记/输出`);\n        this.output = content;\n        console.log(`  -> 已保存 ${content.length.toLocaleString()} 字`);\n        return _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.RLM_MESSAGES.OUTPUT_UPDATED;\n    }\n    /**\n   * 获取输出\n   */ getOutput() {\n        this.logToolCall(\"get_output\", `AI 正在查看当前已生成的输出内容`);\n        const result = this.output || _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.RLM_MESSAGES.OUTPUT_EMPTY;\n        console.log(`  -> 当前输出: ${this.output ? result.length.toLocaleString() + \" 字\" : \"空\"}`);\n        return result;\n    }\n    // ==================== 主入口 ====================\n    /**\n   * 阅读文档\n   */ async read(input) {\n        const startTime = Date.now();\n        this.toolCallCount = 0;\n        this.readChunksSet.clear();\n        // 生成文档唯一标识和 thread_id\n        this.documentId = this.generateDocumentId(input.content);\n        const threadId = this.getThreadId();\n        console.log(\"\");\n        console.log(\"========== RLM 文档阅读开始 ==========\");\n        console.log(`文档: ${input.title || \"未命名\"} (${input.content.length.toLocaleString()} 字)`);\n        console.log(`任务: ${this.config.task.purpose}`);\n        console.log(`模型: ${this.config.model}`);\n        if (this.config.enableCheckpoint) {\n            console.log(`断点续读: 已启用 (thread: ${threadId})`);\n        }\n        // 1. 预处理：切分文档\n        this.chunks = this.prepareChunks(input.content);\n        this.output = \"\";\n        if (this.chunks.length === 0) {\n            console.log(\"错误: 文档内容为空\");\n            return {\n                content: _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.RLM_MESSAGES.EMPTY_DOCUMENT\n            };\n        }\n        console.log(`分块: ${this.chunks.length} 块`);\n        // 2. 尝试从 checkpoint 恢复状态\n        const hasHistory = await this.tryRestoreFromCheckpoint(threadId);\n        if (hasHistory) {\n            console.log(`  继续上次阅读进度...`);\n        }\n        console.log(\"\");\n        // 3. 构建提示词\n        const systemPrompt = (0,_prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.buildRLMPrompt)(this.config.task);\n        // 4. 创建工具（绑定当前实例的处理函数）\n        const tools = [\n            (0,_tools_rlm__WEBPACK_IMPORTED_MODULE_7__.createGetDocumentStatsTool)(()=>this.getDocumentStats()),\n            (0,_tools_rlm__WEBPACK_IMPORTED_MODULE_7__.createGetChunkListTool)(()=>this.getChunkList()),\n            (0,_tools_rlm__WEBPACK_IMPORTED_MODULE_7__.createSearchDocumentTool)((keyword)=>this.searchDocument(keyword)),\n            (0,_tools_rlm__WEBPACK_IMPORTED_MODULE_7__.createReadChunkTool)((index)=>this.readChunk(index)),\n            (0,_tools_rlm__WEBPACK_IMPORTED_MODULE_7__.createSpawnReaderTool)((indexes, question)=>this.spawnReader(indexes, question)),\n            (0,_tools_rlm__WEBPACK_IMPORTED_MODULE_7__.createUpdateOutputTool)((content)=>this.updateOutput(content)),\n            (0,_tools_rlm__WEBPACK_IMPORTED_MODULE_7__.createGetOutputTool)(()=>this.getOutput()),\n            (0,_tools_rlm__WEBPACK_IMPORTED_MODULE_7__.createDoneTool)(()=>{\n                this.toolCallCount++;\n                console.log(\"\");\n                console.log(`[工具 #${this.toolCallCount}] done`);\n                // 检查覆盖率\n                const totalChunks = this.chunks.length;\n                const readCount = this.readChunksSet.size;\n                const coverage = totalChunks > 0 ? (readCount / totalChunks * 100).toFixed(1) : 0;\n                const minCoverage = this.config.task.minCoverage ?? 0.8; // 默认 80%\n                const minCoveragePercent = (minCoverage * 100).toFixed(0);\n                console.log(`  已读: ${readCount}/${totalChunks} 块 (覆盖率 ${coverage}%，要求 ${minCoveragePercent}%)`);\n                // 检查覆盖率是否满足要求\n                if (totalChunks > 10 && readCount < totalChunks * minCoverage) {\n                    const remaining = Math.ceil(totalChunks * minCoverage) - readCount;\n                    // 找出未读的块，合并成范围便于 AI 理解\n                    const allChunks = new Set(Array.from({\n                        length: totalChunks\n                    }, (_, i)=>i + 1));\n                    const unreadChunks = Array.from(allChunks).filter((i)=>!this.readChunksSet.has(i)).sort((a, b)=>a - b);\n                    // 合并连续范围\n                    const ranges = [];\n                    let start = unreadChunks[0];\n                    let end = unreadChunks[0];\n                    for(let i = 1; i < unreadChunks.length; i++){\n                        if (unreadChunks[i] === end + 1) {\n                            end = unreadChunks[i];\n                        } else {\n                            ranges.push(start === end ? `${start}` : `${start}-${end}`);\n                            start = unreadChunks[i];\n                            end = unreadChunks[i];\n                        }\n                    }\n                    ranges.push(start === end ? `${start}` : `${start}-${end}`);\n                    // 只显示前几个范围，避免消息过长\n                    const displayRanges = ranges.slice(0, 5);\n                    const rangeHint = displayRanges.join(\", \") + (ranges.length > 5 ? ` 等共 ${ranges.length} 个区间` : \"\");\n                    console.log(`  ❌ 拒绝：覆盖率不足 ${minCoveragePercent}%，还需阅读约 ${remaining} 块`);\n                    console.log(`  📍 未读范围: ${rangeHint}`);\n                    return `错误：覆盖率不足 ${minCoveragePercent}%（当前 ${coverage}%）。未读块: ${rangeHint}。请使用 spawn_reader 阅读这些未读块，然后再调用 done。`;\n                }\n                console.log(`  ✓ 任务完成`);\n                return \"任务已完成。请不要再调用任何工具。\";\n            })\n        ];\n        try {\n            // 使用配置好 baseURL 的 LLM 实例\n            const llm = this.createLLM(this.config.model);\n            // 创建 agent，启用 checkpointer 时传入\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const agentConfig = {\n                model: llm,\n                systemPrompt,\n                tools\n            };\n            if (this.config.enableCheckpoint) {\n                agentConfig.checkpointer = await getCheckpointer();\n            }\n            const agent = (0,deepagents__WEBPACK_IMPORTED_MODULE_3__.createDeepAgent)(agentConfig);\n            // 5. 启动阅读（deepagents 会自动处理工具调用）\n            const initMessage = (0,_prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.buildInitMessage)(input.title);\n            // 启用 checkpointer 时传入 thread_id\n            const invokeConfig = {\n                recursionLimit: this.config.recursionLimit\n            };\n            if (this.config.enableCheckpoint) {\n                invokeConfig.configurable = {\n                    thread_id: threadId\n                };\n            }\n            await agent.invoke({\n                messages: [\n                    {\n                        role: \"user\",\n                        content: initMessage\n                    }\n                ]\n            }, invokeConfig);\n            const duration = ((Date.now() - startTime) / 1000).toFixed(1);\n            console.log(\"\");\n            console.log(\"========== RLM 阅读完成 ==========\");\n            console.log(`统计: ${this.toolCallCount} 次工具调用, 耗时 ${duration} 秒, 输出 ${(this.output || \"\").length.toLocaleString()} 字`);\n            console.log(\"\");\n            return {\n                content: this.output || _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.RLM_MESSAGES.NO_OUTPUT,\n                metadata: {\n                    totalChunks: this.chunks.length,\n                    task: this.config.task.purpose\n                }\n            };\n        } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : String(error);\n            const duration = ((Date.now() - startTime) / 1000).toFixed(1);\n            // 打印完整堆栈以便调试\n            if (error instanceof Error && error.stack) {\n                console.error(\"完整错误堆栈:\", error.stack);\n            }\n            // 如果是递归限制错误，返回当前已有的输出\n            if (errorMessage.includes(\"GRAPH_RECURSION_LIMIT\") || errorMessage.includes(\"Recursion limit\")) {\n                console.log(\"\");\n                console.log(\"========== RLM 达到递归限制 ==========\");\n                console.log(`统计: ${this.toolCallCount} 次工具调用, 耗时 ${duration} 秒, 当前输出 ${(this.output || \"\").length.toLocaleString()} 字`);\n                console.log(\"提示: 已达到最大循环次数，返回当前结果\");\n                console.log(\"\");\n                return {\n                    content: this.output || _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.RLM_MESSAGES.NO_OUTPUT,\n                    metadata: {\n                        totalChunks: this.chunks.length,\n                        task: this.config.task.purpose,\n                        warning: \"达到递归限制，结果可能不完整\"\n                    }\n                };\n            }\n            console.log(\"\");\n            console.log(\"========== RLM 阅读出错 ==========\");\n            console.log(`错误: ${errorMessage}`);\n            console.log(`耗时: ${duration} 秒`);\n            console.log(\"\");\n            return {\n                content: _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.RLM_MESSAGES.PROCESS_ERROR(errorMessage)\n            };\n        }\n    }\n    // ==================== 便捷静态方法 ====================\n    /**\n   * 生成学习笔记\n   */ static async studyNotes(input, config) {\n        const reader = new RLMReader({\n            ...config,\n            task: _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.TASK_STUDY_NOTES\n        });\n        return reader.read(input);\n    }\n    /**\n   * 生成摘要\n   */ static async summary(input, config) {\n        const reader = new RLMReader({\n            ...config,\n            task: _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.TASK_SUMMARY\n        });\n        return reader.read(input);\n    }\n    /**\n   * 提取教学知识点\n   */ static async teachingPoints(input, config) {\n        const reader = new RLMReader({\n            ...config,\n            task: _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.TASK_TEACHING_POINTS\n        });\n        return reader.read(input);\n    }\n    /**\n   * 论文分析\n   */ static async paperAnalysis(input, config) {\n        const reader = new RLMReader({\n            ...config,\n            task: _prompts_rlm__WEBPACK_IMPORTED_MODULE_6__.TASK_PAPER_ANALYSIS\n        });\n        return reader.read(input);\n    }\n    /**\n   * 自定义任务\n   */ static async withTask(input, task, config) {\n        const reader = new RLMReader({\n            ...config,\n            task\n        });\n        return reader.read(input);\n    }\n}\n// ==================== 导出 ====================\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPa00sT0FBTzlDLElBQUksQ0FBQ0M7SUFDckI7SUFFQTs7R0FFQyxHQUNELGFBQWE4QyxRQUFROUMsS0FBb0IsRUFBRTNHLE1BQWlDLEVBQXNCO1FBQ2hHLE1BQU13SixTQUFTLElBQUkxSixVQUFVO1lBQUUsR0FBR0UsTUFBTTtZQUFFZixNQUFNMUIsc0RBQVlBO1FBQUM7UUFDN0QsT0FBT2lNLE9BQU85QyxJQUFJLENBQUNDO0lBQ3JCO0lBRUE7O0dBRUMsR0FDRCxhQUFhK0MsZUFBZS9DLEtBQW9CLEVBQUUzRyxNQUFpQyxFQUFzQjtRQUN2RyxNQUFNd0osU0FBUyxJQUFJMUosVUFBVTtZQUFFLEdBQUdFLE1BQU07WUFBRWYsTUFBTXpCLDhEQUFvQkE7UUFBQztRQUNyRSxPQUFPZ00sT0FBTzlDLElBQUksQ0FBQ0M7SUFDckI7SUFFQTs7R0FFQyxHQUNELGFBQWFnRCxjQUFjaEQsS0FBb0IsRUFBRTNHLE1BQWlDLEVBQXNCO1FBQ3RHLE1BQU13SixTQUFTLElBQUkxSixVQUFVO1lBQUUsR0FBR0UsTUFBTTtZQUFFZixNQUFNeEIsNkRBQW1CQTtRQUFDO1FBQ3BFLE9BQU8rTCxPQUFPOUMsSUFBSSxDQUFDQztJQUNyQjtJQUVBOztHQUVDLEdBQ0QsYUFBYWlELFNBQ1hqRCxLQUFvQixFQUNwQjFILElBQW1CLEVBQ25CZSxNQUFpQyxFQUNiO1FBQ3BCLE1BQU13SixTQUFTLElBQUkxSixVQUFVO1lBQUUsR0FBR0UsTUFBTTtZQUFFZjtRQUFLO1FBQy9DLE9BQU91SyxPQUFPOUMsSUFBSSxDQUFDQztJQUNyQjtBQUNGO0FBRUEsK0NBQStDO0FBT3hCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vc3JjL2xpYi9ybG0tcmVhZGVyLnRzP2JiOTgiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSTE0gKFJlY3Vyc2l2ZSBMYW5ndWFnZSBNb2RlbCkg6ZiF6K+75ZmoXG4gKiBcbiAqIOaguOW/g+iDveWKm++8mlxuICogMS4g5q616JC96L6555WM5YiH5YiG77yM5L+d6K+B6K+t5LmJ5a6M5pW0XG4gKiAyLiBMTE0g6Ieq5Li75Yaz5a6a6ZiF6K+7562W55WlXG4gKiAzLiDlj6/phY3nva7nmoTku7vliqHnsbvlnotcbiAqIDQuIOW5tuihjOWtkCBBZ2VudCDlpITnkIblpKfmlofmoaNcbiAqIDUuIENoZWNrcG9pbnRlciDmlq3ngrnnu63or7vmlK/mjIFcbiAqL1xuXG5pbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnY3J5cHRvJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgc3BsaXRJbnRvUGFyYWdyYXBocyB9IGZyb20gJy4vdGV4dC1zcGxpdHRlcic7XG5pbXBvcnQgeyBjcmVhdGVEZWVwQWdlbnQsIHR5cGUgRGVlcEFnZW50IH0gZnJvbSAnZGVlcGFnZW50cyc7XG5pbXBvcnQgeyBDaGF0T3BlbkFJIH0gZnJvbSAnQGxhbmdjaGFpbi9vcGVuYWknO1xuaW1wb3J0IHsgU3FsaXRlU2F2ZXIgfSBmcm9tICdAbGFuZ2NoYWluL2xhbmdncmFwaC1jaGVja3BvaW50LXNxbGl0ZSc7XG5pbXBvcnQge1xuICBidWlsZFJMTVByb21wdCxcbiAgYnVpbGRJbml0TWVzc2FnZSxcbiAgYnVpbGRTdWJSZWFkZXJQcm9tcHQsXG4gIGZvcm1hdENodW5rQ29udGVudCxcbiAgUkxNX01FU1NBR0VTLFxuICBUQVNLX1NUVURZX05PVEVTLFxuICBUQVNLX1NVTU1BUlksXG4gIFRBU0tfVEVBQ0hJTkdfUE9JTlRTLFxuICBUQVNLX1BBUEVSX0FOQUxZU0lTLFxufSBmcm9tICcuL3Byb21wdHMvcmxtJztcbmltcG9ydCB7XG4gIGNyZWF0ZUdldERvY3VtZW50U3RhdHNUb29sLFxuICBjcmVhdGVHZXRDaHVua0xpc3RUb29sLFxuICBjcmVhdGVTZWFyY2hEb2N1bWVudFRvb2wsXG4gIGNyZWF0ZVJlYWRDaHVua1Rvb2wsXG4gIGNyZWF0ZVNwYXduUmVhZGVyVG9vbCxcbiAgY3JlYXRlVXBkYXRlT3V0cHV0VG9vbCxcbiAgY3JlYXRlR2V0T3V0cHV0VG9vbCxcbiAgY3JlYXRlRG9uZVRvb2wsXG59IGZyb20gJy4vdG9vbHMvcmxtJztcbmltcG9ydCB0eXBlIHtcbiAgRG9jdW1lbnRJbnB1dCxcbiAgRG9jdW1lbnRDaHVuayxcbiAgRG9jdW1lbnRTdGF0cyxcbiAgUkxNT3V0cHV0LFxuICBSTE1SZWFkZXJDb25maWcsXG4gIFJMTVRhc2tDb25maWcsXG4gIFJMTVN0YXRlLFxufSBmcm9tICcuL3R5cGVzJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT0gU1FMaXRlIENoZWNrcG9pbnRlciA9PT09PT09PT09PT09PT09PT09PVxuXG4vLyBTUUxpdGUg5pWw5o2u5bqT6Lev5b6EXG5jb25zdCBDSEVDS1BPSU5UX0RCX1BBVEggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJy5ybG0tY2hlY2twb2ludHMuZGInKTtcblxuLy8g5L2/55So5Y2V5L6L5qih5byP77yM56Gu5L+d6Leo6LCD55So5L+d5oyB54q25oCBXG5sZXQgZ2xvYmFsQ2hlY2twb2ludGVyOiBTcWxpdGVTYXZlciB8IG51bGwgPSBudWxsO1xubGV0IGNoZWNrcG9pbnRlckluaXRQcm9taXNlOiBQcm9taXNlPFNxbGl0ZVNhdmVyPiB8IG51bGwgPSBudWxsO1xuXG5hc3luYyBmdW5jdGlvbiBnZXRDaGVja3BvaW50ZXIoKTogUHJvbWlzZTxTcWxpdGVTYXZlcj4ge1xuICBpZiAoZ2xvYmFsQ2hlY2twb2ludGVyKSB7XG4gICAgcmV0dXJuIGdsb2JhbENoZWNrcG9pbnRlcjtcbiAgfVxuICBcbiAgaWYgKCFjaGVja3BvaW50ZXJJbml0UHJvbWlzZSkge1xuICAgIGNoZWNrcG9pbnRlckluaXRQcm9taXNlID0gKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNhdmVyID0gU3FsaXRlU2F2ZXIuZnJvbUNvbm5TdHJpbmcoQ0hFQ0tQT0lOVF9EQl9QQVRIKTtcbiAgICAgIC8vIOWmguaenCBmcm9tQ29ublN0cmluZyDov5Tlm54gUHJvbWlzZe+8jOmcgOimgSBhd2FpdFxuICAgICAgY29uc3QgaW5zdGFuY2UgPSBzYXZlciBpbnN0YW5jZW9mIFByb21pc2UgPyBhd2FpdCBzYXZlciA6IHNhdmVyO1xuICAgICAgLy8g5Yid5aeL5YyW5pWw5o2u5bqTIHNjaGVtYe+8iOW/hemhu+iwg+eUqCBzZXR1cO+8iVxuICAgICAgYXdhaXQgaW5zdGFuY2Uuc2V0dXAoKTtcbiAgICAgIGdsb2JhbENoZWNrcG9pbnRlciA9IGluc3RhbmNlO1xuICAgICAgY29uc29sZS5sb2coYFtSTE1dIENoZWNrcG9pbnRlciDlt7LliJ3lp4vljJY6ICR7Q0hFQ0tQT0lOVF9EQl9QQVRIfWApO1xuICAgICAgcmV0dXJuIGdsb2JhbENoZWNrcG9pbnRlcjtcbiAgICB9KSgpO1xuICB9XG4gIFxuICByZXR1cm4gY2hlY2twb2ludGVySW5pdFByb21pc2U7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09IOm7mOiupOmFjee9riA9PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBERUZBVUxUX0NPTkZJRzogUmVxdWlyZWQ8UkxNUmVhZGVyQ29uZmlnPiA9IHtcbiAgdGFzazogVEFTS19TVFVEWV9OT1RFUyxcbiAgY2h1bmtTaXplOiAyMDAwLFxuICBtb2RlbDogcHJvY2Vzcy5lbnYuT1BFTkFJX01PREVMIHx8ICdxd2VuLXBsdXMnLFxuICBtb2RlbFByb3ZpZGVyOiBwcm9jZXNzLmVudi5PUEVOQUlfTU9ERUxfUFJPVklERVIgfHwgJ29wZW5haScsXG4gIHN1YkFnZW50TW9kZWw6IHByb2Nlc3MuZW52Lk9QRU5BSV9NT0RFTCB8fCAncXdlbi1wbHVzJyxcbiAgc3ViQWdlbnRNb2RlbFByb3ZpZGVyOiBwcm9jZXNzLmVudi5PUEVOQUlfTU9ERUxfUFJPVklERVIgfHwgJ29wZW5haScsXG4gIGJhc2VVUkw6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfQkFTRSB8fCAnaHR0cHM6Ly9kYXNoc2NvcGUuYWxpeXVuY3MuY29tL2NvbXBhdGlibGUtbW9kZS92MScsXG4gIHJlY3Vyc2lvbkxpbWl0OiA1MDAsXG4gIGVuYWJsZUNoZWNrcG9pbnQ6IHRydWUsICAvLyBTUUxpdGUg5pat54K557ut6K+7XG59O1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PSBSTE1SZWFkZXIg57G7ID09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjbGFzcyBSTE1SZWFkZXIge1xuICBwcml2YXRlIGNodW5rczogRG9jdW1lbnRDaHVua1tdID0gW107XG4gIHByaXZhdGUgb3V0cHV0OiBzdHJpbmcgPSAnJztcbiAgcHJpdmF0ZSBjb25maWc6IFJlcXVpcmVkPFJMTVJlYWRlckNvbmZpZz47XG4gIHByaXZhdGUgdG9vbENhbGxDb3VudDogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSByZWFkQ2h1bmtzU2V0OiBTZXQ8bnVtYmVyPiA9IG5ldyBTZXQoKTtcbiAgcHJpdmF0ZSBkb2N1bWVudElkOiBzdHJpbmcgPSAnJztcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IFJMTVJlYWRlckNvbmZpZyA9IHt9KSB7XG4gICAgdGhpcy5jb25maWcgPSB7XG4gICAgICB0YXNrOiBjb25maWcudGFzayB8fCBERUZBVUxUX0NPTkZJRy50YXNrLFxuICAgICAgY2h1bmtTaXplOiBjb25maWcuY2h1bmtTaXplIHx8IERFRkFVTFRfQ09ORklHLmNodW5rU2l6ZSxcbiAgICAgIG1vZGVsOiBjb25maWcubW9kZWwgfHwgREVGQVVMVF9DT05GSUcubW9kZWwsXG4gICAgICBtb2RlbFByb3ZpZGVyOiBjb25maWcubW9kZWxQcm92aWRlciB8fCBERUZBVUxUX0NPTkZJRy5tb2RlbFByb3ZpZGVyLFxuICAgICAgc3ViQWdlbnRNb2RlbDogY29uZmlnLnN1YkFnZW50TW9kZWwgfHwgREVGQVVMVF9DT05GSUcuc3ViQWdlbnRNb2RlbCxcbiAgICAgIHN1YkFnZW50TW9kZWxQcm92aWRlcjogY29uZmlnLnN1YkFnZW50TW9kZWxQcm92aWRlciB8fCBERUZBVUxUX0NPTkZJRy5zdWJBZ2VudE1vZGVsUHJvdmlkZXIsXG4gICAgICBiYXNlVVJMOiBjb25maWcuYmFzZVVSTCB8fCBERUZBVUxUX0NPTkZJRy5iYXNlVVJMLFxuICAgICAgcmVjdXJzaW9uTGltaXQ6IGNvbmZpZy5yZWN1cnNpb25MaW1pdCB8fCBERUZBVUxUX0NPTkZJRy5yZWN1cnNpb25MaW1pdCxcbiAgICAgIGVuYWJsZUNoZWNrcG9pbnQ6IGNvbmZpZy5lbmFibGVDaGVja3BvaW50ID8/IERFRkFVTFRfQ09ORklHLmVuYWJsZUNoZWNrcG9pbnQsXG4gICAgfTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09IFRocmVhZCBJRCDnlJ/miJAgPT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog55Sf5oiQ5paH5qGj5ZSv5LiA5qCH6K+G77yI55So5LqOIHRocmVhZF9pZO+8iVxuICAgKiDln7rkuo7lhoXlrrnlk4jluIwgKyDku7vliqHnsbvlnotcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVEb2N1bWVudElkKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgaGFzaCA9IGNyZWF0ZUhhc2goJ21kNScpXG4gICAgICAudXBkYXRlKGNvbnRlbnQuc3Vic3RyaW5nKDAsIDEwMDAwKSlcbiAgICAgIC51cGRhdGUodGhpcy5jb25maWcudGFzay5wdXJwb3NlKVxuICAgICAgLmRpZ2VzdCgnaGV4JylcbiAgICAgIC5zdWJzdHJpbmcoMCwgMTIpO1xuICAgIHJldHVybiBoYXNoO1xuICB9XG5cbiAgLyoqXG4gICAqIOeUn+aIkCB0aHJlYWRfaWTvvIjnlKjkuo4gY2hlY2twb2ludGVy77yJXG4gICAqL1xuICBwcml2YXRlIGdldFRocmVhZElkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBybG0tJHt0aGlzLmRvY3VtZW50SWR9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmo4Dmn6XmmK/lkKbmnInljoblj7IgY2hlY2twb2ludFxuICAgKiDms6jmhI/vvJpjaGVja3BvaW50IOeUqOS6juiuqSBBSSDnn6XpgZPoh6rlt7HlgZrov4fku4DkuYjvvIzkuI3mmK/nlKjkuo7mlq3nlLXnu63kvKBcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgdHJ5UmVzdG9yZUZyb21DaGVja3BvaW50KHRocmVhZElkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAoIXRoaXMuY29uZmlnLmVuYWJsZUNoZWNrcG9pbnQpIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2hlY2twb2ludGVyID0gYXdhaXQgZ2V0Q2hlY2twb2ludGVyKCk7XG4gICAgICBcbiAgICAgIC8vIOajgOafpeaYr+WQpuacieatpCB0aHJlYWQg55qEIGNoZWNrcG9pbnRcbiAgICAgIGxldCBoYXNDaGVja3BvaW50ID0gZmFsc2U7XG4gICAgICBmb3IgYXdhaXQgKGNvbnN0IF9jcCBvZiBjaGVja3BvaW50ZXIubGlzdCh7IGNvbmZpZ3VyYWJsZTogeyB0aHJlYWRfaWQ6IHRocmVhZElkIH0gfSkpIHtcbiAgICAgICAgaGFzQ2hlY2twb2ludCA9IHRydWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoaGFzQ2hlY2twb2ludCkge1xuICAgICAgICBjb25zb2xlLmxvZyhgICDwn5OmIOWPkeeOsOWOhuWPsua2iOaBr+iusOW9lWApO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaGFzQ2hlY2twb2ludDtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmxvZyhgICDimqDvuI8g5qOA5p+l5Y6G5Y+y5aSx6LSlOiAke2UgaW5zdGFuY2VvZiBFcnJvciA/IGUubWVzc2FnZSA6ICdVbmtub3duJ31gKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu66YWN572u5aW9IGJhc2VVUkwg55qEIExMTSDlrp7kvotcbiAgICovXG4gIHByaXZhdGUgY3JlYXRlTExNKG1vZGVsOiBzdHJpbmcpOiBDaGF0T3BlbkFJIHtcbiAgICByZXR1cm4gbmV3IENoYXRPcGVuQUkoe1xuICAgICAgbW9kZWwsXG4gICAgICBvcGVuQUlBcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZLFxuICAgICAgY29uZmlndXJhdGlvbjoge1xuICAgICAgICBiYXNlVVJMOiB0aGlzLmNvbmZpZy5iYXNlVVJMLFxuICAgICAgfSxcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgfSk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PSDpooTlpITnkIYgPT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog5q616JC96L6555WM5YiH5YiGXG4gICAqL1xuICBwcml2YXRlIHByZXBhcmVDaHVua3MoY29udGVudDogc3RyaW5nKTogRG9jdW1lbnRDaHVua1tdIHtcbiAgICBjb25zdCBwYXJhZ3JhcGhzID0gc3BsaXRJbnRvUGFyYWdyYXBocyhjb250ZW50LCB0aGlzLmNvbmZpZy5jaHVua1NpemUpO1xuICAgIGxldCBjaGFyUG9zID0gMDtcbiAgICByZXR1cm4gcGFyYWdyYXBocy5tYXAoKHAsIGkpID0+IHtcbiAgICAgIGNvbnN0IGNodW5rOiBEb2N1bWVudENodW5rID0ge1xuICAgICAgICBpbmRleDogaSArIDEsXG4gICAgICAgIGNvbnRlbnQ6IHAsXG4gICAgICAgIGNoYXJTdGFydDogY2hhclBvcyxcbiAgICAgICAgY2hhckVuZDogY2hhclBvcyArIHAubGVuZ3RoLFxuICAgICAgfTtcbiAgICAgIGNoYXJQb3MgKz0gcC5sZW5ndGg7XG4gICAgICByZXR1cm4gY2h1bms7XG4gICAgfSk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PSDml6Xlv5fovoXliqkgPT09PT09PT09PT09PT09PT09PT1cblxuICBwcml2YXRlIGxvZyhtZXNzYWdlOiBzdHJpbmcsIGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCd6aC1DTicpO1xuICAgIGNvbnN0IHByZWZpeCA9IGBbUkxNICR7dGltZXN0YW1wfV1gO1xuICAgIGlmIChkYXRhKSB7XG4gICAgICBjb25zb2xlLmxvZyhgJHtwcmVmaXh9ICR7bWVzc2FnZX1gKTtcbiAgICAgIE9iamVjdC5lbnRyaWVzKGRhdGEpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhgICAgIOKUlOKUgCAke2tleX06ICR7dHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyA/IEpTT04uc3RyaW5naWZ5KHZhbHVlKSA6IHZhbHVlfWApO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKGAke3ByZWZpeH0gJHttZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgbG9nVG9vbENhbGwodG9vbE5hbWU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgcGFyYW1zPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgICB0aGlzLnRvb2xDYWxsQ291bnQrKztcbiAgICBjb25zb2xlLmxvZygnJyk7XG4gICAgY29uc29sZS5sb2coYFvlt6XlhbcgIyR7dGhpcy50b29sQ2FsbENvdW50fV0gJHt0b29sTmFtZX1gKTtcbiAgICBjb25zb2xlLmxvZyhgICDor7TmmI46ICR7ZGVzY3JpcHRpb259YCk7XG4gICAgaWYgKHBhcmFtcykge1xuICAgICAgT2JqZWN0LmVudHJpZXMocGFyYW1zKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgY29uc3QgZGlzcGxheVZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB2YWx1ZS5sZW5ndGggPiAxMDAgXG4gICAgICAgICAgPyB2YWx1ZS5zdWJzdHJpbmcoMCwgMTAwKSArICcuLi4nIFxuICAgICAgICAgIDogdmFsdWU7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgICR7a2V5fTogJHtkaXNwbGF5VmFsdWV9YCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGxvZ1Rvb2xSZXN1bHQocmVzdWx0OiBzdHJpbmcgfCBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICAgIGlmICh0eXBlb2YgcmVzdWx0ID09PSAnc3RyaW5nJykge1xuICAgICAgY29uc29sZS5sb2coYCAgLT4g6L+U5ZueOiAke3Jlc3VsdC5sZW5ndGggPiAyMDAgPyByZXN1bHQuc3Vic3RyaW5nKDAsIDIwMCkgKyAnLi4uJyA6IHJlc3VsdH1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coYCAgLT4g6L+U5ZueOmAsIHJlc3VsdCk7XG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT0g5bel5YW35a6e546wID09PT09PT09PT09PT09PT09PT09XG5cbiAgLyoqXG4gICAqIOiOt+WPluaWh+aho+e7n+iuoVxuICAgKi9cbiAgcHJpdmF0ZSBnZXREb2N1bWVudFN0YXRzKCk6IERvY3VtZW50U3RhdHMge1xuICAgIHRoaXMubG9nVG9vbENhbGwoJ2dldF9kb2N1bWVudF9zdGF0cycsICdBSSDmraPlnKjkuobop6PmlofmoaPnmoTln7rmnKzkv6Hmga/vvIjmgLvlrZfmlbDjgIHliIblnZfmlbDph4/jgIHlubPlnYfmr4/lnZflpKflsI/vvIknKTtcbiAgICBcbiAgICBjb25zdCB0b3RhbENoYXJzID0gdGhpcy5jaHVua3MucmVkdWNlKChzdW0sIGMpID0+IHN1bSArIGMuY29udGVudC5sZW5ndGgsIDApO1xuICAgIGNvbnN0IHN0YXRzID0ge1xuICAgICAgdG90YWxDaGFycyxcbiAgICAgIHRvdGFsQ2h1bmtzOiB0aGlzLmNodW5rcy5sZW5ndGgsXG4gICAgICBhdmdDaHVua1NpemU6IHRoaXMuY2h1bmtzLmxlbmd0aCA+IDAgPyBNYXRoLnJvdW5kKHRvdGFsQ2hhcnMgLyB0aGlzLmNodW5rcy5sZW5ndGgpIDogMCxcbiAgICB9O1xuICAgIFxuICAgIGNvbnNvbGUubG9nKGAgIC0+IOaAu+Wtl+aVsDogJHtzdGF0cy50b3RhbENoYXJzLnRvTG9jYWxlU3RyaW5nKCl9IOWtlywg5YiG5Z2X5pWwOiAke3N0YXRzLnRvdGFsQ2h1bmtzfSDlnZcsIOW5s+Wdh+avj+WdlzogJHtzdGF0cy5hdmdDaHVua1NpemUudG9Mb2NhbGVTdHJpbmcoKX0g5a2XYCk7XG4gICAgXG4gICAgcmV0dXJuIHN0YXRzO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWdl+WIl+ihqOmihOiniFxuICAgKiDms6jmhI/vvJrkuLrpgb/lhY3ov5Tlm57lgLzov4flpKflr7zoh7QgQVBJIOagvOW8j+mXrumimO+8jOWPqui/lOWbnuWJjSAyMCDkuKrlnZfnmoTpooTop4hcbiAgICovXG4gIHByaXZhdGUgZ2V0Q2h1bmtMaXN0KCk6IHN0cmluZyB7XG4gICAgdGhpcy5sb2dUb29sQ2FsbCgnZ2V0X2NodW5rX2xpc3QnLCAnQUkg5q2j5Zyo5rWP6KeI5paH5qGj57uT5p6E77yM5p+l55yL5q+P5Z2X55qE5byA5aS05YaF5a65Jyk7XG4gICAgXG4gICAgY29uc3QgdG90YWwgPSB0aGlzLmNodW5rcy5sZW5ndGg7XG4gICAgY29uc3QgcHJldmlld0NvdW50ID0gTWF0aC5taW4oMjAsIHRvdGFsKTtcbiAgICBcbiAgICAvLyDlj6rlj5bliY0gMjAg5Liq5Z2X55qE6aKE6KeIXG4gICAgY29uc3QgcHJldmlld3MgPSB0aGlzLmNodW5rcy5zbGljZSgwLCBwcmV2aWV3Q291bnQpLm1hcChjID0+IFxuICAgICAgYOWdlyR7Yy5pbmRleH06IFwiJHtjLmNvbnRlbnQuc3Vic3RyaW5nKDAsIDUwKX0uLi5cIiAoJHtjLmNvbnRlbnQubGVuZ3RofeWtlylgXG4gICAgKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhgICAtPiDojrflj5bliLAgJHt0b3RhbH0g5Liq5Z2X55qE6aKE6KeIYCk7XG4gICAgcHJldmlld3Muc2xpY2UoMCwgMikuZm9yRWFjaChwID0+IGNvbnNvbGUubG9nKGAgICAgICR7cH1gKSk7XG4gICAgaWYgKHByZXZpZXdDb3VudCA+IDIpIHtcbiAgICAgIGNvbnNvbGUubG9nKGAgICAgIC4uLiDlhbEgJHt0b3RhbH0g5Z2XYCk7XG4gICAgfVxuICAgIFxuICAgIC8vIOi/lOWbnuWtl+espuS4suiAjOS4jeaYr+aVsOe7hO+8jOmBv+WFjSBBUEkg5qC85byP6Zeu6aKYXG4gICAgcmV0dXJuIGDmlofmoaPlhbEgJHt0b3RhbH0g5Z2X44CC5YmNICR7cHJldmlld0NvdW50fSDlnZfpooTop4jvvJpcXG4ke3ByZXZpZXdzLmpvaW4oJ1xcbicpfVxcblxcbuaPkOekuu+8muS9v+eUqCBzcGF3bl9yZWFkZXIo5Z2X6IyD5Zu0LCDpl67popgpIOWIhuaJuemYheivu+WFqOmDqOWGheWuueOAgmA7XG4gIH1cblxuICAvKipcbiAgICog5pCc57Si5YWz6ZSu6K+NXG4gICAqL1xuICBwcml2YXRlIHNlYXJjaERvY3VtZW50KGtleXdvcmQ6IHN0cmluZyk6IG51bWJlcltdIHtcbiAgICB0aGlzLmxvZ1Rvb2xDYWxsKCdzZWFyY2hfZG9jdW1lbnQnLCBgQUkg5q2j5Zyo5pCc57Si5YyF5ZCr5YWz6ZSu6K+N55qE5YaF5a655Z2XYCwgeyDlhbPplK7or406IGtleXdvcmQgfSk7XG4gICAgXG4gICAgY29uc3QgcmVzdWx0cyA9IHRoaXMuY2h1bmtzXG4gICAgICAuZmlsdGVyKGMgPT4gYy5jb250ZW50LmluY2x1ZGVzKGtleXdvcmQpKVxuICAgICAgLm1hcChjID0+IGMuaW5kZXgpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKGAgIC0+IOaJvuWIsCAke3Jlc3VsdHMubGVuZ3RofSDkuKrljLnphY3lnZcke3Jlc3VsdHMubGVuZ3RoID4gMCA/ICc6IFsnICsgcmVzdWx0cy5qb2luKCcsICcpICsgJ10nIDogJyd9YCk7XG4gICAgXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICAvKipcbiAgICog6K+75Y+W5Z2X5YaF5a65XG4gICAqL1xuICBwcml2YXRlIHJlYWRDaHVuayhpbmRleDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICB0aGlzLmxvZ1Rvb2xDYWxsKCdyZWFkX2NodW5rJywgYEFJIOato+WcqOmYheivu+esrCAke2luZGV4fSDlnZfnmoTlrozmlbTlhoXlrrlgKTtcbiAgICBcbiAgICBjb25zdCBjaHVuayA9IHRoaXMuY2h1bmtzLmZpbmQoYyA9PiBjLmluZGV4ID09PSBpbmRleCk7XG4gICAgY29uc3QgcmVzdWx0ID0gY2h1bms/LmNvbnRlbnQgfHwgUkxNX01FU1NBR0VTLkNIVU5LX05PVF9GT1VORChpbmRleCk7XG4gICAgXG4gICAgLy8g6K6w5b2V5bey6K+75Z2XXG4gICAgaWYgKGNodW5rKSB7XG4gICAgICB0aGlzLnJlYWRDaHVua3NTZXQuYWRkKGluZGV4KTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coYCAgLT4gJHtjaHVuayA/IHJlc3VsdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKSArICcg5a2XJyA6ICflnZfkuI3lrZjlnKgnfWApO1xuICAgIFxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICog5rS+5Ye66ZiF6K+75Yqp5omLXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNwYXduUmVhZGVyKGluZGV4ZXM6IG51bWJlcltdLCBxdWVzdGlvbjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICB0aGlzLmxvZ1Rvb2xDYWxsKCdzcGF3bl9yZWFkZXInLCBgQUkg5rS+5Ye65Yqp5omL6ZiF6K+75aSa5Liq5YaF5a655Z2X5bm25Zue562U6Zeu6aKYYCwge1xuICAgICAg6ZiF6K+76IyD5Zu0OiBg5Z2XICR7aW5kZXhlc1swXX0g5YiwIOWdlyAke2luZGV4ZXNbaW5kZXhlcy5sZW5ndGgtMV19ICjlhbEgJHtpbmRleGVzLmxlbmd0aH0g5Z2XKWAsXG4gICAgICDpl67popg6IHF1ZXN0aW9uLmxlbmd0aCA+IDgwID8gcXVlc3Rpb24uc3Vic3RyaW5nKDAsIDgwKSArICcuLi4nIDogcXVlc3Rpb24sXG4gICAgfSk7XG4gICAgXG4gICAgY29uc29sZS5sb2coYCAgKOWtkEFnZW505byA5aeL5bel5L2cLi4uKWApO1xuICAgIFxuICAgIGNvbnN0IGNvbnRlbnQgPSBpbmRleGVzLm1hcChpID0+IHtcbiAgICAgIGNvbnN0IGNodW5rID0gdGhpcy5yZWFkQ2h1bmsoaSk7XG4gICAgICByZXR1cm4gZm9ybWF0Q2h1bmtDb250ZW50KGksIGNodW5rKTtcbiAgICB9KS5qb2luKCdcXG5cXG4tLS1cXG5cXG4nKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBsbG0gPSB0aGlzLmNyZWF0ZUxMTSh0aGlzLmNvbmZpZy5zdWJBZ2VudE1vZGVsKTtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICBjb25zdCBzdWJBZ2VudDogYW55ID0gY3JlYXRlRGVlcEFnZW50KHtcbiAgICAgICAgbW9kZWw6IGxsbSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzdWJBZ2VudC5pbnZva2Uoe1xuICAgICAgICBtZXNzYWdlczogW3tcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgY29udGVudDogYnVpbGRTdWJSZWFkZXJQcm9tcHQocXVlc3Rpb24sIGNvbnRlbnQpLFxuICAgICAgICB9XSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBtZXNzYWdlcyA9IHJlc3VsdD8ubWVzc2FnZXMgfHwgW107XG4gICAgICBjb25zdCBsYXN0TWVzc2FnZSA9IG1lc3NhZ2VzW21lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICAgICAgY29uc3QgYW5zd2VyID0gbGFzdE1lc3NhZ2U/LmNvbnRlbnQgfHwgJ+aXoOazleiOt+WPluWbnuetlCc7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGAgIC0+IOWtkEFnZW506L+U5ZueICR7YW5zd2VyLmxlbmd0aC50b0xvY2FsZVN0cmluZygpfSDlrZdgKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIGFuc3dlcjtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgICAtPiDlrZBBZ2VudOWHuumUmTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICAgIHJldHVybiBSTE1fTUVTU0FHRVMuUkVBREVSX0VSUk9SKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pu05paw6L6T5Ye6XG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZU91dHB1dChjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHRoaXMubG9nVG9vbENhbGwoJ3VwZGF0ZV9vdXRwdXQnLCBgQUkg5q2j5Zyo5L+d5a2Y55Sf5oiQ55qE56yU6K6wL+i+k+WHumApO1xuICAgIFxuICAgIHRoaXMub3V0cHV0ID0gY29udGVudDtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhgICAtPiDlt7Lkv53lrZggJHtjb250ZW50Lmxlbmd0aC50b0xvY2FsZVN0cmluZygpfSDlrZdgKTtcbiAgICBcbiAgICByZXR1cm4gUkxNX01FU1NBR0VTLk9VVFBVVF9VUERBVEVEO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlui+k+WHulxuICAgKi9cbiAgcHJpdmF0ZSBnZXRPdXRwdXQoKTogc3RyaW5nIHtcbiAgICB0aGlzLmxvZ1Rvb2xDYWxsKCdnZXRfb3V0cHV0JywgYEFJIOato+WcqOafpeeci+W9k+WJjeW3sueUn+aIkOeahOi+k+WHuuWGheWuuWApO1xuICAgIFxuICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMub3V0cHV0IHx8IFJMTV9NRVNTQUdFUy5PVVRQVVRfRU1QVFk7XG4gICAgXG4gICAgY29uc29sZS5sb2coYCAgLT4g5b2T5YmN6L6T5Ye6OiAke3RoaXMub3V0cHV0ID8gcmVzdWx0Lmxlbmd0aC50b0xvY2FsZVN0cmluZygpICsgJyDlrZcnIDogJ+epuid9YCk7XG4gICAgXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09IOS4u+WFpeWPoyA9PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDpmIXor7vmlofmoaNcbiAgICovXG4gIGFzeW5jIHJlYWQoaW5wdXQ6IERvY3VtZW50SW5wdXQpOiBQcm9taXNlPFJMTU91dHB1dD4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgdGhpcy50b29sQ2FsbENvdW50ID0gMDtcbiAgICB0aGlzLnJlYWRDaHVua3NTZXQuY2xlYXIoKTtcbiAgICBcbiAgICAvLyDnlJ/miJDmlofmoaPllK/kuIDmoIfor4blkowgdGhyZWFkX2lkXG4gICAgdGhpcy5kb2N1bWVudElkID0gdGhpcy5nZW5lcmF0ZURvY3VtZW50SWQoaW5wdXQuY29udGVudCk7XG4gICAgY29uc3QgdGhyZWFkSWQgPSB0aGlzLmdldFRocmVhZElkKCk7XG4gICAgXG4gICAgY29uc29sZS5sb2coJycpO1xuICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09IFJMTSDmlofmoaPpmIXor7vlvIDlp4sgPT09PT09PT09PScpO1xuICAgIGNvbnNvbGUubG9nKGDmlofmoaM6ICR7aW5wdXQudGl0bGUgfHwgJ+acquWRveWQjSd9ICgke2lucHV0LmNvbnRlbnQubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IOWtlylgKTtcbiAgICBjb25zb2xlLmxvZyhg5Lu75YqhOiAke3RoaXMuY29uZmlnLnRhc2sucHVycG9zZX1gKTtcbiAgICBjb25zb2xlLmxvZyhg5qih5Z6LOiAke3RoaXMuY29uZmlnLm1vZGVsfWApO1xuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVDaGVja3BvaW50KSB7XG4gICAgICBjb25zb2xlLmxvZyhg5pat54K557ut6K+7OiDlt7LlkK/nlKggKHRocmVhZDogJHt0aHJlYWRJZH0pYCk7XG4gICAgfVxuICAgIFxuICAgIC8vIDEuIOmihOWkhOeQhu+8muWIh+WIhuaWh+aho1xuICAgIHRoaXMuY2h1bmtzID0gdGhpcy5wcmVwYXJlQ2h1bmtzKGlucHV0LmNvbnRlbnQpO1xuICAgIHRoaXMub3V0cHV0ID0gJyc7XG5cbiAgICBpZiAodGhpcy5jaHVua3MubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZygn6ZSZ6K+vOiDmlofmoaPlhoXlrrnkuLrnqbonKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IFJMTV9NRVNTQUdFUy5FTVBUWV9ET0NVTUVOVCxcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKGDliIblnZc6ICR7dGhpcy5jaHVua3MubGVuZ3RofSDlnZdgKTtcbiAgICBcbiAgICAvLyAyLiDlsJ3or5Xku44gY2hlY2twb2ludCDmgaLlpI3nirbmgIFcbiAgICBjb25zdCBoYXNIaXN0b3J5ID0gYXdhaXQgdGhpcy50cnlSZXN0b3JlRnJvbUNoZWNrcG9pbnQodGhyZWFkSWQpO1xuICAgIGlmIChoYXNIaXN0b3J5KSB7XG4gICAgICBjb25zb2xlLmxvZyhgICDnu6fnu63kuIrmrKHpmIXor7vov5vluqYuLi5gKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coJycpO1xuXG4gICAgLy8gMy4g5p6E5bu65o+Q56S66K+NXG4gICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYnVpbGRSTE1Qcm9tcHQodGhpcy5jb25maWcudGFzayk7XG5cbiAgICAvLyA0LiDliJvlu7rlt6XlhbfvvIjnu5HlrprlvZPliY3lrp7kvovnmoTlpITnkIblh73mlbDvvIlcbiAgICBjb25zdCB0b29scyA9IFtcbiAgICAgIGNyZWF0ZUdldERvY3VtZW50U3RhdHNUb29sKCgpID0+IHRoaXMuZ2V0RG9jdW1lbnRTdGF0cygpKSxcbiAgICAgIGNyZWF0ZUdldENodW5rTGlzdFRvb2woKCkgPT4gdGhpcy5nZXRDaHVua0xpc3QoKSksXG4gICAgICBjcmVhdGVTZWFyY2hEb2N1bWVudFRvb2woKGtleXdvcmQpID0+IHRoaXMuc2VhcmNoRG9jdW1lbnQoa2V5d29yZCkpLFxuICAgICAgY3JlYXRlUmVhZENodW5rVG9vbCgoaW5kZXgpID0+IHRoaXMucmVhZENodW5rKGluZGV4KSksXG4gICAgICBjcmVhdGVTcGF3blJlYWRlclRvb2woKGluZGV4ZXMsIHF1ZXN0aW9uKSA9PiB0aGlzLnNwYXduUmVhZGVyKGluZGV4ZXMsIHF1ZXN0aW9uKSksXG4gICAgICBjcmVhdGVVcGRhdGVPdXRwdXRUb29sKChjb250ZW50KSA9PiB0aGlzLnVwZGF0ZU91dHB1dChjb250ZW50KSksXG4gICAgICBjcmVhdGVHZXRPdXRwdXRUb29sKCgpID0+IHRoaXMuZ2V0T3V0cHV0KCkpLFxuICAgICAgY3JlYXRlRG9uZVRvb2woKCkgPT4ge1xuICAgICAgICB0aGlzLnRvb2xDYWxsQ291bnQrKztcbiAgICAgICAgY29uc29sZS5sb2coJycpO1xuICAgICAgICBjb25zb2xlLmxvZyhgW+W3peWFtyAjJHt0aGlzLnRvb2xDYWxsQ291bnR9XSBkb25lYCk7XG4gICAgICAgIFxuICAgICAgICAvLyDmo4Dmn6Xopobnm5bnjodcbiAgICAgICAgY29uc3QgdG90YWxDaHVua3MgPSB0aGlzLmNodW5rcy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHJlYWRDb3VudCA9IHRoaXMucmVhZENodW5rc1NldC5zaXplO1xuICAgICAgICBjb25zdCBjb3ZlcmFnZSA9IHRvdGFsQ2h1bmtzID4gMCA/IChyZWFkQ291bnQgLyB0b3RhbENodW5rcyAqIDEwMCkudG9GaXhlZCgxKSA6IDA7XG4gICAgICAgIGNvbnN0IG1pbkNvdmVyYWdlID0gdGhpcy5jb25maWcudGFzay5taW5Db3ZlcmFnZSA/PyAwLjg7IC8vIOm7mOiupCA4MCVcbiAgICAgICAgY29uc3QgbWluQ292ZXJhZ2VQZXJjZW50ID0gKG1pbkNvdmVyYWdlICogMTAwKS50b0ZpeGVkKDApO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYCAg5bey6K+7OiAke3JlYWRDb3VudH0vJHt0b3RhbENodW5rc30g5Z2XICjopobnm5bnjocgJHtjb3ZlcmFnZX0l77yM6KaB5rGCICR7bWluQ292ZXJhZ2VQZXJjZW50fSUpYCk7XG4gICAgICAgIFxuICAgICAgICAvLyDmo4Dmn6Xopobnm5bnjofmmK/lkKbmu6HotrPopoHmsYJcbiAgICAgICAgaWYgKHRvdGFsQ2h1bmtzID4gMTAgJiYgcmVhZENvdW50IDwgdG90YWxDaHVua3MgKiBtaW5Db3ZlcmFnZSkge1xuICAgICAgICAgIGNvbnN0IHJlbWFpbmluZyA9IE1hdGguY2VpbCh0b3RhbENodW5rcyAqIG1pbkNvdmVyYWdlKSAtIHJlYWRDb3VudDtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDmib7lh7rmnKror7vnmoTlnZfvvIzlkIjlubbmiJDojIPlm7Tkvr/kuo4gQUkg55CG6KejXG4gICAgICAgICAgY29uc3QgYWxsQ2h1bmtzID0gbmV3IFNldChBcnJheS5mcm9tKHsgbGVuZ3RoOiB0b3RhbENodW5rcyB9LCAoXywgaSkgPT4gaSArIDEpKTtcbiAgICAgICAgICBjb25zdCB1bnJlYWRDaHVua3MgPSBBcnJheS5mcm9tKGFsbENodW5rcykuZmlsdGVyKGkgPT4gIXRoaXMucmVhZENodW5rc1NldC5oYXMoaSkpLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDlkIjlubbov57nu63ojIPlm7RcbiAgICAgICAgICBjb25zdCByYW5nZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgbGV0IHN0YXJ0ID0gdW5yZWFkQ2h1bmtzWzBdO1xuICAgICAgICAgIGxldCBlbmQgPSB1bnJlYWRDaHVua3NbMF07XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB1bnJlYWRDaHVua3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh1bnJlYWRDaHVua3NbaV0gPT09IGVuZCArIDEpIHtcbiAgICAgICAgICAgICAgZW5kID0gdW5yZWFkQ2h1bmtzW2ldO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmFuZ2VzLnB1c2goc3RhcnQgPT09IGVuZCA/IGAke3N0YXJ0fWAgOiBgJHtzdGFydH0tJHtlbmR9YCk7XG4gICAgICAgICAgICAgIHN0YXJ0ID0gdW5yZWFkQ2h1bmtzW2ldO1xuICAgICAgICAgICAgICBlbmQgPSB1bnJlYWRDaHVua3NbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJhbmdlcy5wdXNoKHN0YXJ0ID09PSBlbmQgPyBgJHtzdGFydH1gIDogYCR7c3RhcnR9LSR7ZW5kfWApO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIOWPquaYvuekuuWJjeWHoOS4quiMg+WbtO+8jOmBv+WFjea2iOaBr+i/h+mVv1xuICAgICAgICAgIGNvbnN0IGRpc3BsYXlSYW5nZXMgPSByYW5nZXMuc2xpY2UoMCwgNSk7XG4gICAgICAgICAgY29uc3QgcmFuZ2VIaW50ID0gZGlzcGxheVJhbmdlcy5qb2luKCcsICcpICsgKHJhbmdlcy5sZW5ndGggPiA1ID8gYCDnrYnlhbEgJHtyYW5nZXMubGVuZ3RofSDkuKrljLrpl7RgIDogJycpO1xuICAgICAgICAgIFxuICAgICAgICAgIGNvbnNvbGUubG9nKGAgIOKdjCDmi5Lnu53vvJropobnm5bnjofkuI3otrMgJHttaW5Db3ZlcmFnZVBlcmNlbnR9Je+8jOi/mOmcgOmYheivu+e6piAke3JlbWFpbmluZ30g5Z2XYCk7XG4gICAgICAgICAgY29uc29sZS5sb2coYCAg8J+TjSDmnKror7vojIPlm7Q6ICR7cmFuZ2VIaW50fWApO1xuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiBg6ZSZ6K+v77ya6KaG55uW546H5LiN6LazICR7bWluQ292ZXJhZ2VQZXJjZW50fSXvvIjlvZPliY0gJHtjb3ZlcmFnZX0l77yJ44CC5pyq6K+75Z2XOiAke3JhbmdlSGludH3jgILor7fkvb/nlKggc3Bhd25fcmVhZGVyIOmYheivu+i/meS6m+acquivu+Wdl++8jOeEtuWQjuWGjeiwg+eUqCBkb25l44CCYDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYCAg4pyTIOS7u+WKoeWujOaIkGApO1xuICAgICAgICByZXR1cm4gJ+S7u+WKoeW3suWujOaIkOOAguivt+S4jeimgeWGjeiwg+eUqOS7u+S9leW3peWFt+OAgic7XG4gICAgICB9KSxcbiAgICBdO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIOS9v+eUqOmFjee9ruWlvSBiYXNlVVJMIOeahCBMTE0g5a6e5L6LXG4gICAgICBjb25zdCBsbG0gPSB0aGlzLmNyZWF0ZUxMTSh0aGlzLmNvbmZpZy5tb2RlbCk7XG4gICAgICBcbiAgICAgIC8vIOWIm+W7uiBhZ2VudO+8jOWQr+eUqCBjaGVja3BvaW50ZXIg5pe25Lyg5YWlXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgY29uc3QgYWdlbnRDb25maWc6IGFueSA9IHtcbiAgICAgICAgbW9kZWw6IGxsbSxcbiAgICAgICAgc3lzdGVtUHJvbXB0LFxuICAgICAgICB0b29scyxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVDaGVja3BvaW50KSB7XG4gICAgICAgIGFnZW50Q29uZmlnLmNoZWNrcG9pbnRlciA9IGF3YWl0IGdldENoZWNrcG9pbnRlcigpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBhZ2VudDogYW55ID0gY3JlYXRlRGVlcEFnZW50KGFnZW50Q29uZmlnKTtcblxuICAgICAgLy8gNS4g5ZCv5Yqo6ZiF6K+777yIZGVlcGFnZW50cyDkvJroh6rliqjlpITnkIblt6XlhbfosIPnlKjvvIlcbiAgICAgIGNvbnN0IGluaXRNZXNzYWdlID0gYnVpbGRJbml0TWVzc2FnZShpbnB1dC50aXRsZSk7XG4gICAgICBcbiAgICAgIC8vIOWQr+eUqCBjaGVja3BvaW50ZXIg5pe25Lyg5YWlIHRocmVhZF9pZFxuICAgICAgY29uc3QgaW52b2tlQ29uZmlnOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHsgXG4gICAgICAgIHJlY3Vyc2lvbkxpbWl0OiB0aGlzLmNvbmZpZy5yZWN1cnNpb25MaW1pdCBcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVDaGVja3BvaW50KSB7XG4gICAgICAgIGludm9rZUNvbmZpZy5jb25maWd1cmFibGUgPSB7IHRocmVhZF9pZDogdGhyZWFkSWQgfTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgYXdhaXQgYWdlbnQuaW52b2tlKFxuICAgICAgICB7IG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IGluaXRNZXNzYWdlIH1dIH0sXG4gICAgICAgIGludm9rZUNvbmZpZ1xuICAgICAgKTtcblxuICAgICAgY29uc3QgZHVyYXRpb24gPSAoKERhdGUubm93KCkgLSBzdGFydFRpbWUpIC8gMTAwMCkudG9GaXhlZCgxKTtcbiAgICAgIGNvbnNvbGUubG9nKCcnKTtcbiAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09IFJMTSDpmIXor7vlrozmiJAgPT09PT09PT09PScpO1xuICAgICAgY29uc29sZS5sb2coYOe7n+iuoTogJHt0aGlzLnRvb2xDYWxsQ291bnR9IOasoeW3peWFt+iwg+eUqCwg6ICX5pe2ICR7ZHVyYXRpb259IOenkiwg6L6T5Ye6ICR7KHRoaXMub3V0cHV0IHx8ICcnKS5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0g5a2XYCk7XG4gICAgICBjb25zb2xlLmxvZygnJyk7XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IHRoaXMub3V0cHV0IHx8IFJMTV9NRVNTQUdFUy5OT19PVVRQVVQsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdG90YWxDaHVua3M6IHRoaXMuY2h1bmtzLmxlbmd0aCxcbiAgICAgICAgICB0YXNrOiB0aGlzLmNvbmZpZy50YXNrLnB1cnBvc2UsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9ICgoRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSkgLyAxMDAwKS50b0ZpeGVkKDEpO1xuICAgICAgXG4gICAgICAvLyDmiZPljbDlrozmlbTloIbmoIjku6Xkvr/osIPor5VcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLnN0YWNrKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WujOaVtOmUmeivr+WghuagiDonLCBlcnJvci5zdGFjayk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOWmguaenOaYr+mAkuW9kumZkOWItumUmeivr++8jOi/lOWbnuW9k+WJjeW3suacieeahOi+k+WHulxuICAgICAgaWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcygnR1JBUEhfUkVDVVJTSU9OX0xJTUlUJykgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCdSZWN1cnNpb24gbGltaXQnKSkge1xuICAgICAgICBjb25zb2xlLmxvZygnJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09IFJMTSDovr7liLDpgJLlvZLpmZDliLYgPT09PT09PT09PScpO1xuICAgICAgICBjb25zb2xlLmxvZyhg57uf6K6hOiAke3RoaXMudG9vbENhbGxDb3VudH0g5qyh5bel5YW36LCD55SoLCDogJfml7YgJHtkdXJhdGlvbn0g56eSLCDlvZPliY3ovpPlh7ogJHsodGhpcy5vdXRwdXQgfHwgJycpLmxlbmd0aC50b0xvY2FsZVN0cmluZygpfSDlrZdgKTtcbiAgICAgICAgY29uc29sZS5sb2coJ+aPkOekujog5bey6L6+5Yiw5pyA5aSn5b6q546v5qyh5pWw77yM6L+U5Zue5b2T5YmN57uT5p6cJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCcnKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29udGVudDogdGhpcy5vdXRwdXQgfHwgUkxNX01FU1NBR0VTLk5PX09VVFBVVCxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgdG90YWxDaHVua3M6IHRoaXMuY2h1bmtzLmxlbmd0aCxcbiAgICAgICAgICAgIHRhc2s6IHRoaXMuY29uZmlnLnRhc2sucHVycG9zZSxcbiAgICAgICAgICAgIHdhcm5pbmc6ICfovr7liLDpgJLlvZLpmZDliLbvvIznu5Pmnpzlj6/og73kuI3lrozmlbQnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCcnKTtcbiAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09IFJMTSDpmIXor7vlh7rplJkgPT09PT09PT09PScpO1xuICAgICAgY29uc29sZS5sb2coYOmUmeivrzogJHtlcnJvck1lc3NhZ2V9YCk7XG4gICAgICBjb25zb2xlLmxvZyhg6ICX5pe2OiAke2R1cmF0aW9ufSDnp5JgKTtcbiAgICAgIGNvbnNvbGUubG9nKCcnKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29udGVudDogUkxNX01FU1NBR0VTLlBST0NFU1NfRVJST1IoZXJyb3JNZXNzYWdlKSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT0g5L6/5o236Z2Z5oCB5pa55rOVID09PT09PT09PT09PT09PT09PT09XG5cbiAgLyoqXG4gICAqIOeUn+aIkOWtpuS5oOeslOiusFxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHN0dWR5Tm90ZXMoaW5wdXQ6IERvY3VtZW50SW5wdXQsIGNvbmZpZz86IFBhcnRpYWw8UkxNUmVhZGVyQ29uZmlnPik6IFByb21pc2U8UkxNT3V0cHV0PiB7XG4gICAgY29uc3QgcmVhZGVyID0gbmV3IFJMTVJlYWRlcih7IC4uLmNvbmZpZywgdGFzazogVEFTS19TVFVEWV9OT1RFUyB9KTtcbiAgICByZXR1cm4gcmVhZGVyLnJlYWQoaW5wdXQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOeUn+aIkOaRmOimgVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHN1bW1hcnkoaW5wdXQ6IERvY3VtZW50SW5wdXQsIGNvbmZpZz86IFBhcnRpYWw8UkxNUmVhZGVyQ29uZmlnPik6IFByb21pc2U8UkxNT3V0cHV0PiB7XG4gICAgY29uc3QgcmVhZGVyID0gbmV3IFJMTVJlYWRlcih7IC4uLmNvbmZpZywgdGFzazogVEFTS19TVU1NQVJZIH0pO1xuICAgIHJldHVybiByZWFkZXIucmVhZChpbnB1dCk7XG4gIH1cblxuICAvKipcbiAgICog5o+Q5Y+W5pWZ5a2m55+l6K+G54K5XG4gICAqL1xuICBzdGF0aWMgYXN5bmMgdGVhY2hpbmdQb2ludHMoaW5wdXQ6IERvY3VtZW50SW5wdXQsIGNvbmZpZz86IFBhcnRpYWw8UkxNUmVhZGVyQ29uZmlnPik6IFByb21pc2U8UkxNT3V0cHV0PiB7XG4gICAgY29uc3QgcmVhZGVyID0gbmV3IFJMTVJlYWRlcih7IC4uLmNvbmZpZywgdGFzazogVEFTS19URUFDSElOR19QT0lOVFMgfSk7XG4gICAgcmV0dXJuIHJlYWRlci5yZWFkKGlucHV0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorrrmlofliIbmnpBcbiAgICovXG4gIHN0YXRpYyBhc3luYyBwYXBlckFuYWx5c2lzKGlucHV0OiBEb2N1bWVudElucHV0LCBjb25maWc/OiBQYXJ0aWFsPFJMTVJlYWRlckNvbmZpZz4pOiBQcm9taXNlPFJMTU91dHB1dD4ge1xuICAgIGNvbnN0IHJlYWRlciA9IG5ldyBSTE1SZWFkZXIoeyAuLi5jb25maWcsIHRhc2s6IFRBU0tfUEFQRVJfQU5BTFlTSVMgfSk7XG4gICAgcmV0dXJuIHJlYWRlci5yZWFkKGlucHV0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDoh6rlrprkuYnku7vliqFcbiAgICovXG4gIHN0YXRpYyBhc3luYyB3aXRoVGFzayhcbiAgICBpbnB1dDogRG9jdW1lbnRJbnB1dCxcbiAgICB0YXNrOiBSTE1UYXNrQ29uZmlnLFxuICAgIGNvbmZpZz86IFBhcnRpYWw8UkxNUmVhZGVyQ29uZmlnPlxuICApOiBQcm9taXNlPFJMTU91dHB1dD4ge1xuICAgIGNvbnN0IHJlYWRlciA9IG5ldyBSTE1SZWFkZXIoeyAuLi5jb25maWcsIHRhc2sgfSk7XG4gICAgcmV0dXJuIHJlYWRlci5yZWFkKGlucHV0KTtcbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PSDlr7zlh7ogPT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IHtcbiAgVEFTS19TVFVEWV9OT1RFUyxcbiAgVEFTS19TVU1NQVJZLFxuICBUQVNLX1RFQUNISU5HX1BPSU5UUyxcbiAgVEFTS19QQVBFUl9BTkFMWVNJUyxcbn0gZnJvbSAnLi9wcm9tcHRzL3JsbSc7XG4iXSwibmFtZXMiOlsiY3JlYXRlSGFzaCIsInBhdGgiLCJzcGxpdEludG9QYXJhZ3JhcGhzIiwiY3JlYXRlRGVlcEFnZW50IiwiQ2hhdE9wZW5BSSIsIlNxbGl0ZVNhdmVyIiwiYnVpbGRSTE1Qcm9tcHQiLCJidWlsZEluaXRNZXNzYWdlIiwiYnVpbGRTdWJSZWFkZXJQcm9tcHQiLCJmb3JtYXRDaHVua0NvbnRlbnQiLCJSTE1fTUVTU0FHRVMiLCJUQVNLX1NUVURZX05PVEVTIiwiVEFTS19TVU1NQVJZIiwiVEFTS19URUFDSElOR19QT0lOVFMiLCJUQVNLX1BBUEVSX0FOQUxZU0lTIiwiY3JlYXRlR2V0RG9jdW1lbnRTdGF0c1Rvb2wiLCJjcmVhdGVHZXRDaHVua0xpc3RUb29sIiwiY3JlYXRlU2VhcmNoRG9jdW1lbnRUb29sIiwiY3JlYXRlUmVhZENodW5rVG9vbCIsImNyZWF0ZVNwYXduUmVhZGVyVG9vbCIsImNyZWF0ZVVwZGF0ZU91dHB1dFRvb2wiLCJjcmVhdGVHZXRPdXRwdXRUb29sIiwiY3JlYXRlRG9uZVRvb2wiLCJDSEVDS1BPSU5UX0RCX1BBVEgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImdsb2JhbENoZWNrcG9pbnRlciIsImNoZWNrcG9pbnRlckluaXRQcm9taXNlIiwiZ2V0Q2hlY2twb2ludGVyIiwic2F2ZXIiLCJmcm9tQ29ublN0cmluZyIsImluc3RhbmNlIiwiUHJvbWlzZSIsInNldHVwIiwiY29uc29sZSIsImxvZyIsIkRFRkFVTFRfQ09ORklHIiwidGFzayIsImNodW5rU2l6ZSIsIm1vZGVsIiwiZW52IiwiT1BFTkFJX01PREVMIiwibW9kZWxQcm92aWRlciIsIk9QRU5BSV9NT0RFTF9QUk9WSURFUiIsInN1YkFnZW50TW9kZWwiLCJzdWJBZ2VudE1vZGVsUHJvdmlkZXIiLCJiYXNlVVJMIiwiT1BFTkFJX0FQSV9CQVNFIiwicmVjdXJzaW9uTGltaXQiLCJlbmFibGVDaGVja3BvaW50IiwiUkxNUmVhZGVyIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJjaHVua3MiLCJvdXRwdXQiLCJ0b29sQ2FsbENvdW50IiwicmVhZENodW5rc1NldCIsIlNldCIsImRvY3VtZW50SWQiLCJnZW5lcmF0ZURvY3VtZW50SWQiLCJjb250ZW50IiwiaGFzaCIsInVwZGF0ZSIsInN1YnN0cmluZyIsInB1cnBvc2UiLCJkaWdlc3QiLCJnZXRUaHJlYWRJZCIsInRyeVJlc3RvcmVGcm9tQ2hlY2twb2ludCIsInRocmVhZElkIiwiY2hlY2twb2ludGVyIiwiaGFzQ2hlY2twb2ludCIsIl9jcCIsImxpc3QiLCJjb25maWd1cmFibGUiLCJ0aHJlYWRfaWQiLCJlIiwiRXJyb3IiLCJtZXNzYWdlIiwiY3JlYXRlTExNIiwib3BlbkFJQXBpS2V5IiwiT1BFTkFJX0FQSV9LRVkiLCJjb25maWd1cmF0aW9uIiwidGVtcGVyYXR1cmUiLCJwcmVwYXJlQ2h1bmtzIiwicGFyYWdyYXBocyIsImNoYXJQb3MiLCJtYXAiLCJwIiwiaSIsImNodW5rIiwiaW5kZXgiLCJjaGFyU3RhcnQiLCJjaGFyRW5kIiwibGVuZ3RoIiwiZGF0YSIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJwcmVmaXgiLCJPYmplY3QiLCJlbnRyaWVzIiwiZm9yRWFjaCIsImtleSIsInZhbHVlIiwiSlNPTiIsInN0cmluZ2lmeSIsImxvZ1Rvb2xDYWxsIiwidG9vbE5hbWUiLCJkZXNjcmlwdGlvbiIsInBhcmFtcyIsImRpc3BsYXlWYWx1ZSIsImxvZ1Rvb2xSZXN1bHQiLCJyZXN1bHQiLCJnZXREb2N1bWVudFN0YXRzIiwidG90YWxDaGFycyIsInJlZHVjZSIsInN1bSIsImMiLCJzdGF0cyIsInRvdGFsQ2h1bmtzIiwiYXZnQ2h1bmtTaXplIiwiTWF0aCIsInJvdW5kIiwidG9Mb2NhbGVTdHJpbmciLCJnZXRDaHVua0xpc3QiLCJ0b3RhbCIsInByZXZpZXdDb3VudCIsIm1pbiIsInByZXZpZXdzIiwic2xpY2UiLCJzZWFyY2hEb2N1bWVudCIsImtleXdvcmQiLCLlhbPplK7or40iLCJyZXN1bHRzIiwiZmlsdGVyIiwiaW5jbHVkZXMiLCJyZWFkQ2h1bmsiLCJmaW5kIiwiQ0hVTktfTk9UX0ZPVU5EIiwiYWRkIiwic3Bhd25SZWFkZXIiLCJpbmRleGVzIiwicXVlc3Rpb24iLCLpmIXor7vojIPlm7QiLCLpl67popgiLCJsbG0iLCJzdWJBZ2VudCIsImludm9rZSIsIm1lc3NhZ2VzIiwicm9sZSIsImxhc3RNZXNzYWdlIiwiYW5zd2VyIiwiZXJyb3IiLCJSRUFERVJfRVJST1IiLCJ1cGRhdGVPdXRwdXQiLCJPVVRQVVRfVVBEQVRFRCIsImdldE91dHB1dCIsIk9VVFBVVF9FTVBUWSIsInJlYWQiLCJpbnB1dCIsInN0YXJ0VGltZSIsIm5vdyIsImNsZWFyIiwidGl0bGUiLCJFTVBUWV9ET0NVTUVOVCIsImhhc0hpc3RvcnkiLCJzeXN0ZW1Qcm9tcHQiLCJ0b29scyIsInJlYWRDb3VudCIsInNpemUiLCJjb3ZlcmFnZSIsInRvRml4ZWQiLCJtaW5Db3ZlcmFnZSIsIm1pbkNvdmVyYWdlUGVyY2VudCIsInJlbWFpbmluZyIsImNlaWwiLCJhbGxDaHVua3MiLCJBcnJheSIsImZyb20iLCJfIiwidW5yZWFkQ2h1bmtzIiwiaGFzIiwic29ydCIsImEiLCJiIiwicmFuZ2VzIiwic3RhcnQiLCJlbmQiLCJwdXNoIiwiZGlzcGxheVJhbmdlcyIsInJhbmdlSGludCIsImFnZW50Q29uZmlnIiwiYWdlbnQiLCJpbml0TWVzc2FnZSIsImludm9rZUNvbmZpZyIsImR1cmF0aW9uIiwiTk9fT1VUUFVUIiwibWV0YWRhdGEiLCJlcnJvck1lc3NhZ2UiLCJTdHJpbmciLCJzdGFjayIsIndhcm5pbmciLCJQUk9DRVNTX0VSUk9SIiwic3R1ZHlOb3RlcyIsInJlYWRlciIsInN1bW1hcnkiLCJ0ZWFjaGluZ1BvaW50cyIsInBhcGVyQW5hbHlzaXMiLCJ3aXRoVGFzayJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/rlm-reader.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/text-splitter.ts":
/*!**********************************!*\
  !*** ./src/lib/text-splitter.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   splitIntoParagraphs: () => (/* binding */ splitIntoParagraphs)\n/* harmony export */ });\n/**\n * 文本切分工具\n */ const MAX_PARAGRAPH_CHARS = 2000;\nfunction splitLongText(text, maxChars) {\n    const chunks = [];\n    let remaining = text;\n    while(remaining.length > maxChars){\n        let splitIndex = remaining.lastIndexOf(\"。\", maxChars);\n        if (splitIndex === -1 || splitIndex < maxChars * 0.5) {\n            splitIndex = remaining.lastIndexOf(\".\", maxChars);\n        }\n        if (splitIndex === -1 || splitIndex < maxChars * 0.5) {\n            splitIndex = maxChars;\n        } else {\n            splitIndex += 1;\n        }\n        chunks.push(remaining.substring(0, splitIndex).trim());\n        remaining = remaining.substring(splitIndex).trim();\n    }\n    if (remaining) {\n        chunks.push(remaining);\n    }\n    return chunks;\n}\n/**\n * 按段落边界切分文本\n */ function splitIntoParagraphs(content, maxChars = MAX_PARAGRAPH_CHARS) {\n    const rawParagraphs = content.split(/\\n\\s*\\n/).filter((p)=>p.trim().length > 0);\n    const paragraphs = [];\n    let currentParagraph = \"\";\n    for (const raw of rawParagraphs){\n        const trimmed = raw.trim();\n        if (currentParagraph.length + trimmed.length + 2 <= maxChars) {\n            currentParagraph = currentParagraph ? currentParagraph + \"\\n\\n\" + trimmed : trimmed;\n        } else {\n            if (currentParagraph) {\n                paragraphs.push(currentParagraph);\n            }\n            if (trimmed.length > maxChars) {\n                const chunks = splitLongText(trimmed, maxChars);\n                paragraphs.push(...chunks);\n                currentParagraph = \"\";\n            } else {\n                currentParagraph = trimmed;\n            }\n        }\n    }\n    if (currentParagraph) {\n        paragraphs.push(currentParagraph);\n    }\n    return paragraphs;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3RleHQtc3BsaXR0ZXIudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBOztDQUVDLEdBRUQsTUFBTUEsc0JBQXNCO0FBRTVCLFNBQVNDLGNBQWNDLElBQVksRUFBRUMsUUFBZ0I7SUFDbkQsTUFBTUMsU0FBbUIsRUFBRTtJQUMzQixJQUFJQyxZQUFZSDtJQUVoQixNQUFPRyxVQUFVQyxNQUFNLEdBQUdILFNBQVU7UUFDbEMsSUFBSUksYUFBYUYsVUFBVUcsV0FBVyxDQUFDLEtBQUtMO1FBQzVDLElBQUlJLGVBQWUsQ0FBQyxLQUFLQSxhQUFhSixXQUFXLEtBQUs7WUFDcERJLGFBQWFGLFVBQVVHLFdBQVcsQ0FBQyxLQUFLTDtRQUMxQztRQUNBLElBQUlJLGVBQWUsQ0FBQyxLQUFLQSxhQUFhSixXQUFXLEtBQUs7WUFDcERJLGFBQWFKO1FBQ2YsT0FBTztZQUNMSSxjQUFjO1FBQ2hCO1FBRUFILE9BQU9LLElBQUksQ0FBQ0osVUFBVUssU0FBUyxDQUFDLEdBQUdILFlBQVlJLElBQUk7UUFDbkROLFlBQVlBLFVBQVVLLFNBQVMsQ0FBQ0gsWUFBWUksSUFBSTtJQUNsRDtJQUVBLElBQUlOLFdBQVc7UUFDYkQsT0FBT0ssSUFBSSxDQUFDSjtJQUNkO0lBRUEsT0FBT0Q7QUFDVDtBQUVBOztDQUVDLEdBQ00sU0FBU1Esb0JBQW9CQyxPQUFlLEVBQUVWLFdBQW1CSCxtQkFBbUI7SUFDekYsTUFBTWMsZ0JBQWdCRCxRQUFRRSxLQUFLLENBQUMsV0FBV0MsTUFBTSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFTixJQUFJLEdBQUdMLE1BQU0sR0FBRztJQUU3RSxNQUFNWSxhQUF1QixFQUFFO0lBQy9CLElBQUlDLG1CQUFtQjtJQUV2QixLQUFLLE1BQU1DLE9BQU9OLGNBQWU7UUFDL0IsTUFBTU8sVUFBVUQsSUFBSVQsSUFBSTtRQUV4QixJQUFJUSxpQkFBaUJiLE1BQU0sR0FBR2UsUUFBUWYsTUFBTSxHQUFHLEtBQUtILFVBQVU7WUFDNURnQixtQkFBbUJBLG1CQUNmQSxtQkFBbUIsU0FBU0UsVUFDNUJBO1FBQ04sT0FBTztZQUNMLElBQUlGLGtCQUFrQjtnQkFDcEJELFdBQVdULElBQUksQ0FBQ1U7WUFDbEI7WUFFQSxJQUFJRSxRQUFRZixNQUFNLEdBQUdILFVBQVU7Z0JBQzdCLE1BQU1DLFNBQVNILGNBQWNvQixTQUFTbEI7Z0JBQ3RDZSxXQUFXVCxJQUFJLElBQUlMO2dCQUNuQmUsbUJBQW1CO1lBQ3JCLE9BQU87Z0JBQ0xBLG1CQUFtQkU7WUFDckI7UUFDRjtJQUNGO0lBRUEsSUFBSUYsa0JBQWtCO1FBQ3BCRCxXQUFXVCxJQUFJLENBQUNVO0lBQ2xCO0lBRUEsT0FBT0Q7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL3NyYy9saWIvdGV4dC1zcGxpdHRlci50cz8wNmFiIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5paH5pys5YiH5YiG5bel5YW3XG4gKi9cblxuY29uc3QgTUFYX1BBUkFHUkFQSF9DSEFSUyA9IDIwMDA7XG5cbmZ1bmN0aW9uIHNwbGl0TG9uZ1RleHQodGV4dDogc3RyaW5nLCBtYXhDaGFyczogbnVtYmVyKTogc3RyaW5nW10ge1xuICBjb25zdCBjaHVua3M6IHN0cmluZ1tdID0gW107XG4gIGxldCByZW1haW5pbmcgPSB0ZXh0O1xuICBcbiAgd2hpbGUgKHJlbWFpbmluZy5sZW5ndGggPiBtYXhDaGFycykge1xuICAgIGxldCBzcGxpdEluZGV4ID0gcmVtYWluaW5nLmxhc3RJbmRleE9mKCfjgIInLCBtYXhDaGFycyk7XG4gICAgaWYgKHNwbGl0SW5kZXggPT09IC0xIHx8IHNwbGl0SW5kZXggPCBtYXhDaGFycyAqIDAuNSkge1xuICAgICAgc3BsaXRJbmRleCA9IHJlbWFpbmluZy5sYXN0SW5kZXhPZignLicsIG1heENoYXJzKTtcbiAgICB9XG4gICAgaWYgKHNwbGl0SW5kZXggPT09IC0xIHx8IHNwbGl0SW5kZXggPCBtYXhDaGFycyAqIDAuNSkge1xuICAgICAgc3BsaXRJbmRleCA9IG1heENoYXJzO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcGxpdEluZGV4ICs9IDE7XG4gICAgfVxuICAgIFxuICAgIGNodW5rcy5wdXNoKHJlbWFpbmluZy5zdWJzdHJpbmcoMCwgc3BsaXRJbmRleCkudHJpbSgpKTtcbiAgICByZW1haW5pbmcgPSByZW1haW5pbmcuc3Vic3RyaW5nKHNwbGl0SW5kZXgpLnRyaW0oKTtcbiAgfVxuICBcbiAgaWYgKHJlbWFpbmluZykge1xuICAgIGNodW5rcy5wdXNoKHJlbWFpbmluZyk7XG4gIH1cbiAgXG4gIHJldHVybiBjaHVua3M7XG59XG5cbi8qKlxuICog5oyJ5q616JC96L6555WM5YiH5YiG5paH5pysXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzcGxpdEludG9QYXJhZ3JhcGhzKGNvbnRlbnQ6IHN0cmluZywgbWF4Q2hhcnM6IG51bWJlciA9IE1BWF9QQVJBR1JBUEhfQ0hBUlMpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHJhd1BhcmFncmFwaHMgPSBjb250ZW50LnNwbGl0KC9cXG5cXHMqXFxuLykuZmlsdGVyKHAgPT4gcC50cmltKCkubGVuZ3RoID4gMCk7XG4gIFxuICBjb25zdCBwYXJhZ3JhcGhzOiBzdHJpbmdbXSA9IFtdO1xuICBsZXQgY3VycmVudFBhcmFncmFwaCA9ICcnO1xuICBcbiAgZm9yIChjb25zdCByYXcgb2YgcmF3UGFyYWdyYXBocykge1xuICAgIGNvbnN0IHRyaW1tZWQgPSByYXcudHJpbSgpO1xuICAgIFxuICAgIGlmIChjdXJyZW50UGFyYWdyYXBoLmxlbmd0aCArIHRyaW1tZWQubGVuZ3RoICsgMiA8PSBtYXhDaGFycykge1xuICAgICAgY3VycmVudFBhcmFncmFwaCA9IGN1cnJlbnRQYXJhZ3JhcGggXG4gICAgICAgID8gY3VycmVudFBhcmFncmFwaCArICdcXG5cXG4nICsgdHJpbW1lZCBcbiAgICAgICAgOiB0cmltbWVkO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoY3VycmVudFBhcmFncmFwaCkge1xuICAgICAgICBwYXJhZ3JhcGhzLnB1c2goY3VycmVudFBhcmFncmFwaCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmICh0cmltbWVkLmxlbmd0aCA+IG1heENoYXJzKSB7XG4gICAgICAgIGNvbnN0IGNodW5rcyA9IHNwbGl0TG9uZ1RleHQodHJpbW1lZCwgbWF4Q2hhcnMpO1xuICAgICAgICBwYXJhZ3JhcGhzLnB1c2goLi4uY2h1bmtzKTtcbiAgICAgICAgY3VycmVudFBhcmFncmFwaCA9ICcnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudFBhcmFncmFwaCA9IHRyaW1tZWQ7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICBpZiAoY3VycmVudFBhcmFncmFwaCkge1xuICAgIHBhcmFncmFwaHMucHVzaChjdXJyZW50UGFyYWdyYXBoKTtcbiAgfVxuICBcbiAgcmV0dXJuIHBhcmFncmFwaHM7XG59XG4iXSwibmFtZXMiOlsiTUFYX1BBUkFHUkFQSF9DSEFSUyIsInNwbGl0TG9uZ1RleHQiLCJ0ZXh0IiwibWF4Q2hhcnMiLCJjaHVua3MiLCJyZW1haW5pbmciLCJsZW5ndGgiLCJzcGxpdEluZGV4IiwibGFzdEluZGV4T2YiLCJwdXNoIiwic3Vic3RyaW5nIiwidHJpbSIsInNwbGl0SW50b1BhcmFncmFwaHMiLCJjb250ZW50IiwicmF3UGFyYWdyYXBocyIsInNwbGl0IiwiZmlsdGVyIiwicCIsInBhcmFncmFwaHMiLCJjdXJyZW50UGFyYWdyYXBoIiwicmF3IiwidHJpbW1lZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/text-splitter.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/deep-reader/append-output.ts":
/*!****************************************************!*\
  !*** ./src/lib/tools/deep-reader/append-output.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAppendOutputTool: () => (/* binding */ createAppendOutputTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * DeepReader 工具：追加输出\n */ \n\n/**\n * 创建追加输出工具\n * @param handler 处理函数，追加内容到输出\n */ function createAppendOutputTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(async (input)=>{\n        const totalChars = handler(input.content);\n        return `已追加 ${input.content.length} 字，当前总输出 ${totalChars} 字`;\n    }, {\n        name: \"append_output\",\n        description: \"将生成的评书内容追加到输出文件\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({\n            content: zod__WEBPACK_IMPORTED_MODULE_1__.string().describe(\"要追加的评书内容\")\n        })\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL2RlZXAtcmVhZGVyL2FwcGVuZC1vdXRwdXQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7O0NBRUMsR0FFZ0M7QUFDVDtBQUV4Qjs7O0NBR0MsR0FDTSxTQUFTRSx1QkFDZEMsT0FBb0M7SUFFcEMsT0FBT0gsK0NBQUlBLENBQ1QsT0FBT0k7UUFDTCxNQUFNQyxhQUFhRixRQUFRQyxNQUFNRSxPQUFPO1FBQ3hDLE9BQU8sQ0FBQyxJQUFJLEVBQUVGLE1BQU1FLE9BQU8sQ0FBQ0MsTUFBTSxDQUFDLFNBQVMsRUFBRUYsV0FBVyxFQUFFLENBQUM7SUFDOUQsR0FDQTtRQUNFRyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsUUFBUVQsdUNBQVEsQ0FBQztZQUNmSyxTQUFTTCx1Q0FBUSxHQUFHWSxRQUFRLENBQUM7UUFDL0I7SUFDRjtBQUVKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vc3JjL2xpYi90b29scy9kZWVwLXJlYWRlci9hcHBlbmQtb3V0cHV0LnRzPzFhOTkiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZWVwUmVhZGVyIOW3peWFt++8mui/veWKoOi+k+WHulxuICovXG5cbmltcG9ydCB7IHRvb2wgfSBmcm9tICdsYW5nY2hhaW4nO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbi8qKlxuICog5Yib5bu66L+95Yqg6L6T5Ye65bel5YW3XG4gKiBAcGFyYW0gaGFuZGxlciDlpITnkIblh73mlbDvvIzov73liqDlhoXlrrnliLDovpPlh7pcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFwcGVuZE91dHB1dFRvb2woXG4gIGhhbmRsZXI6IChjb250ZW50OiBzdHJpbmcpID0+IG51bWJlclxuKSB7XG4gIHJldHVybiB0b29sKFxuICAgIGFzeW5jIChpbnB1dCkgPT4ge1xuICAgICAgY29uc3QgdG90YWxDaGFycyA9IGhhbmRsZXIoaW5wdXQuY29udGVudCk7XG4gICAgICByZXR1cm4gYOW3sui/veWKoCAke2lucHV0LmNvbnRlbnQubGVuZ3RofSDlrZfvvIzlvZPliY3mgLvovpPlh7ogJHt0b3RhbENoYXJzfSDlrZdgO1xuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ2FwcGVuZF9vdXRwdXQnLFxuICAgICAgZGVzY3JpcHRpb246ICflsIbnlJ/miJDnmoTor4TkuablhoXlrrnov73liqDliLDovpPlh7rmlofku7YnLFxuICAgICAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgICAgIGNvbnRlbnQ6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ+imgei/veWKoOeahOivhOS5puWGheWuuScpLFxuICAgICAgfSksXG4gICAgfVxuICApO1xufVxuIl0sIm5hbWVzIjpbInRvb2wiLCJ6IiwiY3JlYXRlQXBwZW5kT3V0cHV0VG9vbCIsImhhbmRsZXIiLCJpbnB1dCIsInRvdGFsQ2hhcnMiLCJjb250ZW50IiwibGVuZ3RoIiwibmFtZSIsImRlc2NyaXB0aW9uIiwic2NoZW1hIiwib2JqZWN0Iiwic3RyaW5nIiwiZGVzY3JpYmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/deep-reader/append-output.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/deep-reader/chapter-info.ts":
/*!***************************************************!*\
  !*** ./src/lib/tools/deep-reader/chapter-info.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGetChapterInfoTool: () => (/* binding */ createGetChapterInfoTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * DeepReader 工具：获取章节信息\n */ \n\n/**\n * 创建获取章节信息工具\n * @param handler 处理函数，返回章节统计信息\n */ function createGetChapterInfoTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(async ()=>{\n        const info = handler();\n        return JSON.stringify(info, null, 2);\n    }, {\n        name: \"get_chapter_info\",\n        description: \"获取当前章节的统计信息，包括总字数、片段数量、每个片段的预览\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({})\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL2RlZXAtcmVhZGVyL2NoYXB0ZXItaW5mby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7Q0FFQyxHQUVnQztBQUNUO0FBY3hCOzs7Q0FHQyxHQUNNLFNBQVNFLHlCQUF5QkMsT0FBMEI7SUFDakUsT0FBT0gsK0NBQUlBLENBQ1Q7UUFDRSxNQUFNSSxPQUFPRDtRQUNiLE9BQU9FLEtBQUtDLFNBQVMsQ0FBQ0YsTUFBTSxNQUFNO0lBQ3BDLEdBQ0E7UUFDRUcsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLFFBQVFSLHVDQUFRLENBQUMsQ0FBQztJQUNwQjtBQUVKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vc3JjL2xpYi90b29scy9kZWVwLXJlYWRlci9jaGFwdGVyLWluZm8udHM/NGU5MiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERlZXBSZWFkZXIg5bel5YW377ya6I635Y+W56ug6IqC5L+h5oGvXG4gKi9cblxuaW1wb3J0IHsgdG9vbCB9IGZyb20gJ2xhbmdjaGFpbic7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuZXhwb3J0IGludGVyZmFjZSBDaGFwdGVySW5mbyB7XG4gIHRvdGFsQ2hhcnM6IG51bWJlcjtcbiAgc2VnbWVudENvdW50OiBudW1iZXI7XG4gIHNlZ21lbnRzOiBBcnJheTx7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBjaGFyU3RhcnQ6IG51bWJlcjtcbiAgICBjaGFyRW5kOiBudW1iZXI7XG4gICAgY2hhckNvdW50OiBudW1iZXI7XG4gICAgcHJldmlldzogc3RyaW5nO1xuICB9Pjtcbn1cblxuLyoqXG4gKiDliJvlu7rojrflj5bnq6DoioLkv6Hmga/lt6XlhbdcbiAqIEBwYXJhbSBoYW5kbGVyIOWkhOeQhuWHveaVsO+8jOi/lOWbnueroOiKgue7n+iuoeS/oeaBr1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlR2V0Q2hhcHRlckluZm9Ub29sKGhhbmRsZXI6ICgpID0+IENoYXB0ZXJJbmZvKSB7XG4gIHJldHVybiB0b29sKFxuICAgIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGluZm8gPSBoYW5kbGVyKCk7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoaW5mbywgbnVsbCwgMik7XG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnZ2V0X2NoYXB0ZXJfaW5mbycsXG4gICAgICBkZXNjcmlwdGlvbjogJ+iOt+WPluW9k+WJjeeroOiKgueahOe7n+iuoeS/oeaBr++8jOWMheaLrOaAu+Wtl+aVsOOAgeeJh+auteaVsOmHj+OAgeavj+S4queJh+auteeahOmihOiniCcsXG4gICAgICBzY2hlbWE6IHoub2JqZWN0KHt9KSxcbiAgICB9XG4gICk7XG59XG4iXSwibmFtZXMiOlsidG9vbCIsInoiLCJjcmVhdGVHZXRDaGFwdGVySW5mb1Rvb2wiLCJoYW5kbGVyIiwiaW5mbyIsIkpTT04iLCJzdHJpbmdpZnkiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJzY2hlbWEiLCJvYmplY3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/deep-reader/chapter-info.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/deep-reader/done.ts":
/*!*******************************************!*\
  !*** ./src/lib/tools/deep-reader/done.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDeepReaderDoneTool: () => (/* binding */ createDeepReaderDoneTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * DeepReader 工具：完成标记\n */ \n\n/**\n * 创建完成标记工具\n * @param handler 检查函数，验证是否可以完成\n */ function createDeepReaderDoneTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(async ()=>{\n        const result = handler();\n        if (result.canFinish) {\n            return `✓ 章节处理完成。已处理 ${result.processedSegments}/${result.totalSegments} 个片段，输出 ${result.outputChars} 字。`;\n        } else {\n            return `✗ 不能完成：${result.message}。已处理 ${result.processedSegments}/${result.totalSegments} 个片段。请继续使用 spawn_writer 处理剩余片段。`;\n        }\n    }, {\n        name: \"done\",\n        description: \"标记当前章节处理完成。只有处理完所有片段后才能调用。\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({})\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL2RlZXAtcmVhZGVyL2RvbmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7O0NBRUMsR0FFZ0M7QUFDVDtBQVV4Qjs7O0NBR0MsR0FDTSxTQUFTRSx5QkFDZEMsT0FBOEI7SUFFOUIsT0FBT0gsK0NBQUlBLENBQ1Q7UUFDRSxNQUFNSSxTQUFTRDtRQUNmLElBQUlDLE9BQU9DLFNBQVMsRUFBRTtZQUNwQixPQUFPLENBQUMsYUFBYSxFQUFFRCxPQUFPRSxpQkFBaUIsQ0FBQyxDQUFDLEVBQUVGLE9BQU9HLGFBQWEsQ0FBQyxRQUFRLEVBQUVILE9BQU9JLFdBQVcsQ0FBQyxHQUFHLENBQUM7UUFDM0csT0FBTztZQUNMLE9BQU8sQ0FBQyxPQUFPLEVBQUVKLE9BQU9LLE9BQU8sQ0FBQyxLQUFLLEVBQUVMLE9BQU9FLGlCQUFpQixDQUFDLENBQUMsRUFBRUYsT0FBT0csYUFBYSxDQUFDLCtCQUErQixDQUFDO1FBQzFIO0lBQ0YsR0FDQTtRQUNFRyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsUUFBUVgsdUNBQVEsQ0FBQyxDQUFDO0lBQ3BCO0FBRUoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9zcmMvbGliL3Rvb2xzL2RlZXAtcmVhZGVyL2RvbmUudHM/NzY0OCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERlZXBSZWFkZXIg5bel5YW377ya5a6M5oiQ5qCH6K6wXG4gKi9cblxuaW1wb3J0IHsgdG9vbCB9IGZyb20gJ2xhbmdjaGFpbic7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuZXhwb3J0IGludGVyZmFjZSBEb25lQ2hlY2tSZXN1bHQge1xuICBjYW5GaW5pc2g6IGJvb2xlYW47XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgcHJvY2Vzc2VkU2VnbWVudHM6IG51bWJlcjtcbiAgdG90YWxTZWdtZW50czogbnVtYmVyO1xuICBvdXRwdXRDaGFyczogbnVtYmVyO1xufVxuXG4vKipcbiAqIOWIm+W7uuWujOaIkOagh+iusOW3peWFt1xuICogQHBhcmFtIGhhbmRsZXIg5qOA5p+l5Ye95pWw77yM6aqM6K+B5piv5ZCm5Y+v5Lul5a6M5oiQXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEZWVwUmVhZGVyRG9uZVRvb2woXG4gIGhhbmRsZXI6ICgpID0+IERvbmVDaGVja1Jlc3VsdFxuKSB7XG4gIHJldHVybiB0b29sKFxuICAgIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGhhbmRsZXIoKTtcbiAgICAgIGlmIChyZXN1bHQuY2FuRmluaXNoKSB7XG4gICAgICAgIHJldHVybiBg4pyTIOeroOiKguWkhOeQhuWujOaIkOOAguW3suWkhOeQhiAke3Jlc3VsdC5wcm9jZXNzZWRTZWdtZW50c30vJHtyZXN1bHQudG90YWxTZWdtZW50c30g5Liq54mH5q6177yM6L6T5Ye6ICR7cmVzdWx0Lm91dHB1dENoYXJzfSDlrZfjgIJgO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGDinJcg5LiN6IO95a6M5oiQ77yaJHtyZXN1bHQubWVzc2FnZX3jgILlt7LlpITnkIYgJHtyZXN1bHQucHJvY2Vzc2VkU2VnbWVudHN9LyR7cmVzdWx0LnRvdGFsU2VnbWVudHN9IOS4queJh+auteOAguivt+e7p+e7reS9v+eUqCBzcGF3bl93cml0ZXIg5aSE55CG5Ymp5L2Z54mH5q6144CCYDtcbiAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdkb25lJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAn5qCH6K6w5b2T5YmN56ug6IqC5aSE55CG5a6M5oiQ44CC5Y+q5pyJ5aSE55CG5a6M5omA5pyJ54mH5q615ZCO5omN6IO96LCD55So44CCJyxcbiAgICAgIHNjaGVtYTogei5vYmplY3Qoe30pLFxuICAgIH1cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJ0b29sIiwieiIsImNyZWF0ZURlZXBSZWFkZXJEb25lVG9vbCIsImhhbmRsZXIiLCJyZXN1bHQiLCJjYW5GaW5pc2giLCJwcm9jZXNzZWRTZWdtZW50cyIsInRvdGFsU2VnbWVudHMiLCJvdXRwdXRDaGFycyIsIm1lc3NhZ2UiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJzY2hlbWEiLCJvYmplY3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/deep-reader/done.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/deep-reader/index.ts":
/*!********************************************!*\
  !*** ./src/lib/tools/deep-reader/index.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAppendOutputTool: () => (/* reexport safe */ _append_output__WEBPACK_IMPORTED_MODULE_3__.createAppendOutputTool),\n/* harmony export */   createDeepReaderDoneTool: () => (/* reexport safe */ _done__WEBPACK_IMPORTED_MODULE_4__.createDeepReaderDoneTool),\n/* harmony export */   createGetChapterInfoTool: () => (/* reexport safe */ _chapter_info__WEBPACK_IMPORTED_MODULE_0__.createGetChapterInfoTool),\n/* harmony export */   createReadSegmentTool: () => (/* reexport safe */ _read_segment__WEBPACK_IMPORTED_MODULE_1__.createReadSegmentTool),\n/* harmony export */   createSpawnWriterTool: () => (/* reexport safe */ _spawn_writer__WEBPACK_IMPORTED_MODULE_2__.createSpawnWriterTool)\n/* harmony export */ });\n/* harmony import */ var _chapter_info__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chapter-info */ \"(rsc)/./src/lib/tools/deep-reader/chapter-info.ts\");\n/* harmony import */ var _read_segment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./read-segment */ \"(rsc)/./src/lib/tools/deep-reader/read-segment.ts\");\n/* harmony import */ var _spawn_writer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./spawn-writer */ \"(rsc)/./src/lib/tools/deep-reader/spawn-writer.ts\");\n/* harmony import */ var _append_output__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./append-output */ \"(rsc)/./src/lib/tools/deep-reader/append-output.ts\");\n/* harmony import */ var _done__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./done */ \"(rsc)/./src/lib/tools/deep-reader/done.ts\");\n/**\n * DeepReader 工具导出\n */ \n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL2RlZXAtcmVhZGVyL2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQTs7Q0FFQyxHQUUyRTtBQUNyQjtBQUMrQztBQUM3QztBQUNlIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vc3JjL2xpYi90b29scy9kZWVwLXJlYWRlci9pbmRleC50cz9iOTc4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGVlcFJlYWRlciDlt6Xlhbflr7zlh7pcbiAqL1xuXG5leHBvcnQgeyBjcmVhdGVHZXRDaGFwdGVySW5mb1Rvb2wsIHR5cGUgQ2hhcHRlckluZm8gfSBmcm9tICcuL2NoYXB0ZXItaW5mbyc7XG5leHBvcnQgeyBjcmVhdGVSZWFkU2VnbWVudFRvb2wgfSBmcm9tICcuL3JlYWQtc2VnbWVudCc7XG5leHBvcnQgeyBjcmVhdGVTcGF3bldyaXRlclRvb2wsIHR5cGUgU3Bhd25Xcml0ZXJJbnB1dCwgdHlwZSBTcGF3bldyaXRlclJlc3VsdCB9IGZyb20gJy4vc3Bhd24td3JpdGVyJztcbmV4cG9ydCB7IGNyZWF0ZUFwcGVuZE91dHB1dFRvb2wgfSBmcm9tICcuL2FwcGVuZC1vdXRwdXQnO1xuZXhwb3J0IHsgY3JlYXRlRGVlcFJlYWRlckRvbmVUb29sLCB0eXBlIERvbmVDaGVja1Jlc3VsdCB9IGZyb20gJy4vZG9uZSc7XG4iXSwibmFtZXMiOlsiY3JlYXRlR2V0Q2hhcHRlckluZm9Ub29sIiwiY3JlYXRlUmVhZFNlZ21lbnRUb29sIiwiY3JlYXRlU3Bhd25Xcml0ZXJUb29sIiwiY3JlYXRlQXBwZW5kT3V0cHV0VG9vbCIsImNyZWF0ZURlZXBSZWFkZXJEb25lVG9vbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/deep-reader/index.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/deep-reader/read-segment.ts":
/*!***************************************************!*\
  !*** ./src/lib/tools/deep-reader/read-segment.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createReadSegmentTool: () => (/* binding */ createReadSegmentTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * DeepReader 工具：读取原文片段\n */ \n\n/**\n * 创建读取片段工具\n * @param handler 处理函数，接收片段 ID，返回原文内容\n */ function createReadSegmentTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(async (input)=>handler(input.segmentId), {\n        name: \"read_segment\",\n        description: \"读取指定片段的原文内容\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({\n            segmentId: zod__WEBPACK_IMPORTED_MODULE_1__.number().describe(\"片段编号（从 1 开始）\")\n        })\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL2RlZXAtcmVhZGVyL3JlYWQtc2VnbWVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7Q0FFQyxHQUVnQztBQUNUO0FBRXhCOzs7Q0FHQyxHQUNNLFNBQVNFLHNCQUNkQyxPQUFzQztJQUV0QyxPQUFPSCwrQ0FBSUEsQ0FDVCxPQUFPSSxRQUFVRCxRQUFRQyxNQUFNQyxTQUFTLEdBQ3hDO1FBQ0VDLE1BQU07UUFDTkMsYUFBYTtRQUNiQyxRQUFRUCx1Q0FBUSxDQUFDO1lBQ2ZJLFdBQVdKLHVDQUFRLEdBQUdVLFFBQVEsQ0FBQztRQUNqQztJQUNGO0FBRUoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9zcmMvbGliL3Rvb2xzL2RlZXAtcmVhZGVyL3JlYWQtc2VnbWVudC50cz9mNzZlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGVlcFJlYWRlciDlt6XlhbfvvJror7vlj5bljp/mlofniYfmrrVcbiAqL1xuXG5pbXBvcnQgeyB0b29sIH0gZnJvbSAnbGFuZ2NoYWluJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG4vKipcbiAqIOWIm+W7uuivu+WPlueJh+auteW3peWFt1xuICogQHBhcmFtIGhhbmRsZXIg5aSE55CG5Ye95pWw77yM5o6l5pS254mH5q61IElE77yM6L+U5Zue5Y6f5paH5YaF5a65XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZWFkU2VnbWVudFRvb2woXG4gIGhhbmRsZXI6IChzZWdtZW50SWQ6IG51bWJlcikgPT4gc3RyaW5nXG4pIHtcbiAgcmV0dXJuIHRvb2woXG4gICAgYXN5bmMgKGlucHV0KSA9PiBoYW5kbGVyKGlucHV0LnNlZ21lbnRJZCksXG4gICAge1xuICAgICAgbmFtZTogJ3JlYWRfc2VnbWVudCcsXG4gICAgICBkZXNjcmlwdGlvbjogJ+ivu+WPluaMh+WumueJh+auteeahOWOn+aWh+WGheWuuScsXG4gICAgICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICAgICAgc2VnbWVudElkOiB6Lm51bWJlcigpLmRlc2NyaWJlKCfniYfmrrXnvJblj7fvvIjku44gMSDlvIDlp4vvvIknKSxcbiAgICAgIH0pLFxuICAgIH1cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJ0b29sIiwieiIsImNyZWF0ZVJlYWRTZWdtZW50VG9vbCIsImhhbmRsZXIiLCJpbnB1dCIsInNlZ21lbnRJZCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInNjaGVtYSIsIm9iamVjdCIsIm51bWJlciIsImRlc2NyaWJlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/deep-reader/read-segment.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/deep-reader/spawn-writer.ts":
/*!***************************************************!*\
  !*** ./src/lib/tools/deep-reader/spawn-writer.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSpawnWriterTool: () => (/* binding */ createSpawnWriterTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * DeepReader 工具：派出写作助手\n */ \n\n/**\n * 创建派出写作助手工具\n * @param handler 处理函数，生成指定片段的评书内容\n */ function createSpawnWriterTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(async (input)=>{\n        const result = await handler({\n            segmentId: input.segmentId,\n            sceneTitle: input.sceneTitle,\n            writingHints: input.writingHints\n        });\n        return JSON.stringify(result);\n    }, {\n        name: \"spawn_writer\",\n        description: \"派一个写作助手，将指定片段的原文改写成评书。每次只处理一个片段。\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({\n            segmentId: zod__WEBPACK_IMPORTED_MODULE_1__.number().describe(\"要处理的片段编号（从 1 开始）\"),\n            sceneTitle: zod__WEBPACK_IMPORTED_MODULE_1__.string().describe(\"这个场景的标题，用于评书回目\"),\n            writingHints: zod__WEBPACK_IMPORTED_MODULE_1__.string().describe(\"写作提示，说明这个场景的重点、氛围、要强调的内容\")\n        })\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL2RlZXAtcmVhZGVyL3NwYXduLXdyaXRlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7Q0FFQyxHQUVnQztBQUNUO0FBY3hCOzs7Q0FHQyxHQUNNLFNBQVNFLHNCQUNkQyxPQUFnRTtJQUVoRSxPQUFPSCwrQ0FBSUEsQ0FDVCxPQUFPSTtRQUNMLE1BQU1DLFNBQVMsTUFBTUYsUUFBUTtZQUMzQkcsV0FBV0YsTUFBTUUsU0FBUztZQUMxQkMsWUFBWUgsTUFBTUcsVUFBVTtZQUM1QkMsY0FBY0osTUFBTUksWUFBWTtRQUNsQztRQUNBLE9BQU9DLEtBQUtDLFNBQVMsQ0FBQ0w7SUFDeEIsR0FDQTtRQUNFTSxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsUUFBUVosdUNBQVEsQ0FBQztZQUNmSyxXQUFXTCx1Q0FBUSxHQUFHZSxRQUFRLENBQUM7WUFDL0JULFlBQVlOLHVDQUFRLEdBQUdlLFFBQVEsQ0FBQztZQUNoQ1IsY0FBY1AsdUNBQVEsR0FBR2UsUUFBUSxDQUFDO1FBQ3BDO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL3NyYy9saWIvdG9vbHMvZGVlcC1yZWFkZXIvc3Bhd24td3JpdGVyLnRzPzgzNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZWVwUmVhZGVyIOW3peWFt++8mua0vuWHuuWGmeS9nOWKqeaJi1xuICovXG5cbmltcG9ydCB7IHRvb2wgfSBmcm9tICdsYW5nY2hhaW4nO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3Bhd25Xcml0ZXJJbnB1dCB7XG4gIHNlZ21lbnRJZDogbnVtYmVyO1xuICBzY2VuZVRpdGxlOiBzdHJpbmc7XG4gIHdyaXRpbmdIaW50czogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNwYXduV3JpdGVyUmVzdWx0IHtcbiAgc2VnbWVudElkOiBudW1iZXI7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgY2hhckNvdW50OiBudW1iZXI7XG59XG5cbi8qKlxuICog5Yib5bu65rS+5Ye65YaZ5L2c5Yqp5omL5bel5YW3XG4gKiBAcGFyYW0gaGFuZGxlciDlpITnkIblh73mlbDvvIznlJ/miJDmjIflrprniYfmrrXnmoTor4TkuablhoXlrrlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNwYXduV3JpdGVyVG9vbChcbiAgaGFuZGxlcjogKGlucHV0OiBTcGF3bldyaXRlcklucHV0KSA9PiBQcm9taXNlPFNwYXduV3JpdGVyUmVzdWx0PlxuKSB7XG4gIHJldHVybiB0b29sKFxuICAgIGFzeW5jIChpbnB1dCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaGFuZGxlcih7XG4gICAgICAgIHNlZ21lbnRJZDogaW5wdXQuc2VnbWVudElkLFxuICAgICAgICBzY2VuZVRpdGxlOiBpbnB1dC5zY2VuZVRpdGxlLFxuICAgICAgICB3cml0aW5nSGludHM6IGlucHV0LndyaXRpbmdIaW50cyxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHJlc3VsdCk7XG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnc3Bhd25fd3JpdGVyJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAn5rS+5LiA5Liq5YaZ5L2c5Yqp5omL77yM5bCG5oyH5a6a54mH5q6155qE5Y6f5paH5pS55YaZ5oiQ6K+E5Lmm44CC5q+P5qyh5Y+q5aSE55CG5LiA5Liq54mH5q6144CCJyxcbiAgICAgIHNjaGVtYTogei5vYmplY3Qoe1xuICAgICAgICBzZWdtZW50SWQ6IHoubnVtYmVyKCkuZGVzY3JpYmUoJ+imgeWkhOeQhueahOeJh+autee8luWPt++8iOS7jiAxIOW8gOWni++8iScpLFxuICAgICAgICBzY2VuZVRpdGxlOiB6LnN0cmluZygpLmRlc2NyaWJlKCfov5nkuKrlnLrmma/nmoTmoIfpopjvvIznlKjkuo7or4Tkuablm57nm64nKSxcbiAgICAgICAgd3JpdGluZ0hpbnRzOiB6LnN0cmluZygpLmRlc2NyaWJlKCflhpnkvZzmj5DnpLrvvIzor7TmmI7ov5nkuKrlnLrmma/nmoTph43ngrnjgIHmsJvlm7TjgIHopoHlvLrosIPnmoTlhoXlrrknKSxcbiAgICAgIH0pLFxuICAgIH1cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJ0b29sIiwieiIsImNyZWF0ZVNwYXduV3JpdGVyVG9vbCIsImhhbmRsZXIiLCJpbnB1dCIsInJlc3VsdCIsInNlZ21lbnRJZCIsInNjZW5lVGl0bGUiLCJ3cml0aW5nSGludHMiLCJKU09OIiwic3RyaW5naWZ5IiwibmFtZSIsImRlc2NyaXB0aW9uIiwic2NoZW1hIiwib2JqZWN0IiwibnVtYmVyIiwiZGVzY3JpYmUiLCJzdHJpbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/deep-reader/spawn-writer.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/rlm/chunk-list.ts":
/*!*****************************************!*\
  !*** ./src/lib/tools/rlm/chunk-list.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGetChunkListTool: () => (/* binding */ createGetChunkListTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * RLM 工具：获取块列表\n */ \n\n/**\n * 创建获取块列表工具\n * @param handler 处理函数，返回块预览摘要（字符串格式）\n */ function createGetChunkListTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(handler, {\n        name: \"get_chunk_list\",\n        description: \"获取文档块的概览，显示前20块的预览和总块数。用于了解文档结构。\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({})\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL3JsbS9jaHVuay1saXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOztDQUVDLEdBRWdDO0FBQ1Q7QUFFeEI7OztDQUdDLEdBQ00sU0FBU0UsdUJBQ2RDLE9BQXFCO0lBRXJCLE9BQU9ILCtDQUFJQSxDQUFDRyxTQUFTO1FBQ25CQyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsUUFBUUwsdUNBQVEsQ0FBQyxDQUFDO0lBQ3BCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9zcmMvbGliL3Rvb2xzL3JsbS9jaHVuay1saXN0LnRzP2I2MGMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSTE0g5bel5YW377ya6I635Y+W5Z2X5YiX6KGoXG4gKi9cblxuaW1wb3J0IHsgdG9vbCB9IGZyb20gJ2xhbmdjaGFpbic7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuLyoqXG4gKiDliJvlu7rojrflj5blnZfliJfooajlt6XlhbdcbiAqIEBwYXJhbSBoYW5kbGVyIOWkhOeQhuWHveaVsO+8jOi/lOWbnuWdl+mihOiniOaRmOimge+8iOWtl+espuS4suagvOW8j++8iVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlR2V0Q2h1bmtMaXN0VG9vbChcbiAgaGFuZGxlcjogKCkgPT4gc3RyaW5nXG4pIHtcbiAgcmV0dXJuIHRvb2woaGFuZGxlciwge1xuICAgIG5hbWU6ICdnZXRfY2h1bmtfbGlzdCcsXG4gICAgZGVzY3JpcHRpb246ICfojrflj5bmlofmoaPlnZfnmoTmpoLop4jvvIzmmL7npLrliY0yMOWdl+eahOmihOiniOWSjOaAu+Wdl+aVsOOAgueUqOS6juS6huino+aWh+aho+e7k+aehOOAgicsXG4gICAgc2NoZW1hOiB6Lm9iamVjdCh7fSksXG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbInRvb2wiLCJ6IiwiY3JlYXRlR2V0Q2h1bmtMaXN0VG9vbCIsImhhbmRsZXIiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJzY2hlbWEiLCJvYmplY3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/rlm/chunk-list.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/rlm/document-stats.ts":
/*!*********************************************!*\
  !*** ./src/lib/tools/rlm/document-stats.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGetDocumentStatsTool: () => (/* binding */ createGetDocumentStatsTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * RLM 工具：获取文档统计\n */ \n\n/**\n * 创建获取文档统计工具\n * @param handler 处理函数，返回文档统计信息\n */ function createGetDocumentStatsTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(handler, {\n        name: \"get_document_stats\",\n        description: \"获取文档统计信息：总字数、总块数、平均块大小\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({})\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL3JsbS9kb2N1bWVudC1zdGF0cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7Q0FFQyxHQUVnQztBQUNUO0FBRXhCOzs7Q0FHQyxHQUNNLFNBQVNFLDJCQUNkQyxPQUFnRjtJQUVoRixPQUFPSCwrQ0FBSUEsQ0FBQ0csU0FBUztRQUNuQkMsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLFFBQVFMLHVDQUFRLENBQUMsQ0FBQztJQUNwQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vc3JjL2xpYi90b29scy9ybG0vZG9jdW1lbnQtc3RhdHMudHM/MmFkYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJMTSDlt6XlhbfvvJrojrflj5bmlofmoaPnu5/orqFcbiAqL1xuXG5pbXBvcnQgeyB0b29sIH0gZnJvbSAnbGFuZ2NoYWluJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG4vKipcbiAqIOWIm+W7uuiOt+WPluaWh+aho+e7n+iuoeW3peWFt1xuICogQHBhcmFtIGhhbmRsZXIg5aSE55CG5Ye95pWw77yM6L+U5Zue5paH5qGj57uf6K6h5L+h5oGvXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVHZXREb2N1bWVudFN0YXRzVG9vbChcbiAgaGFuZGxlcjogKCkgPT4geyB0b3RhbENoYXJzOiBudW1iZXI7IHRvdGFsQ2h1bmtzOiBudW1iZXI7IGF2Z0NodW5rU2l6ZTogbnVtYmVyIH1cbikge1xuICByZXR1cm4gdG9vbChoYW5kbGVyLCB7XG4gICAgbmFtZTogJ2dldF9kb2N1bWVudF9zdGF0cycsXG4gICAgZGVzY3JpcHRpb246ICfojrflj5bmlofmoaPnu5/orqHkv6Hmga/vvJrmgLvlrZfmlbDjgIHmgLvlnZfmlbDjgIHlubPlnYflnZflpKflsI8nLFxuICAgIHNjaGVtYTogei5vYmplY3Qoe30pLFxuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJ0b29sIiwieiIsImNyZWF0ZUdldERvY3VtZW50U3RhdHNUb29sIiwiaGFuZGxlciIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInNjaGVtYSIsIm9iamVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/rlm/document-stats.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/rlm/done.ts":
/*!***********************************!*\
  !*** ./src/lib/tools/rlm/done.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDoneTool: () => (/* binding */ createDoneTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * RLM 工具：标记任务完成\n */ \n\n/**\n * 创建完成任务工具\n * @param handler 处理函数（可以抛出错误来强制停止）\n */ function createDoneTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(handler, {\n        name: \"done\",\n        description: \"任务完成时调用此工具。调用后将结束阅读流程。\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({})\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL3JsbS9kb25lLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOztDQUVDLEdBRWdDO0FBQ1Q7QUFFeEI7OztDQUdDLEdBQ00sU0FBU0UsZUFDZEMsT0FBNkI7SUFFN0IsT0FBT0gsK0NBQUlBLENBQUNHLFNBQVM7UUFDbkJDLE1BQU07UUFDTkMsYUFBYTtRQUNiQyxRQUFRTCx1Q0FBUSxDQUFDLENBQUM7SUFDcEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL3NyYy9saWIvdG9vbHMvcmxtL2RvbmUudHM/NGNiZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJMTSDlt6XlhbfvvJrmoIforrDku7vliqHlrozmiJBcbiAqL1xuXG5pbXBvcnQgeyB0b29sIH0gZnJvbSAnbGFuZ2NoYWluJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG4vKipcbiAqIOWIm+W7uuWujOaIkOS7u+WKoeW3peWFt1xuICogQHBhcmFtIGhhbmRsZXIg5aSE55CG5Ye95pWw77yI5Y+v5Lul5oqb5Ye66ZSZ6K+v5p2l5by65Yi25YGc5q2i77yJXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEb25lVG9vbChcbiAgaGFuZGxlcjogKCkgPT4gc3RyaW5nIHwgbmV2ZXJcbikge1xuICByZXR1cm4gdG9vbChoYW5kbGVyLCB7XG4gICAgbmFtZTogJ2RvbmUnLFxuICAgIGRlc2NyaXB0aW9uOiAn5Lu75Yqh5a6M5oiQ5pe26LCD55So5q2k5bel5YW344CC6LCD55So5ZCO5bCG57uT5p2f6ZiF6K+75rWB56iL44CCJyxcbiAgICBzY2hlbWE6IHoub2JqZWN0KHt9KSxcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsidG9vbCIsInoiLCJjcmVhdGVEb25lVG9vbCIsImhhbmRsZXIiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJzY2hlbWEiLCJvYmplY3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/rlm/done.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/rlm/index.ts":
/*!************************************!*\
  !*** ./src/lib/tools/rlm/index.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDoneTool: () => (/* reexport safe */ _done__WEBPACK_IMPORTED_MODULE_6__.createDoneTool),\n/* harmony export */   createGetChunkListTool: () => (/* reexport safe */ _chunk_list__WEBPACK_IMPORTED_MODULE_1__.createGetChunkListTool),\n/* harmony export */   createGetDocumentStatsTool: () => (/* reexport safe */ _document_stats__WEBPACK_IMPORTED_MODULE_0__.createGetDocumentStatsTool),\n/* harmony export */   createGetOutputTool: () => (/* reexport safe */ _output__WEBPACK_IMPORTED_MODULE_5__.createGetOutputTool),\n/* harmony export */   createReadChunkTool: () => (/* reexport safe */ _read_chunk__WEBPACK_IMPORTED_MODULE_3__.createReadChunkTool),\n/* harmony export */   createSearchDocumentTool: () => (/* reexport safe */ _search_document__WEBPACK_IMPORTED_MODULE_2__.createSearchDocumentTool),\n/* harmony export */   createSpawnReaderTool: () => (/* reexport safe */ _spawn_reader__WEBPACK_IMPORTED_MODULE_4__.createSpawnReaderTool),\n/* harmony export */   createUpdateOutputTool: () => (/* reexport safe */ _output__WEBPACK_IMPORTED_MODULE_5__.createUpdateOutputTool)\n/* harmony export */ });\n/* harmony import */ var _document_stats__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./document-stats */ \"(rsc)/./src/lib/tools/rlm/document-stats.ts\");\n/* harmony import */ var _chunk_list__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-list */ \"(rsc)/./src/lib/tools/rlm/chunk-list.ts\");\n/* harmony import */ var _search_document__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./search-document */ \"(rsc)/./src/lib/tools/rlm/search-document.ts\");\n/* harmony import */ var _read_chunk__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./read-chunk */ \"(rsc)/./src/lib/tools/rlm/read-chunk.ts\");\n/* harmony import */ var _spawn_reader__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./spawn-reader */ \"(rsc)/./src/lib/tools/rlm/spawn-reader.ts\");\n/* harmony import */ var _output__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./output */ \"(rsc)/./src/lib/tools/rlm/output.ts\");\n/* harmony import */ var _done__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./done */ \"(rsc)/./src/lib/tools/rlm/done.ts\");\n/**\n * RLM 工具导出\n */ \n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL3JsbS9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7Q0FFQyxHQUU2RDtBQUNSO0FBQ087QUFDVjtBQUNJO0FBQ2dCO0FBQy9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vc3JjL2xpYi90b29scy9ybG0vaW5kZXgudHM/NjI4YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJMTSDlt6Xlhbflr7zlh7pcbiAqL1xuXG5leHBvcnQgeyBjcmVhdGVHZXREb2N1bWVudFN0YXRzVG9vbCB9IGZyb20gJy4vZG9jdW1lbnQtc3RhdHMnO1xuZXhwb3J0IHsgY3JlYXRlR2V0Q2h1bmtMaXN0VG9vbCB9IGZyb20gJy4vY2h1bmstbGlzdCc7XG5leHBvcnQgeyBjcmVhdGVTZWFyY2hEb2N1bWVudFRvb2wgfSBmcm9tICcuL3NlYXJjaC1kb2N1bWVudCc7XG5leHBvcnQgeyBjcmVhdGVSZWFkQ2h1bmtUb29sIH0gZnJvbSAnLi9yZWFkLWNodW5rJztcbmV4cG9ydCB7IGNyZWF0ZVNwYXduUmVhZGVyVG9vbCB9IGZyb20gJy4vc3Bhd24tcmVhZGVyJztcbmV4cG9ydCB7IGNyZWF0ZVVwZGF0ZU91dHB1dFRvb2wsIGNyZWF0ZUdldE91dHB1dFRvb2wgfSBmcm9tICcuL291dHB1dCc7XG5leHBvcnQgeyBjcmVhdGVEb25lVG9vbCB9IGZyb20gJy4vZG9uZSc7XG4iXSwibmFtZXMiOlsiY3JlYXRlR2V0RG9jdW1lbnRTdGF0c1Rvb2wiLCJjcmVhdGVHZXRDaHVua0xpc3RUb29sIiwiY3JlYXRlU2VhcmNoRG9jdW1lbnRUb29sIiwiY3JlYXRlUmVhZENodW5rVG9vbCIsImNyZWF0ZVNwYXduUmVhZGVyVG9vbCIsImNyZWF0ZVVwZGF0ZU91dHB1dFRvb2wiLCJjcmVhdGVHZXRPdXRwdXRUb29sIiwiY3JlYXRlRG9uZVRvb2wiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/rlm/index.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/rlm/output.ts":
/*!*************************************!*\
  !*** ./src/lib/tools/rlm/output.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGetOutputTool: () => (/* binding */ createGetOutputTool),\n/* harmony export */   createUpdateOutputTool: () => (/* binding */ createUpdateOutputTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * RLM 工具：输出管理\n */ \n\n/**\n * 创建更新输出工具\n * @param handler 处理函数，接收输出内容\n */ function createUpdateOutputTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)((input)=>handler(input.content), {\n        name: \"update_output\",\n        description: \"更新输出内容（笔记/摘要/分析等）\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({\n            content: zod__WEBPACK_IMPORTED_MODULE_1__.string().describe(\"输出内容\")\n        })\n    });\n}\n/**\n * 创建获取输出工具\n * @param handler 处理函数，返回当前输出\n */ function createGetOutputTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(handler, {\n        name: \"get_output\",\n        description: \"获取当前输出内容\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({})\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL3JsbS9vdXRwdXQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztDQUVDLEdBRWdDO0FBQ1Q7QUFFeEI7OztDQUdDLEdBQ00sU0FBU0UsdUJBQ2RDLE9BQW9DO0lBRXBDLE9BQU9ILCtDQUFJQSxDQUNULENBQUNJLFFBQVVELFFBQVFDLE1BQU1DLE9BQU8sR0FDaEM7UUFDRUMsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLFFBQVFQLHVDQUFRLENBQUM7WUFDZkksU0FBU0osdUNBQVEsR0FBR1UsUUFBUSxDQUFDO1FBQy9CO0lBQ0Y7QUFFSjtBQUVBOzs7Q0FHQyxHQUNNLFNBQVNDLG9CQUNkVCxPQUFxQjtJQUVyQixPQUFPSCwrQ0FBSUEsQ0FBQ0csU0FBUztRQUNuQkcsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLFFBQVFQLHVDQUFRLENBQUMsQ0FBQztJQUNwQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vc3JjL2xpYi90b29scy9ybG0vb3V0cHV0LnRzPzFhNzMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSTE0g5bel5YW377ya6L6T5Ye6566h55CGXG4gKi9cblxuaW1wb3J0IHsgdG9vbCB9IGZyb20gJ2xhbmdjaGFpbic7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuLyoqXG4gKiDliJvlu7rmm7TmlrDovpPlh7rlt6XlhbdcbiAqIEBwYXJhbSBoYW5kbGVyIOWkhOeQhuWHveaVsO+8jOaOpeaUtui+k+WHuuWGheWuuVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVXBkYXRlT3V0cHV0VG9vbChcbiAgaGFuZGxlcjogKGNvbnRlbnQ6IHN0cmluZykgPT4gc3RyaW5nXG4pIHtcbiAgcmV0dXJuIHRvb2woXG4gICAgKGlucHV0KSA9PiBoYW5kbGVyKGlucHV0LmNvbnRlbnQpLFxuICAgIHtcbiAgICAgIG5hbWU6ICd1cGRhdGVfb3V0cHV0JyxcbiAgICAgIGRlc2NyaXB0aW9uOiAn5pu05paw6L6T5Ye65YaF5a6577yI56yU6K6wL+aRmOimgS/liIbmnpDnrYnvvIknLFxuICAgICAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgICAgIGNvbnRlbnQ6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ+i+k+WHuuWGheWuuScpLFxuICAgICAgfSksXG4gICAgfVxuICApO1xufVxuXG4vKipcbiAqIOWIm+W7uuiOt+WPlui+k+WHuuW3peWFt1xuICogQHBhcmFtIGhhbmRsZXIg5aSE55CG5Ye95pWw77yM6L+U5Zue5b2T5YmN6L6T5Ye6XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVHZXRPdXRwdXRUb29sKFxuICBoYW5kbGVyOiAoKSA9PiBzdHJpbmdcbikge1xuICByZXR1cm4gdG9vbChoYW5kbGVyLCB7XG4gICAgbmFtZTogJ2dldF9vdXRwdXQnLFxuICAgIGRlc2NyaXB0aW9uOiAn6I635Y+W5b2T5YmN6L6T5Ye65YaF5a65JyxcbiAgICBzY2hlbWE6IHoub2JqZWN0KHt9KSxcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsidG9vbCIsInoiLCJjcmVhdGVVcGRhdGVPdXRwdXRUb29sIiwiaGFuZGxlciIsImlucHV0IiwiY29udGVudCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInNjaGVtYSIsIm9iamVjdCIsInN0cmluZyIsImRlc2NyaWJlIiwiY3JlYXRlR2V0T3V0cHV0VG9vbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/rlm/output.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/rlm/read-chunk.ts":
/*!*****************************************!*\
  !*** ./src/lib/tools/rlm/read-chunk.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createReadChunkTool: () => (/* binding */ createReadChunkTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * RLM 工具：读取块内容\n */ \n\n/**\n * 创建读取块内容工具\n * @param handler 处理函数，接收块编号返回内容\n */ function createReadChunkTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)((input)=>handler(input.index), {\n        name: \"read_chunk\",\n        description: \"读取指定块的完整内容\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({\n            index: zod__WEBPACK_IMPORTED_MODULE_1__.number().describe(\"块编号，从 1 开始\")\n        })\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL3JsbS9yZWFkLWNodW5rLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOztDQUVDLEdBRWdDO0FBQ1Q7QUFFeEI7OztDQUdDLEdBQ00sU0FBU0Usb0JBQ2RDLE9BQWtDO0lBRWxDLE9BQU9ILCtDQUFJQSxDQUNULENBQUNJLFFBQVVELFFBQVFDLE1BQU1DLEtBQUssR0FDOUI7UUFDRUMsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLFFBQVFQLHVDQUFRLENBQUM7WUFDZkksT0FBT0osdUNBQVEsR0FBR1UsUUFBUSxDQUFDO1FBQzdCO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL3NyYy9saWIvdG9vbHMvcmxtL3JlYWQtY2h1bmsudHM/NGZlYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJMTSDlt6XlhbfvvJror7vlj5blnZflhoXlrrlcbiAqL1xuXG5pbXBvcnQgeyB0b29sIH0gZnJvbSAnbGFuZ2NoYWluJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG4vKipcbiAqIOWIm+W7uuivu+WPluWdl+WGheWuueW3peWFt1xuICogQHBhcmFtIGhhbmRsZXIg5aSE55CG5Ye95pWw77yM5o6l5pS25Z2X57yW5Y+36L+U5Zue5YaF5a65XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZWFkQ2h1bmtUb29sKFxuICBoYW5kbGVyOiAoaW5kZXg6IG51bWJlcikgPT4gc3RyaW5nXG4pIHtcbiAgcmV0dXJuIHRvb2woXG4gICAgKGlucHV0KSA9PiBoYW5kbGVyKGlucHV0LmluZGV4KSxcbiAgICB7XG4gICAgICBuYW1lOiAncmVhZF9jaHVuaycsXG4gICAgICBkZXNjcmlwdGlvbjogJ+ivu+WPluaMh+WumuWdl+eahOWujOaVtOWGheWuuScsXG4gICAgICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICAgICAgaW5kZXg6IHoubnVtYmVyKCkuZGVzY3JpYmUoJ+Wdl+e8luWPt++8jOS7jiAxIOW8gOWniycpLFxuICAgICAgfSksXG4gICAgfVxuICApO1xufVxuIl0sIm5hbWVzIjpbInRvb2wiLCJ6IiwiY3JlYXRlUmVhZENodW5rVG9vbCIsImhhbmRsZXIiLCJpbnB1dCIsImluZGV4IiwibmFtZSIsImRlc2NyaXB0aW9uIiwic2NoZW1hIiwib2JqZWN0IiwibnVtYmVyIiwiZGVzY3JpYmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/rlm/read-chunk.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/rlm/search-document.ts":
/*!**********************************************!*\
  !*** ./src/lib/tools/rlm/search-document.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSearchDocumentTool: () => (/* binding */ createSearchDocumentTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * RLM 工具：搜索文档\n */ \n\n/**\n * 创建搜索文档工具\n * @param handler 处理函数，接收关键词返回匹配的块编号\n */ function createSearchDocumentTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)((input)=>handler(input.keyword), {\n        name: \"search_document\",\n        description: \"搜索包含指定关键词的块\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({\n            keyword: zod__WEBPACK_IMPORTED_MODULE_1__.string().describe(\"要搜索的关键词\")\n        })\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL3JsbS9zZWFyY2gtZG9jdW1lbnQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7O0NBRUMsR0FFZ0M7QUFDVDtBQUV4Qjs7O0NBR0MsR0FDTSxTQUFTRSx5QkFDZEMsT0FBc0M7SUFFdEMsT0FBT0gsK0NBQUlBLENBQ1QsQ0FBQ0ksUUFBVUQsUUFBUUMsTUFBTUMsT0FBTyxHQUNoQztRQUNFQyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsUUFBUVAsdUNBQVEsQ0FBQztZQUNmSSxTQUFTSix1Q0FBUSxHQUFHVSxRQUFRLENBQUM7UUFDL0I7SUFDRjtBQUVKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vc3JjL2xpYi90b29scy9ybG0vc2VhcmNoLWRvY3VtZW50LnRzPzM0YjAiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSTE0g5bel5YW377ya5pCc57Si5paH5qGjXG4gKi9cblxuaW1wb3J0IHsgdG9vbCB9IGZyb20gJ2xhbmdjaGFpbic7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuLyoqXG4gKiDliJvlu7rmkJzntKLmlofmoaPlt6XlhbdcbiAqIEBwYXJhbSBoYW5kbGVyIOWkhOeQhuWHveaVsO+8jOaOpeaUtuWFs+mUruivjei/lOWbnuWMuemFjeeahOWdl+e8luWPt1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2VhcmNoRG9jdW1lbnRUb29sKFxuICBoYW5kbGVyOiAoa2V5d29yZDogc3RyaW5nKSA9PiBudW1iZXJbXVxuKSB7XG4gIHJldHVybiB0b29sKFxuICAgIChpbnB1dCkgPT4gaGFuZGxlcihpbnB1dC5rZXl3b3JkKSxcbiAgICB7XG4gICAgICBuYW1lOiAnc2VhcmNoX2RvY3VtZW50JyxcbiAgICAgIGRlc2NyaXB0aW9uOiAn5pCc57Si5YyF5ZCr5oyH5a6a5YWz6ZSu6K+N55qE5Z2XJyxcbiAgICAgIHNjaGVtYTogei5vYmplY3Qoe1xuICAgICAgICBrZXl3b3JkOiB6LnN0cmluZygpLmRlc2NyaWJlKCfopoHmkJzntKLnmoTlhbPplK7or40nKSxcbiAgICAgIH0pLFxuICAgIH1cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJ0b29sIiwieiIsImNyZWF0ZVNlYXJjaERvY3VtZW50VG9vbCIsImhhbmRsZXIiLCJpbnB1dCIsImtleXdvcmQiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJzY2hlbWEiLCJvYmplY3QiLCJzdHJpbmciLCJkZXNjcmliZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/rlm/search-document.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tools/rlm/spawn-reader.ts":
/*!*******************************************!*\
  !*** ./src/lib/tools/rlm/spawn-reader.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSpawnReaderTool: () => (/* binding */ createSpawnReaderTool)\n/* harmony export */ });\n/* harmony import */ var langchain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! langchain */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/classic/external.js\");\n/**\n * RLM 工具：派出阅读助手\n */ \n\n/**\n * 创建派出阅读助手工具\n * @param handler 处理函数，接收块编号列表和问题，返回回答\n */ function createSpawnReaderTool(handler) {\n    return (0,langchain__WEBPACK_IMPORTED_MODULE_0__.tool)(async (input)=>handler(input.chunkIndexes, input.question), {\n        name: \"spawn_reader\",\n        description: \"派一个助手阅读指定块并回答问题\",\n        schema: zod__WEBPACK_IMPORTED_MODULE_1__.object({\n            chunkIndexes: zod__WEBPACK_IMPORTED_MODULE_1__.array(zod__WEBPACK_IMPORTED_MODULE_1__.number()).describe(\"要读的块编号列表\"),\n            question: zod__WEBPACK_IMPORTED_MODULE_1__.string().describe(\"让助手回答的问题\")\n        })\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rvb2xzL3JsbS9zcGF3bi1yZWFkZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7O0NBRUMsR0FFZ0M7QUFDVDtBQUV4Qjs7O0NBR0MsR0FDTSxTQUFTRSxzQkFDZEMsT0FBc0U7SUFFdEUsT0FBT0gsK0NBQUlBLENBQ1QsT0FBT0ksUUFBVUQsUUFBUUMsTUFBTUMsWUFBWSxFQUFFRCxNQUFNRSxRQUFRLEdBQzNEO1FBQ0VDLE1BQU07UUFDTkMsYUFBYTtRQUNiQyxRQUFRUix1Q0FBUSxDQUFDO1lBQ2ZJLGNBQWNKLHNDQUFPLENBQUNBLHVDQUFRLElBQUlZLFFBQVEsQ0FBQztZQUMzQ1AsVUFBVUwsdUNBQVEsR0FBR1ksUUFBUSxDQUFDO1FBQ2hDO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL3NyYy9saWIvdG9vbHMvcmxtL3NwYXduLXJlYWRlci50cz83YTc3Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUkxNIOW3peWFt++8mua0vuWHuumYheivu+WKqeaJi1xuICovXG5cbmltcG9ydCB7IHRvb2wgfSBmcm9tICdsYW5nY2hhaW4nO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbi8qKlxuICog5Yib5bu65rS+5Ye66ZiF6K+75Yqp5omL5bel5YW3XG4gKiBAcGFyYW0gaGFuZGxlciDlpITnkIblh73mlbDvvIzmjqXmlLblnZfnvJblj7fliJfooajlkozpl67popjvvIzov5Tlm57lm57nrZRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNwYXduUmVhZGVyVG9vbChcbiAgaGFuZGxlcjogKGNodW5rSW5kZXhlczogbnVtYmVyW10sIHF1ZXN0aW9uOiBzdHJpbmcpID0+IFByb21pc2U8c3RyaW5nPlxuKSB7XG4gIHJldHVybiB0b29sKFxuICAgIGFzeW5jIChpbnB1dCkgPT4gaGFuZGxlcihpbnB1dC5jaHVua0luZGV4ZXMsIGlucHV0LnF1ZXN0aW9uKSxcbiAgICB7XG4gICAgICBuYW1lOiAnc3Bhd25fcmVhZGVyJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAn5rS+5LiA5Liq5Yqp5omL6ZiF6K+75oyH5a6a5Z2X5bm25Zue562U6Zeu6aKYJyxcbiAgICAgIHNjaGVtYTogei5vYmplY3Qoe1xuICAgICAgICBjaHVua0luZGV4ZXM6IHouYXJyYXkoei5udW1iZXIoKSkuZGVzY3JpYmUoJ+imgeivu+eahOWdl+e8luWPt+WIl+ihqCcpLFxuICAgICAgICBxdWVzdGlvbjogei5zdHJpbmcoKS5kZXNjcmliZSgn6K6p5Yqp5omL5Zue562U55qE6Zeu6aKYJyksXG4gICAgICB9KSxcbiAgICB9XG4gICk7XG59XG4iXSwibmFtZXMiOlsidG9vbCIsInoiLCJjcmVhdGVTcGF3blJlYWRlclRvb2wiLCJoYW5kbGVyIiwiaW5wdXQiLCJjaHVua0luZGV4ZXMiLCJxdWVzdGlvbiIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInNjaGVtYSIsIm9iamVjdCIsImFycmF5IiwibnVtYmVyIiwiZGVzY3JpYmUiLCJzdHJpbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tools/rlm/spawn-reader.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.2.25_react-dom@18.3.1_react@18.3.1__react@18.3.1","vendor-chunks/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_","vendor-chunks/openai@6.25.0_zod@4.3.6","vendor-chunks/zod@4.3.6","vendor-chunks/yaml@2.8.2","vendor-chunks/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry","vendor-chunks/semver@7.7.4","vendor-chunks/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy","vendor-chunks/@langchain+openai@1.2.10_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6__","vendor-chunks/langsmith@0.5.6_openai@6.25.0_zod@4.3.6_","vendor-chunks/fast-glob@3.3.3","vendor-chunks/@langchain+langgraph-checkpoint@1.0.0_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6__","vendor-chunks/uuid@10.0.0","vendor-chunks/better-sqlite3@12.6.2","vendor-chunks/@cfworker+json-schema@4.1.1","vendor-chunks/@nodelib+fs.walk@1.2.8","vendor-chunks/@nodelib+fs.scandir@2.1.5","vendor-chunks/braces@3.0.3","vendor-chunks/picomatch@2.3.1","vendor-chunks/@nodelib+fs.stat@2.0.5","vendor-chunks/p-queue@6.6.2","vendor-chunks/js-tiktoken@1.0.21","vendor-chunks/mustache@4.2.0","vendor-chunks/deepagents@1.8.1_openai@6.25.0_zod@4.3.6__react-dom@18.3.1_react@18.3.1__react@18.3.1","vendor-chunks/@langchain+langgraph-checkpoint-sqlite@1.0.1_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___x5mt5hbw5gguxm32j7hbetr5ym","vendor-chunks/fastq@1.20.1","vendor-chunks/to-regex-range@5.0.1","vendor-chunks/run-parallel@1.2.0","vendor-chunks/reusify@1.1.0","vendor-chunks/queue-microtask@1.2.3","vendor-chunks/p-timeout@3.2.0","vendor-chunks/p-finally@1.0.0","vendor-chunks/micromatch@4.0.8","vendor-chunks/merge2@1.4.1","vendor-chunks/is-number@7.0.0","vendor-chunks/is-glob@4.0.3","vendor-chunks/is-extglob@2.1.1","vendor-chunks/glob-parent@5.1.2","vendor-chunks/fill-range@7.1.1","vendor-chunks/file-uri-to-path@1.0.0","vendor-chunks/eventemitter3@4.0.7","vendor-chunks/decamelize@1.2.0","vendor-chunks/camelcase@6.3.0","vendor-chunks/bindings@1.5.0","vendor-chunks/base64-js@1.5.1","vendor-chunks/ansi-styles@5.2.0"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.2.25_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fread%2Froute&page=%2Fapi%2Fread%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fread%2Froute.ts&appDir=%2FUsers%2Fgongzhen%2Fcode%2F2025%2Fhzm%2Fstorytelling%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fgongzhen%2Fcode%2F2025%2Fhzm%2Fstorytelling&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();