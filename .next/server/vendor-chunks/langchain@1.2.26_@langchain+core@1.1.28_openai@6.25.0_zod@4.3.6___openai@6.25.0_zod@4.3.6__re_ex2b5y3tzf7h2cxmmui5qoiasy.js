"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy";
exports.ids = ["vendor-chunks/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy"];
exports.modules = {

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/_virtual/_rolldown/runtime.js":
/*!***************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/_virtual/_rolldown/runtime.js ***!
  \***************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   __exportAll: () => (/* binding */ __exportAll),\n/* harmony export */   __reExport: () => (/* binding */ __reExport)\n/* harmony export */ });\n//#region \\0rolldown/runtime.js\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __exportAll = (all, no_symbols) => {\n\tlet target = {};\n\tfor (var name in all) {\n\t\t__defProp(target, name, {\n\t\t\tget: all[name],\n\t\t\tenumerable: true\n\t\t});\n\t}\n\tif (!no_symbols) {\n\t\t__defProp(target, Symbol.toStringTag, { value: \"Module\" });\n\t}\n\treturn target;\n};\nvar __copyProps = (to, from, except, desc) => {\n\tif (from && typeof from === \"object\" || typeof from === \"function\") {\n\t\tfor (var keys = __getOwnPropNames(from), i = 0, n = keys.length, key; i < n; i++) {\n\t\t\tkey = keys[i];\n\t\t\tif (!__hasOwnProp.call(to, key) && key !== except) {\n\t\t\t\t__defProp(to, key, {\n\t\t\t\t\tget: ((k) => from[k]).bind(null, key),\n\t\t\t\t\tenumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\treturn to;\n};\nvar __reExport = (target, mod, secondTarget) => (__copyProps(target, mod, \"default\"), secondTarget && __copyProps(secondTarget, mod, \"default\"));\n\n//#endregion\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9fdmlydHVhbC9fcm9sbGRvd24vcnVudGltZS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLDBDQUEwQyxpQkFBaUI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RSxPQUFPO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvX3ZpcnR1YWwvX3JvbGxkb3duL3J1bnRpbWUuanM/OGQ5NiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyNyZWdpb24gXFwwcm9sbGRvd24vcnVudGltZS5qc1xudmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBfX2dldE93blByb3BEZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbnZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzO1xudmFyIF9faGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgX19leHBvcnRBbGwgPSAoYWxsLCBub19zeW1ib2xzKSA9PiB7XG5cdGxldCB0YXJnZXQgPSB7fTtcblx0Zm9yICh2YXIgbmFtZSBpbiBhbGwpIHtcblx0XHRfX2RlZlByb3AodGFyZ2V0LCBuYW1lLCB7XG5cdFx0XHRnZXQ6IGFsbFtuYW1lXSxcblx0XHRcdGVudW1lcmFibGU6IHRydWVcblx0XHR9KTtcblx0fVxuXHRpZiAoIW5vX3N5bWJvbHMpIHtcblx0XHRfX2RlZlByb3AodGFyZ2V0LCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6IFwiTW9kdWxlXCIgfSk7XG5cdH1cblx0cmV0dXJuIHRhcmdldDtcbn07XG52YXIgX19jb3B5UHJvcHMgPSAodG8sIGZyb20sIGV4Y2VwdCwgZGVzYykgPT4ge1xuXHRpZiAoZnJvbSAmJiB0eXBlb2YgZnJvbSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgZnJvbSA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0Zm9yICh2YXIga2V5cyA9IF9fZ2V0T3duUHJvcE5hbWVzKGZyb20pLCBpID0gMCwgbiA9IGtleXMubGVuZ3RoLCBrZXk7IGkgPCBuOyBpKyspIHtcblx0XHRcdGtleSA9IGtleXNbaV07XG5cdFx0XHRpZiAoIV9faGFzT3duUHJvcC5jYWxsKHRvLCBrZXkpICYmIGtleSAhPT0gZXhjZXB0KSB7XG5cdFx0XHRcdF9fZGVmUHJvcCh0bywga2V5LCB7XG5cdFx0XHRcdFx0Z2V0OiAoKGspID0+IGZyb21ba10pLmJpbmQobnVsbCwga2V5KSxcblx0XHRcdFx0XHRlbnVtZXJhYmxlOiAhKGRlc2MgPSBfX2dldE93blByb3BEZXNjKGZyb20sIGtleSkpIHx8IGRlc2MuZW51bWVyYWJsZVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0cmV0dXJuIHRvO1xufTtcbnZhciBfX3JlRXhwb3J0ID0gKHRhcmdldCwgbW9kLCBzZWNvbmRUYXJnZXQpID0+IChfX2NvcHlQcm9wcyh0YXJnZXQsIG1vZCwgXCJkZWZhdWx0XCIpLCBzZWNvbmRUYXJnZXQgJiYgX19jb3B5UHJvcHMoc2Vjb25kVGFyZ2V0LCBtb2QsIFwiZGVmYXVsdFwiKSk7XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgX19leHBvcnRBbGwsIF9fcmVFeHBvcnQgfTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/_virtual/_rolldown/runtime.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/ReactAgent.js":
/*!******************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/ReactAgent.js ***!
  \******************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ReactAgent: () => (/* binding */ ReactAgent)\n/* harmony export */ });\n/* harmony import */ var _annotation_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./annotation.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/annotation.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/utils.js\");\n/* harmony import */ var _nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./nodes/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/utils.js\");\n/* harmony import */ var _nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./nodes/AgentNode.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AgentNode.js\");\n/* harmony import */ var _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./nodes/ToolNode.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/ToolNode.js\");\n/* harmony import */ var _middleware_utils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./middleware/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _nodes_BeforeAgentNode_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./nodes/BeforeAgentNode.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/BeforeAgentNode.js\");\n/* harmony import */ var _nodes_BeforeModelNode_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./nodes/BeforeModelNode.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/BeforeModelNode.js\");\n/* harmony import */ var _nodes_AfterModelNode_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./nodes/AfterModelNode.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AfterModelNode.js\");\n/* harmony import */ var _nodes_AfterAgentNode_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./nodes/AfterAgentNode.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AfterAgentNode.js\");\n/* harmony import */ var _state_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./state.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/state.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/runnables/index.js\");\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//#region src/agents/ReactAgent.ts\n/**\n* ReactAgent is a production-ready ReAct (Reasoning + Acting) agent that combines\n* language models with tools and middleware.\n*\n* The agent is parameterized by a single type bag `Types` that encapsulates all\n* type information:\n*\n* @typeParam Types - An {@link AgentTypeConfig} that bundles:\n*   - `Response`: The structured response type\n*   - `State`: The custom state schema type\n*   - `Context`: The context schema type\n*   - `Middleware`: The middleware array type\n*   - `Tools`: The combined tools type from agent and middleware\n*\n* @example\n* ```typescript\n* // Using the type bag pattern\n* type MyTypes = AgentTypeConfig<\n*   { name: string },  // Response\n*   typeof myState,    // State\n*   typeof myContext,  // Context\n*   typeof middleware, // Middleware\n*   typeof tools       // Tools\n* >;\n*\n* const agent: ReactAgent<MyTypes> = createAgent({ ... });\n* ```\n*/\nvar ReactAgent = class ReactAgent {\n\t#graph;\n\t#toolBehaviorVersion = \"v2\";\n\t#agentNode;\n\t#stateManager = new _state_js__WEBPACK_IMPORTED_MODULE_10__.StateManager();\n\t#defaultConfig;\n\tconstructor(options, defaultConfig) {\n\t\tthis.options = options;\n\t\tthis.#defaultConfig = defaultConfig ?? {};\n\t\tif (options.name) this.#defaultConfig = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_12__.mergeConfigs)(this.#defaultConfig, { metadata: { lc_agent_name: options.name } });\n\t\tthis.#toolBehaviorVersion = options.version ?? this.#toolBehaviorVersion;\n\t\t/**\n\t\t* validate that model option is provided\n\t\t*/\n\t\tif (!options.model) throw new Error(\"`model` option is required to create an agent.\");\n\t\t/**\n\t\t* Check if the LLM already has bound tools and throw if it does.\n\t\t*/\n\t\tif (typeof options.model !== \"string\") (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.validateLLMHasNoBoundTools)(options.model);\n\t\t/**\n\t\t* define complete list of tools based on options and middleware\n\t\t*/\n\t\tconst middlewareTools = this.options.middleware?.filter((m) => m.tools).flatMap((m) => m.tools) ?? [];\n\t\tconst toolClasses = [...options.tools ?? [], ...middlewareTools];\n\t\t/**\n\t\t* If any of the tools are configured to return_directly after running,\n\t\t* our graph needs to check if these were called\n\t\t*/\n\t\tconst shouldReturnDirect = new Set(toolClasses.filter(_utils_js__WEBPACK_IMPORTED_MODULE_1__.isClientTool).filter((tool) => \"returnDirect\" in tool && tool.returnDirect).map((tool) => tool.name));\n\t\t/**\n\t\t* Create a schema that merges agent base schema with middleware state schemas\n\t\t* Using Zod with withLangGraph ensures LangGraph Studio gets proper metadata\n\t\t*/\n\t\tconst { state, input, output } = (0,_annotation_js__WEBPACK_IMPORTED_MODULE_0__.createAgentState)(this.options.responseFormat !== void 0, this.options.stateSchema, this.options.middleware);\n\t\tconst allNodeWorkflows = new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.StateGraph(state, {\n\t\t\tinput,\n\t\t\toutput,\n\t\t\tcontext: this.options.contextSchema\n\t\t});\n\t\tconst beforeAgentNodes = [];\n\t\tconst beforeModelNodes = [];\n\t\tconst afterModelNodes = [];\n\t\tconst afterAgentNodes = [];\n\t\tconst wrapModelCallHookMiddleware = [];\n\t\tthis.#agentNode = new _nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AgentNode({\n\t\t\tmodel: this.options.model,\n\t\t\tsystemMessage: (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.normalizeSystemPrompt)(this.options.systemPrompt),\n\t\t\tincludeAgentName: this.options.includeAgentName,\n\t\t\tname: this.options.name,\n\t\t\tresponseFormat: this.options.responseFormat,\n\t\t\tmiddleware: this.options.middleware,\n\t\t\ttoolClasses,\n\t\t\tshouldReturnDirect,\n\t\t\tsignal: this.options.signal,\n\t\t\twrapModelCallHookMiddleware\n\t\t});\n\t\tconst middlewareNames = /* @__PURE__ */ new Set();\n\t\tconst middleware = this.options.middleware ?? [];\n\t\tfor (let i = 0; i < middleware.length; i++) {\n\t\t\tlet beforeAgentNode;\n\t\t\tlet beforeModelNode;\n\t\t\tlet afterModelNode;\n\t\t\tlet afterAgentNode;\n\t\t\tconst m = middleware[i];\n\t\t\tif (middlewareNames.has(m.name)) throw new Error(`Middleware ${m.name} is defined multiple times`);\n\t\t\tmiddlewareNames.add(m.name);\n\t\t\tif (m.beforeAgent) {\n\t\t\t\tbeforeAgentNode = new _nodes_BeforeAgentNode_js__WEBPACK_IMPORTED_MODULE_6__.BeforeAgentNode(m, { getState: () => this.#stateManager.getState(m.name) });\n\t\t\t\tthis.#stateManager.addNode(m, beforeAgentNode);\n\t\t\t\tconst name = `${m.name}.before_agent`;\n\t\t\t\tbeforeAgentNodes.push({\n\t\t\t\t\tindex: i,\n\t\t\t\t\tname,\n\t\t\t\t\tallowed: (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_5__.getHookConstraint)(m.beforeAgent)\n\t\t\t\t});\n\t\t\t\tallNodeWorkflows.addNode(name, beforeAgentNode, beforeAgentNode.nodeOptions);\n\t\t\t}\n\t\t\tif (m.beforeModel) {\n\t\t\t\tbeforeModelNode = new _nodes_BeforeModelNode_js__WEBPACK_IMPORTED_MODULE_7__.BeforeModelNode(m, { getState: () => this.#stateManager.getState(m.name) });\n\t\t\t\tthis.#stateManager.addNode(m, beforeModelNode);\n\t\t\t\tconst name = `${m.name}.before_model`;\n\t\t\t\tbeforeModelNodes.push({\n\t\t\t\t\tindex: i,\n\t\t\t\t\tname,\n\t\t\t\t\tallowed: (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_5__.getHookConstraint)(m.beforeModel)\n\t\t\t\t});\n\t\t\t\tallNodeWorkflows.addNode(name, beforeModelNode, beforeModelNode.nodeOptions);\n\t\t\t}\n\t\t\tif (m.afterModel) {\n\t\t\t\tafterModelNode = new _nodes_AfterModelNode_js__WEBPACK_IMPORTED_MODULE_8__.AfterModelNode(m, { getState: () => this.#stateManager.getState(m.name) });\n\t\t\t\tthis.#stateManager.addNode(m, afterModelNode);\n\t\t\t\tconst name = `${m.name}.after_model`;\n\t\t\t\tafterModelNodes.push({\n\t\t\t\t\tindex: i,\n\t\t\t\t\tname,\n\t\t\t\t\tallowed: (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_5__.getHookConstraint)(m.afterModel)\n\t\t\t\t});\n\t\t\t\tallNodeWorkflows.addNode(name, afterModelNode, afterModelNode.nodeOptions);\n\t\t\t}\n\t\t\tif (m.afterAgent) {\n\t\t\t\tafterAgentNode = new _nodes_AfterAgentNode_js__WEBPACK_IMPORTED_MODULE_9__.AfterAgentNode(m, { getState: () => this.#stateManager.getState(m.name) });\n\t\t\t\tthis.#stateManager.addNode(m, afterAgentNode);\n\t\t\t\tconst name = `${m.name}.after_agent`;\n\t\t\t\tafterAgentNodes.push({\n\t\t\t\t\tindex: i,\n\t\t\t\t\tname,\n\t\t\t\t\tallowed: (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_5__.getHookConstraint)(m.afterAgent)\n\t\t\t\t});\n\t\t\t\tallNodeWorkflows.addNode(name, afterAgentNode, afterAgentNode.nodeOptions);\n\t\t\t}\n\t\t\tif (m.wrapModelCall) wrapModelCallHookMiddleware.push([m, () => this.#stateManager.getState(m.name)]);\n\t\t}\n\t\t/**\n\t\t* Add Nodes\n\t\t*/\n\t\tallNodeWorkflows.addNode(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME, this.#agentNode);\n\t\t/**\n\t\t* Check if any middleware has wrapToolCall defined.\n\t\t* If so, we need to create a ToolNode even without pre-registered tools\n\t\t* to allow middleware to handle dynamically registered tools.\n\t\t*/\n\t\tconst hasWrapToolCallMiddleware = middleware.some((m) => m.wrapToolCall);\n\t\tconst clientTools = toolClasses.filter(_utils_js__WEBPACK_IMPORTED_MODULE_1__.isClientTool);\n\t\t/**\n\t\t* Create ToolNode if we have client-side tools OR if middleware defines wrapToolCall\n\t\t* (which may handle dynamically registered tools)\n\t\t*/\n\t\tif (clientTools.length > 0 || hasWrapToolCallMiddleware) {\n\t\t\tconst toolNode = new _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.ToolNode(clientTools, {\n\t\t\t\tsignal: this.options.signal,\n\t\t\t\twrapToolCall: (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.wrapToolCall)(middleware)\n\t\t\t});\n\t\t\tallNodeWorkflows.addNode(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME, toolNode);\n\t\t}\n\t\t/**\n\t\t* Add Edges\n\t\t*/\n\t\tlet entryNode;\n\t\tif (beforeAgentNodes.length > 0) entryNode = beforeAgentNodes[0].name;\n\t\telse if (beforeModelNodes.length > 0) entryNode = beforeModelNodes[0].name;\n\t\telse entryNode = _nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME;\n\t\tconst loopEntryNode = beforeModelNodes.length > 0 ? beforeModelNodes[0].name : _nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME;\n\t\tconst exitNode = afterAgentNodes.length > 0 ? afterAgentNodes[afterAgentNodes.length - 1].name : _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END;\n\t\tallNodeWorkflows.addEdge(_langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.START, entryNode);\n\t\t/**\n\t\t* Determine if we have tools available for routing.\n\t\t* This includes both registered client tools AND dynamic tools via middleware.\n\t\t*/\n\t\tconst hasToolsAvailable = clientTools.length > 0 || hasWrapToolCallMiddleware;\n\t\tfor (let i = 0; i < beforeAgentNodes.length; i++) {\n\t\t\tconst node = beforeAgentNodes[i];\n\t\t\tconst current = node.name;\n\t\t\tconst nextDefault = i === beforeAgentNodes.length - 1 ? loopEntryNode : beforeAgentNodes[i + 1].name;\n\t\t\tif (node.allowed && node.allowed.length > 0) {\n\t\t\t\tconst allowedMapped = node.allowed.map((t) => (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(t)).filter((dest) => dest !== _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME || hasToolsAvailable);\n\t\t\t\tconst destinations = Array.from(new Set([nextDefault, ...allowedMapped.map((dest) => dest === _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END ? exitNode : dest)]));\n\t\t\t\tallNodeWorkflows.addConditionalEdges(current, this.#createBeforeAgentRouter(clientTools, nextDefault, exitNode, hasToolsAvailable), destinations);\n\t\t\t} else allNodeWorkflows.addEdge(current, nextDefault);\n\t\t}\n\t\tfor (let i = 0; i < beforeModelNodes.length; i++) {\n\t\t\tconst node = beforeModelNodes[i];\n\t\t\tconst current = node.name;\n\t\t\tconst nextDefault = i === beforeModelNodes.length - 1 ? _nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME : beforeModelNodes[i + 1].name;\n\t\t\tif (node.allowed && node.allowed.length > 0) {\n\t\t\t\tconst allowedMapped = node.allowed.map((t) => (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(t)).filter((dest) => dest !== _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME || hasToolsAvailable);\n\t\t\t\tconst destinations = Array.from(new Set([nextDefault, ...allowedMapped]));\n\t\t\t\tallNodeWorkflows.addConditionalEdges(current, this.#createBeforeModelRouter(clientTools, nextDefault, hasToolsAvailable), destinations);\n\t\t\t} else allNodeWorkflows.addEdge(current, nextDefault);\n\t\t}\n\t\tconst lastAfterModelNode = afterModelNodes.at(-1);\n\t\tif (afterModelNodes.length > 0 && lastAfterModelNode) allNodeWorkflows.addEdge(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME, lastAfterModelNode.name);\n\t\telse {\n\t\t\tconst destinations = this.#getModelPaths(clientTools, false, hasToolsAvailable).map((p) => p === _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END ? exitNode : p);\n\t\t\tif (destinations.length === 1) allNodeWorkflows.addEdge(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME, destinations[0]);\n\t\t\telse allNodeWorkflows.addConditionalEdges(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME, this.#createModelRouter(exitNode), destinations);\n\t\t}\n\t\tfor (let i = afterModelNodes.length - 1; i > 0; i--) {\n\t\t\tconst node = afterModelNodes[i];\n\t\t\tconst current = node.name;\n\t\t\tconst nextDefault = afterModelNodes[i - 1].name;\n\t\t\tif (node.allowed && node.allowed.length > 0) {\n\t\t\t\tconst allowedMapped = node.allowed.map((t) => (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(t)).filter((dest) => dest !== _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME || hasToolsAvailable);\n\t\t\t\tconst destinations = Array.from(new Set([nextDefault, ...allowedMapped]));\n\t\t\t\tallNodeWorkflows.addConditionalEdges(current, this.#createAfterModelSequenceRouter(clientTools, node.allowed, nextDefault, hasToolsAvailable), destinations);\n\t\t\t} else allNodeWorkflows.addEdge(current, nextDefault);\n\t\t}\n\t\tif (afterModelNodes.length > 0) {\n\t\t\tconst firstAfterModel = afterModelNodes[0];\n\t\t\tconst firstAfterModelNode = firstAfterModel.name;\n\t\t\tconst modelPaths = this.#getModelPaths(clientTools, true, hasToolsAvailable).filter((p) => p !== _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME || hasToolsAvailable);\n\t\t\tconst allowJump = Boolean(firstAfterModel.allowed && firstAfterModel.allowed.length > 0);\n\t\t\tconst destinations = modelPaths.map((p) => p === _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END ? exitNode : p);\n\t\t\tallNodeWorkflows.addConditionalEdges(firstAfterModelNode, this.#createAfterModelRouter(clientTools, allowJump, exitNode, hasToolsAvailable), destinations);\n\t\t}\n\t\tfor (let i = afterAgentNodes.length - 1; i > 0; i--) {\n\t\t\tconst node = afterAgentNodes[i];\n\t\t\tconst current = node.name;\n\t\t\tconst nextDefault = afterAgentNodes[i - 1].name;\n\t\t\tif (node.allowed && node.allowed.length > 0) {\n\t\t\t\tconst allowedMapped = node.allowed.map((t) => (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(t)).filter((dest) => dest !== _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME || hasToolsAvailable);\n\t\t\t\tconst destinations = Array.from(new Set([nextDefault, ...allowedMapped]));\n\t\t\t\tallNodeWorkflows.addConditionalEdges(current, this.#createAfterModelSequenceRouter(clientTools, node.allowed, nextDefault, hasToolsAvailable), destinations);\n\t\t\t} else allNodeWorkflows.addEdge(current, nextDefault);\n\t\t}\n\t\tif (afterAgentNodes.length > 0) {\n\t\t\tconst firstAfterAgent = afterAgentNodes[0];\n\t\t\tconst firstAfterAgentNode = firstAfterAgent.name;\n\t\t\tif (firstAfterAgent.allowed && firstAfterAgent.allowed.length > 0) {\n\t\t\t\tconst allowedMapped = firstAfterAgent.allowed.map((t) => (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(t)).filter((dest) => dest !== _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME || hasToolsAvailable);\n\t\t\t\t/**\n\t\t\t\t* For after_agent, only use explicitly allowed destinations (don't add loopEntryNode)\n\t\t\t\t* The default destination (when no jump occurs) should be END\n\t\t\t\t*/\n\t\t\t\tconst destinations = Array.from(new Set([_langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END, ...allowedMapped]));\n\t\t\t\tallNodeWorkflows.addConditionalEdges(firstAfterAgentNode, this.#createAfterModelSequenceRouter(clientTools, firstAfterAgent.allowed, _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END, hasToolsAvailable), destinations);\n\t\t\t} else allNodeWorkflows.addEdge(firstAfterAgentNode, _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END);\n\t\t}\n\t\t/**\n\t\t* add edges for tools node (includes both registered tools and dynamic tools via middleware)\n\t\t*/\n\t\tif (hasToolsAvailable) {\n\t\t\tconst toolReturnTarget = loopEntryNode;\n\t\t\tif (shouldReturnDirect.size > 0) allNodeWorkflows.addConditionalEdges(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME, this.#createToolsRouter(shouldReturnDirect, exitNode), [toolReturnTarget, exitNode]);\n\t\t\telse allNodeWorkflows.addEdge(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME, toolReturnTarget);\n\t\t}\n\t\t/**\n\t\t* compile the graph\n\t\t*/\n\t\tthis.#graph = allNodeWorkflows.compile({\n\t\t\tcheckpointer: this.options.checkpointer,\n\t\t\tstore: this.options.store,\n\t\t\tname: this.options.name,\n\t\t\tdescription: this.options.description\n\t\t});\n\t}\n\t/**\n\t* Get the compiled {@link https://docs.langchain.com/oss/javascript/langgraph/use-graph-api | StateGraph}.\n\t*/\n\tget graph() {\n\t\treturn this.#graph;\n\t}\n\t/**\n\t* Creates a new ReactAgent with the given config merged into the existing config.\n\t* Follows the same pattern as LangGraph's Pregel.withConfig().\n\t*\n\t* The merged config is applied as a default that gets merged with any config\n\t* passed at invocation time (invoke/stream). Invocation-time config takes precedence.\n\t*\n\t* @param config - Configuration to merge with existing config\n\t* @returns A new ReactAgent instance with the merged configuration\n\t*\n\t* @example\n\t* ```typescript\n\t* const agent = createAgent({ model: \"gpt-4o\", tools: [...] });\n\t*\n\t* // Set a default recursion limit\n\t* const configuredAgent = agent.withConfig({ recursionLimit: 1000 });\n\t*\n\t* // Chain multiple configs\n\t* const debugAgent = agent\n\t*   .withConfig({ recursionLimit: 1000 })\n\t*   .withConfig({ tags: [\"debug\"] });\n\t* ```\n\t*/\n\twithConfig(config) {\n\t\treturn new ReactAgent(this.options, (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_12__.mergeConfigs)(this.#defaultConfig, config));\n\t}\n\t/**\n\t* Get possible edge destinations from model node.\n\t* @param toolClasses names of tools to call\n\t* @param includeModelRequest whether to include \"model_request\" as a valid path (for jumpTo routing)\n\t* @param hasToolsAvailable whether tools are available (includes dynamic tools via middleware)\n\t* @returns list of possible edge destinations\n\t*/\n\t#getModelPaths(toolClasses, includeModelRequest = false, hasToolsAvailable = toolClasses.length > 0) {\n\t\tconst paths = [];\n\t\tif (hasToolsAvailable) paths.push(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME);\n\t\tif (includeModelRequest) paths.push(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME);\n\t\tpaths.push(_langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END);\n\t\treturn paths;\n\t}\n\t/**\n\t* Create routing function for tools node conditional edges.\n\t*/\n\t#createToolsRouter(shouldReturnDirect, exitNode) {\n\t\treturn (state) => {\n\t\t\tconst messages = state.messages;\n\t\t\tconst lastMessage = messages[messages.length - 1];\n\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_11__.ToolMessage.isInstance(lastMessage) && lastMessage.name && shouldReturnDirect.has(lastMessage.name)) return this.options.responseFormat ? _nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME : exitNode;\n\t\t\treturn _nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME;\n\t\t};\n\t}\n\t/**\n\t* Create routing function for model node conditional edges.\n\t* @param exitNode - The exit node to route to (could be after_agent or END)\n\t*/\n\t#createModelRouter(exitNode = _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END) {\n\t\t/**\n\t\t* determine if the agent should continue or not\n\t\t*/\n\t\treturn (state) => {\n\t\t\tconst lastMessage = state.messages.at(-1);\n\t\t\tif (!_langchain_core_messages__WEBPACK_IMPORTED_MODULE_11__.AIMessage.isInstance(lastMessage) || !lastMessage.tool_calls || lastMessage.tool_calls.length === 0) return exitNode;\n\t\t\tif (lastMessage.tool_calls.every((toolCall) => toolCall.name.startsWith(\"extract-\"))) return exitNode;\n\t\t\t/**\n\t\t\t* The tool node processes a single message.\n\t\t\t*/\n\t\t\tif (this.#toolBehaviorVersion === \"v1\") return _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME;\n\t\t\t/**\n\t\t\t* Route to tools node (filter out any structured response tool calls)\n\t\t\t*/\n\t\t\tconst regularToolCalls = lastMessage.tool_calls.filter((toolCall) => !toolCall.name.startsWith(\"extract-\"));\n\t\t\tif (regularToolCalls.length === 0) return exitNode;\n\t\t\treturn regularToolCalls.map((toolCall) => new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME, {\n\t\t\t\t...state,\n\t\t\t\tlg_tool_call: toolCall\n\t\t\t}));\n\t\t};\n\t}\n\t/**\n\t* Create routing function for jumpTo functionality after afterModel hooks.\n\t*\n\t* This router checks if the `jumpTo` property is set in the state after afterModel middleware\n\t* execution. If set, it routes to the specified target (\"model_request\" or \"tools\").\n\t* If not set, it falls back to the normal model routing logic for afterModel context.\n\t*\n\t* The jumpTo property is automatically cleared after use to prevent infinite loops.\n\t*\n\t* @param toolClasses - Available tool classes for validation\n\t* @param allowJump - Whether jumping is allowed\n\t* @param exitNode - The exit node to route to (could be after_agent or END)\n\t* @param hasToolsAvailable - Whether tools are available (includes dynamic tools via middleware)\n\t* @returns Router function that handles jumpTo logic and normal routing\n\t*/\n\t#createAfterModelRouter(toolClasses, allowJump, exitNode, hasToolsAvailable = toolClasses.length > 0) {\n\t\tconst hasStructuredResponse = Boolean(this.options.responseFormat);\n\t\treturn (state) => {\n\t\t\tconst builtInState = state;\n\t\t\tconst messages = builtInState.messages;\n\t\t\tconst lastMessage = messages.at(-1);\n\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_11__.AIMessage.isInstance(lastMessage) && (!lastMessage.tool_calls || lastMessage.tool_calls.length === 0)) return exitNode;\n\t\t\tif (allowJump && builtInState.jumpTo) {\n\t\t\t\tconst destination = (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(builtInState.jumpTo);\n\t\t\t\tif (destination === _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END) return exitNode;\n\t\t\t\tif (destination === _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME) {\n\t\t\t\t\tif (!hasToolsAvailable) return exitNode;\n\t\t\t\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME, {\n\t\t\t\t\t\t...state,\n\t\t\t\t\t\tjumpTo: void 0\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME, {\n\t\t\t\t\t...state,\n\t\t\t\t\tjumpTo: void 0\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst toolMessages = messages.filter(_langchain_core_messages__WEBPACK_IMPORTED_MODULE_11__.ToolMessage.isInstance);\n\t\t\tconst lastAiMessage = messages.filter(_langchain_core_messages__WEBPACK_IMPORTED_MODULE_11__.AIMessage.isInstance).at(-1);\n\t\t\tconst pendingToolCalls = lastAiMessage?.tool_calls?.filter((call) => !toolMessages.some((m) => m.tool_call_id === call.id));\n\t\t\tif (pendingToolCalls && pendingToolCalls.length > 0) return pendingToolCalls.map((toolCall) => new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME, {\n\t\t\t\t...state,\n\t\t\t\tlg_tool_call: toolCall\n\t\t\t}));\n\t\t\tconst hasStructuredResponseCalls = lastAiMessage?.tool_calls?.some((toolCall) => toolCall.name.startsWith(\"extract-\"));\n\t\t\tif (pendingToolCalls && pendingToolCalls.length === 0 && !hasStructuredResponseCalls && hasStructuredResponse) return _nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME;\n\t\t\tif (!_langchain_core_messages__WEBPACK_IMPORTED_MODULE_11__.AIMessage.isInstance(lastMessage) || !lastMessage.tool_calls || lastMessage.tool_calls.length === 0) return exitNode;\n\t\t\tconst hasOnlyStructuredResponseCalls = lastMessage.tool_calls.every((toolCall) => toolCall.name.startsWith(\"extract-\"));\n\t\t\tconst hasRegularToolCalls = lastMessage.tool_calls.some((toolCall) => !toolCall.name.startsWith(\"extract-\"));\n\t\t\tif (hasOnlyStructuredResponseCalls || !hasRegularToolCalls) return exitNode;\n\t\t\t/**\n\t\t\t* For routing from afterModel nodes, always use simple string paths\n\t\t\t* The Send API is handled at the model_request node level\n\t\t\t*/\n\t\t\treturn _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME;\n\t\t};\n\t}\n\t/**\n\t* Router for afterModel sequence nodes (connecting later middlewares to earlier ones),\n\t* honoring allowed jump targets and defaulting to the next node.\n\t* @param toolClasses - Available tool classes for validation\n\t* @param allowed - List of allowed jump targets\n\t* @param nextDefault - Default node to route to\n\t* @param hasToolsAvailable - Whether tools are available (includes dynamic tools via middleware)\n\t*/\n\t#createAfterModelSequenceRouter(toolClasses, allowed, nextDefault, hasToolsAvailable = toolClasses.length > 0) {\n\t\tconst allowedSet = new Set(allowed.map((t) => (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(t)));\n\t\treturn (state) => {\n\t\t\tconst builtInState = state;\n\t\t\tif (builtInState.jumpTo) {\n\t\t\t\tconst dest = (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(builtInState.jumpTo);\n\t\t\t\tif (dest === _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END && allowedSet.has(_langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END)) return _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END;\n\t\t\t\tif (dest === _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME && allowedSet.has(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME)) {\n\t\t\t\t\tif (!hasToolsAvailable) return _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END;\n\t\t\t\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME, {\n\t\t\t\t\t\t...state,\n\t\t\t\t\t\tjumpTo: void 0\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (dest === _nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME && allowedSet.has(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME)) return new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME, {\n\t\t\t\t\t...state,\n\t\t\t\t\tjumpTo: void 0\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn nextDefault;\n\t\t};\n\t}\n\t/**\n\t* Create routing function for jumpTo functionality after beforeAgent hooks.\n\t* Falls back to the default next node if no jumpTo is present.\n\t* When jumping to END, routes to exitNode (which could be an afterAgent node).\n\t* @param toolClasses - Available tool classes for validation\n\t* @param nextDefault - Default node to route to\n\t* @param exitNode - Exit node to route to (could be after_agent or END)\n\t* @param hasToolsAvailable - Whether tools are available (includes dynamic tools via middleware)\n\t*/\n\t#createBeforeAgentRouter(toolClasses, nextDefault, exitNode, hasToolsAvailable = toolClasses.length > 0) {\n\t\treturn (state) => {\n\t\t\tconst builtInState = state;\n\t\t\tif (!builtInState.jumpTo) return nextDefault;\n\t\t\tconst destination = (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(builtInState.jumpTo);\n\t\t\tif (destination === _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END)\n /**\n\t\t\t* When beforeAgent jumps to END, route to exitNode (first afterAgent node)\n\t\t\t*/\n\t\t\treturn exitNode;\n\t\t\tif (destination === _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME) {\n\t\t\t\tif (!hasToolsAvailable) return exitNode;\n\t\t\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME, {\n\t\t\t\t\t...state,\n\t\t\t\t\tjumpTo: void 0\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME, {\n\t\t\t\t...state,\n\t\t\t\tjumpTo: void 0\n\t\t\t});\n\t\t};\n\t}\n\t/**\n\t* Create routing function for jumpTo functionality after beforeModel hooks.\n\t* Falls back to the default next node if no jumpTo is present.\n\t* @param toolClasses - Available tool classes for validation\n\t* @param nextDefault - Default node to route to\n\t* @param hasToolsAvailable - Whether tools are available (includes dynamic tools via middleware)\n\t*/\n\t#createBeforeModelRouter(toolClasses, nextDefault, hasToolsAvailable = toolClasses.length > 0) {\n\t\treturn (state) => {\n\t\t\tconst builtInState = state;\n\t\t\tif (!builtInState.jumpTo) return nextDefault;\n\t\t\tconst destination = (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.parseJumpToTarget)(builtInState.jumpTo);\n\t\t\tif (destination === _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END) return _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END;\n\t\t\tif (destination === _nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME) {\n\t\t\t\tif (!hasToolsAvailable) return _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.END;\n\t\t\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_ToolNode_js__WEBPACK_IMPORTED_MODULE_4__.TOOLS_NODE_NAME, {\n\t\t\t\t\t...state,\n\t\t\t\t\tjumpTo: void 0\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Send(_nodes_AgentNode_js__WEBPACK_IMPORTED_MODULE_3__.AGENT_NODE_NAME, {\n\t\t\t\t...state,\n\t\t\t\tjumpTo: void 0\n\t\t\t});\n\t\t};\n\t}\n\t/**\n\t* Initialize middleware states if not already present in the input state.\n\t*/\n\tasync #initializeMiddlewareStates(state, config) {\n\t\tif (!this.options.middleware || this.options.middleware.length === 0 || state instanceof _langchain_langgraph__WEBPACK_IMPORTED_MODULE_13__.Command || !state) return state;\n\t\tconst defaultStates = await (0,_nodes_utils_js__WEBPACK_IMPORTED_MODULE_2__.initializeMiddlewareStates)(this.options.middleware, state);\n\t\tconst updatedState = {\n\t\t\t...(await this.#graph.getState(config).catch(() => ({ values: {} }))).values,\n\t\t\t...state\n\t\t};\n\t\tif (!updatedState) return updatedState;\n\t\tfor (const [key, value] of Object.entries(defaultStates)) if (!(key in updatedState)) updatedState[key] = value;\n\t\treturn updatedState;\n\t}\n\t/**\n\t* Executes the agent with the given state and returns the final state after all processing.\n\t*\n\t* This method runs the agent's entire workflow synchronously, including:\n\t* - Processing the input messages through any configured middleware\n\t* - Calling the language model to generate responses\n\t* - Executing any tool calls made by the model\n\t* - Running all middleware hooks (beforeModel, afterModel, etc.)\n\t*\n\t* @param state - The initial state for the agent execution. Can be:\n\t*   - An object containing `messages` array and any middleware-specific state properties\n\t*   - A Command object for more advanced control flow\n\t*\n\t* @param config - Optional runtime configuration including:\n\t* @param config.context - The context for the agent execution.\n\t* @param config.configurable - LangGraph configuration options like `thread_id`, `run_id`, etc.\n\t* @param config.store - The store for the agent execution for persisting state, see more in {@link https://docs.langchain.com/oss/javascript/langgraph/memory#memory-storage | Memory storage}.\n\t* @param config.signal - An optional {@link https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal | `AbortSignal`} for the agent execution.\n\t* @param config.recursionLimit - The recursion limit for the agent execution.\n\t*\n\t* @returns A Promise that resolves to the final agent state after execution completes.\n\t*          The returned state includes:\n\t*          - a `messages` property containing an array with all messages (input, AI responses, tool calls/results)\n\t*          - a `structuredResponse` property containing the structured response (if configured)\n\t*          - all state values defined in the middleware\n\t*\n\t* @example\n\t* ```typescript\n\t* const agent = new ReactAgent({\n\t*   llm: myModel,\n\t*   tools: [calculator, webSearch],\n\t*   responseFormat: z.object({\n\t*     weather: z.string(),\n\t*   }),\n\t* });\n\t*\n\t* const result = await agent.invoke({\n\t*   messages: [{ role: \"human\", content: \"What's the weather in Paris?\" }]\n\t* });\n\t*\n\t* console.log(result.structuredResponse.weather); // outputs: \"It's sunny and 75Â°F.\"\n\t* ```\n\t*/\n\tasync invoke(state, config) {\n\t\tconst mergedConfig = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_12__.mergeConfigs)(this.#defaultConfig, config);\n\t\tconst initializedState = await this.#initializeMiddlewareStates(state, mergedConfig);\n\t\treturn this.#graph.invoke(initializedState, mergedConfig);\n\t}\n\t/**\n\t* Executes the agent with streaming, returning an async iterable of state updates as they occur.\n\t*\n\t* This method runs the agent's workflow similar to `invoke`, but instead of waiting for\n\t* completion, it streams high-level state updates in real-time. This allows you to:\n\t* - Display intermediate results to users as they're generated\n\t* - Monitor the agent's progress through each step\n\t* - React to state changes as nodes complete\n\t*\n\t* For more granular event-level streaming (like individual LLM tokens), use `streamEvents` instead.\n\t*\n\t* @param state - The initial state for the agent execution. Can be:\n\t*   - An object containing `messages` array and any middleware-specific state properties\n\t*   - A Command object for more advanced control flow\n\t*\n\t* @param config - Optional runtime configuration including:\n\t* @param config.context - The context for the agent execution.\n\t* @param config.configurable - LangGraph configuration options like `thread_id`, `run_id`, etc.\n\t* @param config.store - The store for the agent execution for persisting state, see more in {@link https://docs.langchain.com/oss/javascript/langgraph/memory#memory-storage | Memory storage}.\n\t* @param config.signal - An optional {@link https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal | `AbortSignal`} for the agent execution.\n\t* @param config.streamMode - The streaming mode for the agent execution, see more in {@link https://docs.langchain.com/oss/javascript/langgraph/streaming#supported-stream-modes | Supported stream modes}.\n\t* @param config.recursionLimit - The recursion limit for the agent execution.\n\t*\n\t* @returns A Promise that resolves to an IterableReadableStream of state updates.\n\t*          Each update contains the current state after a node completes.\n\t*\n\t* @example\n\t* ```typescript\n\t* const agent = new ReactAgent({\n\t*   llm: myModel,\n\t*   tools: [calculator, webSearch]\n\t* });\n\t*\n\t* const stream = await agent.stream({\n\t*   messages: [{ role: \"human\", content: \"What's 2+2 and the weather in NYC?\" }]\n\t* });\n\t*\n\t* for await (const chunk of stream) {\n\t*   console.log(chunk); // State update from each node\n\t* }\n\t* ```\n\t*/\n\tasync stream(state, config) {\n\t\tconst mergedConfig = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_12__.mergeConfigs)(this.#defaultConfig, config);\n\t\tconst initializedState = await this.#initializeMiddlewareStates(state, mergedConfig);\n\t\treturn this.#graph.stream(initializedState, mergedConfig);\n\t}\n\t/**\n\t* Visualize the graph as a PNG image.\n\t* @param params - Parameters for the drawMermaidPng method.\n\t* @param params.withStyles - Whether to include styles in the graph.\n\t* @param params.curveStyle - The style of the graph's curves.\n\t* @param params.nodeColors - The colors of the graph's nodes.\n\t* @param params.wrapLabelNWords - The maximum number of words to wrap in a node's label.\n\t* @param params.backgroundColor - The background color of the graph.\n\t* @returns PNG image as a buffer\n\t*/\n\tasync drawMermaidPng(params) {\n\t\tconst arrayBuffer = await (await (await this.#graph.getGraphAsync()).drawMermaidPng(params)).arrayBuffer();\n\t\treturn new Uint8Array(arrayBuffer);\n\t}\n\t/**\n\t* Draw the graph as a Mermaid string.\n\t* @param params - Parameters for the drawMermaid method.\n\t* @param params.withStyles - Whether to include styles in the graph.\n\t* @param params.curveStyle - The style of the graph's curves.\n\t* @param params.nodeColors - The colors of the graph's nodes.\n\t* @param params.wrapLabelNWords - The maximum number of words to wrap in a node's label.\n\t* @param params.backgroundColor - The background color of the graph.\n\t* @returns Mermaid string\n\t*/\n\tasync drawMermaid(params) {\n\t\treturn (await this.#graph.getGraphAsync()).drawMermaid(params);\n\t}\n\t/**\n\t* The following are internal methods to enable support for LangGraph Platform.\n\t* They are not part of the createAgent public API.\n\t*\n\t* Note: we intentionally return as `never` to avoid type errors due to type inference.\n\t*/\n\t/**\n\t* @internal\n\t*/\n\tstreamEvents(state, config, streamOptions) {\n\t\tconst mergedConfig = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_12__.mergeConfigs)(this.#defaultConfig, config);\n\t\treturn this.#graph.streamEvents(state, {\n\t\t\t...mergedConfig,\n\t\t\tversion: config?.version ?? \"v2\"\n\t\t}, streamOptions);\n\t}\n\t/**\n\t* @internal\n\t*/\n\tgetGraphAsync(config) {\n\t\treturn this.#graph.getGraphAsync(config);\n\t}\n\t/**\n\t* @internal\n\t*/\n\tgetState(config, options) {\n\t\treturn this.#graph.getState(config, options);\n\t}\n\t/**\n\t* @internal\n\t*/\n\tgetStateHistory(config, options) {\n\t\treturn this.#graph.getStateHistory(config, options);\n\t}\n\t/**\n\t* @internal\n\t*/\n\tgetSubgraphs(namespace, recurse) {\n\t\treturn this.#graph.getSubgraphs(namespace, recurse);\n\t}\n\t/**\n\t* @internal\n\t*/\n\tgetSubgraphAsync(namespace, recurse) {\n\t\treturn this.#graph.getSubgraphsAsync(namespace, recurse);\n\t}\n\t/**\n\t* @internal\n\t*/\n\tupdateState(inputConfig, values, asNode) {\n\t\treturn this.#graph.updateState(inputConfig, values, asNode);\n\t}\n\t/**\n\t* @internal\n\t*/\n\tget builder() {\n\t\treturn this.#graph.builder;\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=ReactAgent.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvUmVhY3RBZ2VudC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBbUQ7QUFDd0Q7QUFDMUI7QUFDZjtBQUNGO0FBQ047QUFDRztBQUNBO0FBQ0Y7QUFDQTtBQUNqQjtBQUN3QjtBQUNUO0FBQ29COztBQUU3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sY0FBYztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsS0FBSztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsb0RBQVk7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsd0VBQVksd0JBQXdCLFlBQVksK0JBQStCO0FBQ3pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMscUVBQTBCO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxtREFBWTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsdUJBQXVCLEVBQUUsZ0VBQWdCO0FBQ25ELCtCQUErQiw2REFBVTtBQUN6QztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwREFBUztBQUNqQztBQUNBLGtCQUFrQixnRUFBcUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0Esa0JBQWtCLHVCQUF1QjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLFFBQVE7QUFDMUU7QUFDQTtBQUNBLDBCQUEwQixzRUFBZSxNQUFNLHFEQUFxRDtBQUNwRztBQUNBLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLGNBQWMsdUVBQWlCO0FBQy9CLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0VBQWUsTUFBTSxxREFBcUQ7QUFDcEc7QUFDQSxvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQSxjQUFjLHVFQUFpQjtBQUMvQixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLG9FQUFjLE1BQU0scURBQXFEO0FBQ2xHO0FBQ0Esb0JBQW9CLE9BQU87QUFDM0I7QUFDQTtBQUNBO0FBQ0EsY0FBYyx1RUFBaUI7QUFDL0IsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixvRUFBYyxNQUFNLHFEQUFxRDtBQUNsRztBQUNBLG9CQUFvQixPQUFPO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLGNBQWMsdUVBQWlCO0FBQy9CLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixnRUFBZTtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsbURBQVk7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3REFBUTtBQUNoQztBQUNBLGtCQUFrQix1REFBWTtBQUM5QixJQUFJO0FBQ0osNEJBQTRCLCtEQUFlO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGdFQUFlO0FBQ2xDLGlGQUFpRixnRUFBZTtBQUNoRyxtR0FBbUcsc0RBQUc7QUFDdEcsMkJBQTJCLHdEQUFLO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNkJBQTZCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELGtFQUFpQiwrQkFBK0IsK0RBQWU7QUFDakgsa0dBQWtHLHNEQUFHO0FBQ3JHO0FBQ0EsS0FBSztBQUNMO0FBQ0Esa0JBQWtCLDZCQUE2QjtBQUMvQztBQUNBO0FBQ0EsMkRBQTJELGdFQUFlO0FBQzFFO0FBQ0Esa0RBQWtELGtFQUFpQiwrQkFBK0IsK0RBQWU7QUFDakg7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsaUZBQWlGLGdFQUFlO0FBQ2hHO0FBQ0Esb0dBQW9HLHNEQUFHO0FBQ3ZHLDJEQUEyRCxnRUFBZTtBQUMxRSw2Q0FBNkMsZ0VBQWU7QUFDNUQ7QUFDQSwyQ0FBMkMsT0FBTztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxrRUFBaUIsK0JBQStCLCtEQUFlO0FBQ2pIO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvR0FBb0csK0RBQWU7QUFDbkg7QUFDQSxvREFBb0Qsc0RBQUc7QUFDdkQ7QUFDQTtBQUNBLDJDQUEyQyxPQUFPO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELGtFQUFpQiwrQkFBK0IsK0RBQWU7QUFDakg7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELGtFQUFpQiwrQkFBK0IsK0RBQWU7QUFDNUg7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsc0RBQUc7QUFDaEQseUlBQXlJLHNEQUFHO0FBQzVJLEtBQUssbURBQW1ELHNEQUFHO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlFQUF5RSwrREFBZTtBQUN4RixpQ0FBaUMsK0RBQWU7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxxQkFBcUIscUZBQXFGO0FBQzFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLCtCQUErQjtBQUM5RDtBQUNBO0FBQ0EsOENBQThDLHNCQUFzQjtBQUNwRTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsc0JBQXNCO0FBQ3pDLG1CQUFtQixpQkFBaUI7QUFDcEM7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLHdFQUFZO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLCtEQUFlO0FBQ25ELHNDQUFzQyxnRUFBZTtBQUNyRCxhQUFhLHNEQUFHO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sa0VBQVcsK0hBQStILGdFQUFlO0FBQ2hLLFVBQVUsZ0VBQWU7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHNEQUFHO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGdFQUFTO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELCtEQUFlO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsdURBQUksQ0FBQywrREFBZTtBQUNyRTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLGdFQUFTO0FBQ2hCO0FBQ0Esd0JBQXdCLGtFQUFpQjtBQUN6Qyx3QkFBd0Isc0RBQUc7QUFDM0Isd0JBQXdCLCtEQUFlO0FBQ3ZDO0FBQ0EsZ0JBQWdCLHVEQUFJLENBQUMsK0RBQWU7QUFDcEM7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLGVBQWUsdURBQUksQ0FBQyxnRUFBZTtBQUNuQztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esd0NBQXdDLGtFQUFXO0FBQ25ELHlDQUF5QyxnRUFBUztBQUNsRDtBQUNBLHNHQUFzRyx1REFBSSxDQUFDLCtEQUFlO0FBQzFIO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSx5SEFBeUgsZ0VBQWU7QUFDeEksUUFBUSxnRUFBUztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsK0RBQWU7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxrRUFBaUI7QUFDakU7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGtFQUFpQjtBQUNsQyxpQkFBaUIsc0RBQUcsbUJBQW1CLHNEQUFHLFVBQVUsc0RBQUc7QUFDdkQsaUJBQWlCLCtEQUFlLG1CQUFtQiwrREFBZTtBQUNsRSxvQ0FBb0Msc0RBQUc7QUFDdkMsZ0JBQWdCLHVEQUFJLENBQUMsK0RBQWU7QUFDcEM7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLGlCQUFpQixnRUFBZSxtQkFBbUIsZ0VBQWUsY0FBYyx1REFBSSxDQUFDLGdFQUFlO0FBQ3BHO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixrRUFBaUI7QUFDeEMsdUJBQXVCLHNEQUFHO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLCtEQUFlO0FBQ3RDO0FBQ0EsZUFBZSx1REFBSSxDQUFDLCtEQUFlO0FBQ25DO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxjQUFjLHVEQUFJLENBQUMsZ0VBQWU7QUFDbEM7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixrRUFBaUI7QUFDeEMsdUJBQXVCLHNEQUFHLFNBQVMsc0RBQUc7QUFDdEMsdUJBQXVCLCtEQUFlO0FBQ3RDLG1DQUFtQyxzREFBRztBQUN0QyxlQUFlLHVEQUFJLENBQUMsK0RBQWU7QUFDbkM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsdURBQUksQ0FBQyxnRUFBZTtBQUNsQztBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJGQUEyRiwwREFBTztBQUNsRyw4QkFBOEIsMkVBQTBCO0FBQ3hEO0FBQ0EseURBQXlELFlBQVk7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RkFBOEYsaUdBQWlHO0FBQy9MLHVDQUF1QyxvRkFBb0Y7QUFDM0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLElBQUk7QUFDSjtBQUNBO0FBQ0Esa0JBQWtCLHdEQUF3RDtBQUMxRSxJQUFJO0FBQ0o7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdFQUFZO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhGQUE4RixpR0FBaUc7QUFDL0wsdUNBQXVDLG9GQUFvRjtBQUMzSCx1RkFBdUYsb0hBQW9IO0FBQzNNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxrQkFBa0IsOERBQThEO0FBQ2hGLElBQUk7QUFDSjtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdFQUFZO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdFQUFZO0FBQ25DO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ3NCO0FBQ3RCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL1JlYWN0QWdlbnQuanM/NmRmYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVBZ2VudFN0YXRlIH0gZnJvbSBcIi4vYW5ub3RhdGlvbi5qc1wiO1xuaW1wb3J0IHsgaXNDbGllbnRUb29sLCBub3JtYWxpemVTeXN0ZW1Qcm9tcHQsIHZhbGlkYXRlTExNSGFzTm9Cb3VuZFRvb2xzLCB3cmFwVG9vbENhbGwgfSBmcm9tIFwiLi91dGlscy5qc1wiO1xuaW1wb3J0IHsgaW5pdGlhbGl6ZU1pZGRsZXdhcmVTdGF0ZXMsIHBhcnNlSnVtcFRvVGFyZ2V0IH0gZnJvbSBcIi4vbm9kZXMvdXRpbHMuanNcIjtcbmltcG9ydCB7IEFHRU5UX05PREVfTkFNRSwgQWdlbnROb2RlIH0gZnJvbSBcIi4vbm9kZXMvQWdlbnROb2RlLmpzXCI7XG5pbXBvcnQgeyBUT09MU19OT0RFX05BTUUsIFRvb2xOb2RlIH0gZnJvbSBcIi4vbm9kZXMvVG9vbE5vZGUuanNcIjtcbmltcG9ydCB7IGdldEhvb2tDb25zdHJhaW50IH0gZnJvbSBcIi4vbWlkZGxld2FyZS91dGlscy5qc1wiO1xuaW1wb3J0IHsgQmVmb3JlQWdlbnROb2RlIH0gZnJvbSBcIi4vbm9kZXMvQmVmb3JlQWdlbnROb2RlLmpzXCI7XG5pbXBvcnQgeyBCZWZvcmVNb2RlbE5vZGUgfSBmcm9tIFwiLi9ub2Rlcy9CZWZvcmVNb2RlbE5vZGUuanNcIjtcbmltcG9ydCB7IEFmdGVyTW9kZWxOb2RlIH0gZnJvbSBcIi4vbm9kZXMvQWZ0ZXJNb2RlbE5vZGUuanNcIjtcbmltcG9ydCB7IEFmdGVyQWdlbnROb2RlIH0gZnJvbSBcIi4vbm9kZXMvQWZ0ZXJBZ2VudE5vZGUuanNcIjtcbmltcG9ydCB7IFN0YXRlTWFuYWdlciB9IGZyb20gXCIuL3N0YXRlLmpzXCI7XG5pbXBvcnQgeyBBSU1lc3NhZ2UsIFRvb2xNZXNzYWdlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9tZXNzYWdlc1wiO1xuaW1wb3J0IHsgbWVyZ2VDb25maWdzIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9ydW5uYWJsZXNcIjtcbmltcG9ydCB7IENvbW1hbmQsIEVORCwgU1RBUlQsIFNlbmQsIFN0YXRlR3JhcGggfSBmcm9tIFwiQGxhbmdjaGFpbi9sYW5nZ3JhcGhcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvUmVhY3RBZ2VudC50c1xuLyoqXG4qIFJlYWN0QWdlbnQgaXMgYSBwcm9kdWN0aW9uLXJlYWR5IFJlQWN0IChSZWFzb25pbmcgKyBBY3RpbmcpIGFnZW50IHRoYXQgY29tYmluZXNcbiogbGFuZ3VhZ2UgbW9kZWxzIHdpdGggdG9vbHMgYW5kIG1pZGRsZXdhcmUuXG4qXG4qIFRoZSBhZ2VudCBpcyBwYXJhbWV0ZXJpemVkIGJ5IGEgc2luZ2xlIHR5cGUgYmFnIGBUeXBlc2AgdGhhdCBlbmNhcHN1bGF0ZXMgYWxsXG4qIHR5cGUgaW5mb3JtYXRpb246XG4qXG4qIEB0eXBlUGFyYW0gVHlwZXMgLSBBbiB7QGxpbmsgQWdlbnRUeXBlQ29uZmlnfSB0aGF0IGJ1bmRsZXM6XG4qICAgLSBgUmVzcG9uc2VgOiBUaGUgc3RydWN0dXJlZCByZXNwb25zZSB0eXBlXG4qICAgLSBgU3RhdGVgOiBUaGUgY3VzdG9tIHN0YXRlIHNjaGVtYSB0eXBlXG4qICAgLSBgQ29udGV4dGA6IFRoZSBjb250ZXh0IHNjaGVtYSB0eXBlXG4qICAgLSBgTWlkZGxld2FyZWA6IFRoZSBtaWRkbGV3YXJlIGFycmF5IHR5cGVcbiogICAtIGBUb29sc2A6IFRoZSBjb21iaW5lZCB0b29scyB0eXBlIGZyb20gYWdlbnQgYW5kIG1pZGRsZXdhcmVcbipcbiogQGV4YW1wbGVcbiogYGBgdHlwZXNjcmlwdFxuKiAvLyBVc2luZyB0aGUgdHlwZSBiYWcgcGF0dGVyblxuKiB0eXBlIE15VHlwZXMgPSBBZ2VudFR5cGVDb25maWc8XG4qICAgeyBuYW1lOiBzdHJpbmcgfSwgIC8vIFJlc3BvbnNlXG4qICAgdHlwZW9mIG15U3RhdGUsICAgIC8vIFN0YXRlXG4qICAgdHlwZW9mIG15Q29udGV4dCwgIC8vIENvbnRleHRcbiogICB0eXBlb2YgbWlkZGxld2FyZSwgLy8gTWlkZGxld2FyZVxuKiAgIHR5cGVvZiB0b29scyAgICAgICAvLyBUb29sc1xuKiA+O1xuKlxuKiBjb25zdCBhZ2VudDogUmVhY3RBZ2VudDxNeVR5cGVzPiA9IGNyZWF0ZUFnZW50KHsgLi4uIH0pO1xuKiBgYGBcbiovXG52YXIgUmVhY3RBZ2VudCA9IGNsYXNzIFJlYWN0QWdlbnQge1xuXHQjZ3JhcGg7XG5cdCN0b29sQmVoYXZpb3JWZXJzaW9uID0gXCJ2MlwiO1xuXHQjYWdlbnROb2RlO1xuXHQjc3RhdGVNYW5hZ2VyID0gbmV3IFN0YXRlTWFuYWdlcigpO1xuXHQjZGVmYXVsdENvbmZpZztcblx0Y29uc3RydWN0b3Iob3B0aW9ucywgZGVmYXVsdENvbmZpZykge1xuXHRcdHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cdFx0dGhpcy4jZGVmYXVsdENvbmZpZyA9IGRlZmF1bHRDb25maWcgPz8ge307XG5cdFx0aWYgKG9wdGlvbnMubmFtZSkgdGhpcy4jZGVmYXVsdENvbmZpZyA9IG1lcmdlQ29uZmlncyh0aGlzLiNkZWZhdWx0Q29uZmlnLCB7IG1ldGFkYXRhOiB7IGxjX2FnZW50X25hbWU6IG9wdGlvbnMubmFtZSB9IH0pO1xuXHRcdHRoaXMuI3Rvb2xCZWhhdmlvclZlcnNpb24gPSBvcHRpb25zLnZlcnNpb24gPz8gdGhpcy4jdG9vbEJlaGF2aW9yVmVyc2lvbjtcblx0XHQvKipcblx0XHQqIHZhbGlkYXRlIHRoYXQgbW9kZWwgb3B0aW9uIGlzIHByb3ZpZGVkXG5cdFx0Ki9cblx0XHRpZiAoIW9wdGlvbnMubW9kZWwpIHRocm93IG5ldyBFcnJvcihcImBtb2RlbGAgb3B0aW9uIGlzIHJlcXVpcmVkIHRvIGNyZWF0ZSBhbiBhZ2VudC5cIik7XG5cdFx0LyoqXG5cdFx0KiBDaGVjayBpZiB0aGUgTExNIGFscmVhZHkgaGFzIGJvdW5kIHRvb2xzIGFuZCB0aHJvdyBpZiBpdCBkb2VzLlxuXHRcdCovXG5cdFx0aWYgKHR5cGVvZiBvcHRpb25zLm1vZGVsICE9PSBcInN0cmluZ1wiKSB2YWxpZGF0ZUxMTUhhc05vQm91bmRUb29scyhvcHRpb25zLm1vZGVsKTtcblx0XHQvKipcblx0XHQqIGRlZmluZSBjb21wbGV0ZSBsaXN0IG9mIHRvb2xzIGJhc2VkIG9uIG9wdGlvbnMgYW5kIG1pZGRsZXdhcmVcblx0XHQqL1xuXHRcdGNvbnN0IG1pZGRsZXdhcmVUb29scyA9IHRoaXMub3B0aW9ucy5taWRkbGV3YXJlPy5maWx0ZXIoKG0pID0+IG0udG9vbHMpLmZsYXRNYXAoKG0pID0+IG0udG9vbHMpID8/IFtdO1xuXHRcdGNvbnN0IHRvb2xDbGFzc2VzID0gWy4uLm9wdGlvbnMudG9vbHMgPz8gW10sIC4uLm1pZGRsZXdhcmVUb29sc107XG5cdFx0LyoqXG5cdFx0KiBJZiBhbnkgb2YgdGhlIHRvb2xzIGFyZSBjb25maWd1cmVkIHRvIHJldHVybl9kaXJlY3RseSBhZnRlciBydW5uaW5nLFxuXHRcdCogb3VyIGdyYXBoIG5lZWRzIHRvIGNoZWNrIGlmIHRoZXNlIHdlcmUgY2FsbGVkXG5cdFx0Ki9cblx0XHRjb25zdCBzaG91bGRSZXR1cm5EaXJlY3QgPSBuZXcgU2V0KHRvb2xDbGFzc2VzLmZpbHRlcihpc0NsaWVudFRvb2wpLmZpbHRlcigodG9vbCkgPT4gXCJyZXR1cm5EaXJlY3RcIiBpbiB0b29sICYmIHRvb2wucmV0dXJuRGlyZWN0KS5tYXAoKHRvb2wpID0+IHRvb2wubmFtZSkpO1xuXHRcdC8qKlxuXHRcdCogQ3JlYXRlIGEgc2NoZW1hIHRoYXQgbWVyZ2VzIGFnZW50IGJhc2Ugc2NoZW1hIHdpdGggbWlkZGxld2FyZSBzdGF0ZSBzY2hlbWFzXG5cdFx0KiBVc2luZyBab2Qgd2l0aCB3aXRoTGFuZ0dyYXBoIGVuc3VyZXMgTGFuZ0dyYXBoIFN0dWRpbyBnZXRzIHByb3BlciBtZXRhZGF0YVxuXHRcdCovXG5cdFx0Y29uc3QgeyBzdGF0ZSwgaW5wdXQsIG91dHB1dCB9ID0gY3JlYXRlQWdlbnRTdGF0ZSh0aGlzLm9wdGlvbnMucmVzcG9uc2VGb3JtYXQgIT09IHZvaWQgMCwgdGhpcy5vcHRpb25zLnN0YXRlU2NoZW1hLCB0aGlzLm9wdGlvbnMubWlkZGxld2FyZSk7XG5cdFx0Y29uc3QgYWxsTm9kZVdvcmtmbG93cyA9IG5ldyBTdGF0ZUdyYXBoKHN0YXRlLCB7XG5cdFx0XHRpbnB1dCxcblx0XHRcdG91dHB1dCxcblx0XHRcdGNvbnRleHQ6IHRoaXMub3B0aW9ucy5jb250ZXh0U2NoZW1hXG5cdFx0fSk7XG5cdFx0Y29uc3QgYmVmb3JlQWdlbnROb2RlcyA9IFtdO1xuXHRcdGNvbnN0IGJlZm9yZU1vZGVsTm9kZXMgPSBbXTtcblx0XHRjb25zdCBhZnRlck1vZGVsTm9kZXMgPSBbXTtcblx0XHRjb25zdCBhZnRlckFnZW50Tm9kZXMgPSBbXTtcblx0XHRjb25zdCB3cmFwTW9kZWxDYWxsSG9va01pZGRsZXdhcmUgPSBbXTtcblx0XHR0aGlzLiNhZ2VudE5vZGUgPSBuZXcgQWdlbnROb2RlKHtcblx0XHRcdG1vZGVsOiB0aGlzLm9wdGlvbnMubW9kZWwsXG5cdFx0XHRzeXN0ZW1NZXNzYWdlOiBub3JtYWxpemVTeXN0ZW1Qcm9tcHQodGhpcy5vcHRpb25zLnN5c3RlbVByb21wdCksXG5cdFx0XHRpbmNsdWRlQWdlbnROYW1lOiB0aGlzLm9wdGlvbnMuaW5jbHVkZUFnZW50TmFtZSxcblx0XHRcdG5hbWU6IHRoaXMub3B0aW9ucy5uYW1lLFxuXHRcdFx0cmVzcG9uc2VGb3JtYXQ6IHRoaXMub3B0aW9ucy5yZXNwb25zZUZvcm1hdCxcblx0XHRcdG1pZGRsZXdhcmU6IHRoaXMub3B0aW9ucy5taWRkbGV3YXJlLFxuXHRcdFx0dG9vbENsYXNzZXMsXG5cdFx0XHRzaG91bGRSZXR1cm5EaXJlY3QsXG5cdFx0XHRzaWduYWw6IHRoaXMub3B0aW9ucy5zaWduYWwsXG5cdFx0XHR3cmFwTW9kZWxDYWxsSG9va01pZGRsZXdhcmVcblx0XHR9KTtcblx0XHRjb25zdCBtaWRkbGV3YXJlTmFtZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuXHRcdGNvbnN0IG1pZGRsZXdhcmUgPSB0aGlzLm9wdGlvbnMubWlkZGxld2FyZSA/PyBbXTtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IG1pZGRsZXdhcmUubGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCBiZWZvcmVBZ2VudE5vZGU7XG5cdFx0XHRsZXQgYmVmb3JlTW9kZWxOb2RlO1xuXHRcdFx0bGV0IGFmdGVyTW9kZWxOb2RlO1xuXHRcdFx0bGV0IGFmdGVyQWdlbnROb2RlO1xuXHRcdFx0Y29uc3QgbSA9IG1pZGRsZXdhcmVbaV07XG5cdFx0XHRpZiAobWlkZGxld2FyZU5hbWVzLmhhcyhtLm5hbWUpKSB0aHJvdyBuZXcgRXJyb3IoYE1pZGRsZXdhcmUgJHttLm5hbWV9IGlzIGRlZmluZWQgbXVsdGlwbGUgdGltZXNgKTtcblx0XHRcdG1pZGRsZXdhcmVOYW1lcy5hZGQobS5uYW1lKTtcblx0XHRcdGlmIChtLmJlZm9yZUFnZW50KSB7XG5cdFx0XHRcdGJlZm9yZUFnZW50Tm9kZSA9IG5ldyBCZWZvcmVBZ2VudE5vZGUobSwgeyBnZXRTdGF0ZTogKCkgPT4gdGhpcy4jc3RhdGVNYW5hZ2VyLmdldFN0YXRlKG0ubmFtZSkgfSk7XG5cdFx0XHRcdHRoaXMuI3N0YXRlTWFuYWdlci5hZGROb2RlKG0sIGJlZm9yZUFnZW50Tm9kZSk7XG5cdFx0XHRcdGNvbnN0IG5hbWUgPSBgJHttLm5hbWV9LmJlZm9yZV9hZ2VudGA7XG5cdFx0XHRcdGJlZm9yZUFnZW50Tm9kZXMucHVzaCh7XG5cdFx0XHRcdFx0aW5kZXg6IGksXG5cdFx0XHRcdFx0bmFtZSxcblx0XHRcdFx0XHRhbGxvd2VkOiBnZXRIb29rQ29uc3RyYWludChtLmJlZm9yZUFnZW50KVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0YWxsTm9kZVdvcmtmbG93cy5hZGROb2RlKG5hbWUsIGJlZm9yZUFnZW50Tm9kZSwgYmVmb3JlQWdlbnROb2RlLm5vZGVPcHRpb25zKTtcblx0XHRcdH1cblx0XHRcdGlmIChtLmJlZm9yZU1vZGVsKSB7XG5cdFx0XHRcdGJlZm9yZU1vZGVsTm9kZSA9IG5ldyBCZWZvcmVNb2RlbE5vZGUobSwgeyBnZXRTdGF0ZTogKCkgPT4gdGhpcy4jc3RhdGVNYW5hZ2VyLmdldFN0YXRlKG0ubmFtZSkgfSk7XG5cdFx0XHRcdHRoaXMuI3N0YXRlTWFuYWdlci5hZGROb2RlKG0sIGJlZm9yZU1vZGVsTm9kZSk7XG5cdFx0XHRcdGNvbnN0IG5hbWUgPSBgJHttLm5hbWV9LmJlZm9yZV9tb2RlbGA7XG5cdFx0XHRcdGJlZm9yZU1vZGVsTm9kZXMucHVzaCh7XG5cdFx0XHRcdFx0aW5kZXg6IGksXG5cdFx0XHRcdFx0bmFtZSxcblx0XHRcdFx0XHRhbGxvd2VkOiBnZXRIb29rQ29uc3RyYWludChtLmJlZm9yZU1vZGVsKVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0YWxsTm9kZVdvcmtmbG93cy5hZGROb2RlKG5hbWUsIGJlZm9yZU1vZGVsTm9kZSwgYmVmb3JlTW9kZWxOb2RlLm5vZGVPcHRpb25zKTtcblx0XHRcdH1cblx0XHRcdGlmIChtLmFmdGVyTW9kZWwpIHtcblx0XHRcdFx0YWZ0ZXJNb2RlbE5vZGUgPSBuZXcgQWZ0ZXJNb2RlbE5vZGUobSwgeyBnZXRTdGF0ZTogKCkgPT4gdGhpcy4jc3RhdGVNYW5hZ2VyLmdldFN0YXRlKG0ubmFtZSkgfSk7XG5cdFx0XHRcdHRoaXMuI3N0YXRlTWFuYWdlci5hZGROb2RlKG0sIGFmdGVyTW9kZWxOb2RlKTtcblx0XHRcdFx0Y29uc3QgbmFtZSA9IGAke20ubmFtZX0uYWZ0ZXJfbW9kZWxgO1xuXHRcdFx0XHRhZnRlck1vZGVsTm9kZXMucHVzaCh7XG5cdFx0XHRcdFx0aW5kZXg6IGksXG5cdFx0XHRcdFx0bmFtZSxcblx0XHRcdFx0XHRhbGxvd2VkOiBnZXRIb29rQ29uc3RyYWludChtLmFmdGVyTW9kZWwpXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRhbGxOb2RlV29ya2Zsb3dzLmFkZE5vZGUobmFtZSwgYWZ0ZXJNb2RlbE5vZGUsIGFmdGVyTW9kZWxOb2RlLm5vZGVPcHRpb25zKTtcblx0XHRcdH1cblx0XHRcdGlmIChtLmFmdGVyQWdlbnQpIHtcblx0XHRcdFx0YWZ0ZXJBZ2VudE5vZGUgPSBuZXcgQWZ0ZXJBZ2VudE5vZGUobSwgeyBnZXRTdGF0ZTogKCkgPT4gdGhpcy4jc3RhdGVNYW5hZ2VyLmdldFN0YXRlKG0ubmFtZSkgfSk7XG5cdFx0XHRcdHRoaXMuI3N0YXRlTWFuYWdlci5hZGROb2RlKG0sIGFmdGVyQWdlbnROb2RlKTtcblx0XHRcdFx0Y29uc3QgbmFtZSA9IGAke20ubmFtZX0uYWZ0ZXJfYWdlbnRgO1xuXHRcdFx0XHRhZnRlckFnZW50Tm9kZXMucHVzaCh7XG5cdFx0XHRcdFx0aW5kZXg6IGksXG5cdFx0XHRcdFx0bmFtZSxcblx0XHRcdFx0XHRhbGxvd2VkOiBnZXRIb29rQ29uc3RyYWludChtLmFmdGVyQWdlbnQpXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRhbGxOb2RlV29ya2Zsb3dzLmFkZE5vZGUobmFtZSwgYWZ0ZXJBZ2VudE5vZGUsIGFmdGVyQWdlbnROb2RlLm5vZGVPcHRpb25zKTtcblx0XHRcdH1cblx0XHRcdGlmIChtLndyYXBNb2RlbENhbGwpIHdyYXBNb2RlbENhbGxIb29rTWlkZGxld2FyZS5wdXNoKFttLCAoKSA9PiB0aGlzLiNzdGF0ZU1hbmFnZXIuZ2V0U3RhdGUobS5uYW1lKV0pO1xuXHRcdH1cblx0XHQvKipcblx0XHQqIEFkZCBOb2Rlc1xuXHRcdCovXG5cdFx0YWxsTm9kZVdvcmtmbG93cy5hZGROb2RlKEFHRU5UX05PREVfTkFNRSwgdGhpcy4jYWdlbnROb2RlKTtcblx0XHQvKipcblx0XHQqIENoZWNrIGlmIGFueSBtaWRkbGV3YXJlIGhhcyB3cmFwVG9vbENhbGwgZGVmaW5lZC5cblx0XHQqIElmIHNvLCB3ZSBuZWVkIHRvIGNyZWF0ZSBhIFRvb2xOb2RlIGV2ZW4gd2l0aG91dCBwcmUtcmVnaXN0ZXJlZCB0b29sc1xuXHRcdCogdG8gYWxsb3cgbWlkZGxld2FyZSB0byBoYW5kbGUgZHluYW1pY2FsbHkgcmVnaXN0ZXJlZCB0b29scy5cblx0XHQqL1xuXHRcdGNvbnN0IGhhc1dyYXBUb29sQ2FsbE1pZGRsZXdhcmUgPSBtaWRkbGV3YXJlLnNvbWUoKG0pID0+IG0ud3JhcFRvb2xDYWxsKTtcblx0XHRjb25zdCBjbGllbnRUb29scyA9IHRvb2xDbGFzc2VzLmZpbHRlcihpc0NsaWVudFRvb2wpO1xuXHRcdC8qKlxuXHRcdCogQ3JlYXRlIFRvb2xOb2RlIGlmIHdlIGhhdmUgY2xpZW50LXNpZGUgdG9vbHMgT1IgaWYgbWlkZGxld2FyZSBkZWZpbmVzIHdyYXBUb29sQ2FsbFxuXHRcdCogKHdoaWNoIG1heSBoYW5kbGUgZHluYW1pY2FsbHkgcmVnaXN0ZXJlZCB0b29scylcblx0XHQqL1xuXHRcdGlmIChjbGllbnRUb29scy5sZW5ndGggPiAwIHx8IGhhc1dyYXBUb29sQ2FsbE1pZGRsZXdhcmUpIHtcblx0XHRcdGNvbnN0IHRvb2xOb2RlID0gbmV3IFRvb2xOb2RlKGNsaWVudFRvb2xzLCB7XG5cdFx0XHRcdHNpZ25hbDogdGhpcy5vcHRpb25zLnNpZ25hbCxcblx0XHRcdFx0d3JhcFRvb2xDYWxsOiB3cmFwVG9vbENhbGwobWlkZGxld2FyZSlcblx0XHRcdH0pO1xuXHRcdFx0YWxsTm9kZVdvcmtmbG93cy5hZGROb2RlKFRPT0xTX05PREVfTkFNRSwgdG9vbE5vZGUpO1xuXHRcdH1cblx0XHQvKipcblx0XHQqIEFkZCBFZGdlc1xuXHRcdCovXG5cdFx0bGV0IGVudHJ5Tm9kZTtcblx0XHRpZiAoYmVmb3JlQWdlbnROb2Rlcy5sZW5ndGggPiAwKSBlbnRyeU5vZGUgPSBiZWZvcmVBZ2VudE5vZGVzWzBdLm5hbWU7XG5cdFx0ZWxzZSBpZiAoYmVmb3JlTW9kZWxOb2Rlcy5sZW5ndGggPiAwKSBlbnRyeU5vZGUgPSBiZWZvcmVNb2RlbE5vZGVzWzBdLm5hbWU7XG5cdFx0ZWxzZSBlbnRyeU5vZGUgPSBBR0VOVF9OT0RFX05BTUU7XG5cdFx0Y29uc3QgbG9vcEVudHJ5Tm9kZSA9IGJlZm9yZU1vZGVsTm9kZXMubGVuZ3RoID4gMCA/IGJlZm9yZU1vZGVsTm9kZXNbMF0ubmFtZSA6IEFHRU5UX05PREVfTkFNRTtcblx0XHRjb25zdCBleGl0Tm9kZSA9IGFmdGVyQWdlbnROb2Rlcy5sZW5ndGggPiAwID8gYWZ0ZXJBZ2VudE5vZGVzW2FmdGVyQWdlbnROb2Rlcy5sZW5ndGggLSAxXS5uYW1lIDogRU5EO1xuXHRcdGFsbE5vZGVXb3JrZmxvd3MuYWRkRWRnZShTVEFSVCwgZW50cnlOb2RlKTtcblx0XHQvKipcblx0XHQqIERldGVybWluZSBpZiB3ZSBoYXZlIHRvb2xzIGF2YWlsYWJsZSBmb3Igcm91dGluZy5cblx0XHQqIFRoaXMgaW5jbHVkZXMgYm90aCByZWdpc3RlcmVkIGNsaWVudCB0b29scyBBTkQgZHluYW1pYyB0b29scyB2aWEgbWlkZGxld2FyZS5cblx0XHQqL1xuXHRcdGNvbnN0IGhhc1Rvb2xzQXZhaWxhYmxlID0gY2xpZW50VG9vbHMubGVuZ3RoID4gMCB8fCBoYXNXcmFwVG9vbENhbGxNaWRkbGV3YXJlO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYmVmb3JlQWdlbnROb2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0Y29uc3Qgbm9kZSA9IGJlZm9yZUFnZW50Tm9kZXNbaV07XG5cdFx0XHRjb25zdCBjdXJyZW50ID0gbm9kZS5uYW1lO1xuXHRcdFx0Y29uc3QgbmV4dERlZmF1bHQgPSBpID09PSBiZWZvcmVBZ2VudE5vZGVzLmxlbmd0aCAtIDEgPyBsb29wRW50cnlOb2RlIDogYmVmb3JlQWdlbnROb2Rlc1tpICsgMV0ubmFtZTtcblx0XHRcdGlmIChub2RlLmFsbG93ZWQgJiYgbm9kZS5hbGxvd2VkLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Y29uc3QgYWxsb3dlZE1hcHBlZCA9IG5vZGUuYWxsb3dlZC5tYXAoKHQpID0+IHBhcnNlSnVtcFRvVGFyZ2V0KHQpKS5maWx0ZXIoKGRlc3QpID0+IGRlc3QgIT09IFRPT0xTX05PREVfTkFNRSB8fCBoYXNUb29sc0F2YWlsYWJsZSk7XG5cdFx0XHRcdGNvbnN0IGRlc3RpbmF0aW9ucyA9IEFycmF5LmZyb20obmV3IFNldChbbmV4dERlZmF1bHQsIC4uLmFsbG93ZWRNYXBwZWQubWFwKChkZXN0KSA9PiBkZXN0ID09PSBFTkQgPyBleGl0Tm9kZSA6IGRlc3QpXSkpO1xuXHRcdFx0XHRhbGxOb2RlV29ya2Zsb3dzLmFkZENvbmRpdGlvbmFsRWRnZXMoY3VycmVudCwgdGhpcy4jY3JlYXRlQmVmb3JlQWdlbnRSb3V0ZXIoY2xpZW50VG9vbHMsIG5leHREZWZhdWx0LCBleGl0Tm9kZSwgaGFzVG9vbHNBdmFpbGFibGUpLCBkZXN0aW5hdGlvbnMpO1xuXHRcdFx0fSBlbHNlIGFsbE5vZGVXb3JrZmxvd3MuYWRkRWRnZShjdXJyZW50LCBuZXh0RGVmYXVsdCk7XG5cdFx0fVxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYmVmb3JlTW9kZWxOb2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0Y29uc3Qgbm9kZSA9IGJlZm9yZU1vZGVsTm9kZXNbaV07XG5cdFx0XHRjb25zdCBjdXJyZW50ID0gbm9kZS5uYW1lO1xuXHRcdFx0Y29uc3QgbmV4dERlZmF1bHQgPSBpID09PSBiZWZvcmVNb2RlbE5vZGVzLmxlbmd0aCAtIDEgPyBBR0VOVF9OT0RFX05BTUUgOiBiZWZvcmVNb2RlbE5vZGVzW2kgKyAxXS5uYW1lO1xuXHRcdFx0aWYgKG5vZGUuYWxsb3dlZCAmJiBub2RlLmFsbG93ZWQubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCBhbGxvd2VkTWFwcGVkID0gbm9kZS5hbGxvd2VkLm1hcCgodCkgPT4gcGFyc2VKdW1wVG9UYXJnZXQodCkpLmZpbHRlcigoZGVzdCkgPT4gZGVzdCAhPT0gVE9PTFNfTk9ERV9OQU1FIHx8IGhhc1Rvb2xzQXZhaWxhYmxlKTtcblx0XHRcdFx0Y29uc3QgZGVzdGluYXRpb25zID0gQXJyYXkuZnJvbShuZXcgU2V0KFtuZXh0RGVmYXVsdCwgLi4uYWxsb3dlZE1hcHBlZF0pKTtcblx0XHRcdFx0YWxsTm9kZVdvcmtmbG93cy5hZGRDb25kaXRpb25hbEVkZ2VzKGN1cnJlbnQsIHRoaXMuI2NyZWF0ZUJlZm9yZU1vZGVsUm91dGVyKGNsaWVudFRvb2xzLCBuZXh0RGVmYXVsdCwgaGFzVG9vbHNBdmFpbGFibGUpLCBkZXN0aW5hdGlvbnMpO1xuXHRcdFx0fSBlbHNlIGFsbE5vZGVXb3JrZmxvd3MuYWRkRWRnZShjdXJyZW50LCBuZXh0RGVmYXVsdCk7XG5cdFx0fVxuXHRcdGNvbnN0IGxhc3RBZnRlck1vZGVsTm9kZSA9IGFmdGVyTW9kZWxOb2Rlcy5hdCgtMSk7XG5cdFx0aWYgKGFmdGVyTW9kZWxOb2Rlcy5sZW5ndGggPiAwICYmIGxhc3RBZnRlck1vZGVsTm9kZSkgYWxsTm9kZVdvcmtmbG93cy5hZGRFZGdlKEFHRU5UX05PREVfTkFNRSwgbGFzdEFmdGVyTW9kZWxOb2RlLm5hbWUpO1xuXHRcdGVsc2Uge1xuXHRcdFx0Y29uc3QgZGVzdGluYXRpb25zID0gdGhpcy4jZ2V0TW9kZWxQYXRocyhjbGllbnRUb29scywgZmFsc2UsIGhhc1Rvb2xzQXZhaWxhYmxlKS5tYXAoKHApID0+IHAgPT09IEVORCA/IGV4aXROb2RlIDogcCk7XG5cdFx0XHRpZiAoZGVzdGluYXRpb25zLmxlbmd0aCA9PT0gMSkgYWxsTm9kZVdvcmtmbG93cy5hZGRFZGdlKEFHRU5UX05PREVfTkFNRSwgZGVzdGluYXRpb25zWzBdKTtcblx0XHRcdGVsc2UgYWxsTm9kZVdvcmtmbG93cy5hZGRDb25kaXRpb25hbEVkZ2VzKEFHRU5UX05PREVfTkFNRSwgdGhpcy4jY3JlYXRlTW9kZWxSb3V0ZXIoZXhpdE5vZGUpLCBkZXN0aW5hdGlvbnMpO1xuXHRcdH1cblx0XHRmb3IgKGxldCBpID0gYWZ0ZXJNb2RlbE5vZGVzLmxlbmd0aCAtIDE7IGkgPiAwOyBpLS0pIHtcblx0XHRcdGNvbnN0IG5vZGUgPSBhZnRlck1vZGVsTm9kZXNbaV07XG5cdFx0XHRjb25zdCBjdXJyZW50ID0gbm9kZS5uYW1lO1xuXHRcdFx0Y29uc3QgbmV4dERlZmF1bHQgPSBhZnRlck1vZGVsTm9kZXNbaSAtIDFdLm5hbWU7XG5cdFx0XHRpZiAobm9kZS5hbGxvd2VkICYmIG5vZGUuYWxsb3dlZC5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGNvbnN0IGFsbG93ZWRNYXBwZWQgPSBub2RlLmFsbG93ZWQubWFwKCh0KSA9PiBwYXJzZUp1bXBUb1RhcmdldCh0KSkuZmlsdGVyKChkZXN0KSA9PiBkZXN0ICE9PSBUT09MU19OT0RFX05BTUUgfHwgaGFzVG9vbHNBdmFpbGFibGUpO1xuXHRcdFx0XHRjb25zdCBkZXN0aW5hdGlvbnMgPSBBcnJheS5mcm9tKG5ldyBTZXQoW25leHREZWZhdWx0LCAuLi5hbGxvd2VkTWFwcGVkXSkpO1xuXHRcdFx0XHRhbGxOb2RlV29ya2Zsb3dzLmFkZENvbmRpdGlvbmFsRWRnZXMoY3VycmVudCwgdGhpcy4jY3JlYXRlQWZ0ZXJNb2RlbFNlcXVlbmNlUm91dGVyKGNsaWVudFRvb2xzLCBub2RlLmFsbG93ZWQsIG5leHREZWZhdWx0LCBoYXNUb29sc0F2YWlsYWJsZSksIGRlc3RpbmF0aW9ucyk7XG5cdFx0XHR9IGVsc2UgYWxsTm9kZVdvcmtmbG93cy5hZGRFZGdlKGN1cnJlbnQsIG5leHREZWZhdWx0KTtcblx0XHR9XG5cdFx0aWYgKGFmdGVyTW9kZWxOb2Rlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRjb25zdCBmaXJzdEFmdGVyTW9kZWwgPSBhZnRlck1vZGVsTm9kZXNbMF07XG5cdFx0XHRjb25zdCBmaXJzdEFmdGVyTW9kZWxOb2RlID0gZmlyc3RBZnRlck1vZGVsLm5hbWU7XG5cdFx0XHRjb25zdCBtb2RlbFBhdGhzID0gdGhpcy4jZ2V0TW9kZWxQYXRocyhjbGllbnRUb29scywgdHJ1ZSwgaGFzVG9vbHNBdmFpbGFibGUpLmZpbHRlcigocCkgPT4gcCAhPT0gVE9PTFNfTk9ERV9OQU1FIHx8IGhhc1Rvb2xzQXZhaWxhYmxlKTtcblx0XHRcdGNvbnN0IGFsbG93SnVtcCA9IEJvb2xlYW4oZmlyc3RBZnRlck1vZGVsLmFsbG93ZWQgJiYgZmlyc3RBZnRlck1vZGVsLmFsbG93ZWQubGVuZ3RoID4gMCk7XG5cdFx0XHRjb25zdCBkZXN0aW5hdGlvbnMgPSBtb2RlbFBhdGhzLm1hcCgocCkgPT4gcCA9PT0gRU5EID8gZXhpdE5vZGUgOiBwKTtcblx0XHRcdGFsbE5vZGVXb3JrZmxvd3MuYWRkQ29uZGl0aW9uYWxFZGdlcyhmaXJzdEFmdGVyTW9kZWxOb2RlLCB0aGlzLiNjcmVhdGVBZnRlck1vZGVsUm91dGVyKGNsaWVudFRvb2xzLCBhbGxvd0p1bXAsIGV4aXROb2RlLCBoYXNUb29sc0F2YWlsYWJsZSksIGRlc3RpbmF0aW9ucyk7XG5cdFx0fVxuXHRcdGZvciAobGV0IGkgPSBhZnRlckFnZW50Tm9kZXMubGVuZ3RoIC0gMTsgaSA+IDA7IGktLSkge1xuXHRcdFx0Y29uc3Qgbm9kZSA9IGFmdGVyQWdlbnROb2Rlc1tpXTtcblx0XHRcdGNvbnN0IGN1cnJlbnQgPSBub2RlLm5hbWU7XG5cdFx0XHRjb25zdCBuZXh0RGVmYXVsdCA9IGFmdGVyQWdlbnROb2Rlc1tpIC0gMV0ubmFtZTtcblx0XHRcdGlmIChub2RlLmFsbG93ZWQgJiYgbm9kZS5hbGxvd2VkLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Y29uc3QgYWxsb3dlZE1hcHBlZCA9IG5vZGUuYWxsb3dlZC5tYXAoKHQpID0+IHBhcnNlSnVtcFRvVGFyZ2V0KHQpKS5maWx0ZXIoKGRlc3QpID0+IGRlc3QgIT09IFRPT0xTX05PREVfTkFNRSB8fCBoYXNUb29sc0F2YWlsYWJsZSk7XG5cdFx0XHRcdGNvbnN0IGRlc3RpbmF0aW9ucyA9IEFycmF5LmZyb20obmV3IFNldChbbmV4dERlZmF1bHQsIC4uLmFsbG93ZWRNYXBwZWRdKSk7XG5cdFx0XHRcdGFsbE5vZGVXb3JrZmxvd3MuYWRkQ29uZGl0aW9uYWxFZGdlcyhjdXJyZW50LCB0aGlzLiNjcmVhdGVBZnRlck1vZGVsU2VxdWVuY2VSb3V0ZXIoY2xpZW50VG9vbHMsIG5vZGUuYWxsb3dlZCwgbmV4dERlZmF1bHQsIGhhc1Rvb2xzQXZhaWxhYmxlKSwgZGVzdGluYXRpb25zKTtcblx0XHRcdH0gZWxzZSBhbGxOb2RlV29ya2Zsb3dzLmFkZEVkZ2UoY3VycmVudCwgbmV4dERlZmF1bHQpO1xuXHRcdH1cblx0XHRpZiAoYWZ0ZXJBZ2VudE5vZGVzLmxlbmd0aCA+IDApIHtcblx0XHRcdGNvbnN0IGZpcnN0QWZ0ZXJBZ2VudCA9IGFmdGVyQWdlbnROb2Rlc1swXTtcblx0XHRcdGNvbnN0IGZpcnN0QWZ0ZXJBZ2VudE5vZGUgPSBmaXJzdEFmdGVyQWdlbnQubmFtZTtcblx0XHRcdGlmIChmaXJzdEFmdGVyQWdlbnQuYWxsb3dlZCAmJiBmaXJzdEFmdGVyQWdlbnQuYWxsb3dlZC5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGNvbnN0IGFsbG93ZWRNYXBwZWQgPSBmaXJzdEFmdGVyQWdlbnQuYWxsb3dlZC5tYXAoKHQpID0+IHBhcnNlSnVtcFRvVGFyZ2V0KHQpKS5maWx0ZXIoKGRlc3QpID0+IGRlc3QgIT09IFRPT0xTX05PREVfTkFNRSB8fCBoYXNUb29sc0F2YWlsYWJsZSk7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIEZvciBhZnRlcl9hZ2VudCwgb25seSB1c2UgZXhwbGljaXRseSBhbGxvd2VkIGRlc3RpbmF0aW9ucyAoZG9uJ3QgYWRkIGxvb3BFbnRyeU5vZGUpXG5cdFx0XHRcdCogVGhlIGRlZmF1bHQgZGVzdGluYXRpb24gKHdoZW4gbm8ganVtcCBvY2N1cnMpIHNob3VsZCBiZSBFTkRcblx0XHRcdFx0Ki9cblx0XHRcdFx0Y29uc3QgZGVzdGluYXRpb25zID0gQXJyYXkuZnJvbShuZXcgU2V0KFtFTkQsIC4uLmFsbG93ZWRNYXBwZWRdKSk7XG5cdFx0XHRcdGFsbE5vZGVXb3JrZmxvd3MuYWRkQ29uZGl0aW9uYWxFZGdlcyhmaXJzdEFmdGVyQWdlbnROb2RlLCB0aGlzLiNjcmVhdGVBZnRlck1vZGVsU2VxdWVuY2VSb3V0ZXIoY2xpZW50VG9vbHMsIGZpcnN0QWZ0ZXJBZ2VudC5hbGxvd2VkLCBFTkQsIGhhc1Rvb2xzQXZhaWxhYmxlKSwgZGVzdGluYXRpb25zKTtcblx0XHRcdH0gZWxzZSBhbGxOb2RlV29ya2Zsb3dzLmFkZEVkZ2UoZmlyc3RBZnRlckFnZW50Tm9kZSwgRU5EKTtcblx0XHR9XG5cdFx0LyoqXG5cdFx0KiBhZGQgZWRnZXMgZm9yIHRvb2xzIG5vZGUgKGluY2x1ZGVzIGJvdGggcmVnaXN0ZXJlZCB0b29scyBhbmQgZHluYW1pYyB0b29scyB2aWEgbWlkZGxld2FyZSlcblx0XHQqL1xuXHRcdGlmIChoYXNUb29sc0F2YWlsYWJsZSkge1xuXHRcdFx0Y29uc3QgdG9vbFJldHVyblRhcmdldCA9IGxvb3BFbnRyeU5vZGU7XG5cdFx0XHRpZiAoc2hvdWxkUmV0dXJuRGlyZWN0LnNpemUgPiAwKSBhbGxOb2RlV29ya2Zsb3dzLmFkZENvbmRpdGlvbmFsRWRnZXMoVE9PTFNfTk9ERV9OQU1FLCB0aGlzLiNjcmVhdGVUb29sc1JvdXRlcihzaG91bGRSZXR1cm5EaXJlY3QsIGV4aXROb2RlKSwgW3Rvb2xSZXR1cm5UYXJnZXQsIGV4aXROb2RlXSk7XG5cdFx0XHRlbHNlIGFsbE5vZGVXb3JrZmxvd3MuYWRkRWRnZShUT09MU19OT0RFX05BTUUsIHRvb2xSZXR1cm5UYXJnZXQpO1xuXHRcdH1cblx0XHQvKipcblx0XHQqIGNvbXBpbGUgdGhlIGdyYXBoXG5cdFx0Ki9cblx0XHR0aGlzLiNncmFwaCA9IGFsbE5vZGVXb3JrZmxvd3MuY29tcGlsZSh7XG5cdFx0XHRjaGVja3BvaW50ZXI6IHRoaXMub3B0aW9ucy5jaGVja3BvaW50ZXIsXG5cdFx0XHRzdG9yZTogdGhpcy5vcHRpb25zLnN0b3JlLFxuXHRcdFx0bmFtZTogdGhpcy5vcHRpb25zLm5hbWUsXG5cdFx0XHRkZXNjcmlwdGlvbjogdGhpcy5vcHRpb25zLmRlc2NyaXB0aW9uXG5cdFx0fSk7XG5cdH1cblx0LyoqXG5cdCogR2V0IHRoZSBjb21waWxlZCB7QGxpbmsgaHR0cHM6Ly9kb2NzLmxhbmdjaGFpbi5jb20vb3NzL2phdmFzY3JpcHQvbGFuZ2dyYXBoL3VzZS1ncmFwaC1hcGkgfCBTdGF0ZUdyYXBofS5cblx0Ki9cblx0Z2V0IGdyYXBoKCkge1xuXHRcdHJldHVybiB0aGlzLiNncmFwaDtcblx0fVxuXHQvKipcblx0KiBDcmVhdGVzIGEgbmV3IFJlYWN0QWdlbnQgd2l0aCB0aGUgZ2l2ZW4gY29uZmlnIG1lcmdlZCBpbnRvIHRoZSBleGlzdGluZyBjb25maWcuXG5cdCogRm9sbG93cyB0aGUgc2FtZSBwYXR0ZXJuIGFzIExhbmdHcmFwaCdzIFByZWdlbC53aXRoQ29uZmlnKCkuXG5cdCpcblx0KiBUaGUgbWVyZ2VkIGNvbmZpZyBpcyBhcHBsaWVkIGFzIGEgZGVmYXVsdCB0aGF0IGdldHMgbWVyZ2VkIHdpdGggYW55IGNvbmZpZ1xuXHQqIHBhc3NlZCBhdCBpbnZvY2F0aW9uIHRpbWUgKGludm9rZS9zdHJlYW0pLiBJbnZvY2F0aW9uLXRpbWUgY29uZmlnIHRha2VzIHByZWNlZGVuY2UuXG5cdCpcblx0KiBAcGFyYW0gY29uZmlnIC0gQ29uZmlndXJhdGlvbiB0byBtZXJnZSB3aXRoIGV4aXN0aW5nIGNvbmZpZ1xuXHQqIEByZXR1cm5zIEEgbmV3IFJlYWN0QWdlbnQgaW5zdGFuY2Ugd2l0aCB0aGUgbWVyZ2VkIGNvbmZpZ3VyYXRpb25cblx0KlxuXHQqIEBleGFtcGxlXG5cdCogYGBgdHlwZXNjcmlwdFxuXHQqIGNvbnN0IGFnZW50ID0gY3JlYXRlQWdlbnQoeyBtb2RlbDogXCJncHQtNG9cIiwgdG9vbHM6IFsuLi5dIH0pO1xuXHQqXG5cdCogLy8gU2V0IGEgZGVmYXVsdCByZWN1cnNpb24gbGltaXRcblx0KiBjb25zdCBjb25maWd1cmVkQWdlbnQgPSBhZ2VudC53aXRoQ29uZmlnKHsgcmVjdXJzaW9uTGltaXQ6IDEwMDAgfSk7XG5cdCpcblx0KiAvLyBDaGFpbiBtdWx0aXBsZSBjb25maWdzXG5cdCogY29uc3QgZGVidWdBZ2VudCA9IGFnZW50XG5cdCogICAud2l0aENvbmZpZyh7IHJlY3Vyc2lvbkxpbWl0OiAxMDAwIH0pXG5cdCogICAud2l0aENvbmZpZyh7IHRhZ3M6IFtcImRlYnVnXCJdIH0pO1xuXHQqIGBgYFxuXHQqL1xuXHR3aXRoQ29uZmlnKGNvbmZpZykge1xuXHRcdHJldHVybiBuZXcgUmVhY3RBZ2VudCh0aGlzLm9wdGlvbnMsIG1lcmdlQ29uZmlncyh0aGlzLiNkZWZhdWx0Q29uZmlnLCBjb25maWcpKTtcblx0fVxuXHQvKipcblx0KiBHZXQgcG9zc2libGUgZWRnZSBkZXN0aW5hdGlvbnMgZnJvbSBtb2RlbCBub2RlLlxuXHQqIEBwYXJhbSB0b29sQ2xhc3NlcyBuYW1lcyBvZiB0b29scyB0byBjYWxsXG5cdCogQHBhcmFtIGluY2x1ZGVNb2RlbFJlcXVlc3Qgd2hldGhlciB0byBpbmNsdWRlIFwibW9kZWxfcmVxdWVzdFwiIGFzIGEgdmFsaWQgcGF0aCAoZm9yIGp1bXBUbyByb3V0aW5nKVxuXHQqIEBwYXJhbSBoYXNUb29sc0F2YWlsYWJsZSB3aGV0aGVyIHRvb2xzIGFyZSBhdmFpbGFibGUgKGluY2x1ZGVzIGR5bmFtaWMgdG9vbHMgdmlhIG1pZGRsZXdhcmUpXG5cdCogQHJldHVybnMgbGlzdCBvZiBwb3NzaWJsZSBlZGdlIGRlc3RpbmF0aW9uc1xuXHQqL1xuXHQjZ2V0TW9kZWxQYXRocyh0b29sQ2xhc3NlcywgaW5jbHVkZU1vZGVsUmVxdWVzdCA9IGZhbHNlLCBoYXNUb29sc0F2YWlsYWJsZSA9IHRvb2xDbGFzc2VzLmxlbmd0aCA+IDApIHtcblx0XHRjb25zdCBwYXRocyA9IFtdO1xuXHRcdGlmIChoYXNUb29sc0F2YWlsYWJsZSkgcGF0aHMucHVzaChUT09MU19OT0RFX05BTUUpO1xuXHRcdGlmIChpbmNsdWRlTW9kZWxSZXF1ZXN0KSBwYXRocy5wdXNoKEFHRU5UX05PREVfTkFNRSk7XG5cdFx0cGF0aHMucHVzaChFTkQpO1xuXHRcdHJldHVybiBwYXRocztcblx0fVxuXHQvKipcblx0KiBDcmVhdGUgcm91dGluZyBmdW5jdGlvbiBmb3IgdG9vbHMgbm9kZSBjb25kaXRpb25hbCBlZGdlcy5cblx0Ki9cblx0I2NyZWF0ZVRvb2xzUm91dGVyKHNob3VsZFJldHVybkRpcmVjdCwgZXhpdE5vZGUpIHtcblx0XHRyZXR1cm4gKHN0YXRlKSA9PiB7XG5cdFx0XHRjb25zdCBtZXNzYWdlcyA9IHN0YXRlLm1lc3NhZ2VzO1xuXHRcdFx0Y29uc3QgbGFzdE1lc3NhZ2UgPSBtZXNzYWdlc1ttZXNzYWdlcy5sZW5ndGggLSAxXTtcblx0XHRcdGlmIChUb29sTWVzc2FnZS5pc0luc3RhbmNlKGxhc3RNZXNzYWdlKSAmJiBsYXN0TWVzc2FnZS5uYW1lICYmIHNob3VsZFJldHVybkRpcmVjdC5oYXMobGFzdE1lc3NhZ2UubmFtZSkpIHJldHVybiB0aGlzLm9wdGlvbnMucmVzcG9uc2VGb3JtYXQgPyBBR0VOVF9OT0RFX05BTUUgOiBleGl0Tm9kZTtcblx0XHRcdHJldHVybiBBR0VOVF9OT0RFX05BTUU7XG5cdFx0fTtcblx0fVxuXHQvKipcblx0KiBDcmVhdGUgcm91dGluZyBmdW5jdGlvbiBmb3IgbW9kZWwgbm9kZSBjb25kaXRpb25hbCBlZGdlcy5cblx0KiBAcGFyYW0gZXhpdE5vZGUgLSBUaGUgZXhpdCBub2RlIHRvIHJvdXRlIHRvIChjb3VsZCBiZSBhZnRlcl9hZ2VudCBvciBFTkQpXG5cdCovXG5cdCNjcmVhdGVNb2RlbFJvdXRlcihleGl0Tm9kZSA9IEVORCkge1xuXHRcdC8qKlxuXHRcdCogZGV0ZXJtaW5lIGlmIHRoZSBhZ2VudCBzaG91bGQgY29udGludWUgb3Igbm90XG5cdFx0Ki9cblx0XHRyZXR1cm4gKHN0YXRlKSA9PiB7XG5cdFx0XHRjb25zdCBsYXN0TWVzc2FnZSA9IHN0YXRlLm1lc3NhZ2VzLmF0KC0xKTtcblx0XHRcdGlmICghQUlNZXNzYWdlLmlzSW5zdGFuY2UobGFzdE1lc3NhZ2UpIHx8ICFsYXN0TWVzc2FnZS50b29sX2NhbGxzIHx8IGxhc3RNZXNzYWdlLnRvb2xfY2FsbHMubGVuZ3RoID09PSAwKSByZXR1cm4gZXhpdE5vZGU7XG5cdFx0XHRpZiAobGFzdE1lc3NhZ2UudG9vbF9jYWxscy5ldmVyeSgodG9vbENhbGwpID0+IHRvb2xDYWxsLm5hbWUuc3RhcnRzV2l0aChcImV4dHJhY3QtXCIpKSkgcmV0dXJuIGV4aXROb2RlO1xuXHRcdFx0LyoqXG5cdFx0XHQqIFRoZSB0b29sIG5vZGUgcHJvY2Vzc2VzIGEgc2luZ2xlIG1lc3NhZ2UuXG5cdFx0XHQqL1xuXHRcdFx0aWYgKHRoaXMuI3Rvb2xCZWhhdmlvclZlcnNpb24gPT09IFwidjFcIikgcmV0dXJuIFRPT0xTX05PREVfTkFNRTtcblx0XHRcdC8qKlxuXHRcdFx0KiBSb3V0ZSB0byB0b29scyBub2RlIChmaWx0ZXIgb3V0IGFueSBzdHJ1Y3R1cmVkIHJlc3BvbnNlIHRvb2wgY2FsbHMpXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3QgcmVndWxhclRvb2xDYWxscyA9IGxhc3RNZXNzYWdlLnRvb2xfY2FsbHMuZmlsdGVyKCh0b29sQ2FsbCkgPT4gIXRvb2xDYWxsLm5hbWUuc3RhcnRzV2l0aChcImV4dHJhY3QtXCIpKTtcblx0XHRcdGlmIChyZWd1bGFyVG9vbENhbGxzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGV4aXROb2RlO1xuXHRcdFx0cmV0dXJuIHJlZ3VsYXJUb29sQ2FsbHMubWFwKCh0b29sQ2FsbCkgPT4gbmV3IFNlbmQoVE9PTFNfTk9ERV9OQU1FLCB7XG5cdFx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0XHRsZ190b29sX2NhbGw6IHRvb2xDYWxsXG5cdFx0XHR9KSk7XG5cdFx0fTtcblx0fVxuXHQvKipcblx0KiBDcmVhdGUgcm91dGluZyBmdW5jdGlvbiBmb3IganVtcFRvIGZ1bmN0aW9uYWxpdHkgYWZ0ZXIgYWZ0ZXJNb2RlbCBob29rcy5cblx0KlxuXHQqIFRoaXMgcm91dGVyIGNoZWNrcyBpZiB0aGUgYGp1bXBUb2AgcHJvcGVydHkgaXMgc2V0IGluIHRoZSBzdGF0ZSBhZnRlciBhZnRlck1vZGVsIG1pZGRsZXdhcmVcblx0KiBleGVjdXRpb24uIElmIHNldCwgaXQgcm91dGVzIHRvIHRoZSBzcGVjaWZpZWQgdGFyZ2V0IChcIm1vZGVsX3JlcXVlc3RcIiBvciBcInRvb2xzXCIpLlxuXHQqIElmIG5vdCBzZXQsIGl0IGZhbGxzIGJhY2sgdG8gdGhlIG5vcm1hbCBtb2RlbCByb3V0aW5nIGxvZ2ljIGZvciBhZnRlck1vZGVsIGNvbnRleHQuXG5cdCpcblx0KiBUaGUganVtcFRvIHByb3BlcnR5IGlzIGF1dG9tYXRpY2FsbHkgY2xlYXJlZCBhZnRlciB1c2UgdG8gcHJldmVudCBpbmZpbml0ZSBsb29wcy5cblx0KlxuXHQqIEBwYXJhbSB0b29sQ2xhc3NlcyAtIEF2YWlsYWJsZSB0b29sIGNsYXNzZXMgZm9yIHZhbGlkYXRpb25cblx0KiBAcGFyYW0gYWxsb3dKdW1wIC0gV2hldGhlciBqdW1waW5nIGlzIGFsbG93ZWRcblx0KiBAcGFyYW0gZXhpdE5vZGUgLSBUaGUgZXhpdCBub2RlIHRvIHJvdXRlIHRvIChjb3VsZCBiZSBhZnRlcl9hZ2VudCBvciBFTkQpXG5cdCogQHBhcmFtIGhhc1Rvb2xzQXZhaWxhYmxlIC0gV2hldGhlciB0b29scyBhcmUgYXZhaWxhYmxlIChpbmNsdWRlcyBkeW5hbWljIHRvb2xzIHZpYSBtaWRkbGV3YXJlKVxuXHQqIEByZXR1cm5zIFJvdXRlciBmdW5jdGlvbiB0aGF0IGhhbmRsZXMganVtcFRvIGxvZ2ljIGFuZCBub3JtYWwgcm91dGluZ1xuXHQqL1xuXHQjY3JlYXRlQWZ0ZXJNb2RlbFJvdXRlcih0b29sQ2xhc3NlcywgYWxsb3dKdW1wLCBleGl0Tm9kZSwgaGFzVG9vbHNBdmFpbGFibGUgPSB0b29sQ2xhc3Nlcy5sZW5ndGggPiAwKSB7XG5cdFx0Y29uc3QgaGFzU3RydWN0dXJlZFJlc3BvbnNlID0gQm9vbGVhbih0aGlzLm9wdGlvbnMucmVzcG9uc2VGb3JtYXQpO1xuXHRcdHJldHVybiAoc3RhdGUpID0+IHtcblx0XHRcdGNvbnN0IGJ1aWx0SW5TdGF0ZSA9IHN0YXRlO1xuXHRcdFx0Y29uc3QgbWVzc2FnZXMgPSBidWlsdEluU3RhdGUubWVzc2FnZXM7XG5cdFx0XHRjb25zdCBsYXN0TWVzc2FnZSA9IG1lc3NhZ2VzLmF0KC0xKTtcblx0XHRcdGlmIChBSU1lc3NhZ2UuaXNJbnN0YW5jZShsYXN0TWVzc2FnZSkgJiYgKCFsYXN0TWVzc2FnZS50b29sX2NhbGxzIHx8IGxhc3RNZXNzYWdlLnRvb2xfY2FsbHMubGVuZ3RoID09PSAwKSkgcmV0dXJuIGV4aXROb2RlO1xuXHRcdFx0aWYgKGFsbG93SnVtcCAmJiBidWlsdEluU3RhdGUuanVtcFRvKSB7XG5cdFx0XHRcdGNvbnN0IGRlc3RpbmF0aW9uID0gcGFyc2VKdW1wVG9UYXJnZXQoYnVpbHRJblN0YXRlLmp1bXBUbyk7XG5cdFx0XHRcdGlmIChkZXN0aW5hdGlvbiA9PT0gRU5EKSByZXR1cm4gZXhpdE5vZGU7XG5cdFx0XHRcdGlmIChkZXN0aW5hdGlvbiA9PT0gVE9PTFNfTk9ERV9OQU1FKSB7XG5cdFx0XHRcdFx0aWYgKCFoYXNUb29sc0F2YWlsYWJsZSkgcmV0dXJuIGV4aXROb2RlO1xuXHRcdFx0XHRcdHJldHVybiBuZXcgU2VuZChUT09MU19OT0RFX05BTUUsIHtcblx0XHRcdFx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0XHRcdFx0anVtcFRvOiB2b2lkIDBcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbmV3IFNlbmQoQUdFTlRfTk9ERV9OQU1FLCB7XG5cdFx0XHRcdFx0Li4uc3RhdGUsXG5cdFx0XHRcdFx0anVtcFRvOiB2b2lkIDBcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRjb25zdCB0b29sTWVzc2FnZXMgPSBtZXNzYWdlcy5maWx0ZXIoVG9vbE1lc3NhZ2UuaXNJbnN0YW5jZSk7XG5cdFx0XHRjb25zdCBsYXN0QWlNZXNzYWdlID0gbWVzc2FnZXMuZmlsdGVyKEFJTWVzc2FnZS5pc0luc3RhbmNlKS5hdCgtMSk7XG5cdFx0XHRjb25zdCBwZW5kaW5nVG9vbENhbGxzID0gbGFzdEFpTWVzc2FnZT8udG9vbF9jYWxscz8uZmlsdGVyKChjYWxsKSA9PiAhdG9vbE1lc3NhZ2VzLnNvbWUoKG0pID0+IG0udG9vbF9jYWxsX2lkID09PSBjYWxsLmlkKSk7XG5cdFx0XHRpZiAocGVuZGluZ1Rvb2xDYWxscyAmJiBwZW5kaW5nVG9vbENhbGxzLmxlbmd0aCA+IDApIHJldHVybiBwZW5kaW5nVG9vbENhbGxzLm1hcCgodG9vbENhbGwpID0+IG5ldyBTZW5kKFRPT0xTX05PREVfTkFNRSwge1xuXHRcdFx0XHQuLi5zdGF0ZSxcblx0XHRcdFx0bGdfdG9vbF9jYWxsOiB0b29sQ2FsbFxuXHRcdFx0fSkpO1xuXHRcdFx0Y29uc3QgaGFzU3RydWN0dXJlZFJlc3BvbnNlQ2FsbHMgPSBsYXN0QWlNZXNzYWdlPy50b29sX2NhbGxzPy5zb21lKCh0b29sQ2FsbCkgPT4gdG9vbENhbGwubmFtZS5zdGFydHNXaXRoKFwiZXh0cmFjdC1cIikpO1xuXHRcdFx0aWYgKHBlbmRpbmdUb29sQ2FsbHMgJiYgcGVuZGluZ1Rvb2xDYWxscy5sZW5ndGggPT09IDAgJiYgIWhhc1N0cnVjdHVyZWRSZXNwb25zZUNhbGxzICYmIGhhc1N0cnVjdHVyZWRSZXNwb25zZSkgcmV0dXJuIEFHRU5UX05PREVfTkFNRTtcblx0XHRcdGlmICghQUlNZXNzYWdlLmlzSW5zdGFuY2UobGFzdE1lc3NhZ2UpIHx8ICFsYXN0TWVzc2FnZS50b29sX2NhbGxzIHx8IGxhc3RNZXNzYWdlLnRvb2xfY2FsbHMubGVuZ3RoID09PSAwKSByZXR1cm4gZXhpdE5vZGU7XG5cdFx0XHRjb25zdCBoYXNPbmx5U3RydWN0dXJlZFJlc3BvbnNlQ2FsbHMgPSBsYXN0TWVzc2FnZS50b29sX2NhbGxzLmV2ZXJ5KCh0b29sQ2FsbCkgPT4gdG9vbENhbGwubmFtZS5zdGFydHNXaXRoKFwiZXh0cmFjdC1cIikpO1xuXHRcdFx0Y29uc3QgaGFzUmVndWxhclRvb2xDYWxscyA9IGxhc3RNZXNzYWdlLnRvb2xfY2FsbHMuc29tZSgodG9vbENhbGwpID0+ICF0b29sQ2FsbC5uYW1lLnN0YXJ0c1dpdGgoXCJleHRyYWN0LVwiKSk7XG5cdFx0XHRpZiAoaGFzT25seVN0cnVjdHVyZWRSZXNwb25zZUNhbGxzIHx8ICFoYXNSZWd1bGFyVG9vbENhbGxzKSByZXR1cm4gZXhpdE5vZGU7XG5cdFx0XHQvKipcblx0XHRcdCogRm9yIHJvdXRpbmcgZnJvbSBhZnRlck1vZGVsIG5vZGVzLCBhbHdheXMgdXNlIHNpbXBsZSBzdHJpbmcgcGF0aHNcblx0XHRcdCogVGhlIFNlbmQgQVBJIGlzIGhhbmRsZWQgYXQgdGhlIG1vZGVsX3JlcXVlc3Qgbm9kZSBsZXZlbFxuXHRcdFx0Ki9cblx0XHRcdHJldHVybiBUT09MU19OT0RFX05BTUU7XG5cdFx0fTtcblx0fVxuXHQvKipcblx0KiBSb3V0ZXIgZm9yIGFmdGVyTW9kZWwgc2VxdWVuY2Ugbm9kZXMgKGNvbm5lY3RpbmcgbGF0ZXIgbWlkZGxld2FyZXMgdG8gZWFybGllciBvbmVzKSxcblx0KiBob25vcmluZyBhbGxvd2VkIGp1bXAgdGFyZ2V0cyBhbmQgZGVmYXVsdGluZyB0byB0aGUgbmV4dCBub2RlLlxuXHQqIEBwYXJhbSB0b29sQ2xhc3NlcyAtIEF2YWlsYWJsZSB0b29sIGNsYXNzZXMgZm9yIHZhbGlkYXRpb25cblx0KiBAcGFyYW0gYWxsb3dlZCAtIExpc3Qgb2YgYWxsb3dlZCBqdW1wIHRhcmdldHNcblx0KiBAcGFyYW0gbmV4dERlZmF1bHQgLSBEZWZhdWx0IG5vZGUgdG8gcm91dGUgdG9cblx0KiBAcGFyYW0gaGFzVG9vbHNBdmFpbGFibGUgLSBXaGV0aGVyIHRvb2xzIGFyZSBhdmFpbGFibGUgKGluY2x1ZGVzIGR5bmFtaWMgdG9vbHMgdmlhIG1pZGRsZXdhcmUpXG5cdCovXG5cdCNjcmVhdGVBZnRlck1vZGVsU2VxdWVuY2VSb3V0ZXIodG9vbENsYXNzZXMsIGFsbG93ZWQsIG5leHREZWZhdWx0LCBoYXNUb29sc0F2YWlsYWJsZSA9IHRvb2xDbGFzc2VzLmxlbmd0aCA+IDApIHtcblx0XHRjb25zdCBhbGxvd2VkU2V0ID0gbmV3IFNldChhbGxvd2VkLm1hcCgodCkgPT4gcGFyc2VKdW1wVG9UYXJnZXQodCkpKTtcblx0XHRyZXR1cm4gKHN0YXRlKSA9PiB7XG5cdFx0XHRjb25zdCBidWlsdEluU3RhdGUgPSBzdGF0ZTtcblx0XHRcdGlmIChidWlsdEluU3RhdGUuanVtcFRvKSB7XG5cdFx0XHRcdGNvbnN0IGRlc3QgPSBwYXJzZUp1bXBUb1RhcmdldChidWlsdEluU3RhdGUuanVtcFRvKTtcblx0XHRcdFx0aWYgKGRlc3QgPT09IEVORCAmJiBhbGxvd2VkU2V0LmhhcyhFTkQpKSByZXR1cm4gRU5EO1xuXHRcdFx0XHRpZiAoZGVzdCA9PT0gVE9PTFNfTk9ERV9OQU1FICYmIGFsbG93ZWRTZXQuaGFzKFRPT0xTX05PREVfTkFNRSkpIHtcblx0XHRcdFx0XHRpZiAoIWhhc1Rvb2xzQXZhaWxhYmxlKSByZXR1cm4gRU5EO1xuXHRcdFx0XHRcdHJldHVybiBuZXcgU2VuZChUT09MU19OT0RFX05BTUUsIHtcblx0XHRcdFx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0XHRcdFx0anVtcFRvOiB2b2lkIDBcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoZGVzdCA9PT0gQUdFTlRfTk9ERV9OQU1FICYmIGFsbG93ZWRTZXQuaGFzKEFHRU5UX05PREVfTkFNRSkpIHJldHVybiBuZXcgU2VuZChBR0VOVF9OT0RFX05BTUUsIHtcblx0XHRcdFx0XHQuLi5zdGF0ZSxcblx0XHRcdFx0XHRqdW1wVG86IHZvaWQgMFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBuZXh0RGVmYXVsdDtcblx0XHR9O1xuXHR9XG5cdC8qKlxuXHQqIENyZWF0ZSByb3V0aW5nIGZ1bmN0aW9uIGZvciBqdW1wVG8gZnVuY3Rpb25hbGl0eSBhZnRlciBiZWZvcmVBZ2VudCBob29rcy5cblx0KiBGYWxscyBiYWNrIHRvIHRoZSBkZWZhdWx0IG5leHQgbm9kZSBpZiBubyBqdW1wVG8gaXMgcHJlc2VudC5cblx0KiBXaGVuIGp1bXBpbmcgdG8gRU5ELCByb3V0ZXMgdG8gZXhpdE5vZGUgKHdoaWNoIGNvdWxkIGJlIGFuIGFmdGVyQWdlbnQgbm9kZSkuXG5cdCogQHBhcmFtIHRvb2xDbGFzc2VzIC0gQXZhaWxhYmxlIHRvb2wgY2xhc3NlcyBmb3IgdmFsaWRhdGlvblxuXHQqIEBwYXJhbSBuZXh0RGVmYXVsdCAtIERlZmF1bHQgbm9kZSB0byByb3V0ZSB0b1xuXHQqIEBwYXJhbSBleGl0Tm9kZSAtIEV4aXQgbm9kZSB0byByb3V0ZSB0byAoY291bGQgYmUgYWZ0ZXJfYWdlbnQgb3IgRU5EKVxuXHQqIEBwYXJhbSBoYXNUb29sc0F2YWlsYWJsZSAtIFdoZXRoZXIgdG9vbHMgYXJlIGF2YWlsYWJsZSAoaW5jbHVkZXMgZHluYW1pYyB0b29scyB2aWEgbWlkZGxld2FyZSlcblx0Ki9cblx0I2NyZWF0ZUJlZm9yZUFnZW50Um91dGVyKHRvb2xDbGFzc2VzLCBuZXh0RGVmYXVsdCwgZXhpdE5vZGUsIGhhc1Rvb2xzQXZhaWxhYmxlID0gdG9vbENsYXNzZXMubGVuZ3RoID4gMCkge1xuXHRcdHJldHVybiAoc3RhdGUpID0+IHtcblx0XHRcdGNvbnN0IGJ1aWx0SW5TdGF0ZSA9IHN0YXRlO1xuXHRcdFx0aWYgKCFidWlsdEluU3RhdGUuanVtcFRvKSByZXR1cm4gbmV4dERlZmF1bHQ7XG5cdFx0XHRjb25zdCBkZXN0aW5hdGlvbiA9IHBhcnNlSnVtcFRvVGFyZ2V0KGJ1aWx0SW5TdGF0ZS5qdW1wVG8pO1xuXHRcdFx0aWYgKGRlc3RpbmF0aW9uID09PSBFTkQpXG4gLyoqXG5cdFx0XHQqIFdoZW4gYmVmb3JlQWdlbnQganVtcHMgdG8gRU5ELCByb3V0ZSB0byBleGl0Tm9kZSAoZmlyc3QgYWZ0ZXJBZ2VudCBub2RlKVxuXHRcdFx0Ki9cblx0XHRcdHJldHVybiBleGl0Tm9kZTtcblx0XHRcdGlmIChkZXN0aW5hdGlvbiA9PT0gVE9PTFNfTk9ERV9OQU1FKSB7XG5cdFx0XHRcdGlmICghaGFzVG9vbHNBdmFpbGFibGUpIHJldHVybiBleGl0Tm9kZTtcblx0XHRcdFx0cmV0dXJuIG5ldyBTZW5kKFRPT0xTX05PREVfTkFNRSwge1xuXHRcdFx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0XHRcdGp1bXBUbzogdm9pZCAwXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG5ldyBTZW5kKEFHRU5UX05PREVfTkFNRSwge1xuXHRcdFx0XHQuLi5zdGF0ZSxcblx0XHRcdFx0anVtcFRvOiB2b2lkIDBcblx0XHRcdH0pO1xuXHRcdH07XG5cdH1cblx0LyoqXG5cdCogQ3JlYXRlIHJvdXRpbmcgZnVuY3Rpb24gZm9yIGp1bXBUbyBmdW5jdGlvbmFsaXR5IGFmdGVyIGJlZm9yZU1vZGVsIGhvb2tzLlxuXHQqIEZhbGxzIGJhY2sgdG8gdGhlIGRlZmF1bHQgbmV4dCBub2RlIGlmIG5vIGp1bXBUbyBpcyBwcmVzZW50LlxuXHQqIEBwYXJhbSB0b29sQ2xhc3NlcyAtIEF2YWlsYWJsZSB0b29sIGNsYXNzZXMgZm9yIHZhbGlkYXRpb25cblx0KiBAcGFyYW0gbmV4dERlZmF1bHQgLSBEZWZhdWx0IG5vZGUgdG8gcm91dGUgdG9cblx0KiBAcGFyYW0gaGFzVG9vbHNBdmFpbGFibGUgLSBXaGV0aGVyIHRvb2xzIGFyZSBhdmFpbGFibGUgKGluY2x1ZGVzIGR5bmFtaWMgdG9vbHMgdmlhIG1pZGRsZXdhcmUpXG5cdCovXG5cdCNjcmVhdGVCZWZvcmVNb2RlbFJvdXRlcih0b29sQ2xhc3NlcywgbmV4dERlZmF1bHQsIGhhc1Rvb2xzQXZhaWxhYmxlID0gdG9vbENsYXNzZXMubGVuZ3RoID4gMCkge1xuXHRcdHJldHVybiAoc3RhdGUpID0+IHtcblx0XHRcdGNvbnN0IGJ1aWx0SW5TdGF0ZSA9IHN0YXRlO1xuXHRcdFx0aWYgKCFidWlsdEluU3RhdGUuanVtcFRvKSByZXR1cm4gbmV4dERlZmF1bHQ7XG5cdFx0XHRjb25zdCBkZXN0aW5hdGlvbiA9IHBhcnNlSnVtcFRvVGFyZ2V0KGJ1aWx0SW5TdGF0ZS5qdW1wVG8pO1xuXHRcdFx0aWYgKGRlc3RpbmF0aW9uID09PSBFTkQpIHJldHVybiBFTkQ7XG5cdFx0XHRpZiAoZGVzdGluYXRpb24gPT09IFRPT0xTX05PREVfTkFNRSkge1xuXHRcdFx0XHRpZiAoIWhhc1Rvb2xzQXZhaWxhYmxlKSByZXR1cm4gRU5EO1xuXHRcdFx0XHRyZXR1cm4gbmV3IFNlbmQoVE9PTFNfTk9ERV9OQU1FLCB7XG5cdFx0XHRcdFx0Li4uc3RhdGUsXG5cdFx0XHRcdFx0anVtcFRvOiB2b2lkIDBcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbmV3IFNlbmQoQUdFTlRfTk9ERV9OQU1FLCB7XG5cdFx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0XHRqdW1wVG86IHZvaWQgMFxuXHRcdFx0fSk7XG5cdFx0fTtcblx0fVxuXHQvKipcblx0KiBJbml0aWFsaXplIG1pZGRsZXdhcmUgc3RhdGVzIGlmIG5vdCBhbHJlYWR5IHByZXNlbnQgaW4gdGhlIGlucHV0IHN0YXRlLlxuXHQqL1xuXHRhc3luYyAjaW5pdGlhbGl6ZU1pZGRsZXdhcmVTdGF0ZXMoc3RhdGUsIGNvbmZpZykge1xuXHRcdGlmICghdGhpcy5vcHRpb25zLm1pZGRsZXdhcmUgfHwgdGhpcy5vcHRpb25zLm1pZGRsZXdhcmUubGVuZ3RoID09PSAwIHx8IHN0YXRlIGluc3RhbmNlb2YgQ29tbWFuZCB8fCAhc3RhdGUpIHJldHVybiBzdGF0ZTtcblx0XHRjb25zdCBkZWZhdWx0U3RhdGVzID0gYXdhaXQgaW5pdGlhbGl6ZU1pZGRsZXdhcmVTdGF0ZXModGhpcy5vcHRpb25zLm1pZGRsZXdhcmUsIHN0YXRlKTtcblx0XHRjb25zdCB1cGRhdGVkU3RhdGUgPSB7XG5cdFx0XHQuLi4oYXdhaXQgdGhpcy4jZ3JhcGguZ2V0U3RhdGUoY29uZmlnKS5jYXRjaCgoKSA9PiAoeyB2YWx1ZXM6IHt9IH0pKSkudmFsdWVzLFxuXHRcdFx0Li4uc3RhdGVcblx0XHR9O1xuXHRcdGlmICghdXBkYXRlZFN0YXRlKSByZXR1cm4gdXBkYXRlZFN0YXRlO1xuXHRcdGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRlZmF1bHRTdGF0ZXMpKSBpZiAoIShrZXkgaW4gdXBkYXRlZFN0YXRlKSkgdXBkYXRlZFN0YXRlW2tleV0gPSB2YWx1ZTtcblx0XHRyZXR1cm4gdXBkYXRlZFN0YXRlO1xuXHR9XG5cdC8qKlxuXHQqIEV4ZWN1dGVzIHRoZSBhZ2VudCB3aXRoIHRoZSBnaXZlbiBzdGF0ZSBhbmQgcmV0dXJucyB0aGUgZmluYWwgc3RhdGUgYWZ0ZXIgYWxsIHByb2Nlc3NpbmcuXG5cdCpcblx0KiBUaGlzIG1ldGhvZCBydW5zIHRoZSBhZ2VudCdzIGVudGlyZSB3b3JrZmxvdyBzeW5jaHJvbm91c2x5LCBpbmNsdWRpbmc6XG5cdCogLSBQcm9jZXNzaW5nIHRoZSBpbnB1dCBtZXNzYWdlcyB0aHJvdWdoIGFueSBjb25maWd1cmVkIG1pZGRsZXdhcmVcblx0KiAtIENhbGxpbmcgdGhlIGxhbmd1YWdlIG1vZGVsIHRvIGdlbmVyYXRlIHJlc3BvbnNlc1xuXHQqIC0gRXhlY3V0aW5nIGFueSB0b29sIGNhbGxzIG1hZGUgYnkgdGhlIG1vZGVsXG5cdCogLSBSdW5uaW5nIGFsbCBtaWRkbGV3YXJlIGhvb2tzIChiZWZvcmVNb2RlbCwgYWZ0ZXJNb2RlbCwgZXRjLilcblx0KlxuXHQqIEBwYXJhbSBzdGF0ZSAtIFRoZSBpbml0aWFsIHN0YXRlIGZvciB0aGUgYWdlbnQgZXhlY3V0aW9uLiBDYW4gYmU6XG5cdCogICAtIEFuIG9iamVjdCBjb250YWluaW5nIGBtZXNzYWdlc2AgYXJyYXkgYW5kIGFueSBtaWRkbGV3YXJlLXNwZWNpZmljIHN0YXRlIHByb3BlcnRpZXNcblx0KiAgIC0gQSBDb21tYW5kIG9iamVjdCBmb3IgbW9yZSBhZHZhbmNlZCBjb250cm9sIGZsb3dcblx0KlxuXHQqIEBwYXJhbSBjb25maWcgLSBPcHRpb25hbCBydW50aW1lIGNvbmZpZ3VyYXRpb24gaW5jbHVkaW5nOlxuXHQqIEBwYXJhbSBjb25maWcuY29udGV4dCAtIFRoZSBjb250ZXh0IGZvciB0aGUgYWdlbnQgZXhlY3V0aW9uLlxuXHQqIEBwYXJhbSBjb25maWcuY29uZmlndXJhYmxlIC0gTGFuZ0dyYXBoIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBsaWtlIGB0aHJlYWRfaWRgLCBgcnVuX2lkYCwgZXRjLlxuXHQqIEBwYXJhbSBjb25maWcuc3RvcmUgLSBUaGUgc3RvcmUgZm9yIHRoZSBhZ2VudCBleGVjdXRpb24gZm9yIHBlcnNpc3Rpbmcgc3RhdGUsIHNlZSBtb3JlIGluIHtAbGluayBodHRwczovL2RvY3MubGFuZ2NoYWluLmNvbS9vc3MvamF2YXNjcmlwdC9sYW5nZ3JhcGgvbWVtb3J5I21lbW9yeS1zdG9yYWdlIHwgTWVtb3J5IHN0b3JhZ2V9LlxuXHQqIEBwYXJhbSBjb25maWcuc2lnbmFsIC0gQW4gb3B0aW9uYWwge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9BYm9ydFNpZ25hbCB8IGBBYm9ydFNpZ25hbGB9IGZvciB0aGUgYWdlbnQgZXhlY3V0aW9uLlxuXHQqIEBwYXJhbSBjb25maWcucmVjdXJzaW9uTGltaXQgLSBUaGUgcmVjdXJzaW9uIGxpbWl0IGZvciB0aGUgYWdlbnQgZXhlY3V0aW9uLlxuXHQqXG5cdCogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIGZpbmFsIGFnZW50IHN0YXRlIGFmdGVyIGV4ZWN1dGlvbiBjb21wbGV0ZXMuXG5cdCogICAgICAgICAgVGhlIHJldHVybmVkIHN0YXRlIGluY2x1ZGVzOlxuXHQqICAgICAgICAgIC0gYSBgbWVzc2FnZXNgIHByb3BlcnR5IGNvbnRhaW5pbmcgYW4gYXJyYXkgd2l0aCBhbGwgbWVzc2FnZXMgKGlucHV0LCBBSSByZXNwb25zZXMsIHRvb2wgY2FsbHMvcmVzdWx0cylcblx0KiAgICAgICAgICAtIGEgYHN0cnVjdHVyZWRSZXNwb25zZWAgcHJvcGVydHkgY29udGFpbmluZyB0aGUgc3RydWN0dXJlZCByZXNwb25zZSAoaWYgY29uZmlndXJlZClcblx0KiAgICAgICAgICAtIGFsbCBzdGF0ZSB2YWx1ZXMgZGVmaW5lZCBpbiB0aGUgbWlkZGxld2FyZVxuXHQqXG5cdCogQGV4YW1wbGVcblx0KiBgYGB0eXBlc2NyaXB0XG5cdCogY29uc3QgYWdlbnQgPSBuZXcgUmVhY3RBZ2VudCh7XG5cdCogICBsbG06IG15TW9kZWwsXG5cdCogICB0b29sczogW2NhbGN1bGF0b3IsIHdlYlNlYXJjaF0sXG5cdCogICByZXNwb25zZUZvcm1hdDogei5vYmplY3Qoe1xuXHQqICAgICB3ZWF0aGVyOiB6LnN0cmluZygpLFxuXHQqICAgfSksXG5cdCogfSk7XG5cdCpcblx0KiBjb25zdCByZXN1bHQgPSBhd2FpdCBhZ2VudC5pbnZva2Uoe1xuXHQqICAgbWVzc2FnZXM6IFt7IHJvbGU6IFwiaHVtYW5cIiwgY29udGVudDogXCJXaGF0J3MgdGhlIHdlYXRoZXIgaW4gUGFyaXM/XCIgfV1cblx0KiB9KTtcblx0KlxuXHQqIGNvbnNvbGUubG9nKHJlc3VsdC5zdHJ1Y3R1cmVkUmVzcG9uc2Uud2VhdGhlcik7IC8vIG91dHB1dHM6IFwiSXQncyBzdW5ueSBhbmQgNzXCsEYuXCJcblx0KiBgYGBcblx0Ki9cblx0YXN5bmMgaW52b2tlKHN0YXRlLCBjb25maWcpIHtcblx0XHRjb25zdCBtZXJnZWRDb25maWcgPSBtZXJnZUNvbmZpZ3ModGhpcy4jZGVmYXVsdENvbmZpZywgY29uZmlnKTtcblx0XHRjb25zdCBpbml0aWFsaXplZFN0YXRlID0gYXdhaXQgdGhpcy4jaW5pdGlhbGl6ZU1pZGRsZXdhcmVTdGF0ZXMoc3RhdGUsIG1lcmdlZENvbmZpZyk7XG5cdFx0cmV0dXJuIHRoaXMuI2dyYXBoLmludm9rZShpbml0aWFsaXplZFN0YXRlLCBtZXJnZWRDb25maWcpO1xuXHR9XG5cdC8qKlxuXHQqIEV4ZWN1dGVzIHRoZSBhZ2VudCB3aXRoIHN0cmVhbWluZywgcmV0dXJuaW5nIGFuIGFzeW5jIGl0ZXJhYmxlIG9mIHN0YXRlIHVwZGF0ZXMgYXMgdGhleSBvY2N1ci5cblx0KlxuXHQqIFRoaXMgbWV0aG9kIHJ1bnMgdGhlIGFnZW50J3Mgd29ya2Zsb3cgc2ltaWxhciB0byBgaW52b2tlYCwgYnV0IGluc3RlYWQgb2Ygd2FpdGluZyBmb3Jcblx0KiBjb21wbGV0aW9uLCBpdCBzdHJlYW1zIGhpZ2gtbGV2ZWwgc3RhdGUgdXBkYXRlcyBpbiByZWFsLXRpbWUuIFRoaXMgYWxsb3dzIHlvdSB0bzpcblx0KiAtIERpc3BsYXkgaW50ZXJtZWRpYXRlIHJlc3VsdHMgdG8gdXNlcnMgYXMgdGhleSdyZSBnZW5lcmF0ZWRcblx0KiAtIE1vbml0b3IgdGhlIGFnZW50J3MgcHJvZ3Jlc3MgdGhyb3VnaCBlYWNoIHN0ZXBcblx0KiAtIFJlYWN0IHRvIHN0YXRlIGNoYW5nZXMgYXMgbm9kZXMgY29tcGxldGVcblx0KlxuXHQqIEZvciBtb3JlIGdyYW51bGFyIGV2ZW50LWxldmVsIHN0cmVhbWluZyAobGlrZSBpbmRpdmlkdWFsIExMTSB0b2tlbnMpLCB1c2UgYHN0cmVhbUV2ZW50c2AgaW5zdGVhZC5cblx0KlxuXHQqIEBwYXJhbSBzdGF0ZSAtIFRoZSBpbml0aWFsIHN0YXRlIGZvciB0aGUgYWdlbnQgZXhlY3V0aW9uLiBDYW4gYmU6XG5cdCogICAtIEFuIG9iamVjdCBjb250YWluaW5nIGBtZXNzYWdlc2AgYXJyYXkgYW5kIGFueSBtaWRkbGV3YXJlLXNwZWNpZmljIHN0YXRlIHByb3BlcnRpZXNcblx0KiAgIC0gQSBDb21tYW5kIG9iamVjdCBmb3IgbW9yZSBhZHZhbmNlZCBjb250cm9sIGZsb3dcblx0KlxuXHQqIEBwYXJhbSBjb25maWcgLSBPcHRpb25hbCBydW50aW1lIGNvbmZpZ3VyYXRpb24gaW5jbHVkaW5nOlxuXHQqIEBwYXJhbSBjb25maWcuY29udGV4dCAtIFRoZSBjb250ZXh0IGZvciB0aGUgYWdlbnQgZXhlY3V0aW9uLlxuXHQqIEBwYXJhbSBjb25maWcuY29uZmlndXJhYmxlIC0gTGFuZ0dyYXBoIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBsaWtlIGB0aHJlYWRfaWRgLCBgcnVuX2lkYCwgZXRjLlxuXHQqIEBwYXJhbSBjb25maWcuc3RvcmUgLSBUaGUgc3RvcmUgZm9yIHRoZSBhZ2VudCBleGVjdXRpb24gZm9yIHBlcnNpc3Rpbmcgc3RhdGUsIHNlZSBtb3JlIGluIHtAbGluayBodHRwczovL2RvY3MubGFuZ2NoYWluLmNvbS9vc3MvamF2YXNjcmlwdC9sYW5nZ3JhcGgvbWVtb3J5I21lbW9yeS1zdG9yYWdlIHwgTWVtb3J5IHN0b3JhZ2V9LlxuXHQqIEBwYXJhbSBjb25maWcuc2lnbmFsIC0gQW4gb3B0aW9uYWwge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9BYm9ydFNpZ25hbCB8IGBBYm9ydFNpZ25hbGB9IGZvciB0aGUgYWdlbnQgZXhlY3V0aW9uLlxuXHQqIEBwYXJhbSBjb25maWcuc3RyZWFtTW9kZSAtIFRoZSBzdHJlYW1pbmcgbW9kZSBmb3IgdGhlIGFnZW50IGV4ZWN1dGlvbiwgc2VlIG1vcmUgaW4ge0BsaW5rIGh0dHBzOi8vZG9jcy5sYW5nY2hhaW4uY29tL29zcy9qYXZhc2NyaXB0L2xhbmdncmFwaC9zdHJlYW1pbmcjc3VwcG9ydGVkLXN0cmVhbS1tb2RlcyB8IFN1cHBvcnRlZCBzdHJlYW0gbW9kZXN9LlxuXHQqIEBwYXJhbSBjb25maWcucmVjdXJzaW9uTGltaXQgLSBUaGUgcmVjdXJzaW9uIGxpbWl0IGZvciB0aGUgYWdlbnQgZXhlY3V0aW9uLlxuXHQqXG5cdCogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYW4gSXRlcmFibGVSZWFkYWJsZVN0cmVhbSBvZiBzdGF0ZSB1cGRhdGVzLlxuXHQqICAgICAgICAgIEVhY2ggdXBkYXRlIGNvbnRhaW5zIHRoZSBjdXJyZW50IHN0YXRlIGFmdGVyIGEgbm9kZSBjb21wbGV0ZXMuXG5cdCpcblx0KiBAZXhhbXBsZVxuXHQqIGBgYHR5cGVzY3JpcHRcblx0KiBjb25zdCBhZ2VudCA9IG5ldyBSZWFjdEFnZW50KHtcblx0KiAgIGxsbTogbXlNb2RlbCxcblx0KiAgIHRvb2xzOiBbY2FsY3VsYXRvciwgd2ViU2VhcmNoXVxuXHQqIH0pO1xuXHQqXG5cdCogY29uc3Qgc3RyZWFtID0gYXdhaXQgYWdlbnQuc3RyZWFtKHtcblx0KiAgIG1lc3NhZ2VzOiBbeyByb2xlOiBcImh1bWFuXCIsIGNvbnRlbnQ6IFwiV2hhdCdzIDIrMiBhbmQgdGhlIHdlYXRoZXIgaW4gTllDP1wiIH1dXG5cdCogfSk7XG5cdCpcblx0KiBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHN0cmVhbSkge1xuXHQqICAgY29uc29sZS5sb2coY2h1bmspOyAvLyBTdGF0ZSB1cGRhdGUgZnJvbSBlYWNoIG5vZGVcblx0KiB9XG5cdCogYGBgXG5cdCovXG5cdGFzeW5jIHN0cmVhbShzdGF0ZSwgY29uZmlnKSB7XG5cdFx0Y29uc3QgbWVyZ2VkQ29uZmlnID0gbWVyZ2VDb25maWdzKHRoaXMuI2RlZmF1bHRDb25maWcsIGNvbmZpZyk7XG5cdFx0Y29uc3QgaW5pdGlhbGl6ZWRTdGF0ZSA9IGF3YWl0IHRoaXMuI2luaXRpYWxpemVNaWRkbGV3YXJlU3RhdGVzKHN0YXRlLCBtZXJnZWRDb25maWcpO1xuXHRcdHJldHVybiB0aGlzLiNncmFwaC5zdHJlYW0oaW5pdGlhbGl6ZWRTdGF0ZSwgbWVyZ2VkQ29uZmlnKTtcblx0fVxuXHQvKipcblx0KiBWaXN1YWxpemUgdGhlIGdyYXBoIGFzIGEgUE5HIGltYWdlLlxuXHQqIEBwYXJhbSBwYXJhbXMgLSBQYXJhbWV0ZXJzIGZvciB0aGUgZHJhd01lcm1haWRQbmcgbWV0aG9kLlxuXHQqIEBwYXJhbSBwYXJhbXMud2l0aFN0eWxlcyAtIFdoZXRoZXIgdG8gaW5jbHVkZSBzdHlsZXMgaW4gdGhlIGdyYXBoLlxuXHQqIEBwYXJhbSBwYXJhbXMuY3VydmVTdHlsZSAtIFRoZSBzdHlsZSBvZiB0aGUgZ3JhcGgncyBjdXJ2ZXMuXG5cdCogQHBhcmFtIHBhcmFtcy5ub2RlQ29sb3JzIC0gVGhlIGNvbG9ycyBvZiB0aGUgZ3JhcGgncyBub2Rlcy5cblx0KiBAcGFyYW0gcGFyYW1zLndyYXBMYWJlbE5Xb3JkcyAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiB3b3JkcyB0byB3cmFwIGluIGEgbm9kZSdzIGxhYmVsLlxuXHQqIEBwYXJhbSBwYXJhbXMuYmFja2dyb3VuZENvbG9yIC0gVGhlIGJhY2tncm91bmQgY29sb3Igb2YgdGhlIGdyYXBoLlxuXHQqIEByZXR1cm5zIFBORyBpbWFnZSBhcyBhIGJ1ZmZlclxuXHQqL1xuXHRhc3luYyBkcmF3TWVybWFpZFBuZyhwYXJhbXMpIHtcblx0XHRjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IChhd2FpdCAoYXdhaXQgdGhpcy4jZ3JhcGguZ2V0R3JhcGhBc3luYygpKS5kcmF3TWVybWFpZFBuZyhwYXJhbXMpKS5hcnJheUJ1ZmZlcigpO1xuXHRcdHJldHVybiBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlcik7XG5cdH1cblx0LyoqXG5cdCogRHJhdyB0aGUgZ3JhcGggYXMgYSBNZXJtYWlkIHN0cmluZy5cblx0KiBAcGFyYW0gcGFyYW1zIC0gUGFyYW1ldGVycyBmb3IgdGhlIGRyYXdNZXJtYWlkIG1ldGhvZC5cblx0KiBAcGFyYW0gcGFyYW1zLndpdGhTdHlsZXMgLSBXaGV0aGVyIHRvIGluY2x1ZGUgc3R5bGVzIGluIHRoZSBncmFwaC5cblx0KiBAcGFyYW0gcGFyYW1zLmN1cnZlU3R5bGUgLSBUaGUgc3R5bGUgb2YgdGhlIGdyYXBoJ3MgY3VydmVzLlxuXHQqIEBwYXJhbSBwYXJhbXMubm9kZUNvbG9ycyAtIFRoZSBjb2xvcnMgb2YgdGhlIGdyYXBoJ3Mgbm9kZXMuXG5cdCogQHBhcmFtIHBhcmFtcy53cmFwTGFiZWxOV29yZHMgLSBUaGUgbWF4aW11bSBudW1iZXIgb2Ygd29yZHMgdG8gd3JhcCBpbiBhIG5vZGUncyBsYWJlbC5cblx0KiBAcGFyYW0gcGFyYW1zLmJhY2tncm91bmRDb2xvciAtIFRoZSBiYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSBncmFwaC5cblx0KiBAcmV0dXJucyBNZXJtYWlkIHN0cmluZ1xuXHQqL1xuXHRhc3luYyBkcmF3TWVybWFpZChwYXJhbXMpIHtcblx0XHRyZXR1cm4gKGF3YWl0IHRoaXMuI2dyYXBoLmdldEdyYXBoQXN5bmMoKSkuZHJhd01lcm1haWQocGFyYW1zKTtcblx0fVxuXHQvKipcblx0KiBUaGUgZm9sbG93aW5nIGFyZSBpbnRlcm5hbCBtZXRob2RzIHRvIGVuYWJsZSBzdXBwb3J0IGZvciBMYW5nR3JhcGggUGxhdGZvcm0uXG5cdCogVGhleSBhcmUgbm90IHBhcnQgb2YgdGhlIGNyZWF0ZUFnZW50IHB1YmxpYyBBUEkuXG5cdCpcblx0KiBOb3RlOiB3ZSBpbnRlbnRpb25hbGx5IHJldHVybiBhcyBgbmV2ZXJgIHRvIGF2b2lkIHR5cGUgZXJyb3JzIGR1ZSB0byB0eXBlIGluZmVyZW5jZS5cblx0Ki9cblx0LyoqXG5cdCogQGludGVybmFsXG5cdCovXG5cdHN0cmVhbUV2ZW50cyhzdGF0ZSwgY29uZmlnLCBzdHJlYW1PcHRpb25zKSB7XG5cdFx0Y29uc3QgbWVyZ2VkQ29uZmlnID0gbWVyZ2VDb25maWdzKHRoaXMuI2RlZmF1bHRDb25maWcsIGNvbmZpZyk7XG5cdFx0cmV0dXJuIHRoaXMuI2dyYXBoLnN0cmVhbUV2ZW50cyhzdGF0ZSwge1xuXHRcdFx0Li4ubWVyZ2VkQ29uZmlnLFxuXHRcdFx0dmVyc2lvbjogY29uZmlnPy52ZXJzaW9uID8/IFwidjJcIlxuXHRcdH0sIHN0cmVhbU9wdGlvbnMpO1xuXHR9XG5cdC8qKlxuXHQqIEBpbnRlcm5hbFxuXHQqL1xuXHRnZXRHcmFwaEFzeW5jKGNvbmZpZykge1xuXHRcdHJldHVybiB0aGlzLiNncmFwaC5nZXRHcmFwaEFzeW5jKGNvbmZpZyk7XG5cdH1cblx0LyoqXG5cdCogQGludGVybmFsXG5cdCovXG5cdGdldFN0YXRlKGNvbmZpZywgb3B0aW9ucykge1xuXHRcdHJldHVybiB0aGlzLiNncmFwaC5nZXRTdGF0ZShjb25maWcsIG9wdGlvbnMpO1xuXHR9XG5cdC8qKlxuXHQqIEBpbnRlcm5hbFxuXHQqL1xuXHRnZXRTdGF0ZUhpc3RvcnkoY29uZmlnLCBvcHRpb25zKSB7XG5cdFx0cmV0dXJuIHRoaXMuI2dyYXBoLmdldFN0YXRlSGlzdG9yeShjb25maWcsIG9wdGlvbnMpO1xuXHR9XG5cdC8qKlxuXHQqIEBpbnRlcm5hbFxuXHQqL1xuXHRnZXRTdWJncmFwaHMobmFtZXNwYWNlLCByZWN1cnNlKSB7XG5cdFx0cmV0dXJuIHRoaXMuI2dyYXBoLmdldFN1YmdyYXBocyhuYW1lc3BhY2UsIHJlY3Vyc2UpO1xuXHR9XG5cdC8qKlxuXHQqIEBpbnRlcm5hbFxuXHQqL1xuXHRnZXRTdWJncmFwaEFzeW5jKG5hbWVzcGFjZSwgcmVjdXJzZSkge1xuXHRcdHJldHVybiB0aGlzLiNncmFwaC5nZXRTdWJncmFwaHNBc3luYyhuYW1lc3BhY2UsIHJlY3Vyc2UpO1xuXHR9XG5cdC8qKlxuXHQqIEBpbnRlcm5hbFxuXHQqL1xuXHR1cGRhdGVTdGF0ZShpbnB1dENvbmZpZywgdmFsdWVzLCBhc05vZGUpIHtcblx0XHRyZXR1cm4gdGhpcy4jZ3JhcGgudXBkYXRlU3RhdGUoaW5wdXRDb25maWcsIHZhbHVlcywgYXNOb2RlKTtcblx0fVxuXHQvKipcblx0KiBAaW50ZXJuYWxcblx0Ki9cblx0Z2V0IGJ1aWxkZXIoKSB7XG5cdFx0cmV0dXJuIHRoaXMuI2dyYXBoLmJ1aWxkZXI7XG5cdH1cbn07XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgUmVhY3RBZ2VudCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVhY3RBZ2VudC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/ReactAgent.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/RunnableCallable.js":
/*!************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/RunnableCallable.js ***!
  \************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RunnableCallable: () => (/* binding */ RunnableCallable)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/runnables/index.js\");\n/* harmony import */ var _langchain_core_singletons__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/singletons */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/singletons/index.js\");\n\n\n\n//#region src/agents/RunnableCallable.ts\nvar RunnableCallable = class extends _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_0__.Runnable {\n\tlc_namespace = [\"langgraph\"];\n\tfunc;\n\ttags;\n\tconfig;\n\ttrace = true;\n\trecurse = true;\n\t#state;\n\tconstructor(fields) {\n\t\tsuper();\n\t\tthis.name = fields.name ?? fields.func.name;\n\t\tthis.func = fields.func;\n\t\tthis.config = fields.tags ? { tags: fields.tags } : void 0;\n\t\tthis.recurse = fields.recurse ?? this.recurse;\n\t}\n\tgetState() {\n\t\treturn this.#state;\n\t}\n\t/**\n\t* This allows us to set the state of the runnable, e.g. for model and middleware nodes.\n\t* @internal\n\t*/\n\tsetState(state) {\n\t\tthis.#state = {\n\t\t\t...this.#state,\n\t\t\t...state\n\t\t};\n\t}\n\tasync invoke(input, options) {\n\t\tconst mergedConfig = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_0__.mergeConfigs)(this.config, options);\n\t\tconst returnValue = await _langchain_core_singletons__WEBPACK_IMPORTED_MODULE_1__.AsyncLocalStorageProviderSingleton.runWithConfig(mergedConfig, async () => this.func(input, mergedConfig));\n\t\tif (_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_0__.Runnable.isRunnable(returnValue) && this.recurse) return await _langchain_core_singletons__WEBPACK_IMPORTED_MODULE_1__.AsyncLocalStorageProviderSingleton.runWithConfig(mergedConfig, async () => returnValue.invoke(input, mergedConfig));\n\t\tthis.#state = returnValue;\n\t\treturn returnValue;\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=RunnableCallable.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvUnVubmFibGVDYWxsYWJsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBbUU7QUFDYTs7QUFFaEY7QUFDQSxxQ0FBcUMsK0RBQVE7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxvQkFBb0I7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsdUVBQVk7QUFDbkMsNEJBQTRCLDBGQUFrQztBQUM5RCxNQUFNLCtEQUFRLHVEQUF1RCwwRkFBa0M7QUFDdkc7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDNEI7QUFDNUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvUnVubmFibGVDYWxsYWJsZS5qcz8wZDkyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJ1bm5hYmxlLCBtZXJnZUNvbmZpZ3MgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3J1bm5hYmxlc1wiO1xuaW1wb3J0IHsgQXN5bmNMb2NhbFN0b3JhZ2VQcm92aWRlclNpbmdsZXRvbiB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvc2luZ2xldG9uc1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9SdW5uYWJsZUNhbGxhYmxlLnRzXG52YXIgUnVubmFibGVDYWxsYWJsZSA9IGNsYXNzIGV4dGVuZHMgUnVubmFibGUge1xuXHRsY19uYW1lc3BhY2UgPSBbXCJsYW5nZ3JhcGhcIl07XG5cdGZ1bmM7XG5cdHRhZ3M7XG5cdGNvbmZpZztcblx0dHJhY2UgPSB0cnVlO1xuXHRyZWN1cnNlID0gdHJ1ZTtcblx0I3N0YXRlO1xuXHRjb25zdHJ1Y3RvcihmaWVsZHMpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMubmFtZSA9IGZpZWxkcy5uYW1lID8/IGZpZWxkcy5mdW5jLm5hbWU7XG5cdFx0dGhpcy5mdW5jID0gZmllbGRzLmZ1bmM7XG5cdFx0dGhpcy5jb25maWcgPSBmaWVsZHMudGFncyA/IHsgdGFnczogZmllbGRzLnRhZ3MgfSA6IHZvaWQgMDtcblx0XHR0aGlzLnJlY3Vyc2UgPSBmaWVsZHMucmVjdXJzZSA/PyB0aGlzLnJlY3Vyc2U7XG5cdH1cblx0Z2V0U3RhdGUoKSB7XG5cdFx0cmV0dXJuIHRoaXMuI3N0YXRlO1xuXHR9XG5cdC8qKlxuXHQqIFRoaXMgYWxsb3dzIHVzIHRvIHNldCB0aGUgc3RhdGUgb2YgdGhlIHJ1bm5hYmxlLCBlLmcuIGZvciBtb2RlbCBhbmQgbWlkZGxld2FyZSBub2Rlcy5cblx0KiBAaW50ZXJuYWxcblx0Ki9cblx0c2V0U3RhdGUoc3RhdGUpIHtcblx0XHR0aGlzLiNzdGF0ZSA9IHtcblx0XHRcdC4uLnRoaXMuI3N0YXRlLFxuXHRcdFx0Li4uc3RhdGVcblx0XHR9O1xuXHR9XG5cdGFzeW5jIGludm9rZShpbnB1dCwgb3B0aW9ucykge1xuXHRcdGNvbnN0IG1lcmdlZENvbmZpZyA9IG1lcmdlQ29uZmlncyh0aGlzLmNvbmZpZywgb3B0aW9ucyk7XG5cdFx0Y29uc3QgcmV0dXJuVmFsdWUgPSBhd2FpdCBBc3luY0xvY2FsU3RvcmFnZVByb3ZpZGVyU2luZ2xldG9uLnJ1bldpdGhDb25maWcobWVyZ2VkQ29uZmlnLCBhc3luYyAoKSA9PiB0aGlzLmZ1bmMoaW5wdXQsIG1lcmdlZENvbmZpZykpO1xuXHRcdGlmIChSdW5uYWJsZS5pc1J1bm5hYmxlKHJldHVyblZhbHVlKSAmJiB0aGlzLnJlY3Vyc2UpIHJldHVybiBhd2FpdCBBc3luY0xvY2FsU3RvcmFnZVByb3ZpZGVyU2luZ2xldG9uLnJ1bldpdGhDb25maWcobWVyZ2VkQ29uZmlnLCBhc3luYyAoKSA9PiByZXR1cm5WYWx1ZS5pbnZva2UoaW5wdXQsIG1lcmdlZENvbmZpZykpO1xuXHRcdHRoaXMuI3N0YXRlID0gcmV0dXJuVmFsdWU7XG5cdFx0cmV0dXJuIHJldHVyblZhbHVlO1xuXHR9XG59O1xuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IFJ1bm5hYmxlQ2FsbGFibGUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJ1bm5hYmxlQ2FsbGFibGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/RunnableCallable.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/annotation.js":
/*!******************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/annotation.js ***!
  \******************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAgentState: () => (/* binding */ createAgentState)\n/* harmony export */ });\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n/* harmony import */ var _langchain_langgraph_zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/langgraph/zod */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/graph/zod/index.js\");\n/* harmony import */ var _langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/utils/types */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/types/index.js\");\n\n\n\n\n//#region src/agents/annotation.ts\nfunction createAgentState(hasStructuredResponse = true, stateSchema, middlewareList = []) {\n\t/**\n\t* Collect fields from state schemas\n\t*/\n\tconst stateFields = { jumpTo: new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.UntrackedValue() };\n\tconst inputFields = {};\n\tconst outputFields = {};\n\tconst applySchema = (schema) => {\n\t\tif (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateSchema.isInstance(schema)) {\n\t\t\tfor (const [key, field] of Object.entries(schema.fields)) if (!(key in stateFields)) {\n\t\t\t\tstateFields[key] = field;\n\t\t\t\tif (key.startsWith(\"_\")) continue;\n\t\t\t\tif (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.ReducedValue.isInstance(field)) {\n\t\t\t\t\tinputFields[key] = field.inputSchema || field.valueSchema;\n\t\t\t\t\toutputFields[key] = field.valueSchema;\n\t\t\t\t} else {\n\t\t\t\t\tinputFields[key] = field;\n\t\t\t\t\toutputFields[key] = field;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tconst shape = (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__.getInteropZodObjectShape)(schema);\n\t\tfor (const [key, fieldSchema] of Object.entries(shape)) {\n\t\t\tconst isPrivate = key.startsWith(\"_\");\n\t\t\tif (!(key in stateFields)) {\n\t\t\t\tif ((0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__.isZodSchemaV4)(fieldSchema)) {\n\t\t\t\t\tconst meta = _langchain_langgraph_zod__WEBPACK_IMPORTED_MODULE_1__.schemaMetaRegistry.get(fieldSchema);\n\t\t\t\t\tif (meta?.reducer) {\n\t\t\t\t\t\tif (meta.reducer.schema) {\n\t\t\t\t\t\t\tstateFields[key] = new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.ReducedValue(fieldSchema, {\n\t\t\t\t\t\t\t\tinputSchema: meta.reducer.schema,\n\t\t\t\t\t\t\t\treducer: meta.reducer.fn\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (!isPrivate) {\n\t\t\t\t\t\t\t\tinputFields[key] = meta.reducer.schema;\n\t\t\t\t\t\t\t\toutputFields[key] = fieldSchema;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstateFields[key] = new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.ReducedValue(fieldSchema, { reducer: meta.reducer.fn });\n\t\t\t\t\t\t\tif (!isPrivate) {\n\t\t\t\t\t\t\t\tinputFields[key] = fieldSchema;\n\t\t\t\t\t\t\t\toutputFields[key] = fieldSchema;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstateFields[key] = fieldSchema;\n\t\t\t\tif (!isPrivate) {\n\t\t\t\t\tinputFields[key] = fieldSchema;\n\t\t\t\t\toutputFields[key] = fieldSchema;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\t/**\n\t* Add state schema properties from user-provided schema.\n\t* Supports both StateSchema and Zod v3/v4 objects.\n\t*/\n\tif (stateSchema && (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateSchema.isInstance(stateSchema) || (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__.isInteropZodObject)(stateSchema))) applySchema(stateSchema);\n\t/**\n\t* Add state schema properties from middleware.\n\t* Supports both StateSchema and Zod v3/v4 objects.\n\t*/\n\tfor (const middleware of middlewareList) if (middleware.stateSchema && (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateSchema.isInstance(middleware.stateSchema) || (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__.isInteropZodObject)(middleware.stateSchema))) applySchema(middleware.stateSchema);\n\tif (hasStructuredResponse) outputFields.structuredResponse = new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.UntrackedValue();\n\t/**\n\t* Create StateSchema instances for state, input, and output.\n\t* Using MessagesValue provides the proper message reducer behavior.\n\t*/\n\treturn {\n\t\tstate: new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateSchema({\n\t\t\tmessages: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.MessagesValue,\n\t\t\t...stateFields\n\t\t}),\n\t\tinput: new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateSchema({\n\t\t\tmessages: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.MessagesValue,\n\t\t\t...inputFields\n\t\t}),\n\t\toutput: new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateSchema({\n\t\t\tmessages: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.MessagesValue,\n\t\t\t...outputFields\n\t\t})\n\t};\n}\n\n//#endregion\n\n//# sourceMappingURL=annotation.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvYW5ub3RhdGlvbi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWdHO0FBQ2xDO0FBQzRDOztBQUUxRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLFlBQVksZ0VBQWM7QUFDakQ7QUFDQTtBQUNBO0FBQ0EsTUFBTSw2REFBVztBQUNqQjtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhEQUFZO0FBQ3BCO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHFGQUF3QjtBQUN4QztBQUNBO0FBQ0E7QUFDQSxRQUFRLDBFQUFhO0FBQ3JCLGtCQUFrQix3RUFBa0I7QUFDcEM7QUFDQTtBQUNBLDhCQUE4Qiw4REFBWTtBQUMxQztBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSLDhCQUE4Qiw4REFBWSxnQkFBZ0IsMEJBQTBCO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsNkRBQVcsNEJBQTRCLCtFQUFrQjtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlFQUF5RSw2REFBVyx1Q0FBdUMsK0VBQWtCO0FBQzdJLGtFQUFrRSxnRUFBYztBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw2REFBVztBQUN4QixhQUFhLCtEQUFhO0FBQzFCO0FBQ0EsR0FBRztBQUNILGFBQWEsNkRBQVc7QUFDeEIsYUFBYSwrREFBYTtBQUMxQjtBQUNBLEdBQUc7QUFDSCxjQUFjLDZEQUFXO0FBQ3pCLGFBQWEsK0RBQWE7QUFDMUI7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUM0QjtBQUM1QiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL25vZGVfbW9kdWxlcy8ucG5wbS9sYW5nY2hhaW5AMS4yLjI2X0BsYW5nY2hhaW4rY29yZUAxLjEuMjhfb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX19vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fcmVfZXgyYjV5M3R6ZjdoMmN4bW11aTVxb2lhc3kvbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2FnZW50cy9hbm5vdGF0aW9uLmpzPzNjYmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTWVzc2FnZXNWYWx1ZSwgUmVkdWNlZFZhbHVlLCBTdGF0ZVNjaGVtYSwgVW50cmFja2VkVmFsdWUgfSBmcm9tIFwiQGxhbmdjaGFpbi9sYW5nZ3JhcGhcIjtcbmltcG9ydCB7IHNjaGVtYU1ldGFSZWdpc3RyeSB9IGZyb20gXCJAbGFuZ2NoYWluL2xhbmdncmFwaC96b2RcIjtcbmltcG9ydCB7IGdldEludGVyb3Bab2RPYmplY3RTaGFwZSwgaXNJbnRlcm9wWm9kT2JqZWN0LCBpc1pvZFNjaGVtYVY0IH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS91dGlscy90eXBlc1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9hbm5vdGF0aW9uLnRzXG5mdW5jdGlvbiBjcmVhdGVBZ2VudFN0YXRlKGhhc1N0cnVjdHVyZWRSZXNwb25zZSA9IHRydWUsIHN0YXRlU2NoZW1hLCBtaWRkbGV3YXJlTGlzdCA9IFtdKSB7XG5cdC8qKlxuXHQqIENvbGxlY3QgZmllbGRzIGZyb20gc3RhdGUgc2NoZW1hc1xuXHQqL1xuXHRjb25zdCBzdGF0ZUZpZWxkcyA9IHsganVtcFRvOiBuZXcgVW50cmFja2VkVmFsdWUoKSB9O1xuXHRjb25zdCBpbnB1dEZpZWxkcyA9IHt9O1xuXHRjb25zdCBvdXRwdXRGaWVsZHMgPSB7fTtcblx0Y29uc3QgYXBwbHlTY2hlbWEgPSAoc2NoZW1hKSA9PiB7XG5cdFx0aWYgKFN0YXRlU2NoZW1hLmlzSW5zdGFuY2Uoc2NoZW1hKSkge1xuXHRcdFx0Zm9yIChjb25zdCBba2V5LCBmaWVsZF0gb2YgT2JqZWN0LmVudHJpZXMoc2NoZW1hLmZpZWxkcykpIGlmICghKGtleSBpbiBzdGF0ZUZpZWxkcykpIHtcblx0XHRcdFx0c3RhdGVGaWVsZHNba2V5XSA9IGZpZWxkO1xuXHRcdFx0XHRpZiAoa2V5LnN0YXJ0c1dpdGgoXCJfXCIpKSBjb250aW51ZTtcblx0XHRcdFx0aWYgKFJlZHVjZWRWYWx1ZS5pc0luc3RhbmNlKGZpZWxkKSkge1xuXHRcdFx0XHRcdGlucHV0RmllbGRzW2tleV0gPSBmaWVsZC5pbnB1dFNjaGVtYSB8fCBmaWVsZC52YWx1ZVNjaGVtYTtcblx0XHRcdFx0XHRvdXRwdXRGaWVsZHNba2V5XSA9IGZpZWxkLnZhbHVlU2NoZW1hO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlucHV0RmllbGRzW2tleV0gPSBmaWVsZDtcblx0XHRcdFx0XHRvdXRwdXRGaWVsZHNba2V5XSA9IGZpZWxkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGNvbnN0IHNoYXBlID0gZ2V0SW50ZXJvcFpvZE9iamVjdFNoYXBlKHNjaGVtYSk7XG5cdFx0Zm9yIChjb25zdCBba2V5LCBmaWVsZFNjaGVtYV0gb2YgT2JqZWN0LmVudHJpZXMoc2hhcGUpKSB7XG5cdFx0XHRjb25zdCBpc1ByaXZhdGUgPSBrZXkuc3RhcnRzV2l0aChcIl9cIik7XG5cdFx0XHRpZiAoIShrZXkgaW4gc3RhdGVGaWVsZHMpKSB7XG5cdFx0XHRcdGlmIChpc1pvZFNjaGVtYVY0KGZpZWxkU2NoZW1hKSkge1xuXHRcdFx0XHRcdGNvbnN0IG1ldGEgPSBzY2hlbWFNZXRhUmVnaXN0cnkuZ2V0KGZpZWxkU2NoZW1hKTtcblx0XHRcdFx0XHRpZiAobWV0YT8ucmVkdWNlcikge1xuXHRcdFx0XHRcdFx0aWYgKG1ldGEucmVkdWNlci5zY2hlbWEpIHtcblx0XHRcdFx0XHRcdFx0c3RhdGVGaWVsZHNba2V5XSA9IG5ldyBSZWR1Y2VkVmFsdWUoZmllbGRTY2hlbWEsIHtcblx0XHRcdFx0XHRcdFx0XHRpbnB1dFNjaGVtYTogbWV0YS5yZWR1Y2VyLnNjaGVtYSxcblx0XHRcdFx0XHRcdFx0XHRyZWR1Y2VyOiBtZXRhLnJlZHVjZXIuZm5cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGlmICghaXNQcml2YXRlKSB7XG5cdFx0XHRcdFx0XHRcdFx0aW5wdXRGaWVsZHNba2V5XSA9IG1ldGEucmVkdWNlci5zY2hlbWE7XG5cdFx0XHRcdFx0XHRcdFx0b3V0cHV0RmllbGRzW2tleV0gPSBmaWVsZFNjaGVtYTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0c3RhdGVGaWVsZHNba2V5XSA9IG5ldyBSZWR1Y2VkVmFsdWUoZmllbGRTY2hlbWEsIHsgcmVkdWNlcjogbWV0YS5yZWR1Y2VyLmZuIH0pO1xuXHRcdFx0XHRcdFx0XHRpZiAoIWlzUHJpdmF0ZSkge1xuXHRcdFx0XHRcdFx0XHRcdGlucHV0RmllbGRzW2tleV0gPSBmaWVsZFNjaGVtYTtcblx0XHRcdFx0XHRcdFx0XHRvdXRwdXRGaWVsZHNba2V5XSA9IGZpZWxkU2NoZW1hO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0c3RhdGVGaWVsZHNba2V5XSA9IGZpZWxkU2NoZW1hO1xuXHRcdFx0XHRpZiAoIWlzUHJpdmF0ZSkge1xuXHRcdFx0XHRcdGlucHV0RmllbGRzW2tleV0gPSBmaWVsZFNjaGVtYTtcblx0XHRcdFx0XHRvdXRwdXRGaWVsZHNba2V5XSA9IGZpZWxkU2NoZW1hO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXHQvKipcblx0KiBBZGQgc3RhdGUgc2NoZW1hIHByb3BlcnRpZXMgZnJvbSB1c2VyLXByb3ZpZGVkIHNjaGVtYS5cblx0KiBTdXBwb3J0cyBib3RoIFN0YXRlU2NoZW1hIGFuZCBab2QgdjMvdjQgb2JqZWN0cy5cblx0Ki9cblx0aWYgKHN0YXRlU2NoZW1hICYmIChTdGF0ZVNjaGVtYS5pc0luc3RhbmNlKHN0YXRlU2NoZW1hKSB8fCBpc0ludGVyb3Bab2RPYmplY3Qoc3RhdGVTY2hlbWEpKSkgYXBwbHlTY2hlbWEoc3RhdGVTY2hlbWEpO1xuXHQvKipcblx0KiBBZGQgc3RhdGUgc2NoZW1hIHByb3BlcnRpZXMgZnJvbSBtaWRkbGV3YXJlLlxuXHQqIFN1cHBvcnRzIGJvdGggU3RhdGVTY2hlbWEgYW5kIFpvZCB2My92NCBvYmplY3RzLlxuXHQqL1xuXHRmb3IgKGNvbnN0IG1pZGRsZXdhcmUgb2YgbWlkZGxld2FyZUxpc3QpIGlmIChtaWRkbGV3YXJlLnN0YXRlU2NoZW1hICYmIChTdGF0ZVNjaGVtYS5pc0luc3RhbmNlKG1pZGRsZXdhcmUuc3RhdGVTY2hlbWEpIHx8IGlzSW50ZXJvcFpvZE9iamVjdChtaWRkbGV3YXJlLnN0YXRlU2NoZW1hKSkpIGFwcGx5U2NoZW1hKG1pZGRsZXdhcmUuc3RhdGVTY2hlbWEpO1xuXHRpZiAoaGFzU3RydWN0dXJlZFJlc3BvbnNlKSBvdXRwdXRGaWVsZHMuc3RydWN0dXJlZFJlc3BvbnNlID0gbmV3IFVudHJhY2tlZFZhbHVlKCk7XG5cdC8qKlxuXHQqIENyZWF0ZSBTdGF0ZVNjaGVtYSBpbnN0YW5jZXMgZm9yIHN0YXRlLCBpbnB1dCwgYW5kIG91dHB1dC5cblx0KiBVc2luZyBNZXNzYWdlc1ZhbHVlIHByb3ZpZGVzIHRoZSBwcm9wZXIgbWVzc2FnZSByZWR1Y2VyIGJlaGF2aW9yLlxuXHQqL1xuXHRyZXR1cm4ge1xuXHRcdHN0YXRlOiBuZXcgU3RhdGVTY2hlbWEoe1xuXHRcdFx0bWVzc2FnZXM6IE1lc3NhZ2VzVmFsdWUsXG5cdFx0XHQuLi5zdGF0ZUZpZWxkc1xuXHRcdH0pLFxuXHRcdGlucHV0OiBuZXcgU3RhdGVTY2hlbWEoe1xuXHRcdFx0bWVzc2FnZXM6IE1lc3NhZ2VzVmFsdWUsXG5cdFx0XHQuLi5pbnB1dEZpZWxkc1xuXHRcdH0pLFxuXHRcdG91dHB1dDogbmV3IFN0YXRlU2NoZW1hKHtcblx0XHRcdG1lc3NhZ2VzOiBNZXNzYWdlc1ZhbHVlLFxuXHRcdFx0Li4ub3V0cHV0RmllbGRzXG5cdFx0fSlcblx0fTtcbn1cblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyBjcmVhdGVBZ2VudFN0YXRlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbm5vdGF0aW9uLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/annotation.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/errors.js":
/*!**************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/errors.js ***!
  \**************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MiddlewareError: () => (/* binding */ MiddlewareError),\n/* harmony export */   MultipleStructuredOutputsError: () => (/* binding */ MultipleStructuredOutputsError),\n/* harmony export */   MultipleToolsBoundError: () => (/* binding */ MultipleToolsBoundError),\n/* harmony export */   StructuredOutputParsingError: () => (/* binding */ StructuredOutputParsingError),\n/* harmony export */   ToolInvocationError: () => (/* binding */ ToolInvocationError)\n/* harmony export */ });\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n\n\n//#region src/agents/errors.ts\nvar MultipleToolsBoundError = class extends Error {\n\tconstructor() {\n\t\tsuper(\"The provided LLM already has bound tools. Please provide an LLM without bound tools to createAgent. The agent will bind the tools provided in the 'tools' parameter.\");\n\t}\n};\n/**\n* Raised when model returns multiple structured output tool calls when only one is expected.\n*/\nvar MultipleStructuredOutputsError = class extends Error {\n\ttoolNames;\n\tconstructor(toolNames) {\n\t\tsuper(`The model has called multiple tools: ${toolNames.join(\", \")} to return a structured output. This is not supported. Please provide a single structured output.`);\n\t\tthis.toolNames = toolNames;\n\t}\n};\n/**\n* Raised when structured output tool call arguments fail to parse according to the schema.\n*/\nvar StructuredOutputParsingError = class extends Error {\n\ttoolName;\n\terrors;\n\tconstructor(toolName, errors) {\n\t\tsuper(`Failed to parse structured output for tool '${toolName}':${errors.map((e) => `\\n  - ${e}`).join(\"\")}.`);\n\t\tthis.toolName = toolName;\n\t\tthis.errors = errors;\n\t}\n};\n/**\n* Raised when a tool call is throwing an error.\n*/\nvar ToolInvocationError = class extends Error {\n\ttoolCall;\n\ttoolError;\n\tconstructor(toolError, toolCall) {\n\t\tconst error = toolError instanceof Error ? toolError : new Error(String(toolError));\n\t\tconst toolArgs = JSON.stringify(toolCall.args);\n\t\tsuper(`Error invoking tool '${toolCall.name}' with kwargs ${toolArgs} with error: ${error.stack}\\n Please fix the error and try again.`);\n\t\tthis.toolCall = toolCall;\n\t\tthis.toolError = error;\n\t}\n};\n/**\n* Error thrown when a middleware fails.\n*\n* Use `MiddlewareError.wrap()` to create instances. The constructor is private\n* to ensure that GraphBubbleUp errors (like GraphInterrupt) are never wrapped.\n*/\nvar MiddlewareError = class MiddlewareError extends Error {\n\tstatic \"~brand\" = \"MiddlewareError\";\n\tconstructor(error, middlewareName) {\n\t\tconst errorMessage = error instanceof Error ? error.message : String(error);\n\t\tsuper(errorMessage);\n\t\tthis.name = error instanceof Error ? error.name : `${middlewareName[0].toUpperCase() + middlewareName.slice(1)}Error`;\n\t\tif (error instanceof Error) this.cause = error;\n\t}\n\t/**\n\t* Wrap an error in a MiddlewareError, unless it's a GraphBubbleUp error\n\t* (like GraphInterrupt) which should propagate unchanged.\n\t*\n\t* @param error - The error to wrap\n\t* @param middlewareName - The name of the middleware that threw the error\n\t* @returns The original error if it's a GraphBubbleUp, otherwise a new MiddlewareError\n\t*/\n\tstatic wrap(error, middlewareName) {\n\t\tif ((0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.isGraphBubbleUp)(error)) return error;\n\t\treturn new MiddlewareError(error, middlewareName);\n\t}\n\t/**\n\t* Check if the error is a MiddlewareError.\n\t* @param error - The error to check\n\t* @returns Whether the error is a MiddlewareError\n\t*/\n\tstatic isInstance(error) {\n\t\treturn error instanceof Error && \"~brand\" in error && error[\"~brand\"] === \"MiddlewareError\";\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=errors.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvZXJyb3JzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUF1RDs7QUFFdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELHNCQUFzQjtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCxTQUFTLElBQUksMkJBQTJCLEVBQUUsWUFBWTtBQUM3RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxjQUFjLGdCQUFnQixVQUFVLGNBQWMsWUFBWTtBQUNsRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsMERBQTBEO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLHFFQUFlO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDdUk7QUFDdkkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvZXJyb3JzLmpzP2I3ZmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNHcmFwaEJ1YmJsZVVwIH0gZnJvbSBcIkBsYW5nY2hhaW4vbGFuZ2dyYXBoXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL2Vycm9ycy50c1xudmFyIE11bHRpcGxlVG9vbHNCb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBFcnJvciB7XG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHN1cGVyKFwiVGhlIHByb3ZpZGVkIExMTSBhbHJlYWR5IGhhcyBib3VuZCB0b29scy4gUGxlYXNlIHByb3ZpZGUgYW4gTExNIHdpdGhvdXQgYm91bmQgdG9vbHMgdG8gY3JlYXRlQWdlbnQuIFRoZSBhZ2VudCB3aWxsIGJpbmQgdGhlIHRvb2xzIHByb3ZpZGVkIGluIHRoZSAndG9vbHMnIHBhcmFtZXRlci5cIik7XG5cdH1cbn07XG4vKipcbiogUmFpc2VkIHdoZW4gbW9kZWwgcmV0dXJucyBtdWx0aXBsZSBzdHJ1Y3R1cmVkIG91dHB1dCB0b29sIGNhbGxzIHdoZW4gb25seSBvbmUgaXMgZXhwZWN0ZWQuXG4qL1xudmFyIE11bHRpcGxlU3RydWN0dXJlZE91dHB1dHNFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuXHR0b29sTmFtZXM7XG5cdGNvbnN0cnVjdG9yKHRvb2xOYW1lcykge1xuXHRcdHN1cGVyKGBUaGUgbW9kZWwgaGFzIGNhbGxlZCBtdWx0aXBsZSB0b29sczogJHt0b29sTmFtZXMuam9pbihcIiwgXCIpfSB0byByZXR1cm4gYSBzdHJ1Y3R1cmVkIG91dHB1dC4gVGhpcyBpcyBub3Qgc3VwcG9ydGVkLiBQbGVhc2UgcHJvdmlkZSBhIHNpbmdsZSBzdHJ1Y3R1cmVkIG91dHB1dC5gKTtcblx0XHR0aGlzLnRvb2xOYW1lcyA9IHRvb2xOYW1lcztcblx0fVxufTtcbi8qKlxuKiBSYWlzZWQgd2hlbiBzdHJ1Y3R1cmVkIG91dHB1dCB0b29sIGNhbGwgYXJndW1lbnRzIGZhaWwgdG8gcGFyc2UgYWNjb3JkaW5nIHRvIHRoZSBzY2hlbWEuXG4qL1xudmFyIFN0cnVjdHVyZWRPdXRwdXRQYXJzaW5nRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcblx0dG9vbE5hbWU7XG5cdGVycm9ycztcblx0Y29uc3RydWN0b3IodG9vbE5hbWUsIGVycm9ycykge1xuXHRcdHN1cGVyKGBGYWlsZWQgdG8gcGFyc2Ugc3RydWN0dXJlZCBvdXRwdXQgZm9yIHRvb2wgJyR7dG9vbE5hbWV9Jzoke2Vycm9ycy5tYXAoKGUpID0+IGBcXG4gIC0gJHtlfWApLmpvaW4oXCJcIil9LmApO1xuXHRcdHRoaXMudG9vbE5hbWUgPSB0b29sTmFtZTtcblx0XHR0aGlzLmVycm9ycyA9IGVycm9ycztcblx0fVxufTtcbi8qKlxuKiBSYWlzZWQgd2hlbiBhIHRvb2wgY2FsbCBpcyB0aHJvd2luZyBhbiBlcnJvci5cbiovXG52YXIgVG9vbEludm9jYXRpb25FcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuXHR0b29sQ2FsbDtcblx0dG9vbEVycm9yO1xuXHRjb25zdHJ1Y3Rvcih0b29sRXJyb3IsIHRvb2xDYWxsKSB7XG5cdFx0Y29uc3QgZXJyb3IgPSB0b29sRXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IHRvb2xFcnJvciA6IG5ldyBFcnJvcihTdHJpbmcodG9vbEVycm9yKSk7XG5cdFx0Y29uc3QgdG9vbEFyZ3MgPSBKU09OLnN0cmluZ2lmeSh0b29sQ2FsbC5hcmdzKTtcblx0XHRzdXBlcihgRXJyb3IgaW52b2tpbmcgdG9vbCAnJHt0b29sQ2FsbC5uYW1lfScgd2l0aCBrd2FyZ3MgJHt0b29sQXJnc30gd2l0aCBlcnJvcjogJHtlcnJvci5zdGFja31cXG4gUGxlYXNlIGZpeCB0aGUgZXJyb3IgYW5kIHRyeSBhZ2Fpbi5gKTtcblx0XHR0aGlzLnRvb2xDYWxsID0gdG9vbENhbGw7XG5cdFx0dGhpcy50b29sRXJyb3IgPSBlcnJvcjtcblx0fVxufTtcbi8qKlxuKiBFcnJvciB0aHJvd24gd2hlbiBhIG1pZGRsZXdhcmUgZmFpbHMuXG4qXG4qIFVzZSBgTWlkZGxld2FyZUVycm9yLndyYXAoKWAgdG8gY3JlYXRlIGluc3RhbmNlcy4gVGhlIGNvbnN0cnVjdG9yIGlzIHByaXZhdGVcbiogdG8gZW5zdXJlIHRoYXQgR3JhcGhCdWJibGVVcCBlcnJvcnMgKGxpa2UgR3JhcGhJbnRlcnJ1cHQpIGFyZSBuZXZlciB3cmFwcGVkLlxuKi9cbnZhciBNaWRkbGV3YXJlRXJyb3IgPSBjbGFzcyBNaWRkbGV3YXJlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG5cdHN0YXRpYyBcIn5icmFuZFwiID0gXCJNaWRkbGV3YXJlRXJyb3JcIjtcblx0Y29uc3RydWN0b3IoZXJyb3IsIG1pZGRsZXdhcmVOYW1lKSB7XG5cdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdHN1cGVyKGVycm9yTWVzc2FnZSk7XG5cdFx0dGhpcy5uYW1lID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm5hbWUgOiBgJHttaWRkbGV3YXJlTmFtZVswXS50b1VwcGVyQ2FzZSgpICsgbWlkZGxld2FyZU5hbWUuc2xpY2UoMSl9RXJyb3JgO1xuXHRcdGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB0aGlzLmNhdXNlID0gZXJyb3I7XG5cdH1cblx0LyoqXG5cdCogV3JhcCBhbiBlcnJvciBpbiBhIE1pZGRsZXdhcmVFcnJvciwgdW5sZXNzIGl0J3MgYSBHcmFwaEJ1YmJsZVVwIGVycm9yXG5cdCogKGxpa2UgR3JhcGhJbnRlcnJ1cHQpIHdoaWNoIHNob3VsZCBwcm9wYWdhdGUgdW5jaGFuZ2VkLlxuXHQqXG5cdCogQHBhcmFtIGVycm9yIC0gVGhlIGVycm9yIHRvIHdyYXBcblx0KiBAcGFyYW0gbWlkZGxld2FyZU5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgbWlkZGxld2FyZSB0aGF0IHRocmV3IHRoZSBlcnJvclxuXHQqIEByZXR1cm5zIFRoZSBvcmlnaW5hbCBlcnJvciBpZiBpdCdzIGEgR3JhcGhCdWJibGVVcCwgb3RoZXJ3aXNlIGEgbmV3IE1pZGRsZXdhcmVFcnJvclxuXHQqL1xuXHRzdGF0aWMgd3JhcChlcnJvciwgbWlkZGxld2FyZU5hbWUpIHtcblx0XHRpZiAoaXNHcmFwaEJ1YmJsZVVwKGVycm9yKSkgcmV0dXJuIGVycm9yO1xuXHRcdHJldHVybiBuZXcgTWlkZGxld2FyZUVycm9yKGVycm9yLCBtaWRkbGV3YXJlTmFtZSk7XG5cdH1cblx0LyoqXG5cdCogQ2hlY2sgaWYgdGhlIGVycm9yIGlzIGEgTWlkZGxld2FyZUVycm9yLlxuXHQqIEBwYXJhbSBlcnJvciAtIFRoZSBlcnJvciB0byBjaGVja1xuXHQqIEByZXR1cm5zIFdoZXRoZXIgdGhlIGVycm9yIGlzIGEgTWlkZGxld2FyZUVycm9yXG5cdCovXG5cdHN0YXRpYyBpc0luc3RhbmNlKGVycm9yKSB7XG5cdFx0cmV0dXJuIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgXCJ+YnJhbmRcIiBpbiBlcnJvciAmJiBlcnJvcltcIn5icmFuZFwiXSA9PT0gXCJNaWRkbGV3YXJlRXJyb3JcIjtcblx0fVxufTtcblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyBNaWRkbGV3YXJlRXJyb3IsIE11bHRpcGxlU3RydWN0dXJlZE91dHB1dHNFcnJvciwgTXVsdGlwbGVUb29sc0JvdW5kRXJyb3IsIFN0cnVjdHVyZWRPdXRwdXRQYXJzaW5nRXJyb3IsIFRvb2xJbnZvY2F0aW9uRXJyb3IgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVycm9ycy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/errors.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/index.js":
/*!*************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/index.js ***!
  \*************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAgent: () => (/* binding */ createAgent)\n/* harmony export */ });\n/* harmony import */ var _errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./errors.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/errors.js\");\n/* harmony import */ var _responses_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./responses.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/responses.js\");\n/* harmony import */ var _ReactAgent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ReactAgent.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/ReactAgent.js\");\n/* harmony import */ var _middleware_types_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./middleware/types.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/types.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _tests_utils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./tests/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/tests/utils.js\");\n\n\n\n\n\n\n\n//#region src/agents/index.ts\nfunction createAgent(params) {\n\treturn new _ReactAgent_js__WEBPACK_IMPORTED_MODULE_2__.ReactAgent(params);\n}\n\n//#endregion\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUEwSjtBQUMxRDtBQUNuRDtBQUNZO0FBQ047QUFDSzs7QUFFeEQ7QUFDQTtBQUNBLFlBQVksc0RBQVU7QUFDdEI7O0FBRUE7QUFDdUI7QUFDdkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvaW5kZXguanM/MWMyZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNaWRkbGV3YXJlRXJyb3IsIE11bHRpcGxlU3RydWN0dXJlZE91dHB1dHNFcnJvciwgTXVsdGlwbGVUb29sc0JvdW5kRXJyb3IsIFN0cnVjdHVyZWRPdXRwdXRQYXJzaW5nRXJyb3IsIFRvb2xJbnZvY2F0aW9uRXJyb3IgfSBmcm9tIFwiLi9lcnJvcnMuanNcIjtcbmltcG9ydCB7IFByb3ZpZGVyU3RyYXRlZ3ksIFRvb2xTdHJhdGVneSwgcHJvdmlkZXJTdHJhdGVneSwgdG9vbFN0cmF0ZWd5IH0gZnJvbSBcIi4vcmVzcG9uc2VzLmpzXCI7XG5pbXBvcnQgeyBSZWFjdEFnZW50IH0gZnJvbSBcIi4vUmVhY3RBZ2VudC5qc1wiO1xuaW1wb3J0IHsgTUlERExFV0FSRV9CUkFORCB9IGZyb20gXCIuL21pZGRsZXdhcmUvdHlwZXMuanNcIjtcbmltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUgfSBmcm9tIFwiLi9taWRkbGV3YXJlLmpzXCI7XG5pbXBvcnQgeyBGYWtlVG9vbENhbGxpbmdNb2RlbCB9IGZyb20gXCIuL3Rlc3RzL3V0aWxzLmpzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL2luZGV4LnRzXG5mdW5jdGlvbiBjcmVhdGVBZ2VudChwYXJhbXMpIHtcblx0cmV0dXJuIG5ldyBSZWFjdEFnZW50KHBhcmFtcyk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgY3JlYXRlQWdlbnQgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js":
/*!******************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js ***!
  \******************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createMiddleware: () => (/* binding */ createMiddleware)\n/* harmony export */ });\n/* harmony import */ var _middleware_types_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./middleware/types.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/types.js\");\n\n\n//#region src/agents/middleware.ts\n/**\n* Creates a middleware instance with automatic schema inference.\n*\n* @param config - Middleware configuration\n* @param config.name - The name of the middleware\n* @param config.stateSchema - The schema of the middleware state\n* @param config.contextSchema - The schema of the middleware context\n* @param config.wrapModelCall - The function to wrap model invocation\n* @param config.wrapToolCall - The function to wrap tool invocation\n* @param config.beforeModel - The function to run before the model call\n* @param config.afterModel - The function to run after the model call\n* @param config.beforeAgent - The function to run before the agent execution starts\n* @param config.afterAgent - The function to run after the agent execution completes\n* @returns A middleware instance\n*\n* @example Using Zod schema\n* ```ts\n* const authMiddleware = createMiddleware({\n*   name: \"AuthMiddleware\",\n*   stateSchema: z.object({\n*     isAuthenticated: z.boolean().default(false),\n*   }),\n*   contextSchema: z.object({\n*     userId: z.string(),\n*   }),\n*   beforeModel: async (state, runtime, controls) => {\n*     if (!state.isAuthenticated) {\n*       return controls.terminate(new Error(\"Not authenticated\"));\n*     }\n*   },\n* });\n* ```\n*\n* @example Using StateSchema\n* ```ts\n* import { StateSchema, ReducedValue } from \"@langchain/langgraph\";\n*\n* const historyMiddleware = createMiddleware({\n*   name: \"HistoryMiddleware\",\n*   stateSchema: new StateSchema({\n*     count: z.number().default(0),\n*     history: new ReducedValue(\n*       z.array(z.string()).default(() => []),\n*       { inputSchema: z.string(), reducer: (current, next) => [...current, next] }\n*     ),\n*   }),\n*   beforeModel: async (state, runtime) => {\n*     return { count: state.count + 1 };\n*   },\n* });\n* ```\n*/\nfunction createMiddleware(config) {\n\treturn {\n\t\t[_middleware_types_js__WEBPACK_IMPORTED_MODULE_0__.MIDDLEWARE_BRAND]: true,\n\t\tname: config.name,\n\t\tstateSchema: config.stateSchema,\n\t\tcontextSchema: config.contextSchema,\n\t\twrapToolCall: config.wrapToolCall,\n\t\twrapModelCall: config.wrapModelCall,\n\t\tbeforeAgent: config.beforeAgent,\n\t\tbeforeModel: config.beforeModel,\n\t\tafterModel: config.afterModel,\n\t\tafterAgent: config.afterAgent,\n\t\ttools: config.tools\n\t};\n}\n\n//#endregion\n\n//# sourceMappingURL=middleware.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUF5RDs7QUFFekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDRCQUE0QjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLEtBQUs7QUFDTDtBQUNBLGVBQWU7QUFDZixLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxrRUFBZ0I7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQzRCO0FBQzVCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL21pZGRsZXdhcmUuanM/NTc0YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNSURETEVXQVJFX0JSQU5EIH0gZnJvbSBcIi4vbWlkZGxld2FyZS90eXBlcy5qc1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9taWRkbGV3YXJlLnRzXG4vKipcbiogQ3JlYXRlcyBhIG1pZGRsZXdhcmUgaW5zdGFuY2Ugd2l0aCBhdXRvbWF0aWMgc2NoZW1hIGluZmVyZW5jZS5cbipcbiogQHBhcmFtIGNvbmZpZyAtIE1pZGRsZXdhcmUgY29uZmlndXJhdGlvblxuKiBAcGFyYW0gY29uZmlnLm5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgbWlkZGxld2FyZVxuKiBAcGFyYW0gY29uZmlnLnN0YXRlU2NoZW1hIC0gVGhlIHNjaGVtYSBvZiB0aGUgbWlkZGxld2FyZSBzdGF0ZVxuKiBAcGFyYW0gY29uZmlnLmNvbnRleHRTY2hlbWEgLSBUaGUgc2NoZW1hIG9mIHRoZSBtaWRkbGV3YXJlIGNvbnRleHRcbiogQHBhcmFtIGNvbmZpZy53cmFwTW9kZWxDYWxsIC0gVGhlIGZ1bmN0aW9uIHRvIHdyYXAgbW9kZWwgaW52b2NhdGlvblxuKiBAcGFyYW0gY29uZmlnLndyYXBUb29sQ2FsbCAtIFRoZSBmdW5jdGlvbiB0byB3cmFwIHRvb2wgaW52b2NhdGlvblxuKiBAcGFyYW0gY29uZmlnLmJlZm9yZU1vZGVsIC0gVGhlIGZ1bmN0aW9uIHRvIHJ1biBiZWZvcmUgdGhlIG1vZGVsIGNhbGxcbiogQHBhcmFtIGNvbmZpZy5hZnRlck1vZGVsIC0gVGhlIGZ1bmN0aW9uIHRvIHJ1biBhZnRlciB0aGUgbW9kZWwgY2FsbFxuKiBAcGFyYW0gY29uZmlnLmJlZm9yZUFnZW50IC0gVGhlIGZ1bmN0aW9uIHRvIHJ1biBiZWZvcmUgdGhlIGFnZW50IGV4ZWN1dGlvbiBzdGFydHNcbiogQHBhcmFtIGNvbmZpZy5hZnRlckFnZW50IC0gVGhlIGZ1bmN0aW9uIHRvIHJ1biBhZnRlciB0aGUgYWdlbnQgZXhlY3V0aW9uIGNvbXBsZXRlc1xuKiBAcmV0dXJucyBBIG1pZGRsZXdhcmUgaW5zdGFuY2VcbipcbiogQGV4YW1wbGUgVXNpbmcgWm9kIHNjaGVtYVxuKiBgYGB0c1xuKiBjb25zdCBhdXRoTWlkZGxld2FyZSA9IGNyZWF0ZU1pZGRsZXdhcmUoe1xuKiAgIG5hbWU6IFwiQXV0aE1pZGRsZXdhcmVcIixcbiogICBzdGF0ZVNjaGVtYTogei5vYmplY3Qoe1xuKiAgICAgaXNBdXRoZW50aWNhdGVkOiB6LmJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbiogICB9KSxcbiogICBjb250ZXh0U2NoZW1hOiB6Lm9iamVjdCh7XG4qICAgICB1c2VySWQ6IHouc3RyaW5nKCksXG4qICAgfSksXG4qICAgYmVmb3JlTW9kZWw6IGFzeW5jIChzdGF0ZSwgcnVudGltZSwgY29udHJvbHMpID0+IHtcbiogICAgIGlmICghc3RhdGUuaXNBdXRoZW50aWNhdGVkKSB7XG4qICAgICAgIHJldHVybiBjb250cm9scy50ZXJtaW5hdGUobmV3IEVycm9yKFwiTm90IGF1dGhlbnRpY2F0ZWRcIikpO1xuKiAgICAgfVxuKiAgIH0sXG4qIH0pO1xuKiBgYGBcbipcbiogQGV4YW1wbGUgVXNpbmcgU3RhdGVTY2hlbWFcbiogYGBgdHNcbiogaW1wb3J0IHsgU3RhdGVTY2hlbWEsIFJlZHVjZWRWYWx1ZSB9IGZyb20gXCJAbGFuZ2NoYWluL2xhbmdncmFwaFwiO1xuKlxuKiBjb25zdCBoaXN0b3J5TWlkZGxld2FyZSA9IGNyZWF0ZU1pZGRsZXdhcmUoe1xuKiAgIG5hbWU6IFwiSGlzdG9yeU1pZGRsZXdhcmVcIixcbiogICBzdGF0ZVNjaGVtYTogbmV3IFN0YXRlU2NoZW1hKHtcbiogICAgIGNvdW50OiB6Lm51bWJlcigpLmRlZmF1bHQoMCksXG4qICAgICBoaXN0b3J5OiBuZXcgUmVkdWNlZFZhbHVlKFxuKiAgICAgICB6LmFycmF5KHouc3RyaW5nKCkpLmRlZmF1bHQoKCkgPT4gW10pLFxuKiAgICAgICB7IGlucHV0U2NoZW1hOiB6LnN0cmluZygpLCByZWR1Y2VyOiAoY3VycmVudCwgbmV4dCkgPT4gWy4uLmN1cnJlbnQsIG5leHRdIH1cbiogICAgICksXG4qICAgfSksXG4qICAgYmVmb3JlTW9kZWw6IGFzeW5jIChzdGF0ZSwgcnVudGltZSkgPT4ge1xuKiAgICAgcmV0dXJuIHsgY291bnQ6IHN0YXRlLmNvdW50ICsgMSB9O1xuKiAgIH0sXG4qIH0pO1xuKiBgYGBcbiovXG5mdW5jdGlvbiBjcmVhdGVNaWRkbGV3YXJlKGNvbmZpZykge1xuXHRyZXR1cm4ge1xuXHRcdFtNSURETEVXQVJFX0JSQU5EXTogdHJ1ZSxcblx0XHRuYW1lOiBjb25maWcubmFtZSxcblx0XHRzdGF0ZVNjaGVtYTogY29uZmlnLnN0YXRlU2NoZW1hLFxuXHRcdGNvbnRleHRTY2hlbWE6IGNvbmZpZy5jb250ZXh0U2NoZW1hLFxuXHRcdHdyYXBUb29sQ2FsbDogY29uZmlnLndyYXBUb29sQ2FsbCxcblx0XHR3cmFwTW9kZWxDYWxsOiBjb25maWcud3JhcE1vZGVsQ2FsbCxcblx0XHRiZWZvcmVBZ2VudDogY29uZmlnLmJlZm9yZUFnZW50LFxuXHRcdGJlZm9yZU1vZGVsOiBjb25maWcuYmVmb3JlTW9kZWwsXG5cdFx0YWZ0ZXJNb2RlbDogY29uZmlnLmFmdGVyTW9kZWwsXG5cdFx0YWZ0ZXJBZ2VudDogY29uZmlnLmFmdGVyQWdlbnQsXG5cdFx0dG9vbHM6IGNvbmZpZy50b29sc1xuXHR9O1xufVxuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZGRsZXdhcmUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/constants.js":
/*!****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/constants.js ***!
  \****************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RetrySchema: () => (/* binding */ RetrySchema)\n/* harmony export */ });\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n//#region src/agents/middleware/constants.ts\nconst RetrySchema = zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.object({\n\tmaxRetries: zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.number().min(0).default(2),\n\tretryOn: zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.union([zod_v3__WEBPACK_IMPORTED_MODULE_0__.z[\"function\"]().args(zod_v3__WEBPACK_IMPORTED_MODULE_0__.z[\"instanceof\"](Error)).returns(zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.boolean()), zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.array(zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.custom())]).default(() => () => true),\n\tbackoffFactor: zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.number().min(0).default(2),\n\tinitialDelayMs: zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.number().min(0).default(1e3),\n\tmaxDelayMs: zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.number().min(0).default(6e4),\n\tjitter: zod_v3__WEBPACK_IMPORTED_MODULE_0__.z.boolean().default(true)\n});\n\n//#endregion\n\n//# sourceMappingURL=constants.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9jb25zdGFudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBMkI7O0FBRTNCO0FBQ0Esb0JBQW9CLDRDQUFRO0FBQzVCLGFBQWEsNENBQVE7QUFDckIsVUFBVSwyQ0FBTyxFQUFFLGlEQUFVLFFBQVEsbURBQVksaUJBQWlCLDZDQUFTLEtBQUssMkNBQU8sQ0FBQyw0Q0FBUTtBQUNoRyxnQkFBZ0IsNENBQVE7QUFDeEIsaUJBQWlCLDRDQUFRO0FBQ3pCLGFBQWEsNENBQVE7QUFDckIsU0FBUyw2Q0FBUztBQUNsQixDQUFDOztBQUVEO0FBQ3VCO0FBQ3ZCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL21pZGRsZXdhcmUvY29uc3RhbnRzLmpzP2JmYTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2QvdjNcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvbWlkZGxld2FyZS9jb25zdGFudHMudHNcbmNvbnN0IFJldHJ5U2NoZW1hID0gei5vYmplY3Qoe1xuXHRtYXhSZXRyaWVzOiB6Lm51bWJlcigpLm1pbigwKS5kZWZhdWx0KDIpLFxuXHRyZXRyeU9uOiB6LnVuaW9uKFt6LmZ1bmN0aW9uKCkuYXJncyh6Lmluc3RhbmNlb2YoRXJyb3IpKS5yZXR1cm5zKHouYm9vbGVhbigpKSwgei5hcnJheSh6LmN1c3RvbSgpKV0pLmRlZmF1bHQoKCkgPT4gKCkgPT4gdHJ1ZSksXG5cdGJhY2tvZmZGYWN0b3I6IHoubnVtYmVyKCkubWluKDApLmRlZmF1bHQoMiksXG5cdGluaXRpYWxEZWxheU1zOiB6Lm51bWJlcigpLm1pbigwKS5kZWZhdWx0KDFlMyksXG5cdG1heERlbGF5TXM6IHoubnVtYmVyKCkubWluKDApLmRlZmF1bHQoNmU0KSxcblx0aml0dGVyOiB6LmJvb2xlYW4oKS5kZWZhdWx0KHRydWUpXG59KTtcblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyBSZXRyeVNjaGVtYSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29uc3RhbnRzLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/constants.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/contextEditing.js":
/*!*********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/contextEditing.js ***!
  \*********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ClearToolUsesEdit: () => (/* binding */ ClearToolUsesEdit),\n/* harmony export */   contextEditingMiddleware: () => (/* binding */ contextEditingMiddleware)\n/* harmony export */ });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _summarization_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./summarization.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/summarization.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n\n\n\n\n\n//#region src/agents/middleware/contextEditing.ts\nconst DEFAULT_TOOL_PLACEHOLDER = \"[cleared]\";\nconst DEFAULT_TRIGGER_TOKENS = 1e5;\nconst DEFAULT_KEEP = 3;\n/**\n* Strategy for clearing tool outputs when token limits are exceeded.\n*\n* This strategy mirrors Anthropic's `clear_tool_uses_20250919` behavior by\n* replacing older tool results with a placeholder text when the conversation\n* grows too large. It preserves the most recent tool results and can exclude\n* specific tools from being cleared.\n*\n* @example\n* ```ts\n* import { ClearToolUsesEdit } from \"langchain\";\n*\n* const edit = new ClearToolUsesEdit({\n*   trigger: { tokens: 100000 },  // Start clearing at 100K tokens\n*   keep: { messages: 3 },        // Keep 3 most recent tool results\n*   excludeTools: [\"important\"],   // Never clear \"important\" tool\n*   clearToolInputs: false,        // Keep tool call arguments\n*   placeholder: \"[cleared]\",      // Replacement text\n* });\n*\n* // Multiple trigger conditions\n* const edit2 = new ClearToolUsesEdit({\n*   trigger: [\n*     { tokens: 100000, messages: 50 },\n*     { tokens: 50000, messages: 100 }\n*   ],\n*   keep: { messages: 3 },\n* });\n*\n* // Fractional trigger with model profile\n* const edit3 = new ClearToolUsesEdit({\n*   trigger: { fraction: 0.8 },  // Trigger at 80% of model's max tokens\n*   keep: { fraction: 0.3 },     // Keep 30% of model's max tokens\n* });\n* ```\n*/\nvar ClearToolUsesEdit = class {\n\t#triggerConditions;\n\ttrigger;\n\tkeep;\n\tclearToolInputs;\n\texcludeTools;\n\tplaceholder;\n\tmodel;\n\tclearAtLeast;\n\tconstructor(config = {}) {\n\t\tlet trigger = config.trigger;\n\t\tif (config.triggerTokens !== void 0) {\n\t\t\tconsole.warn(\"triggerTokens is deprecated. Use `trigger: { tokens: value }` instead.\");\n\t\t\tif (trigger === void 0) trigger = { tokens: config.triggerTokens };\n\t\t}\n\t\tlet keep = config.keep;\n\t\tif (config.keepMessages !== void 0) {\n\t\t\tconsole.warn(\"keepMessages is deprecated. Use `keep: { messages: value }` instead.\");\n\t\t\tif (keep === void 0) keep = { messages: config.keepMessages };\n\t\t}\n\t\tif (trigger === void 0) trigger = { tokens: DEFAULT_TRIGGER_TOKENS };\n\t\tif (keep === void 0) keep = { messages: DEFAULT_KEEP };\n\t\tif (Array.isArray(trigger)) {\n\t\t\tthis.#triggerConditions = trigger.map((t) => _summarization_js__WEBPACK_IMPORTED_MODULE_2__.contextSizeSchema.parse(t));\n\t\t\tthis.trigger = this.#triggerConditions;\n\t\t} else {\n\t\t\tconst validated = _summarization_js__WEBPACK_IMPORTED_MODULE_2__.contextSizeSchema.parse(trigger);\n\t\t\tthis.#triggerConditions = [validated];\n\t\t\tthis.trigger = validated;\n\t\t}\n\t\tthis.keep = _summarization_js__WEBPACK_IMPORTED_MODULE_2__.keepSchema.parse(keep);\n\t\tif (config.clearAtLeast !== void 0) console.warn(\"clearAtLeast is deprecated and will be removed in a future version. It conflicts with the `keep` property. Use `keep: { tokens: value }` or `keep: { messages: value }` instead to control retention.\");\n\t\tthis.clearAtLeast = config.clearAtLeast ?? 0;\n\t\tthis.clearToolInputs = config.clearToolInputs ?? false;\n\t\tthis.excludeTools = new Set(config.excludeTools ?? []);\n\t\tthis.placeholder = config.placeholder ?? DEFAULT_TOOL_PLACEHOLDER;\n\t}\n\tasync apply(params) {\n\t\tconst { messages, model, countTokens } = params;\n\t\tconst tokens = await countTokens(messages);\n\t\t/**\n\t\t* Always remove orphaned tool messages (those without corresponding AI messages)\n\t\t* regardless of whether editing is triggered\n\t\t*/\n\t\tconst orphanedIndices = [];\n\t\tfor (let i = 0; i < messages.length; i++) {\n\t\t\tconst msg = messages[i];\n\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage.isInstance(msg)) {\n\t\t\t\tconst aiMessage = this.#findAIMessageForToolCall(messages.slice(0, i), msg.tool_call_id);\n\t\t\t\tif (!aiMessage) orphanedIndices.push(i);\n\t\t\t\telse if (!aiMessage.tool_calls?.find((call) => call.id === msg.tool_call_id)) orphanedIndices.push(i);\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t* Remove orphaned tool messages in reverse order to maintain indices\n\t\t*/\n\t\tfor (let i = orphanedIndices.length - 1; i >= 0; i--) messages.splice(orphanedIndices[i], 1);\n\t\t/**\n\t\t* Recalculate tokens after removing orphaned messages\n\t\t*/\n\t\tlet currentTokens = tokens;\n\t\tif (orphanedIndices.length > 0) currentTokens = await countTokens(messages);\n\t\t/**\n\t\t* Check if editing should be triggered\n\t\t*/\n\t\tif (!this.#shouldEdit(messages, currentTokens, model)) return;\n\t\t/**\n\t\t* Find all tool message candidates with their actual indices in the messages array\n\t\t*/\n\t\tconst candidates = [];\n\t\tfor (let i = 0; i < messages.length; i++) {\n\t\t\tconst msg = messages[i];\n\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage.isInstance(msg)) candidates.push({\n\t\t\t\tidx: i,\n\t\t\t\tmsg\n\t\t\t});\n\t\t}\n\t\tif (candidates.length === 0) return;\n\t\t/**\n\t\t* Determine how many tool results to keep based on keep policy\n\t\t*/\n\t\tconst keepCount = await this.#determineKeepCount(candidates, countTokens, model);\n\t\t/**\n\t\t* Keep the most recent tool messages based on keep policy\n\t\t*/\n\t\tconst candidatesToClear = keepCount >= candidates.length ? [] : keepCount > 0 ? candidates.slice(0, -keepCount) : candidates;\n\t\t/**\n\t\t* If clearAtLeast is set, we may need to clear more messages to meet the token requirement\n\t\t* This is a deprecated feature that conflicts with keep, but we support it for backwards compatibility\n\t\t*/\n\t\tlet clearedTokens = 0;\n\t\tconst initialCandidatesToClear = [...candidatesToClear];\n\t\tfor (const { idx, msg: toolMessage } of initialCandidatesToClear) {\n\t\t\tif ((toolMessage.response_metadata?.context_editing)?.cleared) continue;\n\t\t\t/**\n\t\t\t* Find the corresponding AI message\n\t\t\t*/\n\t\t\tconst aiMessage = this.#findAIMessageForToolCall(messages.slice(0, idx), toolMessage.tool_call_id);\n\t\t\tif (!aiMessage) continue;\n\t\t\t/**\n\t\t\t* Find the corresponding tool call\n\t\t\t*/\n\t\t\tconst toolCall = aiMessage.tool_calls?.find((call) => call.id === toolMessage.tool_call_id);\n\t\t\tif (!toolCall) continue;\n\t\t\t/**\n\t\t\t* Skip if tool is excluded\n\t\t\t*/\n\t\t\tconst toolName = toolMessage.name || toolCall.name;\n\t\t\tif (this.excludeTools.has(toolName)) continue;\n\t\t\t/**\n\t\t\t* Clear the tool message\n\t\t\t*/\n\t\t\tmessages[idx] = new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage({\n\t\t\t\ttool_call_id: toolMessage.tool_call_id,\n\t\t\t\tcontent: this.placeholder,\n\t\t\t\tname: toolMessage.name,\n\t\t\t\tartifact: void 0,\n\t\t\t\tresponse_metadata: {\n\t\t\t\t\t...toolMessage.response_metadata,\n\t\t\t\t\tcontext_editing: {\n\t\t\t\t\t\tcleared: true,\n\t\t\t\t\t\tstrategy: \"clear_tool_uses\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t/**\n\t\t\t* Optionally clear the tool inputs\n\t\t\t*/\n\t\t\tif (this.clearToolInputs) {\n\t\t\t\tconst aiMsgIdx = messages.indexOf(aiMessage);\n\t\t\t\tif (aiMsgIdx >= 0) messages[aiMsgIdx] = this.#buildClearedToolInputMessage(aiMessage, toolMessage.tool_call_id);\n\t\t\t}\n\t\t\t/**\n\t\t\t* Recalculate tokens\n\t\t\t*/\n\t\t\tconst newTokenCount = await countTokens(messages);\n\t\t\tclearedTokens = Math.max(0, currentTokens - newTokenCount);\n\t\t}\n\t\t/**\n\t\t* If clearAtLeast is set and we haven't cleared enough tokens,\n\t\t* continue clearing more messages (going backwards from keepCount)\n\t\t* This is deprecated behavior but maintained for backwards compatibility\n\t\t*/\n\t\tif (this.clearAtLeast > 0 && clearedTokens < this.clearAtLeast) {\n\t\t\t/**\n\t\t\t* Find remaining candidates that weren't cleared yet (those that were kept)\n\t\t\t*/\n\t\t\tconst remainingCandidates = keepCount > 0 && keepCount < candidates.length ? candidates.slice(-keepCount) : [];\n\t\t\t/**\n\t\t\t* Clear additional messages until we've cleared at least clearAtLeast tokens\n\t\t\t* Go backwards through the kept messages\n\t\t\t*/\n\t\t\tfor (let i = remainingCandidates.length - 1; i >= 0; i--) {\n\t\t\t\tif (clearedTokens >= this.clearAtLeast) break;\n\t\t\t\tconst { idx, msg: toolMessage } = remainingCandidates[i];\n\t\t\t\tif ((toolMessage.response_metadata?.context_editing)?.cleared) continue;\n\t\t\t\t/**\n\t\t\t\t* Find the corresponding AI message\n\t\t\t\t*/\n\t\t\t\tconst aiMessage = this.#findAIMessageForToolCall(messages.slice(0, idx), toolMessage.tool_call_id);\n\t\t\t\tif (!aiMessage) continue;\n\t\t\t\t/**\n\t\t\t\t* Find the corresponding tool call\n\t\t\t\t*/\n\t\t\t\tconst toolCall = aiMessage.tool_calls?.find((call) => call.id === toolMessage.tool_call_id);\n\t\t\t\tif (!toolCall) continue;\n\t\t\t\t/**\n\t\t\t\t* Skip if tool is excluded\n\t\t\t\t*/\n\t\t\t\tconst toolName = toolMessage.name || toolCall.name;\n\t\t\t\tif (this.excludeTools.has(toolName)) continue;\n\t\t\t\t/**\n\t\t\t\t* Clear the tool message\n\t\t\t\t*/\n\t\t\t\tmessages[idx] = new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage({\n\t\t\t\t\ttool_call_id: toolMessage.tool_call_id,\n\t\t\t\t\tcontent: this.placeholder,\n\t\t\t\t\tname: toolMessage.name,\n\t\t\t\t\tartifact: void 0,\n\t\t\t\t\tresponse_metadata: {\n\t\t\t\t\t\t...toolMessage.response_metadata,\n\t\t\t\t\t\tcontext_editing: {\n\t\t\t\t\t\t\tcleared: true,\n\t\t\t\t\t\t\tstrategy: \"clear_tool_uses\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t/**\n\t\t\t\t* Optionally clear the tool inputs\n\t\t\t\t*/\n\t\t\t\tif (this.clearToolInputs) {\n\t\t\t\t\tconst aiMsgIdx = messages.indexOf(aiMessage);\n\t\t\t\t\tif (aiMsgIdx >= 0) messages[aiMsgIdx] = this.#buildClearedToolInputMessage(aiMessage, toolMessage.tool_call_id);\n\t\t\t\t}\n\t\t\t\t/**\n\t\t\t\t* Recalculate tokens\n\t\t\t\t*/\n\t\t\t\tconst newTokenCount = await countTokens(messages);\n\t\t\t\tclearedTokens = Math.max(0, currentTokens - newTokenCount);\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t* Determine whether editing should run for the current token usage\n\t*/\n\t#shouldEdit(messages, totalTokens, model) {\n\t\t/**\n\t\t* Check each condition (OR logic between conditions)\n\t\t*/\n\t\tfor (const trigger of this.#triggerConditions) {\n\t\t\t/**\n\t\t\t* Within a single condition, all specified properties must be satisfied (AND logic)\n\t\t\t*/\n\t\t\tlet conditionMet = true;\n\t\t\tlet hasAnyProperty = false;\n\t\t\tif (trigger.messages !== void 0) {\n\t\t\t\thasAnyProperty = true;\n\t\t\t\tif (messages.length < trigger.messages) conditionMet = false;\n\t\t\t}\n\t\t\tif (trigger.tokens !== void 0) {\n\t\t\t\thasAnyProperty = true;\n\t\t\t\tif (totalTokens < trigger.tokens) conditionMet = false;\n\t\t\t}\n\t\t\tif (trigger.fraction !== void 0) {\n\t\t\t\thasAnyProperty = true;\n\t\t\t\tif (!model) continue;\n\t\t\t\tconst maxInputTokens = (0,_summarization_js__WEBPACK_IMPORTED_MODULE_2__.getProfileLimits)(model);\n\t\t\t\tif (typeof maxInputTokens === \"number\") {\n\t\t\t\t\tconst threshold = Math.floor(maxInputTokens * trigger.fraction);\n\t\t\t\t\tif (threshold <= 0) continue;\n\t\t\t\t\tif (totalTokens < threshold) conditionMet = false;\n\t\t\t\t} else\n /**\n\t\t\t\t* If fraction is specified but we can't get model limits, skip this condition\n\t\t\t\t*/\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/**\n\t\t\t* If condition has at least one property and all properties are satisfied, trigger editing\n\t\t\t*/\n\t\t\tif (hasAnyProperty && conditionMet) return true;\n\t\t}\n\t\treturn false;\n\t}\n\t/**\n\t* Determine how many tool results to keep based on keep policy\n\t*/\n\tasync #determineKeepCount(candidates, countTokens, model) {\n\t\tif (\"messages\" in this.keep && this.keep.messages !== void 0) return this.keep.messages;\n\t\tif (\"tokens\" in this.keep && this.keep.tokens !== void 0) {\n\t\t\t/**\n\t\t\t* For token-based keep, count backwards from the end until we exceed the token limit\n\t\t\t* This is a simplified implementation - keeping N most recent tool messages\n\t\t\t* A more sophisticated implementation would count actual tokens\n\t\t\t*/\n\t\t\tconst targetTokens = this.keep.tokens;\n\t\t\tlet tokenCount = 0;\n\t\t\tlet keepCount = 0;\n\t\t\tfor (let i = candidates.length - 1; i >= 0; i--) {\n\t\t\t\tconst candidate = candidates[i];\n\t\t\t\t/**\n\t\t\t\t* Estimate tokens for this tool message (simplified - could be improved)\n\t\t\t\t*/\n\t\t\t\tconst msgTokens = await countTokens([candidate.msg]);\n\t\t\t\tif (tokenCount + msgTokens <= targetTokens) {\n\t\t\t\t\ttokenCount += msgTokens;\n\t\t\t\t\tkeepCount++;\n\t\t\t\t} else break;\n\t\t\t}\n\t\t\treturn keepCount;\n\t\t}\n\t\tif (\"fraction\" in this.keep && this.keep.fraction !== void 0) {\n\t\t\tif (!model) return DEFAULT_KEEP;\n\t\t\tconst maxInputTokens = (0,_summarization_js__WEBPACK_IMPORTED_MODULE_2__.getProfileLimits)(model);\n\t\t\tif (typeof maxInputTokens === \"number\") {\n\t\t\t\tconst targetTokens = Math.floor(maxInputTokens * this.keep.fraction);\n\t\t\t\tif (targetTokens <= 0) return DEFAULT_KEEP;\n\t\t\t\t/**\n\t\t\t\t* Use token-based logic with fractional target\n\t\t\t\t*/\n\t\t\t\tlet tokenCount = 0;\n\t\t\t\tlet keepCount = 0;\n\t\t\t\tfor (let i = candidates.length - 1; i >= 0; i--) {\n\t\t\t\t\tconst candidate = candidates[i];\n\t\t\t\t\tconst msgTokens = await countTokens([candidate.msg]);\n\t\t\t\t\tif (tokenCount + msgTokens <= targetTokens) {\n\t\t\t\t\t\ttokenCount += msgTokens;\n\t\t\t\t\t\tkeepCount++;\n\t\t\t\t\t} else break;\n\t\t\t\t}\n\t\t\t\treturn keepCount;\n\t\t\t}\n\t\t}\n\t\treturn DEFAULT_KEEP;\n\t}\n\t#findAIMessageForToolCall(previousMessages, toolCallId) {\n\t\tfor (let i = previousMessages.length - 1; i >= 0; i--) {\n\t\t\tconst msg = previousMessages[i];\n\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.AIMessage.isInstance(msg)) {\n\t\t\t\tif (msg.tool_calls?.some((call) => call.id === toolCallId)) return msg;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\t#buildClearedToolInputMessage(message, toolCallId) {\n\t\tconst updatedToolCalls = message.tool_calls?.map((toolCall) => {\n\t\t\tif (toolCall.id === toolCallId) return {\n\t\t\t\t...toolCall,\n\t\t\t\targs: {}\n\t\t\t};\n\t\t\treturn toolCall;\n\t\t});\n\t\tconst metadata = { ...message.response_metadata };\n\t\tconst contextEntry = { ...metadata.context_editing };\n\t\tconst clearedIds = new Set(contextEntry.cleared_tool_inputs);\n\t\tclearedIds.add(toolCallId);\n\t\tcontextEntry.cleared_tool_inputs = Array.from(clearedIds).sort();\n\t\tmetadata.context_editing = contextEntry;\n\t\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.AIMessage({\n\t\t\tcontent: message.content,\n\t\t\ttool_calls: updatedToolCalls,\n\t\t\tresponse_metadata: metadata,\n\t\t\tid: message.id,\n\t\t\tname: message.name,\n\t\t\tadditional_kwargs: message.additional_kwargs\n\t\t});\n\t}\n};\n/**\n* Middleware that automatically prunes tool results to manage context size.\n*\n* This middleware applies a sequence of edits when the total input token count\n* exceeds configured thresholds. By default, it uses the `ClearToolUsesEdit` strategy\n* which mirrors Anthropic's `clear_tool_uses_20250919` behaviour by clearing older\n* tool results once the conversation exceeds 100,000 tokens.\n*\n* ## Basic Usage\n*\n* Use the middleware with default settings to automatically manage context:\n*\n* @example Basic usage with defaults\n* ```ts\n* import { contextEditingMiddleware } from \"langchain\";\n* import { createAgent } from \"langchain\";\n*\n* const agent = createAgent({\n*   model: \"anthropic:claude-sonnet-4-5\",\n*   tools: [searchTool, calculatorTool],\n*   middleware: [\n*     contextEditingMiddleware(),\n*   ],\n* });\n* ```\n*\n* The default configuration:\n* - Triggers when context exceeds **100,000 tokens**\n* - Keeps the **3 most recent** tool results\n* - Uses **approximate token counting** (fast)\n* - Does not clear tool call arguments\n*\n* ## Custom Configuration\n*\n* Customize the clearing behavior with `ClearToolUsesEdit`:\n*\n* @example Custom ClearToolUsesEdit configuration\n* ```ts\n* import { contextEditingMiddleware, ClearToolUsesEdit } from \"langchain\";\n*\n* // Single condition: trigger if tokens >= 50000 AND messages >= 20\n* const agent1 = createAgent({\n*   model: \"anthropic:claude-sonnet-4-5\",\n*   tools: [searchTool, calculatorTool],\n*   middleware: [\n*     contextEditingMiddleware({\n*       edits: [\n*         new ClearToolUsesEdit({\n*           trigger: { tokens: 50000, messages: 20 },\n*           keep: { messages: 5 },\n*           excludeTools: [\"search\"],\n*           clearToolInputs: true,\n*         }),\n*       ],\n*       tokenCountMethod: \"approx\",\n*     }),\n*   ],\n* });\n*\n* // Multiple conditions: trigger if (tokens >= 50000 AND messages >= 20) OR (tokens >= 30000 AND messages >= 50)\n* const agent2 = createAgent({\n*   model: \"anthropic:claude-sonnet-4-5\",\n*   tools: [searchTool, calculatorTool],\n*   middleware: [\n*     contextEditingMiddleware({\n*       edits: [\n*         new ClearToolUsesEdit({\n*           trigger: [\n*             { tokens: 50000, messages: 20 },\n*             { tokens: 30000, messages: 50 },\n*           ],\n*           keep: { messages: 5 },\n*         }),\n*       ],\n*     }),\n*   ],\n* });\n*\n* // Fractional trigger with model profile\n* const agent3 = createAgent({\n*   model: chatModel,\n*   tools: [searchTool, calculatorTool],\n*   middleware: [\n*     contextEditingMiddleware({\n*       edits: [\n*         new ClearToolUsesEdit({\n*           trigger: { fraction: 0.8 },  // Trigger at 80% of model's max tokens\n*           keep: { fraction: 0.3 },     // Keep 30% of model's max tokens\n*           model: chatModel,\n*         }),\n*       ],\n*     }),\n*   ],\n* });\n* ```\n*\n* ## Custom Editing Strategies\n*\n* Implement your own context editing strategy by creating a class that\n* implements the `ContextEdit` interface:\n*\n* @example Custom editing strategy\n* ```ts\n* import { contextEditingMiddleware, type ContextEdit, type TokenCounter } from \"langchain\";\n* import type { BaseMessage } from \"@langchain/core/messages\";\n*\n* class CustomEdit implements ContextEdit {\n*   async apply(params: {\n*     tokens: number;\n*     messages: BaseMessage[];\n*     countTokens: TokenCounter;\n*   }): Promise<number> {\n*     // Implement your custom editing logic here\n*     // and apply it to the messages array, then\n*     // return the new token count after edits\n*     return countTokens(messages);\n*   }\n* }\n* ```\n*\n* @param config - Configuration options for the middleware\n* @returns A middleware instance that can be used with `createAgent`\n*/\nfunction contextEditingMiddleware(config = {}) {\n\tconst edits = config.edits ?? [new ClearToolUsesEdit()];\n\tconst tokenCountMethod = config.tokenCountMethod ?? \"approx\";\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_1__.createMiddleware)({\n\t\tname: \"ContextEditingMiddleware\",\n\t\twrapModelCall: async (request, handler) => {\n\t\t\tif (!request.messages || request.messages.length === 0) return handler(request);\n\t\t\t/**\n\t\t\t* Use model's token counting method\n\t\t\t*/\n\t\t\tconst systemMsg = request.systemPrompt ? [new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.SystemMessage(request.systemPrompt)] : [];\n\t\t\tconst countTokens = tokenCountMethod === \"approx\" ? _utils_js__WEBPACK_IMPORTED_MODULE_0__.countTokensApproximately : async (messages) => {\n\t\t\t\tconst allMessages = [...systemMsg, ...messages];\n\t\t\t\t/**\n\t\t\t\t* Check if model has getNumTokensFromMessages method\n\t\t\t\t* currently only OpenAI models have this method\n\t\t\t\t*/\n\t\t\t\tif (\"getNumTokensFromMessages\" in request.model) return request.model.getNumTokensFromMessages(allMessages).then(({ totalCount }) => totalCount);\n\t\t\t\tthrow new Error(`Model \"${request.model.getName()}\" does not support token counting`);\n\t\t\t};\n\t\t\t/**\n\t\t\t* Apply each edit in sequence\n\t\t\t*/\n\t\t\tfor (const edit of edits) await edit.apply({\n\t\t\t\tmessages: request.messages,\n\t\t\t\tmodel: request.model,\n\t\t\t\tcountTokens\n\t\t\t});\n\t\t\treturn handler(request);\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=contextEditing.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9jb250ZXh0RWRpdGluZy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBc0Q7QUFDRjtBQUNpQztBQUNKOztBQUVqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxvQkFBb0I7QUFDL0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCO0FBQy9CLFlBQVksYUFBYTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhCQUE4QjtBQUN0QyxRQUFRO0FBQ1I7QUFDQSxZQUFZLGFBQWE7QUFDekIsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZUFBZTtBQUM5QixZQUFZLGVBQWU7QUFDM0IsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLDhEQUE4RCxlQUFlO0FBQzdFLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQSwwREFBMEQsaUJBQWlCO0FBQzNFLGlDQUFpQztBQUNqQztBQUNBLHNDQUFzQztBQUN0QyxnQ0FBZ0M7QUFDaEM7QUFDQSxnREFBZ0QsZ0VBQWlCO0FBQ2pFO0FBQ0EsSUFBSTtBQUNKLHFCQUFxQixnRUFBaUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0EsY0FBYyx5REFBVTtBQUN4Qiw0S0FBNEssZUFBZSxjQUFjLGlCQUFpQjtBQUMxTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLCtCQUErQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IscUJBQXFCO0FBQ3ZDO0FBQ0EsT0FBTyxpRUFBVztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLFFBQVE7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IscUJBQXFCO0FBQ3ZDO0FBQ0EsT0FBTyxpRUFBVztBQUNsQjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx3QkFBd0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsaUVBQVc7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsUUFBUTtBQUN4RDtBQUNBLFlBQVksd0JBQXdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlFQUFXO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLG1FQUFnQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLFFBQVE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLG1FQUFnQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLFFBQVE7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxRQUFRO0FBQ3BEO0FBQ0EsT0FBTywrREFBUztBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gscUJBQXFCO0FBQ3JCLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsK0RBQVM7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVywyQkFBMkI7QUFDdEMsV0FBVyxjQUFjO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDhDQUE4QztBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsNkJBQTZCO0FBQ3BELG9CQUFvQixhQUFhO0FBQ2pDO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw2QkFBNkI7QUFDN0MsZ0JBQWdCLDZCQUE2QjtBQUM3QztBQUNBLG9CQUFvQixhQUFhO0FBQ2pDLFdBQVc7QUFDWDtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsZUFBZTtBQUN0QyxvQkFBb0IsZUFBZTtBQUNuQztBQUNBLFdBQVc7QUFDWDtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGdFQUFnRTtBQUMzRSxnQkFBZ0IsY0FBYztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QztBQUM3QztBQUNBO0FBQ0EsUUFBUSxnRUFBZ0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELG1FQUFhO0FBQzlELHVEQUF1RCwrREFBd0I7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdIQUF3SCxZQUFZO0FBQ3BJLDhCQUE4Qix3QkFBd0I7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ3VEO0FBQ3ZEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL21pZGRsZXdhcmUvY29udGV4dEVkaXRpbmcuanM/NDE0OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb3VudFRva2Vuc0FwcHJveGltYXRlbHkgfSBmcm9tIFwiLi91dGlscy5qc1wiO1xuaW1wb3J0IHsgY3JlYXRlTWlkZGxld2FyZSB9IGZyb20gXCIuLi9taWRkbGV3YXJlLmpzXCI7XG5pbXBvcnQgeyBjb250ZXh0U2l6ZVNjaGVtYSwgZ2V0UHJvZmlsZUxpbWl0cywga2VlcFNjaGVtYSB9IGZyb20gXCIuL3N1bW1hcml6YXRpb24uanNcIjtcbmltcG9ydCB7IEFJTWVzc2FnZSwgU3lzdGVtTWVzc2FnZSwgVG9vbE1lc3NhZ2UgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL21lc3NhZ2VzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL21pZGRsZXdhcmUvY29udGV4dEVkaXRpbmcudHNcbmNvbnN0IERFRkFVTFRfVE9PTF9QTEFDRUhPTERFUiA9IFwiW2NsZWFyZWRdXCI7XG5jb25zdCBERUZBVUxUX1RSSUdHRVJfVE9LRU5TID0gMWU1O1xuY29uc3QgREVGQVVMVF9LRUVQID0gMztcbi8qKlxuKiBTdHJhdGVneSBmb3IgY2xlYXJpbmcgdG9vbCBvdXRwdXRzIHdoZW4gdG9rZW4gbGltaXRzIGFyZSBleGNlZWRlZC5cbipcbiogVGhpcyBzdHJhdGVneSBtaXJyb3JzIEFudGhyb3BpYydzIGBjbGVhcl90b29sX3VzZXNfMjAyNTA5MTlgIGJlaGF2aW9yIGJ5XG4qIHJlcGxhY2luZyBvbGRlciB0b29sIHJlc3VsdHMgd2l0aCBhIHBsYWNlaG9sZGVyIHRleHQgd2hlbiB0aGUgY29udmVyc2F0aW9uXG4qIGdyb3dzIHRvbyBsYXJnZS4gSXQgcHJlc2VydmVzIHRoZSBtb3N0IHJlY2VudCB0b29sIHJlc3VsdHMgYW5kIGNhbiBleGNsdWRlXG4qIHNwZWNpZmljIHRvb2xzIGZyb20gYmVpbmcgY2xlYXJlZC5cbipcbiogQGV4YW1wbGVcbiogYGBgdHNcbiogaW1wb3J0IHsgQ2xlYXJUb29sVXNlc0VkaXQgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qXG4qIGNvbnN0IGVkaXQgPSBuZXcgQ2xlYXJUb29sVXNlc0VkaXQoe1xuKiAgIHRyaWdnZXI6IHsgdG9rZW5zOiAxMDAwMDAgfSwgIC8vIFN0YXJ0IGNsZWFyaW5nIGF0IDEwMEsgdG9rZW5zXG4qICAga2VlcDogeyBtZXNzYWdlczogMyB9LCAgICAgICAgLy8gS2VlcCAzIG1vc3QgcmVjZW50IHRvb2wgcmVzdWx0c1xuKiAgIGV4Y2x1ZGVUb29sczogW1wiaW1wb3J0YW50XCJdLCAgIC8vIE5ldmVyIGNsZWFyIFwiaW1wb3J0YW50XCIgdG9vbFxuKiAgIGNsZWFyVG9vbElucHV0czogZmFsc2UsICAgICAgICAvLyBLZWVwIHRvb2wgY2FsbCBhcmd1bWVudHNcbiogICBwbGFjZWhvbGRlcjogXCJbY2xlYXJlZF1cIiwgICAgICAvLyBSZXBsYWNlbWVudCB0ZXh0XG4qIH0pO1xuKlxuKiAvLyBNdWx0aXBsZSB0cmlnZ2VyIGNvbmRpdGlvbnNcbiogY29uc3QgZWRpdDIgPSBuZXcgQ2xlYXJUb29sVXNlc0VkaXQoe1xuKiAgIHRyaWdnZXI6IFtcbiogICAgIHsgdG9rZW5zOiAxMDAwMDAsIG1lc3NhZ2VzOiA1MCB9LFxuKiAgICAgeyB0b2tlbnM6IDUwMDAwLCBtZXNzYWdlczogMTAwIH1cbiogICBdLFxuKiAgIGtlZXA6IHsgbWVzc2FnZXM6IDMgfSxcbiogfSk7XG4qXG4qIC8vIEZyYWN0aW9uYWwgdHJpZ2dlciB3aXRoIG1vZGVsIHByb2ZpbGVcbiogY29uc3QgZWRpdDMgPSBuZXcgQ2xlYXJUb29sVXNlc0VkaXQoe1xuKiAgIHRyaWdnZXI6IHsgZnJhY3Rpb246IDAuOCB9LCAgLy8gVHJpZ2dlciBhdCA4MCUgb2YgbW9kZWwncyBtYXggdG9rZW5zXG4qICAga2VlcDogeyBmcmFjdGlvbjogMC4zIH0sICAgICAvLyBLZWVwIDMwJSBvZiBtb2RlbCdzIG1heCB0b2tlbnNcbiogfSk7XG4qIGBgYFxuKi9cbnZhciBDbGVhclRvb2xVc2VzRWRpdCA9IGNsYXNzIHtcblx0I3RyaWdnZXJDb25kaXRpb25zO1xuXHR0cmlnZ2VyO1xuXHRrZWVwO1xuXHRjbGVhclRvb2xJbnB1dHM7XG5cdGV4Y2x1ZGVUb29scztcblx0cGxhY2Vob2xkZXI7XG5cdG1vZGVsO1xuXHRjbGVhckF0TGVhc3Q7XG5cdGNvbnN0cnVjdG9yKGNvbmZpZyA9IHt9KSB7XG5cdFx0bGV0IHRyaWdnZXIgPSBjb25maWcudHJpZ2dlcjtcblx0XHRpZiAoY29uZmlnLnRyaWdnZXJUb2tlbnMgIT09IHZvaWQgMCkge1xuXHRcdFx0Y29uc29sZS53YXJuKFwidHJpZ2dlclRva2VucyBpcyBkZXByZWNhdGVkLiBVc2UgYHRyaWdnZXI6IHsgdG9rZW5zOiB2YWx1ZSB9YCBpbnN0ZWFkLlwiKTtcblx0XHRcdGlmICh0cmlnZ2VyID09PSB2b2lkIDApIHRyaWdnZXIgPSB7IHRva2VuczogY29uZmlnLnRyaWdnZXJUb2tlbnMgfTtcblx0XHR9XG5cdFx0bGV0IGtlZXAgPSBjb25maWcua2VlcDtcblx0XHRpZiAoY29uZmlnLmtlZXBNZXNzYWdlcyAhPT0gdm9pZCAwKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJrZWVwTWVzc2FnZXMgaXMgZGVwcmVjYXRlZC4gVXNlIGBrZWVwOiB7IG1lc3NhZ2VzOiB2YWx1ZSB9YCBpbnN0ZWFkLlwiKTtcblx0XHRcdGlmIChrZWVwID09PSB2b2lkIDApIGtlZXAgPSB7IG1lc3NhZ2VzOiBjb25maWcua2VlcE1lc3NhZ2VzIH07XG5cdFx0fVxuXHRcdGlmICh0cmlnZ2VyID09PSB2b2lkIDApIHRyaWdnZXIgPSB7IHRva2VuczogREVGQVVMVF9UUklHR0VSX1RPS0VOUyB9O1xuXHRcdGlmIChrZWVwID09PSB2b2lkIDApIGtlZXAgPSB7IG1lc3NhZ2VzOiBERUZBVUxUX0tFRVAgfTtcblx0XHRpZiAoQXJyYXkuaXNBcnJheSh0cmlnZ2VyKSkge1xuXHRcdFx0dGhpcy4jdHJpZ2dlckNvbmRpdGlvbnMgPSB0cmlnZ2VyLm1hcCgodCkgPT4gY29udGV4dFNpemVTY2hlbWEucGFyc2UodCkpO1xuXHRcdFx0dGhpcy50cmlnZ2VyID0gdGhpcy4jdHJpZ2dlckNvbmRpdGlvbnM7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnN0IHZhbGlkYXRlZCA9IGNvbnRleHRTaXplU2NoZW1hLnBhcnNlKHRyaWdnZXIpO1xuXHRcdFx0dGhpcy4jdHJpZ2dlckNvbmRpdGlvbnMgPSBbdmFsaWRhdGVkXTtcblx0XHRcdHRoaXMudHJpZ2dlciA9IHZhbGlkYXRlZDtcblx0XHR9XG5cdFx0dGhpcy5rZWVwID0ga2VlcFNjaGVtYS5wYXJzZShrZWVwKTtcblx0XHRpZiAoY29uZmlnLmNsZWFyQXRMZWFzdCAhPT0gdm9pZCAwKSBjb25zb2xlLndhcm4oXCJjbGVhckF0TGVhc3QgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24uIEl0IGNvbmZsaWN0cyB3aXRoIHRoZSBga2VlcGAgcHJvcGVydHkuIFVzZSBga2VlcDogeyB0b2tlbnM6IHZhbHVlIH1gIG9yIGBrZWVwOiB7IG1lc3NhZ2VzOiB2YWx1ZSB9YCBpbnN0ZWFkIHRvIGNvbnRyb2wgcmV0ZW50aW9uLlwiKTtcblx0XHR0aGlzLmNsZWFyQXRMZWFzdCA9IGNvbmZpZy5jbGVhckF0TGVhc3QgPz8gMDtcblx0XHR0aGlzLmNsZWFyVG9vbElucHV0cyA9IGNvbmZpZy5jbGVhclRvb2xJbnB1dHMgPz8gZmFsc2U7XG5cdFx0dGhpcy5leGNsdWRlVG9vbHMgPSBuZXcgU2V0KGNvbmZpZy5leGNsdWRlVG9vbHMgPz8gW10pO1xuXHRcdHRoaXMucGxhY2Vob2xkZXIgPSBjb25maWcucGxhY2Vob2xkZXIgPz8gREVGQVVMVF9UT09MX1BMQUNFSE9MREVSO1xuXHR9XG5cdGFzeW5jIGFwcGx5KHBhcmFtcykge1xuXHRcdGNvbnN0IHsgbWVzc2FnZXMsIG1vZGVsLCBjb3VudFRva2VucyB9ID0gcGFyYW1zO1xuXHRcdGNvbnN0IHRva2VucyA9IGF3YWl0IGNvdW50VG9rZW5zKG1lc3NhZ2VzKTtcblx0XHQvKipcblx0XHQqIEFsd2F5cyByZW1vdmUgb3JwaGFuZWQgdG9vbCBtZXNzYWdlcyAodGhvc2Ugd2l0aG91dCBjb3JyZXNwb25kaW5nIEFJIG1lc3NhZ2VzKVxuXHRcdCogcmVnYXJkbGVzcyBvZiB3aGV0aGVyIGVkaXRpbmcgaXMgdHJpZ2dlcmVkXG5cdFx0Ki9cblx0XHRjb25zdCBvcnBoYW5lZEluZGljZXMgPSBbXTtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IG1lc3NhZ2VzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRjb25zdCBtc2cgPSBtZXNzYWdlc1tpXTtcblx0XHRcdGlmIChUb29sTWVzc2FnZS5pc0luc3RhbmNlKG1zZykpIHtcblx0XHRcdFx0Y29uc3QgYWlNZXNzYWdlID0gdGhpcy4jZmluZEFJTWVzc2FnZUZvclRvb2xDYWxsKG1lc3NhZ2VzLnNsaWNlKDAsIGkpLCBtc2cudG9vbF9jYWxsX2lkKTtcblx0XHRcdFx0aWYgKCFhaU1lc3NhZ2UpIG9ycGhhbmVkSW5kaWNlcy5wdXNoKGkpO1xuXHRcdFx0XHRlbHNlIGlmICghYWlNZXNzYWdlLnRvb2xfY2FsbHM/LmZpbmQoKGNhbGwpID0+IGNhbGwuaWQgPT09IG1zZy50b29sX2NhbGxfaWQpKSBvcnBoYW5lZEluZGljZXMucHVzaChpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0LyoqXG5cdFx0KiBSZW1vdmUgb3JwaGFuZWQgdG9vbCBtZXNzYWdlcyBpbiByZXZlcnNlIG9yZGVyIHRvIG1haW50YWluIGluZGljZXNcblx0XHQqL1xuXHRcdGZvciAobGV0IGkgPSBvcnBoYW5lZEluZGljZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIG1lc3NhZ2VzLnNwbGljZShvcnBoYW5lZEluZGljZXNbaV0sIDEpO1xuXHRcdC8qKlxuXHRcdCogUmVjYWxjdWxhdGUgdG9rZW5zIGFmdGVyIHJlbW92aW5nIG9ycGhhbmVkIG1lc3NhZ2VzXG5cdFx0Ki9cblx0XHRsZXQgY3VycmVudFRva2VucyA9IHRva2Vucztcblx0XHRpZiAob3JwaGFuZWRJbmRpY2VzLmxlbmd0aCA+IDApIGN1cnJlbnRUb2tlbnMgPSBhd2FpdCBjb3VudFRva2VucyhtZXNzYWdlcyk7XG5cdFx0LyoqXG5cdFx0KiBDaGVjayBpZiBlZGl0aW5nIHNob3VsZCBiZSB0cmlnZ2VyZWRcblx0XHQqL1xuXHRcdGlmICghdGhpcy4jc2hvdWxkRWRpdChtZXNzYWdlcywgY3VycmVudFRva2VucywgbW9kZWwpKSByZXR1cm47XG5cdFx0LyoqXG5cdFx0KiBGaW5kIGFsbCB0b29sIG1lc3NhZ2UgY2FuZGlkYXRlcyB3aXRoIHRoZWlyIGFjdHVhbCBpbmRpY2VzIGluIHRoZSBtZXNzYWdlcyBhcnJheVxuXHRcdCovXG5cdFx0Y29uc3QgY2FuZGlkYXRlcyA9IFtdO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbWVzc2FnZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGNvbnN0IG1zZyA9IG1lc3NhZ2VzW2ldO1xuXHRcdFx0aWYgKFRvb2xNZXNzYWdlLmlzSW5zdGFuY2UobXNnKSkgY2FuZGlkYXRlcy5wdXNoKHtcblx0XHRcdFx0aWR4OiBpLFxuXHRcdFx0XHRtc2dcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRpZiAoY2FuZGlkYXRlcy5sZW5ndGggPT09IDApIHJldHVybjtcblx0XHQvKipcblx0XHQqIERldGVybWluZSBob3cgbWFueSB0b29sIHJlc3VsdHMgdG8ga2VlcCBiYXNlZCBvbiBrZWVwIHBvbGljeVxuXHRcdCovXG5cdFx0Y29uc3Qga2VlcENvdW50ID0gYXdhaXQgdGhpcy4jZGV0ZXJtaW5lS2VlcENvdW50KGNhbmRpZGF0ZXMsIGNvdW50VG9rZW5zLCBtb2RlbCk7XG5cdFx0LyoqXG5cdFx0KiBLZWVwIHRoZSBtb3N0IHJlY2VudCB0b29sIG1lc3NhZ2VzIGJhc2VkIG9uIGtlZXAgcG9saWN5XG5cdFx0Ki9cblx0XHRjb25zdCBjYW5kaWRhdGVzVG9DbGVhciA9IGtlZXBDb3VudCA+PSBjYW5kaWRhdGVzLmxlbmd0aCA/IFtdIDoga2VlcENvdW50ID4gMCA/IGNhbmRpZGF0ZXMuc2xpY2UoMCwgLWtlZXBDb3VudCkgOiBjYW5kaWRhdGVzO1xuXHRcdC8qKlxuXHRcdCogSWYgY2xlYXJBdExlYXN0IGlzIHNldCwgd2UgbWF5IG5lZWQgdG8gY2xlYXIgbW9yZSBtZXNzYWdlcyB0byBtZWV0IHRoZSB0b2tlbiByZXF1aXJlbWVudFxuXHRcdCogVGhpcyBpcyBhIGRlcHJlY2F0ZWQgZmVhdHVyZSB0aGF0IGNvbmZsaWN0cyB3aXRoIGtlZXAsIGJ1dCB3ZSBzdXBwb3J0IGl0IGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eVxuXHRcdCovXG5cdFx0bGV0IGNsZWFyZWRUb2tlbnMgPSAwO1xuXHRcdGNvbnN0IGluaXRpYWxDYW5kaWRhdGVzVG9DbGVhciA9IFsuLi5jYW5kaWRhdGVzVG9DbGVhcl07XG5cdFx0Zm9yIChjb25zdCB7IGlkeCwgbXNnOiB0b29sTWVzc2FnZSB9IG9mIGluaXRpYWxDYW5kaWRhdGVzVG9DbGVhcikge1xuXHRcdFx0aWYgKCh0b29sTWVzc2FnZS5yZXNwb25zZV9tZXRhZGF0YT8uY29udGV4dF9lZGl0aW5nKT8uY2xlYXJlZCkgY29udGludWU7XG5cdFx0XHQvKipcblx0XHRcdCogRmluZCB0aGUgY29ycmVzcG9uZGluZyBBSSBtZXNzYWdlXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3QgYWlNZXNzYWdlID0gdGhpcy4jZmluZEFJTWVzc2FnZUZvclRvb2xDYWxsKG1lc3NhZ2VzLnNsaWNlKDAsIGlkeCksIHRvb2xNZXNzYWdlLnRvb2xfY2FsbF9pZCk7XG5cdFx0XHRpZiAoIWFpTWVzc2FnZSkgY29udGludWU7XG5cdFx0XHQvKipcblx0XHRcdCogRmluZCB0aGUgY29ycmVzcG9uZGluZyB0b29sIGNhbGxcblx0XHRcdCovXG5cdFx0XHRjb25zdCB0b29sQ2FsbCA9IGFpTWVzc2FnZS50b29sX2NhbGxzPy5maW5kKChjYWxsKSA9PiBjYWxsLmlkID09PSB0b29sTWVzc2FnZS50b29sX2NhbGxfaWQpO1xuXHRcdFx0aWYgKCF0b29sQ2FsbCkgY29udGludWU7XG5cdFx0XHQvKipcblx0XHRcdCogU2tpcCBpZiB0b29sIGlzIGV4Y2x1ZGVkXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3QgdG9vbE5hbWUgPSB0b29sTWVzc2FnZS5uYW1lIHx8IHRvb2xDYWxsLm5hbWU7XG5cdFx0XHRpZiAodGhpcy5leGNsdWRlVG9vbHMuaGFzKHRvb2xOYW1lKSkgY29udGludWU7XG5cdFx0XHQvKipcblx0XHRcdCogQ2xlYXIgdGhlIHRvb2wgbWVzc2FnZVxuXHRcdFx0Ki9cblx0XHRcdG1lc3NhZ2VzW2lkeF0gPSBuZXcgVG9vbE1lc3NhZ2Uoe1xuXHRcdFx0XHR0b29sX2NhbGxfaWQ6IHRvb2xNZXNzYWdlLnRvb2xfY2FsbF9pZCxcblx0XHRcdFx0Y29udGVudDogdGhpcy5wbGFjZWhvbGRlcixcblx0XHRcdFx0bmFtZTogdG9vbE1lc3NhZ2UubmFtZSxcblx0XHRcdFx0YXJ0aWZhY3Q6IHZvaWQgMCxcblx0XHRcdFx0cmVzcG9uc2VfbWV0YWRhdGE6IHtcblx0XHRcdFx0XHQuLi50b29sTWVzc2FnZS5yZXNwb25zZV9tZXRhZGF0YSxcblx0XHRcdFx0XHRjb250ZXh0X2VkaXRpbmc6IHtcblx0XHRcdFx0XHRcdGNsZWFyZWQ6IHRydWUsXG5cdFx0XHRcdFx0XHRzdHJhdGVneTogXCJjbGVhcl90b29sX3VzZXNcIlxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHQvKipcblx0XHRcdCogT3B0aW9uYWxseSBjbGVhciB0aGUgdG9vbCBpbnB1dHNcblx0XHRcdCovXG5cdFx0XHRpZiAodGhpcy5jbGVhclRvb2xJbnB1dHMpIHtcblx0XHRcdFx0Y29uc3QgYWlNc2dJZHggPSBtZXNzYWdlcy5pbmRleE9mKGFpTWVzc2FnZSk7XG5cdFx0XHRcdGlmIChhaU1zZ0lkeCA+PSAwKSBtZXNzYWdlc1thaU1zZ0lkeF0gPSB0aGlzLiNidWlsZENsZWFyZWRUb29sSW5wdXRNZXNzYWdlKGFpTWVzc2FnZSwgdG9vbE1lc3NhZ2UudG9vbF9jYWxsX2lkKTtcblx0XHRcdH1cblx0XHRcdC8qKlxuXHRcdFx0KiBSZWNhbGN1bGF0ZSB0b2tlbnNcblx0XHRcdCovXG5cdFx0XHRjb25zdCBuZXdUb2tlbkNvdW50ID0gYXdhaXQgY291bnRUb2tlbnMobWVzc2FnZXMpO1xuXHRcdFx0Y2xlYXJlZFRva2VucyA9IE1hdGgubWF4KDAsIGN1cnJlbnRUb2tlbnMgLSBuZXdUb2tlbkNvdW50KTtcblx0XHR9XG5cdFx0LyoqXG5cdFx0KiBJZiBjbGVhckF0TGVhc3QgaXMgc2V0IGFuZCB3ZSBoYXZlbid0IGNsZWFyZWQgZW5vdWdoIHRva2Vucyxcblx0XHQqIGNvbnRpbnVlIGNsZWFyaW5nIG1vcmUgbWVzc2FnZXMgKGdvaW5nIGJhY2t3YXJkcyBmcm9tIGtlZXBDb3VudClcblx0XHQqIFRoaXMgaXMgZGVwcmVjYXRlZCBiZWhhdmlvciBidXQgbWFpbnRhaW5lZCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcblx0XHQqL1xuXHRcdGlmICh0aGlzLmNsZWFyQXRMZWFzdCA+IDAgJiYgY2xlYXJlZFRva2VucyA8IHRoaXMuY2xlYXJBdExlYXN0KSB7XG5cdFx0XHQvKipcblx0XHRcdCogRmluZCByZW1haW5pbmcgY2FuZGlkYXRlcyB0aGF0IHdlcmVuJ3QgY2xlYXJlZCB5ZXQgKHRob3NlIHRoYXQgd2VyZSBrZXB0KVxuXHRcdFx0Ki9cblx0XHRcdGNvbnN0IHJlbWFpbmluZ0NhbmRpZGF0ZXMgPSBrZWVwQ291bnQgPiAwICYmIGtlZXBDb3VudCA8IGNhbmRpZGF0ZXMubGVuZ3RoID8gY2FuZGlkYXRlcy5zbGljZSgta2VlcENvdW50KSA6IFtdO1xuXHRcdFx0LyoqXG5cdFx0XHQqIENsZWFyIGFkZGl0aW9uYWwgbWVzc2FnZXMgdW50aWwgd2UndmUgY2xlYXJlZCBhdCBsZWFzdCBjbGVhckF0TGVhc3QgdG9rZW5zXG5cdFx0XHQqIEdvIGJhY2t3YXJkcyB0aHJvdWdoIHRoZSBrZXB0IG1lc3NhZ2VzXG5cdFx0XHQqL1xuXHRcdFx0Zm9yIChsZXQgaSA9IHJlbWFpbmluZ0NhbmRpZGF0ZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0aWYgKGNsZWFyZWRUb2tlbnMgPj0gdGhpcy5jbGVhckF0TGVhc3QpIGJyZWFrO1xuXHRcdFx0XHRjb25zdCB7IGlkeCwgbXNnOiB0b29sTWVzc2FnZSB9ID0gcmVtYWluaW5nQ2FuZGlkYXRlc1tpXTtcblx0XHRcdFx0aWYgKCh0b29sTWVzc2FnZS5yZXNwb25zZV9tZXRhZGF0YT8uY29udGV4dF9lZGl0aW5nKT8uY2xlYXJlZCkgY29udGludWU7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIEZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgQUkgbWVzc2FnZVxuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCBhaU1lc3NhZ2UgPSB0aGlzLiNmaW5kQUlNZXNzYWdlRm9yVG9vbENhbGwobWVzc2FnZXMuc2xpY2UoMCwgaWR4KSwgdG9vbE1lc3NhZ2UudG9vbF9jYWxsX2lkKTtcblx0XHRcdFx0aWYgKCFhaU1lc3NhZ2UpIGNvbnRpbnVlO1xuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBGaW5kIHRoZSBjb3JyZXNwb25kaW5nIHRvb2wgY2FsbFxuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCB0b29sQ2FsbCA9IGFpTWVzc2FnZS50b29sX2NhbGxzPy5maW5kKChjYWxsKSA9PiBjYWxsLmlkID09PSB0b29sTWVzc2FnZS50b29sX2NhbGxfaWQpO1xuXHRcdFx0XHRpZiAoIXRvb2xDYWxsKSBjb250aW51ZTtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogU2tpcCBpZiB0b29sIGlzIGV4Y2x1ZGVkXG5cdFx0XHRcdCovXG5cdFx0XHRcdGNvbnN0IHRvb2xOYW1lID0gdG9vbE1lc3NhZ2UubmFtZSB8fCB0b29sQ2FsbC5uYW1lO1xuXHRcdFx0XHRpZiAodGhpcy5leGNsdWRlVG9vbHMuaGFzKHRvb2xOYW1lKSkgY29udGludWU7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIENsZWFyIHRoZSB0b29sIG1lc3NhZ2Vcblx0XHRcdFx0Ki9cblx0XHRcdFx0bWVzc2FnZXNbaWR4XSA9IG5ldyBUb29sTWVzc2FnZSh7XG5cdFx0XHRcdFx0dG9vbF9jYWxsX2lkOiB0b29sTWVzc2FnZS50b29sX2NhbGxfaWQsXG5cdFx0XHRcdFx0Y29udGVudDogdGhpcy5wbGFjZWhvbGRlcixcblx0XHRcdFx0XHRuYW1lOiB0b29sTWVzc2FnZS5uYW1lLFxuXHRcdFx0XHRcdGFydGlmYWN0OiB2b2lkIDAsXG5cdFx0XHRcdFx0cmVzcG9uc2VfbWV0YWRhdGE6IHtcblx0XHRcdFx0XHRcdC4uLnRvb2xNZXNzYWdlLnJlc3BvbnNlX21ldGFkYXRhLFxuXHRcdFx0XHRcdFx0Y29udGV4dF9lZGl0aW5nOiB7XG5cdFx0XHRcdFx0XHRcdGNsZWFyZWQ6IHRydWUsXG5cdFx0XHRcdFx0XHRcdHN0cmF0ZWd5OiBcImNsZWFyX3Rvb2xfdXNlc1wiXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogT3B0aW9uYWxseSBjbGVhciB0aGUgdG9vbCBpbnB1dHNcblx0XHRcdFx0Ki9cblx0XHRcdFx0aWYgKHRoaXMuY2xlYXJUb29sSW5wdXRzKSB7XG5cdFx0XHRcdFx0Y29uc3QgYWlNc2dJZHggPSBtZXNzYWdlcy5pbmRleE9mKGFpTWVzc2FnZSk7XG5cdFx0XHRcdFx0aWYgKGFpTXNnSWR4ID49IDApIG1lc3NhZ2VzW2FpTXNnSWR4XSA9IHRoaXMuI2J1aWxkQ2xlYXJlZFRvb2xJbnB1dE1lc3NhZ2UoYWlNZXNzYWdlLCB0b29sTWVzc2FnZS50b29sX2NhbGxfaWQpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIFJlY2FsY3VsYXRlIHRva2Vuc1xuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCBuZXdUb2tlbkNvdW50ID0gYXdhaXQgY291bnRUb2tlbnMobWVzc2FnZXMpO1xuXHRcdFx0XHRjbGVhcmVkVG9rZW5zID0gTWF0aC5tYXgoMCwgY3VycmVudFRva2VucyAtIG5ld1Rva2VuQ291bnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHQvKipcblx0KiBEZXRlcm1pbmUgd2hldGhlciBlZGl0aW5nIHNob3VsZCBydW4gZm9yIHRoZSBjdXJyZW50IHRva2VuIHVzYWdlXG5cdCovXG5cdCNzaG91bGRFZGl0KG1lc3NhZ2VzLCB0b3RhbFRva2VucywgbW9kZWwpIHtcblx0XHQvKipcblx0XHQqIENoZWNrIGVhY2ggY29uZGl0aW9uIChPUiBsb2dpYyBiZXR3ZWVuIGNvbmRpdGlvbnMpXG5cdFx0Ki9cblx0XHRmb3IgKGNvbnN0IHRyaWdnZXIgb2YgdGhpcy4jdHJpZ2dlckNvbmRpdGlvbnMpIHtcblx0XHRcdC8qKlxuXHRcdFx0KiBXaXRoaW4gYSBzaW5nbGUgY29uZGl0aW9uLCBhbGwgc3BlY2lmaWVkIHByb3BlcnRpZXMgbXVzdCBiZSBzYXRpc2ZpZWQgKEFORCBsb2dpYylcblx0XHRcdCovXG5cdFx0XHRsZXQgY29uZGl0aW9uTWV0ID0gdHJ1ZTtcblx0XHRcdGxldCBoYXNBbnlQcm9wZXJ0eSA9IGZhbHNlO1xuXHRcdFx0aWYgKHRyaWdnZXIubWVzc2FnZXMgIT09IHZvaWQgMCkge1xuXHRcdFx0XHRoYXNBbnlQcm9wZXJ0eSA9IHRydWU7XG5cdFx0XHRcdGlmIChtZXNzYWdlcy5sZW5ndGggPCB0cmlnZ2VyLm1lc3NhZ2VzKSBjb25kaXRpb25NZXQgPSBmYWxzZTtcblx0XHRcdH1cblx0XHRcdGlmICh0cmlnZ2VyLnRva2VucyAhPT0gdm9pZCAwKSB7XG5cdFx0XHRcdGhhc0FueVByb3BlcnR5ID0gdHJ1ZTtcblx0XHRcdFx0aWYgKHRvdGFsVG9rZW5zIDwgdHJpZ2dlci50b2tlbnMpIGNvbmRpdGlvbk1ldCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRyaWdnZXIuZnJhY3Rpb24gIT09IHZvaWQgMCkge1xuXHRcdFx0XHRoYXNBbnlQcm9wZXJ0eSA9IHRydWU7XG5cdFx0XHRcdGlmICghbW9kZWwpIGNvbnRpbnVlO1xuXHRcdFx0XHRjb25zdCBtYXhJbnB1dFRva2VucyA9IGdldFByb2ZpbGVMaW1pdHMobW9kZWwpO1xuXHRcdFx0XHRpZiAodHlwZW9mIG1heElucHV0VG9rZW5zID09PSBcIm51bWJlclwiKSB7XG5cdFx0XHRcdFx0Y29uc3QgdGhyZXNob2xkID0gTWF0aC5mbG9vcihtYXhJbnB1dFRva2VucyAqIHRyaWdnZXIuZnJhY3Rpb24pO1xuXHRcdFx0XHRcdGlmICh0aHJlc2hvbGQgPD0gMCkgY29udGludWU7XG5cdFx0XHRcdFx0aWYgKHRvdGFsVG9rZW5zIDwgdGhyZXNob2xkKSBjb25kaXRpb25NZXQgPSBmYWxzZTtcblx0XHRcdFx0fSBlbHNlXG4gLyoqXG5cdFx0XHRcdCogSWYgZnJhY3Rpb24gaXMgc3BlY2lmaWVkIGJ1dCB3ZSBjYW4ndCBnZXQgbW9kZWwgbGltaXRzLCBza2lwIHRoaXMgY29uZGl0aW9uXG5cdFx0XHRcdCovXG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXHRcdFx0LyoqXG5cdFx0XHQqIElmIGNvbmRpdGlvbiBoYXMgYXQgbGVhc3Qgb25lIHByb3BlcnR5IGFuZCBhbGwgcHJvcGVydGllcyBhcmUgc2F0aXNmaWVkLCB0cmlnZ2VyIGVkaXRpbmdcblx0XHRcdCovXG5cdFx0XHRpZiAoaGFzQW55UHJvcGVydHkgJiYgY29uZGl0aW9uTWV0KSByZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cdC8qKlxuXHQqIERldGVybWluZSBob3cgbWFueSB0b29sIHJlc3VsdHMgdG8ga2VlcCBiYXNlZCBvbiBrZWVwIHBvbGljeVxuXHQqL1xuXHRhc3luYyAjZGV0ZXJtaW5lS2VlcENvdW50KGNhbmRpZGF0ZXMsIGNvdW50VG9rZW5zLCBtb2RlbCkge1xuXHRcdGlmIChcIm1lc3NhZ2VzXCIgaW4gdGhpcy5rZWVwICYmIHRoaXMua2VlcC5tZXNzYWdlcyAhPT0gdm9pZCAwKSByZXR1cm4gdGhpcy5rZWVwLm1lc3NhZ2VzO1xuXHRcdGlmIChcInRva2Vuc1wiIGluIHRoaXMua2VlcCAmJiB0aGlzLmtlZXAudG9rZW5zICE9PSB2b2lkIDApIHtcblx0XHRcdC8qKlxuXHRcdFx0KiBGb3IgdG9rZW4tYmFzZWQga2VlcCwgY291bnQgYmFja3dhcmRzIGZyb20gdGhlIGVuZCB1bnRpbCB3ZSBleGNlZWQgdGhlIHRva2VuIGxpbWl0XG5cdFx0XHQqIFRoaXMgaXMgYSBzaW1wbGlmaWVkIGltcGxlbWVudGF0aW9uIC0ga2VlcGluZyBOIG1vc3QgcmVjZW50IHRvb2wgbWVzc2FnZXNcblx0XHRcdCogQSBtb3JlIHNvcGhpc3RpY2F0ZWQgaW1wbGVtZW50YXRpb24gd291bGQgY291bnQgYWN0dWFsIHRva2Vuc1xuXHRcdFx0Ki9cblx0XHRcdGNvbnN0IHRhcmdldFRva2VucyA9IHRoaXMua2VlcC50b2tlbnM7XG5cdFx0XHRsZXQgdG9rZW5Db3VudCA9IDA7XG5cdFx0XHRsZXQga2VlcENvdW50ID0gMDtcblx0XHRcdGZvciAobGV0IGkgPSBjYW5kaWRhdGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdFx0XHRcdGNvbnN0IGNhbmRpZGF0ZSA9IGNhbmRpZGF0ZXNbaV07XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIEVzdGltYXRlIHRva2VucyBmb3IgdGhpcyB0b29sIG1lc3NhZ2UgKHNpbXBsaWZpZWQgLSBjb3VsZCBiZSBpbXByb3ZlZClcblx0XHRcdFx0Ki9cblx0XHRcdFx0Y29uc3QgbXNnVG9rZW5zID0gYXdhaXQgY291bnRUb2tlbnMoW2NhbmRpZGF0ZS5tc2ddKTtcblx0XHRcdFx0aWYgKHRva2VuQ291bnQgKyBtc2dUb2tlbnMgPD0gdGFyZ2V0VG9rZW5zKSB7XG5cdFx0XHRcdFx0dG9rZW5Db3VudCArPSBtc2dUb2tlbnM7XG5cdFx0XHRcdFx0a2VlcENvdW50Kys7XG5cdFx0XHRcdH0gZWxzZSBicmVhaztcblx0XHRcdH1cblx0XHRcdHJldHVybiBrZWVwQ291bnQ7XG5cdFx0fVxuXHRcdGlmIChcImZyYWN0aW9uXCIgaW4gdGhpcy5rZWVwICYmIHRoaXMua2VlcC5mcmFjdGlvbiAhPT0gdm9pZCAwKSB7XG5cdFx0XHRpZiAoIW1vZGVsKSByZXR1cm4gREVGQVVMVF9LRUVQO1xuXHRcdFx0Y29uc3QgbWF4SW5wdXRUb2tlbnMgPSBnZXRQcm9maWxlTGltaXRzKG1vZGVsKTtcblx0XHRcdGlmICh0eXBlb2YgbWF4SW5wdXRUb2tlbnMgPT09IFwibnVtYmVyXCIpIHtcblx0XHRcdFx0Y29uc3QgdGFyZ2V0VG9rZW5zID0gTWF0aC5mbG9vcihtYXhJbnB1dFRva2VucyAqIHRoaXMua2VlcC5mcmFjdGlvbik7XG5cdFx0XHRcdGlmICh0YXJnZXRUb2tlbnMgPD0gMCkgcmV0dXJuIERFRkFVTFRfS0VFUDtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogVXNlIHRva2VuLWJhc2VkIGxvZ2ljIHdpdGggZnJhY3Rpb25hbCB0YXJnZXRcblx0XHRcdFx0Ki9cblx0XHRcdFx0bGV0IHRva2VuQ291bnQgPSAwO1xuXHRcdFx0XHRsZXQga2VlcENvdW50ID0gMDtcblx0XHRcdFx0Zm9yIChsZXQgaSA9IGNhbmRpZGF0ZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0XHRjb25zdCBjYW5kaWRhdGUgPSBjYW5kaWRhdGVzW2ldO1xuXHRcdFx0XHRcdGNvbnN0IG1zZ1Rva2VucyA9IGF3YWl0IGNvdW50VG9rZW5zKFtjYW5kaWRhdGUubXNnXSk7XG5cdFx0XHRcdFx0aWYgKHRva2VuQ291bnQgKyBtc2dUb2tlbnMgPD0gdGFyZ2V0VG9rZW5zKSB7XG5cdFx0XHRcdFx0XHR0b2tlbkNvdW50ICs9IG1zZ1Rva2Vucztcblx0XHRcdFx0XHRcdGtlZXBDb3VudCsrO1xuXHRcdFx0XHRcdH0gZWxzZSBicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4ga2VlcENvdW50O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gREVGQVVMVF9LRUVQO1xuXHR9XG5cdCNmaW5kQUlNZXNzYWdlRm9yVG9vbENhbGwocHJldmlvdXNNZXNzYWdlcywgdG9vbENhbGxJZCkge1xuXHRcdGZvciAobGV0IGkgPSBwcmV2aW91c01lc3NhZ2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdFx0XHRjb25zdCBtc2cgPSBwcmV2aW91c01lc3NhZ2VzW2ldO1xuXHRcdFx0aWYgKEFJTWVzc2FnZS5pc0luc3RhbmNlKG1zZykpIHtcblx0XHRcdFx0aWYgKG1zZy50b29sX2NhbGxzPy5zb21lKChjYWxsKSA9PiBjYWxsLmlkID09PSB0b29sQ2FsbElkKSkgcmV0dXJuIG1zZztcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblx0I2J1aWxkQ2xlYXJlZFRvb2xJbnB1dE1lc3NhZ2UobWVzc2FnZSwgdG9vbENhbGxJZCkge1xuXHRcdGNvbnN0IHVwZGF0ZWRUb29sQ2FsbHMgPSBtZXNzYWdlLnRvb2xfY2FsbHM/Lm1hcCgodG9vbENhbGwpID0+IHtcblx0XHRcdGlmICh0b29sQ2FsbC5pZCA9PT0gdG9vbENhbGxJZCkgcmV0dXJuIHtcblx0XHRcdFx0Li4udG9vbENhbGwsXG5cdFx0XHRcdGFyZ3M6IHt9XG5cdFx0XHR9O1xuXHRcdFx0cmV0dXJuIHRvb2xDYWxsO1xuXHRcdH0pO1xuXHRcdGNvbnN0IG1ldGFkYXRhID0geyAuLi5tZXNzYWdlLnJlc3BvbnNlX21ldGFkYXRhIH07XG5cdFx0Y29uc3QgY29udGV4dEVudHJ5ID0geyAuLi5tZXRhZGF0YS5jb250ZXh0X2VkaXRpbmcgfTtcblx0XHRjb25zdCBjbGVhcmVkSWRzID0gbmV3IFNldChjb250ZXh0RW50cnkuY2xlYXJlZF90b29sX2lucHV0cyk7XG5cdFx0Y2xlYXJlZElkcy5hZGQodG9vbENhbGxJZCk7XG5cdFx0Y29udGV4dEVudHJ5LmNsZWFyZWRfdG9vbF9pbnB1dHMgPSBBcnJheS5mcm9tKGNsZWFyZWRJZHMpLnNvcnQoKTtcblx0XHRtZXRhZGF0YS5jb250ZXh0X2VkaXRpbmcgPSBjb250ZXh0RW50cnk7XG5cdFx0cmV0dXJuIG5ldyBBSU1lc3NhZ2Uoe1xuXHRcdFx0Y29udGVudDogbWVzc2FnZS5jb250ZW50LFxuXHRcdFx0dG9vbF9jYWxsczogdXBkYXRlZFRvb2xDYWxscyxcblx0XHRcdHJlc3BvbnNlX21ldGFkYXRhOiBtZXRhZGF0YSxcblx0XHRcdGlkOiBtZXNzYWdlLmlkLFxuXHRcdFx0bmFtZTogbWVzc2FnZS5uYW1lLFxuXHRcdFx0YWRkaXRpb25hbF9rd2FyZ3M6IG1lc3NhZ2UuYWRkaXRpb25hbF9rd2FyZ3Ncblx0XHR9KTtcblx0fVxufTtcbi8qKlxuKiBNaWRkbGV3YXJlIHRoYXQgYXV0b21hdGljYWxseSBwcnVuZXMgdG9vbCByZXN1bHRzIHRvIG1hbmFnZSBjb250ZXh0IHNpemUuXG4qXG4qIFRoaXMgbWlkZGxld2FyZSBhcHBsaWVzIGEgc2VxdWVuY2Ugb2YgZWRpdHMgd2hlbiB0aGUgdG90YWwgaW5wdXQgdG9rZW4gY291bnRcbiogZXhjZWVkcyBjb25maWd1cmVkIHRocmVzaG9sZHMuIEJ5IGRlZmF1bHQsIGl0IHVzZXMgdGhlIGBDbGVhclRvb2xVc2VzRWRpdGAgc3RyYXRlZ3lcbiogd2hpY2ggbWlycm9ycyBBbnRocm9waWMncyBgY2xlYXJfdG9vbF91c2VzXzIwMjUwOTE5YCBiZWhhdmlvdXIgYnkgY2xlYXJpbmcgb2xkZXJcbiogdG9vbCByZXN1bHRzIG9uY2UgdGhlIGNvbnZlcnNhdGlvbiBleGNlZWRzIDEwMCwwMDAgdG9rZW5zLlxuKlxuKiAjIyBCYXNpYyBVc2FnZVxuKlxuKiBVc2UgdGhlIG1pZGRsZXdhcmUgd2l0aCBkZWZhdWx0IHNldHRpbmdzIHRvIGF1dG9tYXRpY2FsbHkgbWFuYWdlIGNvbnRleHQ6XG4qXG4qIEBleGFtcGxlIEJhc2ljIHVzYWdlIHdpdGggZGVmYXVsdHNcbiogYGBgdHNcbiogaW1wb3J0IHsgY29udGV4dEVkaXRpbmdNaWRkbGV3YXJlIH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKiBpbXBvcnQgeyBjcmVhdGVBZ2VudCB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwiYW50aHJvcGljOmNsYXVkZS1zb25uZXQtNC01XCIsXG4qICAgdG9vbHM6IFtzZWFyY2hUb29sLCBjYWxjdWxhdG9yVG9vbF0sXG4qICAgbWlkZGxld2FyZTogW1xuKiAgICAgY29udGV4dEVkaXRpbmdNaWRkbGV3YXJlKCksXG4qICAgXSxcbiogfSk7XG4qIGBgYFxuKlxuKiBUaGUgZGVmYXVsdCBjb25maWd1cmF0aW9uOlxuKiAtIFRyaWdnZXJzIHdoZW4gY29udGV4dCBleGNlZWRzICoqMTAwLDAwMCB0b2tlbnMqKlxuKiAtIEtlZXBzIHRoZSAqKjMgbW9zdCByZWNlbnQqKiB0b29sIHJlc3VsdHNcbiogLSBVc2VzICoqYXBwcm94aW1hdGUgdG9rZW4gY291bnRpbmcqKiAoZmFzdClcbiogLSBEb2VzIG5vdCBjbGVhciB0b29sIGNhbGwgYXJndW1lbnRzXG4qXG4qICMjIEN1c3RvbSBDb25maWd1cmF0aW9uXG4qXG4qIEN1c3RvbWl6ZSB0aGUgY2xlYXJpbmcgYmVoYXZpb3Igd2l0aCBgQ2xlYXJUb29sVXNlc0VkaXRgOlxuKlxuKiBAZXhhbXBsZSBDdXN0b20gQ2xlYXJUb29sVXNlc0VkaXQgY29uZmlndXJhdGlvblxuKiBgYGB0c1xuKiBpbXBvcnQgeyBjb250ZXh0RWRpdGluZ01pZGRsZXdhcmUsIENsZWFyVG9vbFVzZXNFZGl0IH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKlxuKiAvLyBTaW5nbGUgY29uZGl0aW9uOiB0cmlnZ2VyIGlmIHRva2VucyA+PSA1MDAwMCBBTkQgbWVzc2FnZXMgPj0gMjBcbiogY29uc3QgYWdlbnQxID0gY3JlYXRlQWdlbnQoe1xuKiAgIG1vZGVsOiBcImFudGhyb3BpYzpjbGF1ZGUtc29ubmV0LTQtNVwiLFxuKiAgIHRvb2xzOiBbc2VhcmNoVG9vbCwgY2FsY3VsYXRvclRvb2xdLFxuKiAgIG1pZGRsZXdhcmU6IFtcbiogICAgIGNvbnRleHRFZGl0aW5nTWlkZGxld2FyZSh7XG4qICAgICAgIGVkaXRzOiBbXG4qICAgICAgICAgbmV3IENsZWFyVG9vbFVzZXNFZGl0KHtcbiogICAgICAgICAgIHRyaWdnZXI6IHsgdG9rZW5zOiA1MDAwMCwgbWVzc2FnZXM6IDIwIH0sXG4qICAgICAgICAgICBrZWVwOiB7IG1lc3NhZ2VzOiA1IH0sXG4qICAgICAgICAgICBleGNsdWRlVG9vbHM6IFtcInNlYXJjaFwiXSxcbiogICAgICAgICAgIGNsZWFyVG9vbElucHV0czogdHJ1ZSxcbiogICAgICAgICB9KSxcbiogICAgICAgXSxcbiogICAgICAgdG9rZW5Db3VudE1ldGhvZDogXCJhcHByb3hcIixcbiogICAgIH0pLFxuKiAgIF0sXG4qIH0pO1xuKlxuKiAvLyBNdWx0aXBsZSBjb25kaXRpb25zOiB0cmlnZ2VyIGlmICh0b2tlbnMgPj0gNTAwMDAgQU5EIG1lc3NhZ2VzID49IDIwKSBPUiAodG9rZW5zID49IDMwMDAwIEFORCBtZXNzYWdlcyA+PSA1MClcbiogY29uc3QgYWdlbnQyID0gY3JlYXRlQWdlbnQoe1xuKiAgIG1vZGVsOiBcImFudGhyb3BpYzpjbGF1ZGUtc29ubmV0LTQtNVwiLFxuKiAgIHRvb2xzOiBbc2VhcmNoVG9vbCwgY2FsY3VsYXRvclRvb2xdLFxuKiAgIG1pZGRsZXdhcmU6IFtcbiogICAgIGNvbnRleHRFZGl0aW5nTWlkZGxld2FyZSh7XG4qICAgICAgIGVkaXRzOiBbXG4qICAgICAgICAgbmV3IENsZWFyVG9vbFVzZXNFZGl0KHtcbiogICAgICAgICAgIHRyaWdnZXI6IFtcbiogICAgICAgICAgICAgeyB0b2tlbnM6IDUwMDAwLCBtZXNzYWdlczogMjAgfSxcbiogICAgICAgICAgICAgeyB0b2tlbnM6IDMwMDAwLCBtZXNzYWdlczogNTAgfSxcbiogICAgICAgICAgIF0sXG4qICAgICAgICAgICBrZWVwOiB7IG1lc3NhZ2VzOiA1IH0sXG4qICAgICAgICAgfSksXG4qICAgICAgIF0sXG4qICAgICB9KSxcbiogICBdLFxuKiB9KTtcbipcbiogLy8gRnJhY3Rpb25hbCB0cmlnZ2VyIHdpdGggbW9kZWwgcHJvZmlsZVxuKiBjb25zdCBhZ2VudDMgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IGNoYXRNb2RlbCxcbiogICB0b29sczogW3NlYXJjaFRvb2wsIGNhbGN1bGF0b3JUb29sXSxcbiogICBtaWRkbGV3YXJlOiBbXG4qICAgICBjb250ZXh0RWRpdGluZ01pZGRsZXdhcmUoe1xuKiAgICAgICBlZGl0czogW1xuKiAgICAgICAgIG5ldyBDbGVhclRvb2xVc2VzRWRpdCh7XG4qICAgICAgICAgICB0cmlnZ2VyOiB7IGZyYWN0aW9uOiAwLjggfSwgIC8vIFRyaWdnZXIgYXQgODAlIG9mIG1vZGVsJ3MgbWF4IHRva2Vuc1xuKiAgICAgICAgICAga2VlcDogeyBmcmFjdGlvbjogMC4zIH0sICAgICAvLyBLZWVwIDMwJSBvZiBtb2RlbCdzIG1heCB0b2tlbnNcbiogICAgICAgICAgIG1vZGVsOiBjaGF0TW9kZWwsXG4qICAgICAgICAgfSksXG4qICAgICAgIF0sXG4qICAgICB9KSxcbiogICBdLFxuKiB9KTtcbiogYGBgXG4qXG4qICMjIEN1c3RvbSBFZGl0aW5nIFN0cmF0ZWdpZXNcbipcbiogSW1wbGVtZW50IHlvdXIgb3duIGNvbnRleHQgZWRpdGluZyBzdHJhdGVneSBieSBjcmVhdGluZyBhIGNsYXNzIHRoYXRcbiogaW1wbGVtZW50cyB0aGUgYENvbnRleHRFZGl0YCBpbnRlcmZhY2U6XG4qXG4qIEBleGFtcGxlIEN1c3RvbSBlZGl0aW5nIHN0cmF0ZWd5XG4qIGBgYHRzXG4qIGltcG9ydCB7IGNvbnRleHRFZGl0aW5nTWlkZGxld2FyZSwgdHlwZSBDb250ZXh0RWRpdCwgdHlwZSBUb2tlbkNvdW50ZXIgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qIGltcG9ydCB0eXBlIHsgQmFzZU1lc3NhZ2UgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL21lc3NhZ2VzXCI7XG4qXG4qIGNsYXNzIEN1c3RvbUVkaXQgaW1wbGVtZW50cyBDb250ZXh0RWRpdCB7XG4qICAgYXN5bmMgYXBwbHkocGFyYW1zOiB7XG4qICAgICB0b2tlbnM6IG51bWJlcjtcbiogICAgIG1lc3NhZ2VzOiBCYXNlTWVzc2FnZVtdO1xuKiAgICAgY291bnRUb2tlbnM6IFRva2VuQ291bnRlcjtcbiogICB9KTogUHJvbWlzZTxudW1iZXI+IHtcbiogICAgIC8vIEltcGxlbWVudCB5b3VyIGN1c3RvbSBlZGl0aW5nIGxvZ2ljIGhlcmVcbiogICAgIC8vIGFuZCBhcHBseSBpdCB0byB0aGUgbWVzc2FnZXMgYXJyYXksIHRoZW5cbiogICAgIC8vIHJldHVybiB0aGUgbmV3IHRva2VuIGNvdW50IGFmdGVyIGVkaXRzXG4qICAgICByZXR1cm4gY291bnRUb2tlbnMobWVzc2FnZXMpO1xuKiAgIH1cbiogfVxuKiBgYGBcbipcbiogQHBhcmFtIGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIG1pZGRsZXdhcmVcbiogQHJldHVybnMgQSBtaWRkbGV3YXJlIGluc3RhbmNlIHRoYXQgY2FuIGJlIHVzZWQgd2l0aCBgY3JlYXRlQWdlbnRgXG4qL1xuZnVuY3Rpb24gY29udGV4dEVkaXRpbmdNaWRkbGV3YXJlKGNvbmZpZyA9IHt9KSB7XG5cdGNvbnN0IGVkaXRzID0gY29uZmlnLmVkaXRzID8/IFtuZXcgQ2xlYXJUb29sVXNlc0VkaXQoKV07XG5cdGNvbnN0IHRva2VuQ291bnRNZXRob2QgPSBjb25maWcudG9rZW5Db3VudE1ldGhvZCA/PyBcImFwcHJveFwiO1xuXHRyZXR1cm4gY3JlYXRlTWlkZGxld2FyZSh7XG5cdFx0bmFtZTogXCJDb250ZXh0RWRpdGluZ01pZGRsZXdhcmVcIixcblx0XHR3cmFwTW9kZWxDYWxsOiBhc3luYyAocmVxdWVzdCwgaGFuZGxlcikgPT4ge1xuXHRcdFx0aWYgKCFyZXF1ZXN0Lm1lc3NhZ2VzIHx8IHJlcXVlc3QubWVzc2FnZXMubGVuZ3RoID09PSAwKSByZXR1cm4gaGFuZGxlcihyZXF1ZXN0KTtcblx0XHRcdC8qKlxuXHRcdFx0KiBVc2UgbW9kZWwncyB0b2tlbiBjb3VudGluZyBtZXRob2Rcblx0XHRcdCovXG5cdFx0XHRjb25zdCBzeXN0ZW1Nc2cgPSByZXF1ZXN0LnN5c3RlbVByb21wdCA/IFtuZXcgU3lzdGVtTWVzc2FnZShyZXF1ZXN0LnN5c3RlbVByb21wdCldIDogW107XG5cdFx0XHRjb25zdCBjb3VudFRva2VucyA9IHRva2VuQ291bnRNZXRob2QgPT09IFwiYXBwcm94XCIgPyBjb3VudFRva2Vuc0FwcHJveGltYXRlbHkgOiBhc3luYyAobWVzc2FnZXMpID0+IHtcblx0XHRcdFx0Y29uc3QgYWxsTWVzc2FnZXMgPSBbLi4uc3lzdGVtTXNnLCAuLi5tZXNzYWdlc107XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIENoZWNrIGlmIG1vZGVsIGhhcyBnZXROdW1Ub2tlbnNGcm9tTWVzc2FnZXMgbWV0aG9kXG5cdFx0XHRcdCogY3VycmVudGx5IG9ubHkgT3BlbkFJIG1vZGVscyBoYXZlIHRoaXMgbWV0aG9kXG5cdFx0XHRcdCovXG5cdFx0XHRcdGlmIChcImdldE51bVRva2Vuc0Zyb21NZXNzYWdlc1wiIGluIHJlcXVlc3QubW9kZWwpIHJldHVybiByZXF1ZXN0Lm1vZGVsLmdldE51bVRva2Vuc0Zyb21NZXNzYWdlcyhhbGxNZXNzYWdlcykudGhlbigoeyB0b3RhbENvdW50IH0pID0+IHRvdGFsQ291bnQpO1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYE1vZGVsIFwiJHtyZXF1ZXN0Lm1vZGVsLmdldE5hbWUoKX1cIiBkb2VzIG5vdCBzdXBwb3J0IHRva2VuIGNvdW50aW5nYCk7XG5cdFx0XHR9O1xuXHRcdFx0LyoqXG5cdFx0XHQqIEFwcGx5IGVhY2ggZWRpdCBpbiBzZXF1ZW5jZVxuXHRcdFx0Ki9cblx0XHRcdGZvciAoY29uc3QgZWRpdCBvZiBlZGl0cykgYXdhaXQgZWRpdC5hcHBseSh7XG5cdFx0XHRcdG1lc3NhZ2VzOiByZXF1ZXN0Lm1lc3NhZ2VzLFxuXHRcdFx0XHRtb2RlbDogcmVxdWVzdC5tb2RlbCxcblx0XHRcdFx0Y291bnRUb2tlbnNcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIGhhbmRsZXIocmVxdWVzdCk7XG5cdFx0fVxuXHR9KTtcbn1cblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyBDbGVhclRvb2xVc2VzRWRpdCwgY29udGV4dEVkaXRpbmdNaWRkbGV3YXJlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb250ZXh0RWRpdGluZy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/contextEditing.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/dynamicSystemPrompt.js":
/*!**************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/dynamicSystemPrompt.js ***!
  \**************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   dynamicSystemPromptMiddleware: () => (/* binding */ dynamicSystemPromptMiddleware)\n/* harmony export */ });\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n\n\n\n//#region src/agents/middleware/dynamicSystemPrompt.ts\n/**\n* Dynamic System Prompt Middleware\n*\n* Allows setting the system prompt dynamically right before each model invocation.\n* Useful when the prompt depends on the current agent state or per-invocation context.\n*\n* @typeParam TContextSchema - The shape of the runtime context available at invocation time.\n* If your agent defines a `contextSchema`, pass the inferred type here to get full type-safety\n* for `runtime.context`.\n*\n* @param fn - Function that receives the current agent `state` and `runtime`, and\n* returns the system prompt for the next model call as a string.\n*\n* @returns A middleware instance that sets `systemPrompt` for the next model call.\n*\n* @example Basic usage with typed context\n* ```ts\n* import { z } from \"zod\";\n* import { dynamicSystemPrompt } from \"langchain\";\n* import { createAgent, SystemMessage } from \"langchain\";\n*\n* const contextSchema = z.object({ region: z.string().optional() });\n*\n* const middleware = dynamicSystemPrompt<z.infer<typeof contextSchema>>(\n*   (_state, runtime) => `You are a helpful assistant. Region: ${runtime.context.region ?? \"n/a\"}`\n* );\n*\n* const agent = createAgent({\n*   model: \"anthropic:claude-sonnet-4-5\",\n*   contextSchema,\n*   middleware: [middleware],\n* });\n*\n* await agent.invoke({ messages }, { context: { region: \"EU\" } });\n* ```\n*\n* @public\n*/\nfunction dynamicSystemPromptMiddleware(fn) {\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)({\n\t\tname: \"DynamicSystemPromptMiddleware\",\n\t\twrapModelCall: async (request, handler) => {\n\t\t\tconst systemPrompt = await fn(request.state, request.runtime);\n\t\t\tif (!(typeof systemPrompt === \"string\" || _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.SystemMessage.isInstance(systemPrompt))) throw new Error(\"dynamicSystemPromptMiddleware function must return a string or SystemMessage\");\n\t\t\treturn handler({\n\t\t\t\t...request,\n\t\t\t\tsystemMessage: request.systemMessage.concat(systemPrompt)\n\t\t\t});\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=dynamicSystemPrompt.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9keW5hbWljU3lzdGVtUHJvbXB0LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFvRDtBQUNLOztBQUV6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLElBQUk7QUFDZixXQUFXLHNCQUFzQjtBQUNqQyxXQUFXLDZCQUE2QjtBQUN4QztBQUNBLG1DQUFtQywrQkFBK0I7QUFDbEU7QUFDQTtBQUNBLGlFQUFpRSxnQ0FBZ0M7QUFDakc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsdUJBQXVCLFVBQVUsSUFBSSxXQUFXLGdCQUFnQjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxnRUFBZ0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLG1FQUFhO0FBQzFEO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUN5QztBQUN6QyIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL25vZGVfbW9kdWxlcy8ucG5wbS9sYW5nY2hhaW5AMS4yLjI2X0BsYW5nY2hhaW4rY29yZUAxLjEuMjhfb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX19vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fcmVfZXgyYjV5M3R6ZjdoMmN4bW11aTVxb2lhc3kvbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2FnZW50cy9taWRkbGV3YXJlL2R5bmFtaWNTeXN0ZW1Qcm9tcHQuanM/MDk5ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVNaWRkbGV3YXJlIH0gZnJvbSBcIi4uL21pZGRsZXdhcmUuanNcIjtcbmltcG9ydCB7IFN5c3RlbU1lc3NhZ2UgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL21lc3NhZ2VzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL21pZGRsZXdhcmUvZHluYW1pY1N5c3RlbVByb21wdC50c1xuLyoqXG4qIER5bmFtaWMgU3lzdGVtIFByb21wdCBNaWRkbGV3YXJlXG4qXG4qIEFsbG93cyBzZXR0aW5nIHRoZSBzeXN0ZW0gcHJvbXB0IGR5bmFtaWNhbGx5IHJpZ2h0IGJlZm9yZSBlYWNoIG1vZGVsIGludm9jYXRpb24uXG4qIFVzZWZ1bCB3aGVuIHRoZSBwcm9tcHQgZGVwZW5kcyBvbiB0aGUgY3VycmVudCBhZ2VudCBzdGF0ZSBvciBwZXItaW52b2NhdGlvbiBjb250ZXh0LlxuKlxuKiBAdHlwZVBhcmFtIFRDb250ZXh0U2NoZW1hIC0gVGhlIHNoYXBlIG9mIHRoZSBydW50aW1lIGNvbnRleHQgYXZhaWxhYmxlIGF0IGludm9jYXRpb24gdGltZS5cbiogSWYgeW91ciBhZ2VudCBkZWZpbmVzIGEgYGNvbnRleHRTY2hlbWFgLCBwYXNzIHRoZSBpbmZlcnJlZCB0eXBlIGhlcmUgdG8gZ2V0IGZ1bGwgdHlwZS1zYWZldHlcbiogZm9yIGBydW50aW1lLmNvbnRleHRgLlxuKlxuKiBAcGFyYW0gZm4gLSBGdW5jdGlvbiB0aGF0IHJlY2VpdmVzIHRoZSBjdXJyZW50IGFnZW50IGBzdGF0ZWAgYW5kIGBydW50aW1lYCwgYW5kXG4qIHJldHVybnMgdGhlIHN5c3RlbSBwcm9tcHQgZm9yIHRoZSBuZXh0IG1vZGVsIGNhbGwgYXMgYSBzdHJpbmcuXG4qXG4qIEByZXR1cm5zIEEgbWlkZGxld2FyZSBpbnN0YW5jZSB0aGF0IHNldHMgYHN5c3RlbVByb21wdGAgZm9yIHRoZSBuZXh0IG1vZGVsIGNhbGwuXG4qXG4qIEBleGFtcGxlIEJhc2ljIHVzYWdlIHdpdGggdHlwZWQgY29udGV4dFxuKiBgYGB0c1xuKiBpbXBvcnQgeyB6IH0gZnJvbSBcInpvZFwiO1xuKiBpbXBvcnQgeyBkeW5hbWljU3lzdGVtUHJvbXB0IH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKiBpbXBvcnQgeyBjcmVhdGVBZ2VudCwgU3lzdGVtTWVzc2FnZSB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbipcbiogY29uc3QgY29udGV4dFNjaGVtYSA9IHoub2JqZWN0KHsgcmVnaW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCkgfSk7XG4qXG4qIGNvbnN0IG1pZGRsZXdhcmUgPSBkeW5hbWljU3lzdGVtUHJvbXB0PHouaW5mZXI8dHlwZW9mIGNvbnRleHRTY2hlbWE+PihcbiogICAoX3N0YXRlLCBydW50aW1lKSA9PiBgWW91IGFyZSBhIGhlbHBmdWwgYXNzaXN0YW50LiBSZWdpb246ICR7cnVudGltZS5jb250ZXh0LnJlZ2lvbiA/PyBcIm4vYVwifWBcbiogKTtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwiYW50aHJvcGljOmNsYXVkZS1zb25uZXQtNC01XCIsXG4qICAgY29udGV4dFNjaGVtYSxcbiogICBtaWRkbGV3YXJlOiBbbWlkZGxld2FyZV0sXG4qIH0pO1xuKlxuKiBhd2FpdCBhZ2VudC5pbnZva2UoeyBtZXNzYWdlcyB9LCB7IGNvbnRleHQ6IHsgcmVnaW9uOiBcIkVVXCIgfSB9KTtcbiogYGBgXG4qXG4qIEBwdWJsaWNcbiovXG5mdW5jdGlvbiBkeW5hbWljU3lzdGVtUHJvbXB0TWlkZGxld2FyZShmbikge1xuXHRyZXR1cm4gY3JlYXRlTWlkZGxld2FyZSh7XG5cdFx0bmFtZTogXCJEeW5hbWljU3lzdGVtUHJvbXB0TWlkZGxld2FyZVwiLFxuXHRcdHdyYXBNb2RlbENhbGw6IGFzeW5jIChyZXF1ZXN0LCBoYW5kbGVyKSA9PiB7XG5cdFx0XHRjb25zdCBzeXN0ZW1Qcm9tcHQgPSBhd2FpdCBmbihyZXF1ZXN0LnN0YXRlLCByZXF1ZXN0LnJ1bnRpbWUpO1xuXHRcdFx0aWYgKCEodHlwZW9mIHN5c3RlbVByb21wdCA9PT0gXCJzdHJpbmdcIiB8fCBTeXN0ZW1NZXNzYWdlLmlzSW5zdGFuY2Uoc3lzdGVtUHJvbXB0KSkpIHRocm93IG5ldyBFcnJvcihcImR5bmFtaWNTeXN0ZW1Qcm9tcHRNaWRkbGV3YXJlIGZ1bmN0aW9uIG11c3QgcmV0dXJuIGEgc3RyaW5nIG9yIFN5c3RlbU1lc3NhZ2VcIik7XG5cdFx0XHRyZXR1cm4gaGFuZGxlcih7XG5cdFx0XHRcdC4uLnJlcXVlc3QsXG5cdFx0XHRcdHN5c3RlbU1lc3NhZ2U6IHJlcXVlc3Quc3lzdGVtTWVzc2FnZS5jb25jYXQoc3lzdGVtUHJvbXB0KVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn1cblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyBkeW5hbWljU3lzdGVtUHJvbXB0TWlkZGxld2FyZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZHluYW1pY1N5c3RlbVByb21wdC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/dynamicSystemPrompt.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/error.js":
/*!************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/error.js ***!
  \************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InvalidRetryConfigError: () => (/* binding */ InvalidRetryConfigError)\n/* harmony export */ });\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/index.js\");\n\n\n//#region src/agents/middleware/error.ts\n/**\n* Error thrown when the configuration for a retry middleware is invalid.\n*/\nvar InvalidRetryConfigError = class extends Error {\n\tcause;\n\tconstructor(error) {\n\t\tconst message = zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.prettifyError(error).slice(2);\n\t\tsuper(message);\n\t\tthis.name = \"InvalidRetryConfigError\";\n\t\tthis.cause = error;\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=error.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9lcnJvci5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUEyQjs7QUFFM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbURBQWU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNtQztBQUNuQyIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL25vZGVfbW9kdWxlcy8ucG5wbS9sYW5nY2hhaW5AMS4yLjI2X0BsYW5nY2hhaW4rY29yZUAxLjEuMjhfb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX19vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fcmVfZXgyYjV5M3R6ZjdoMmN4bW11aTVxb2lhc3kvbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2FnZW50cy9taWRkbGV3YXJlL2Vycm9yLmpzP2Y0ZmUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2QvdjRcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvbWlkZGxld2FyZS9lcnJvci50c1xuLyoqXG4qIEVycm9yIHRocm93biB3aGVuIHRoZSBjb25maWd1cmF0aW9uIGZvciBhIHJldHJ5IG1pZGRsZXdhcmUgaXMgaW52YWxpZC5cbiovXG52YXIgSW52YWxpZFJldHJ5Q29uZmlnRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcblx0Y2F1c2U7XG5cdGNvbnN0cnVjdG9yKGVycm9yKSB7XG5cdFx0Y29uc3QgbWVzc2FnZSA9IHoucHJldHRpZnlFcnJvcihlcnJvcikuc2xpY2UoMik7XG5cdFx0c3VwZXIobWVzc2FnZSk7XG5cdFx0dGhpcy5uYW1lID0gXCJJbnZhbGlkUmV0cnlDb25maWdFcnJvclwiO1xuXHRcdHRoaXMuY2F1c2UgPSBlcnJvcjtcblx0fVxufTtcblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyBJbnZhbGlkUmV0cnlDb25maWdFcnJvciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZXJyb3IuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/error.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/hitl.js":
/*!***********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/hitl.js ***!
  \***********************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   humanInTheLoopMiddleware: () => (/* binding */ humanInTheLoopMiddleware)\n/* harmony export */ });\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n/* harmony import */ var _langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/utils/types */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/types/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n\n\n\n\n//#region src/agents/middleware/hitl.ts\nconst DescriptionFunctionSchema = zod_v3__WEBPACK_IMPORTED_MODULE_4__.z[\"function\"]().args(zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.custom(), zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.custom(), zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.custom()).returns(zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.union([zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.string(), zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.promise(zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.string())]));\n/**\n* The type of decision a human can make.\n*/\nconst ALLOWED_DECISIONS = [\n\t\"approve\",\n\t\"edit\",\n\t\"reject\"\n];\nconst DecisionType = zod_v3__WEBPACK_IMPORTED_MODULE_4__.z[\"enum\"](ALLOWED_DECISIONS);\nconst InterruptOnConfigSchema = zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.object({\n\tallowedDecisions: zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.array(DecisionType),\n\tdescription: zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.union([zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.string(), DescriptionFunctionSchema]).optional(),\n\targsSchema: zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.record(zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.any()).optional()\n});\nconst contextSchema = zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.object({\n\tinterruptOn: zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.record(zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.union([zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.boolean(), InterruptOnConfigSchema])).optional(),\n\tdescriptionPrefix: zod_v3__WEBPACK_IMPORTED_MODULE_4__.z.string().default(\"Tool execution requires approval\")\n});\n/**\n* Creates a Human-in-the-Loop (HITL) middleware for tool approval and oversight.\n*\n* This middleware intercepts tool calls made by an AI agent and provides human oversight\n* capabilities before execution. It enables selective approval workflows where certain tools\n* require human intervention while others can execute automatically.\n*\n* A invocation result that has been interrupted by the middleware will have a `__interrupt__`\n* property that contains the interrupt request.\n*\n* ```ts\n* import { type HITLRequest, type HITLResponse } from \"langchain\";\n* import { type Interrupt } from \"langchain\";\n*\n* const result = await agent.invoke(request);\n* const interruptRequest = result.__interrupt__?.[0] as Interrupt<HITLRequest>;\n*\n* // Examine the action requests and review configs\n* const actionRequests = interruptRequest.value.actionRequests;\n* const reviewConfigs = interruptRequest.value.reviewConfigs;\n*\n* // Create decisions for each action\n* const resume: HITLResponse = {\n*   decisions: actionRequests.map((action, i) => {\n*     if (action.name === \"calculator\") {\n*       return { type: \"approve\" };\n*     } else if (action.name === \"write_file\") {\n*       return {\n*         type: \"edit\",\n*         editedAction: { name: \"write_file\", args: { filename: \"safe.txt\", content: \"Safe content\" } }\n*       };\n*     }\n*     return { type: \"reject\", message: \"Action not allowed\" };\n*   })\n* };\n*\n* // Resume with decisions\n* await agent.invoke(new Command({ resume }), config);\n* ```\n*\n* ## Features\n*\n* - **Selective Tool Approval**: Configure which tools require human approval\n* - **Multiple Decision Types**: Approve, edit, or reject tool calls\n* - **Asynchronous Workflow**: Uses LangGraph's interrupt mechanism for non-blocking approval\n* - **Custom Approval Messages**: Provide context-specific descriptions for approval requests\n*\n* ## Decision Types\n*\n* When a tool requires approval, the human operator can respond with:\n* - `approve`: Execute the tool with original arguments\n* - `edit`: Modify the tool name and/or arguments before execution\n* - `reject`: Provide a manual response instead of executing the tool\n*\n* @param options - Configuration options for the middleware\n* @param options.interruptOn - Per-tool configuration mapping tool names to their settings\n* @param options.interruptOn[toolName].allowedDecisions - Array of decision types allowed for this tool (e.g., [\"approve\", \"edit\", \"reject\"])\n* @param options.interruptOn[toolName].description - Custom approval message for the tool. Can be either a static string or a callable that dynamically generates the description based on agent state, runtime, and tool call information\n* @param options.interruptOn[toolName].argsSchema - JSON schema for the arguments associated with the action, if edits are allowed\n* @param options.descriptionPrefix - Default prefix for approval messages (default: \"Tool execution requires approval\"). Only used for tools that do not define a custom `description` in their InterruptOnConfig.\n*\n* @returns A middleware instance that can be passed to `createAgent`\n*\n* @example\n* Basic usage with selective tool approval\n* ```typescript\n* import { humanInTheLoopMiddleware } from \"langchain\";\n* import { createAgent } from \"langchain\";\n*\n* const hitlMiddleware = humanInTheLoopMiddleware({\n*   interruptOn: {\n*     // Interrupt write_file tool and allow edits or approvals\n*     \"write_file\": {\n*       allowedDecisions: [\"approve\", \"edit\"],\n*       description: \"â ï¸ File write operation requires approval\"\n*     },\n*     // Auto-approve read_file tool\n*     \"read_file\": false\n*   }\n* });\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4\",\n*   tools: [writeFileTool, readFileTool],\n*   middleware: [hitlMiddleware]\n* });\n* ```\n*\n* @example\n* Handling approval requests\n* ```typescript\n* import { type HITLRequest, type HITLResponse, type Interrupt } from \"langchain\";\n* import { Command } from \"@langchain/langgraph\";\n*\n* // Initial agent invocation\n* const result = await agent.invoke({\n*   messages: [new HumanMessage(\"Write 'Hello' to output.txt\")]\n* }, config);\n*\n* // Check if agent is paused for approval\n* if (result.__interrupt__) {\n*   const interruptRequest = result.__interrupt__?.[0] as Interrupt<HITLRequest>;\n*\n*   // Show tool call details to user\n*   console.log(\"Actions:\", interruptRequest.value.actionRequests);\n*   console.log(\"Review configs:\", interruptRequest.value.reviewConfigs);\n*\n*   // Resume with approval\n*   const resume: HITLResponse = {\n*     decisions: [{ type: \"approve\" }]\n*   };\n*   await agent.invoke(\n*     new Command({ resume }),\n*     config\n*   );\n* }\n* ```\n*\n* @example\n* Different decision types\n* ```typescript\n* import { type HITLResponse } from \"langchain\";\n*\n* // Approve the tool call as-is\n* const resume: HITLResponse = {\n*   decisions: [{ type: \"approve\" }]\n* };\n*\n* // Edit the tool arguments\n* const resume: HITLResponse = {\n*   decisions: [{\n*     type: \"edit\",\n*     editedAction: { name: \"write_file\", args: { filename: \"safe.txt\", content: \"Modified\" } }\n*   }]\n* };\n*\n* // Reject with feedback\n* const resume: HITLResponse = {\n*   decisions: [{\n*     type: \"reject\",\n*     message: \"File operation not allowed in demo mode\"\n*   }]\n* };\n* ```\n*\n* @example\n* Production use case with database operations\n* ```typescript\n* const hitlMiddleware = humanInTheLoopMiddleware({\n*   interruptOn: {\n*     \"execute_sql\": {\n*       allowedDecisions: [\"approve\", \"edit\", \"reject\"],\n*       description: \"ð¨ SQL query requires DBA approval\\nPlease review for safety and performance\"\n*     },\n*     \"read_schema\": false,  // Reading metadata is safe\n*     \"delete_records\": {\n*       allowedDecisions: [\"approve\", \"reject\"],\n*       description: \"â DESTRUCTIVE OPERATION - Requires manager approval\"\n*     }\n*   },\n*   descriptionPrefix: \"Database operation pending approval\"\n* });\n* ```\n*\n* @example\n* Using dynamic callable descriptions\n* ```typescript\n* import { type DescriptionFactory, type ToolCall } from \"langchain\";\n* import type { AgentBuiltInState, Runtime } from \"langchain/agents\";\n*\n* // Define a dynamic description factory\n* const formatToolDescription: DescriptionFactory = (\n*   toolCall: ToolCall,\n*   state: AgentBuiltInState,\n*   runtime: Runtime<unknown>\n* ) => {\n*   return `Tool: ${toolCall.name}\\nArguments:\\n${JSON.stringify(toolCall.args, null, 2)}`;\n* };\n*\n* const hitlMiddleware = humanInTheLoopMiddleware({\n*   interruptOn: {\n*     \"write_file\": {\n*       allowedDecisions: [\"approve\", \"edit\"],\n*       // Use dynamic description that can access tool call, state, and runtime\n*       description: formatToolDescription\n*     },\n*     // Or use an inline function\n*     \"send_email\": {\n*       allowedDecisions: [\"approve\", \"reject\"],\n*       description: (toolCall, state, runtime) => {\n*         const { to, subject } = toolCall.args;\n*         return `Email to ${to}\\nSubject: ${subject}\\n\\nRequires approval before sending`;\n*       }\n*     }\n*   }\n* });\n* ```\n*\n* @remarks\n* - Tool calls are processed in the order they appear in the AI message\n* - Auto-approved tools execute immediately without interruption\n* - Multiple tools requiring approval are bundled into a single interrupt request\n* - The middleware operates in the `afterModel` phase, intercepting before tool execution\n* - Requires a checkpointer to maintain state across interruptions\n*\n* @see {@link createAgent} for agent creation\n* @see {@link Command} for resuming interrupted execution\n* @public\n*/\nfunction humanInTheLoopMiddleware(options) {\n\tconst createActionAndConfig = async (toolCall, config, state, runtime) => {\n\t\tconst toolName = toolCall.name;\n\t\tconst toolArgs = toolCall.args;\n\t\tconst descriptionValue = config.description;\n\t\tlet description;\n\t\tif (typeof descriptionValue === \"function\") description = await descriptionValue(toolCall, state, runtime);\n\t\telse if (descriptionValue !== void 0) description = descriptionValue;\n\t\telse description = `${options.descriptionPrefix ?? \"Tool execution requires approval\"}\\n\\nTool: ${toolName}\\nArgs: ${JSON.stringify(toolArgs, null, 2)}`;\n\t\t/**\n\t\t* Create ActionRequest with description\n\t\t*/\n\t\tconst actionRequest = {\n\t\t\tname: toolName,\n\t\t\targs: toolArgs,\n\t\t\tdescription\n\t\t};\n\t\t/**\n\t\t* Create ReviewConfig\n\t\t*/\n\t\tconst reviewConfig = {\n\t\t\tactionName: toolName,\n\t\t\tallowedDecisions: config.allowedDecisions\n\t\t};\n\t\tif (config.argsSchema) reviewConfig.argsSchema = config.argsSchema;\n\t\treturn {\n\t\t\tactionRequest,\n\t\t\treviewConfig\n\t\t};\n\t};\n\tconst processDecision = (decision, toolCall, config) => {\n\t\tconst allowedDecisions = config.allowedDecisions;\n\t\tif (decision.type === \"approve\" && allowedDecisions.includes(\"approve\")) return {\n\t\t\trevisedToolCall: toolCall,\n\t\t\ttoolMessage: null\n\t\t};\n\t\tif (decision.type === \"edit\" && allowedDecisions.includes(\"edit\")) {\n\t\t\tconst editedAction = decision.editedAction;\n\t\t\t/**\n\t\t\t* Validate edited action structure\n\t\t\t*/\n\t\t\tif (!editedAction || typeof editedAction.name !== \"string\") throw new Error(`Invalid edited action for tool \"${toolCall.name}\": name must be a string`);\n\t\t\tif (!editedAction.args || typeof editedAction.args !== \"object\") throw new Error(`Invalid edited action for tool \"${toolCall.name}\": args must be an object`);\n\t\t\treturn {\n\t\t\t\trevisedToolCall: {\n\t\t\t\t\ttype: \"tool_call\",\n\t\t\t\t\tname: editedAction.name,\n\t\t\t\t\targs: editedAction.args,\n\t\t\t\t\tid: toolCall.id\n\t\t\t\t},\n\t\t\t\ttoolMessage: null\n\t\t\t};\n\t\t}\n\t\tif (decision.type === \"reject\" && allowedDecisions.includes(\"reject\")) {\n\t\t\t/**\n\t\t\t* Validate that message is a string if provided\n\t\t\t*/\n\t\t\tif (decision.message !== void 0 && typeof decision.message !== \"string\") throw new Error(`Tool call response for \"${toolCall.name}\" must be a string, got ${typeof decision.message}`);\n\t\t\treturn {\n\t\t\t\trevisedToolCall: toolCall,\n\t\t\t\ttoolMessage: new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.ToolMessage({\n\t\t\t\t\tcontent: decision.message ?? `User rejected the tool call for \\`${toolCall.name}\\` with id ${toolCall.id}`,\n\t\t\t\t\tname: toolCall.name,\n\t\t\t\t\ttool_call_id: toolCall.id,\n\t\t\t\t\tstatus: \"error\"\n\t\t\t\t})\n\t\t\t};\n\t\t}\n\t\tconst msg = `Unexpected human decision: ${JSON.stringify(decision)}. Decision type '${decision.type}' is not allowed for tool '${toolCall.name}'. Expected one of ${JSON.stringify(allowedDecisions)} based on the tool's configuration.`;\n\t\tthrow new Error(msg);\n\t};\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)({\n\t\tname: \"HumanInTheLoopMiddleware\",\n\t\tcontextSchema,\n\t\tafterModel: {\n\t\t\tcanJumpTo: [\"model\"],\n\t\t\thook: async (state, runtime) => {\n\t\t\t\tconst config = (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_3__.interopParse)(contextSchema, {\n\t\t\t\t\t...options,\n\t\t\t\t\t...runtime.context || {}\n\t\t\t\t});\n\t\t\t\tif (!config) return;\n\t\t\t\tconst { messages } = state;\n\t\t\t\tif (!messages.length) return;\n\t\t\t\t/**\n\t\t\t\t* Don't do anything if the last message isn't an AI message with tool calls.\n\t\t\t\t*/\n\t\t\t\tconst lastMessage = [...messages].reverse().find((msg) => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance(msg));\n\t\t\t\tif (!lastMessage || !lastMessage.tool_calls?.length) return;\n\t\t\t\t/**\n\t\t\t\t* If the user omits the interruptOn config, we don't do anything.\n\t\t\t\t*/\n\t\t\t\tif (!config.interruptOn) return;\n\t\t\t\t/**\n\t\t\t\t* Resolve per-tool configs (boolean true -> all decisions allowed; false -> auto-approve)\n\t\t\t\t*/\n\t\t\t\tconst resolvedConfigs = {};\n\t\t\t\tfor (const [toolName, toolConfig] of Object.entries(config.interruptOn)) if (typeof toolConfig === \"boolean\") {\n\t\t\t\t\tif (toolConfig === true) resolvedConfigs[toolName] = { allowedDecisions: [...ALLOWED_DECISIONS] };\n\t\t\t\t} else if (toolConfig.allowedDecisions) resolvedConfigs[toolName] = toolConfig;\n\t\t\t\tconst interruptToolCalls = [];\n\t\t\t\tconst autoApprovedToolCalls = [];\n\t\t\t\tfor (const toolCall of lastMessage.tool_calls) if (toolCall.name in resolvedConfigs) interruptToolCalls.push(toolCall);\n\t\t\t\telse autoApprovedToolCalls.push(toolCall);\n\t\t\t\t/**\n\t\t\t\t* No interrupt tool calls, so we can just return.\n\t\t\t\t*/\n\t\t\t\tif (!interruptToolCalls.length) return;\n\t\t\t\t/**\n\t\t\t\t* Create action requests and review configs for all tools that need approval\n\t\t\t\t*/\n\t\t\t\tconst actionRequests = [];\n\t\t\t\tconst reviewConfigs = [];\n\t\t\t\tfor (const toolCall of interruptToolCalls) {\n\t\t\t\t\tconst interruptConfig = resolvedConfigs[toolCall.name];\n\t\t\t\t\t/**\n\t\t\t\t\t* Create ActionRequest and ReviewConfig using helper method\n\t\t\t\t\t*/\n\t\t\t\t\tconst { actionRequest, reviewConfig } = await createActionAndConfig(toolCall, interruptConfig, state, runtime);\n\t\t\t\t\tactionRequests.push(actionRequest);\n\t\t\t\t\treviewConfigs.push(reviewConfig);\n\t\t\t\t}\n\t\t\t\tconst decisions = (await (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_2__.interrupt)({\n\t\t\t\t\tactionRequests,\n\t\t\t\t\treviewConfigs\n\t\t\t\t})).decisions;\n\t\t\t\t/**\n\t\t\t\t* Validate that decisions is a valid array before checking length\n\t\t\t\t*/\n\t\t\t\tif (!decisions || !Array.isArray(decisions)) throw new Error(\"Invalid HITLResponse: decisions must be a non-empty array\");\n\t\t\t\t/**\n\t\t\t\t* Validate that the number of decisions matches the number of interrupt tool calls\n\t\t\t\t*/\n\t\t\t\tif (decisions.length !== interruptToolCalls.length) throw new Error(`Number of human decisions (${decisions.length}) does not match number of hanging tool calls (${interruptToolCalls.length}).`);\n\t\t\t\tconst revisedToolCalls = [...autoApprovedToolCalls];\n\t\t\t\tconst artificialToolMessages = [];\n\t\t\t\tconst hasRejectedToolCalls = decisions.some((decision) => decision.type === \"reject\");\n\t\t\t\t/**\n\t\t\t\t* Process each decision using helper method\n\t\t\t\t*/\n\t\t\t\tfor (let i = 0; i < decisions.length; i++) {\n\t\t\t\t\tconst decision = decisions[i];\n\t\t\t\t\tconst toolCall = interruptToolCalls[i];\n\t\t\t\t\tconst interruptConfig = resolvedConfigs[toolCall.name];\n\t\t\t\t\tconst { revisedToolCall, toolMessage } = processDecision(decision, toolCall, interruptConfig);\n\t\t\t\t\tif (revisedToolCall && (!hasRejectedToolCalls || decision.type === \"reject\")) revisedToolCalls.push(revisedToolCall);\n\t\t\t\t\tif (toolMessage) artificialToolMessages.push(toolMessage);\n\t\t\t\t}\n\t\t\t\t/**\n\t\t\t\t* Update the AI message to only include approved tool calls\n\t\t\t\t*/\n\t\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance(lastMessage)) lastMessage.tool_calls = revisedToolCalls;\n\t\t\t\tconst jumpTo = hasRejectedToolCalls ? \"model\" : void 0;\n\t\t\t\treturn {\n\t\t\t\t\tmessages: [lastMessage, ...artificialToolMessages],\n\t\t\t\t\tjumpTo\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=hitl.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9oaXRsLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFvRDtBQUNjO0FBQ2pCO0FBQ1U7QUFDaEM7O0FBRTNCO0FBQ0Esa0NBQWtDLGlEQUFVLFFBQVEsNENBQVEsSUFBSSw0Q0FBUSxJQUFJLDRDQUFRLFlBQVksMkNBQU8sRUFBRSw0Q0FBUSxJQUFJLDZDQUFTLENBQUMsNENBQVE7QUFDdkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw2Q0FBTTtBQUMzQixnQ0FBZ0MsNENBQVE7QUFDeEMsbUJBQW1CLDJDQUFPO0FBQzFCLGNBQWMsMkNBQU8sRUFBRSw0Q0FBUTtBQUMvQixhQUFhLDRDQUFRLENBQUMseUNBQUs7QUFDM0IsQ0FBQztBQUNELHNCQUFzQiw0Q0FBUTtBQUM5QixjQUFjLDRDQUFRLENBQUMsMkNBQU8sRUFBRSw2Q0FBUztBQUN6QyxvQkFBb0IsNENBQVE7QUFDNUIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHNDQUFzQztBQUNqRCxXQUFXLGlCQUFpQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsUUFBUTtBQUNSO0FBQ0E7QUFDQSwwQkFBMEIsNEJBQTRCO0FBQ3REO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxRQUFRO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVywyQkFBMkI7QUFDdEMsV0FBVyxjQUFjO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHNEQUFzRDtBQUNqRSxXQUFXLFVBQVU7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLG9CQUFvQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsaUJBQWlCO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiw0QkFBNEI7QUFDbEQsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx5Q0FBeUM7QUFDcEQsZ0JBQWdCLDZCQUE2QjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixjQUFjLGdCQUFnQix1Q0FBdUM7QUFDekY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixjQUFjO0FBQ2hDLDZCQUE2QixHQUFHLGFBQWEsUUFBUTtBQUNyRDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxtQkFBbUI7QUFDM0IsUUFBUSxlQUFlO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdFQUFnRSxZQUFZLFNBQVMsVUFBVSxrQ0FBa0M7QUFDeko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtIQUFrSCxjQUFjO0FBQ2hJLHVIQUF1SCxjQUFjO0FBQ3JJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVIQUF1SCxjQUFjLDBCQUEwQix3QkFBd0I7QUFDdkw7QUFDQTtBQUNBLHFCQUFxQixpRUFBVztBQUNoQyx1RUFBdUUsY0FBYyxhQUFhLFlBQVk7QUFDOUc7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSw0Q0FBNEMseUJBQXlCLG1CQUFtQixjQUFjLDZCQUE2QixjQUFjLHFCQUFxQixrQ0FBa0M7QUFDeE07QUFDQTtBQUNBLFFBQVEsZ0VBQWdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIseUVBQVk7QUFDL0I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLFlBQVksV0FBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCwrREFBUztBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RUFBdUU7QUFDdkU7QUFDQTtBQUNBO0FBQ0EsNERBQTREO0FBQzVELE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDhCQUE4QjtBQUMzQztBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsK0RBQVM7QUFDdEM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNHQUFzRyxpQkFBaUIsaURBQWlELDBCQUEwQjtBQUNsTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0JBQXNCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLGFBQWEsK0JBQStCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQVM7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDb0M7QUFDcEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9oaXRsLmpzP2FmNDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlTWlkZGxld2FyZSB9IGZyb20gXCIuLi9taWRkbGV3YXJlLmpzXCI7XG5pbXBvcnQgeyBBSU1lc3NhZ2UsIFRvb2xNZXNzYWdlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9tZXNzYWdlc1wiO1xuaW1wb3J0IHsgaW50ZXJydXB0IH0gZnJvbSBcIkBsYW5nY2hhaW4vbGFuZ2dyYXBoXCI7XG5pbXBvcnQgeyBpbnRlcm9wUGFyc2UgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3V0aWxzL3R5cGVzXCI7XG5pbXBvcnQgeyB6IH0gZnJvbSBcInpvZC92M1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9taWRkbGV3YXJlL2hpdGwudHNcbmNvbnN0IERlc2NyaXB0aW9uRnVuY3Rpb25TY2hlbWEgPSB6LmZ1bmN0aW9uKCkuYXJncyh6LmN1c3RvbSgpLCB6LmN1c3RvbSgpLCB6LmN1c3RvbSgpKS5yZXR1cm5zKHoudW5pb24oW3ouc3RyaW5nKCksIHoucHJvbWlzZSh6LnN0cmluZygpKV0pKTtcbi8qKlxuKiBUaGUgdHlwZSBvZiBkZWNpc2lvbiBhIGh1bWFuIGNhbiBtYWtlLlxuKi9cbmNvbnN0IEFMTE9XRURfREVDSVNJT05TID0gW1xuXHRcImFwcHJvdmVcIixcblx0XCJlZGl0XCIsXG5cdFwicmVqZWN0XCJcbl07XG5jb25zdCBEZWNpc2lvblR5cGUgPSB6LmVudW0oQUxMT1dFRF9ERUNJU0lPTlMpO1xuY29uc3QgSW50ZXJydXB0T25Db25maWdTY2hlbWEgPSB6Lm9iamVjdCh7XG5cdGFsbG93ZWREZWNpc2lvbnM6IHouYXJyYXkoRGVjaXNpb25UeXBlKSxcblx0ZGVzY3JpcHRpb246IHoudW5pb24oW3ouc3RyaW5nKCksIERlc2NyaXB0aW9uRnVuY3Rpb25TY2hlbWFdKS5vcHRpb25hbCgpLFxuXHRhcmdzU2NoZW1hOiB6LnJlY29yZCh6LmFueSgpKS5vcHRpb25hbCgpXG59KTtcbmNvbnN0IGNvbnRleHRTY2hlbWEgPSB6Lm9iamVjdCh7XG5cdGludGVycnVwdE9uOiB6LnJlY29yZCh6LnVuaW9uKFt6LmJvb2xlYW4oKSwgSW50ZXJydXB0T25Db25maWdTY2hlbWFdKSkub3B0aW9uYWwoKSxcblx0ZGVzY3JpcHRpb25QcmVmaXg6IHouc3RyaW5nKCkuZGVmYXVsdChcIlRvb2wgZXhlY3V0aW9uIHJlcXVpcmVzIGFwcHJvdmFsXCIpXG59KTtcbi8qKlxuKiBDcmVhdGVzIGEgSHVtYW4taW4tdGhlLUxvb3AgKEhJVEwpIG1pZGRsZXdhcmUgZm9yIHRvb2wgYXBwcm92YWwgYW5kIG92ZXJzaWdodC5cbipcbiogVGhpcyBtaWRkbGV3YXJlIGludGVyY2VwdHMgdG9vbCBjYWxscyBtYWRlIGJ5IGFuIEFJIGFnZW50IGFuZCBwcm92aWRlcyBodW1hbiBvdmVyc2lnaHRcbiogY2FwYWJpbGl0aWVzIGJlZm9yZSBleGVjdXRpb24uIEl0IGVuYWJsZXMgc2VsZWN0aXZlIGFwcHJvdmFsIHdvcmtmbG93cyB3aGVyZSBjZXJ0YWluIHRvb2xzXG4qIHJlcXVpcmUgaHVtYW4gaW50ZXJ2ZW50aW9uIHdoaWxlIG90aGVycyBjYW4gZXhlY3V0ZSBhdXRvbWF0aWNhbGx5LlxuKlxuKiBBIGludm9jYXRpb24gcmVzdWx0IHRoYXQgaGFzIGJlZW4gaW50ZXJydXB0ZWQgYnkgdGhlIG1pZGRsZXdhcmUgd2lsbCBoYXZlIGEgYF9faW50ZXJydXB0X19gXG4qIHByb3BlcnR5IHRoYXQgY29udGFpbnMgdGhlIGludGVycnVwdCByZXF1ZXN0LlxuKlxuKiBgYGB0c1xuKiBpbXBvcnQgeyB0eXBlIEhJVExSZXF1ZXN0LCB0eXBlIEhJVExSZXNwb25zZSB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbiogaW1wb3J0IHsgdHlwZSBJbnRlcnJ1cHQgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qXG4qIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFnZW50Lmludm9rZShyZXF1ZXN0KTtcbiogY29uc3QgaW50ZXJydXB0UmVxdWVzdCA9IHJlc3VsdC5fX2ludGVycnVwdF9fPy5bMF0gYXMgSW50ZXJydXB0PEhJVExSZXF1ZXN0PjtcbipcbiogLy8gRXhhbWluZSB0aGUgYWN0aW9uIHJlcXVlc3RzIGFuZCByZXZpZXcgY29uZmlnc1xuKiBjb25zdCBhY3Rpb25SZXF1ZXN0cyA9IGludGVycnVwdFJlcXVlc3QudmFsdWUuYWN0aW9uUmVxdWVzdHM7XG4qIGNvbnN0IHJldmlld0NvbmZpZ3MgPSBpbnRlcnJ1cHRSZXF1ZXN0LnZhbHVlLnJldmlld0NvbmZpZ3M7XG4qXG4qIC8vIENyZWF0ZSBkZWNpc2lvbnMgZm9yIGVhY2ggYWN0aW9uXG4qIGNvbnN0IHJlc3VtZTogSElUTFJlc3BvbnNlID0ge1xuKiAgIGRlY2lzaW9uczogYWN0aW9uUmVxdWVzdHMubWFwKChhY3Rpb24sIGkpID0+IHtcbiogICAgIGlmIChhY3Rpb24ubmFtZSA9PT0gXCJjYWxjdWxhdG9yXCIpIHtcbiogICAgICAgcmV0dXJuIHsgdHlwZTogXCJhcHByb3ZlXCIgfTtcbiogICAgIH0gZWxzZSBpZiAoYWN0aW9uLm5hbWUgPT09IFwid3JpdGVfZmlsZVwiKSB7XG4qICAgICAgIHJldHVybiB7XG4qICAgICAgICAgdHlwZTogXCJlZGl0XCIsXG4qICAgICAgICAgZWRpdGVkQWN0aW9uOiB7IG5hbWU6IFwid3JpdGVfZmlsZVwiLCBhcmdzOiB7IGZpbGVuYW1lOiBcInNhZmUudHh0XCIsIGNvbnRlbnQ6IFwiU2FmZSBjb250ZW50XCIgfSB9XG4qICAgICAgIH07XG4qICAgICB9XG4qICAgICByZXR1cm4geyB0eXBlOiBcInJlamVjdFwiLCBtZXNzYWdlOiBcIkFjdGlvbiBub3QgYWxsb3dlZFwiIH07XG4qICAgfSlcbiogfTtcbipcbiogLy8gUmVzdW1lIHdpdGggZGVjaXNpb25zXG4qIGF3YWl0IGFnZW50Lmludm9rZShuZXcgQ29tbWFuZCh7IHJlc3VtZSB9KSwgY29uZmlnKTtcbiogYGBgXG4qXG4qICMjIEZlYXR1cmVzXG4qXG4qIC0gKipTZWxlY3RpdmUgVG9vbCBBcHByb3ZhbCoqOiBDb25maWd1cmUgd2hpY2ggdG9vbHMgcmVxdWlyZSBodW1hbiBhcHByb3ZhbFxuKiAtICoqTXVsdGlwbGUgRGVjaXNpb24gVHlwZXMqKjogQXBwcm92ZSwgZWRpdCwgb3IgcmVqZWN0IHRvb2wgY2FsbHNcbiogLSAqKkFzeW5jaHJvbm91cyBXb3JrZmxvdyoqOiBVc2VzIExhbmdHcmFwaCdzIGludGVycnVwdCBtZWNoYW5pc20gZm9yIG5vbi1ibG9ja2luZyBhcHByb3ZhbFxuKiAtICoqQ3VzdG9tIEFwcHJvdmFsIE1lc3NhZ2VzKio6IFByb3ZpZGUgY29udGV4dC1zcGVjaWZpYyBkZXNjcmlwdGlvbnMgZm9yIGFwcHJvdmFsIHJlcXVlc3RzXG4qXG4qICMjIERlY2lzaW9uIFR5cGVzXG4qXG4qIFdoZW4gYSB0b29sIHJlcXVpcmVzIGFwcHJvdmFsLCB0aGUgaHVtYW4gb3BlcmF0b3IgY2FuIHJlc3BvbmQgd2l0aDpcbiogLSBgYXBwcm92ZWA6IEV4ZWN1dGUgdGhlIHRvb2wgd2l0aCBvcmlnaW5hbCBhcmd1bWVudHNcbiogLSBgZWRpdGA6IE1vZGlmeSB0aGUgdG9vbCBuYW1lIGFuZC9vciBhcmd1bWVudHMgYmVmb3JlIGV4ZWN1dGlvblxuKiAtIGByZWplY3RgOiBQcm92aWRlIGEgbWFudWFsIHJlc3BvbnNlIGluc3RlYWQgb2YgZXhlY3V0aW5nIHRoZSB0b29sXG4qXG4qIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgbWlkZGxld2FyZVxuKiBAcGFyYW0gb3B0aW9ucy5pbnRlcnJ1cHRPbiAtIFBlci10b29sIGNvbmZpZ3VyYXRpb24gbWFwcGluZyB0b29sIG5hbWVzIHRvIHRoZWlyIHNldHRpbmdzXG4qIEBwYXJhbSBvcHRpb25zLmludGVycnVwdE9uW3Rvb2xOYW1lXS5hbGxvd2VkRGVjaXNpb25zIC0gQXJyYXkgb2YgZGVjaXNpb24gdHlwZXMgYWxsb3dlZCBmb3IgdGhpcyB0b29sIChlLmcuLCBbXCJhcHByb3ZlXCIsIFwiZWRpdFwiLCBcInJlamVjdFwiXSlcbiogQHBhcmFtIG9wdGlvbnMuaW50ZXJydXB0T25bdG9vbE5hbWVdLmRlc2NyaXB0aW9uIC0gQ3VzdG9tIGFwcHJvdmFsIG1lc3NhZ2UgZm9yIHRoZSB0b29sLiBDYW4gYmUgZWl0aGVyIGEgc3RhdGljIHN0cmluZyBvciBhIGNhbGxhYmxlIHRoYXQgZHluYW1pY2FsbHkgZ2VuZXJhdGVzIHRoZSBkZXNjcmlwdGlvbiBiYXNlZCBvbiBhZ2VudCBzdGF0ZSwgcnVudGltZSwgYW5kIHRvb2wgY2FsbCBpbmZvcm1hdGlvblxuKiBAcGFyYW0gb3B0aW9ucy5pbnRlcnJ1cHRPblt0b29sTmFtZV0uYXJnc1NjaGVtYSAtIEpTT04gc2NoZW1hIGZvciB0aGUgYXJndW1lbnRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgYWN0aW9uLCBpZiBlZGl0cyBhcmUgYWxsb3dlZFxuKiBAcGFyYW0gb3B0aW9ucy5kZXNjcmlwdGlvblByZWZpeCAtIERlZmF1bHQgcHJlZml4IGZvciBhcHByb3ZhbCBtZXNzYWdlcyAoZGVmYXVsdDogXCJUb29sIGV4ZWN1dGlvbiByZXF1aXJlcyBhcHByb3ZhbFwiKS4gT25seSB1c2VkIGZvciB0b29scyB0aGF0IGRvIG5vdCBkZWZpbmUgYSBjdXN0b20gYGRlc2NyaXB0aW9uYCBpbiB0aGVpciBJbnRlcnJ1cHRPbkNvbmZpZy5cbipcbiogQHJldHVybnMgQSBtaWRkbGV3YXJlIGluc3RhbmNlIHRoYXQgY2FuIGJlIHBhc3NlZCB0byBgY3JlYXRlQWdlbnRgXG4qXG4qIEBleGFtcGxlXG4qIEJhc2ljIHVzYWdlIHdpdGggc2VsZWN0aXZlIHRvb2wgYXBwcm92YWxcbiogYGBgdHlwZXNjcmlwdFxuKiBpbXBvcnQgeyBodW1hbkluVGhlTG9vcE1pZGRsZXdhcmUgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qIGltcG9ydCB7IGNyZWF0ZUFnZW50IH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKlxuKiBjb25zdCBoaXRsTWlkZGxld2FyZSA9IGh1bWFuSW5UaGVMb29wTWlkZGxld2FyZSh7XG4qICAgaW50ZXJydXB0T246IHtcbiogICAgIC8vIEludGVycnVwdCB3cml0ZV9maWxlIHRvb2wgYW5kIGFsbG93IGVkaXRzIG9yIGFwcHJvdmFsc1xuKiAgICAgXCJ3cml0ZV9maWxlXCI6IHtcbiogICAgICAgYWxsb3dlZERlY2lzaW9uczogW1wiYXBwcm92ZVwiLCBcImVkaXRcIl0sXG4qICAgICAgIGRlc2NyaXB0aW9uOiBcIuKaoO+4jyBGaWxlIHdyaXRlIG9wZXJhdGlvbiByZXF1aXJlcyBhcHByb3ZhbFwiXG4qICAgICB9LFxuKiAgICAgLy8gQXV0by1hcHByb3ZlIHJlYWRfZmlsZSB0b29sXG4qICAgICBcInJlYWRfZmlsZVwiOiBmYWxzZVxuKiAgIH1cbiogfSk7XG4qXG4qIGNvbnN0IGFnZW50ID0gY3JlYXRlQWdlbnQoe1xuKiAgIG1vZGVsOiBcIm9wZW5haTpncHQtNFwiLFxuKiAgIHRvb2xzOiBbd3JpdGVGaWxlVG9vbCwgcmVhZEZpbGVUb29sXSxcbiogICBtaWRkbGV3YXJlOiBbaGl0bE1pZGRsZXdhcmVdXG4qIH0pO1xuKiBgYGBcbipcbiogQGV4YW1wbGVcbiogSGFuZGxpbmcgYXBwcm92YWwgcmVxdWVzdHNcbiogYGBgdHlwZXNjcmlwdFxuKiBpbXBvcnQgeyB0eXBlIEhJVExSZXF1ZXN0LCB0eXBlIEhJVExSZXNwb25zZSwgdHlwZSBJbnRlcnJ1cHQgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qIGltcG9ydCB7IENvbW1hbmQgfSBmcm9tIFwiQGxhbmdjaGFpbi9sYW5nZ3JhcGhcIjtcbipcbiogLy8gSW5pdGlhbCBhZ2VudCBpbnZvY2F0aW9uXG4qIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFnZW50Lmludm9rZSh7XG4qICAgbWVzc2FnZXM6IFtuZXcgSHVtYW5NZXNzYWdlKFwiV3JpdGUgJ0hlbGxvJyB0byBvdXRwdXQudHh0XCIpXVxuKiB9LCBjb25maWcpO1xuKlxuKiAvLyBDaGVjayBpZiBhZ2VudCBpcyBwYXVzZWQgZm9yIGFwcHJvdmFsXG4qIGlmIChyZXN1bHQuX19pbnRlcnJ1cHRfXykge1xuKiAgIGNvbnN0IGludGVycnVwdFJlcXVlc3QgPSByZXN1bHQuX19pbnRlcnJ1cHRfXz8uWzBdIGFzIEludGVycnVwdDxISVRMUmVxdWVzdD47XG4qXG4qICAgLy8gU2hvdyB0b29sIGNhbGwgZGV0YWlscyB0byB1c2VyXG4qICAgY29uc29sZS5sb2coXCJBY3Rpb25zOlwiLCBpbnRlcnJ1cHRSZXF1ZXN0LnZhbHVlLmFjdGlvblJlcXVlc3RzKTtcbiogICBjb25zb2xlLmxvZyhcIlJldmlldyBjb25maWdzOlwiLCBpbnRlcnJ1cHRSZXF1ZXN0LnZhbHVlLnJldmlld0NvbmZpZ3MpO1xuKlxuKiAgIC8vIFJlc3VtZSB3aXRoIGFwcHJvdmFsXG4qICAgY29uc3QgcmVzdW1lOiBISVRMUmVzcG9uc2UgPSB7XG4qICAgICBkZWNpc2lvbnM6IFt7IHR5cGU6IFwiYXBwcm92ZVwiIH1dXG4qICAgfTtcbiogICBhd2FpdCBhZ2VudC5pbnZva2UoXG4qICAgICBuZXcgQ29tbWFuZCh7IHJlc3VtZSB9KSxcbiogICAgIGNvbmZpZ1xuKiAgICk7XG4qIH1cbiogYGBgXG4qXG4qIEBleGFtcGxlXG4qIERpZmZlcmVudCBkZWNpc2lvbiB0eXBlc1xuKiBgYGB0eXBlc2NyaXB0XG4qIGltcG9ydCB7IHR5cGUgSElUTFJlc3BvbnNlIH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKlxuKiAvLyBBcHByb3ZlIHRoZSB0b29sIGNhbGwgYXMtaXNcbiogY29uc3QgcmVzdW1lOiBISVRMUmVzcG9uc2UgPSB7XG4qICAgZGVjaXNpb25zOiBbeyB0eXBlOiBcImFwcHJvdmVcIiB9XVxuKiB9O1xuKlxuKiAvLyBFZGl0IHRoZSB0b29sIGFyZ3VtZW50c1xuKiBjb25zdCByZXN1bWU6IEhJVExSZXNwb25zZSA9IHtcbiogICBkZWNpc2lvbnM6IFt7XG4qICAgICB0eXBlOiBcImVkaXRcIixcbiogICAgIGVkaXRlZEFjdGlvbjogeyBuYW1lOiBcIndyaXRlX2ZpbGVcIiwgYXJnczogeyBmaWxlbmFtZTogXCJzYWZlLnR4dFwiLCBjb250ZW50OiBcIk1vZGlmaWVkXCIgfSB9XG4qICAgfV1cbiogfTtcbipcbiogLy8gUmVqZWN0IHdpdGggZmVlZGJhY2tcbiogY29uc3QgcmVzdW1lOiBISVRMUmVzcG9uc2UgPSB7XG4qICAgZGVjaXNpb25zOiBbe1xuKiAgICAgdHlwZTogXCJyZWplY3RcIixcbiogICAgIG1lc3NhZ2U6IFwiRmlsZSBvcGVyYXRpb24gbm90IGFsbG93ZWQgaW4gZGVtbyBtb2RlXCJcbiogICB9XVxuKiB9O1xuKiBgYGBcbipcbiogQGV4YW1wbGVcbiogUHJvZHVjdGlvbiB1c2UgY2FzZSB3aXRoIGRhdGFiYXNlIG9wZXJhdGlvbnNcbiogYGBgdHlwZXNjcmlwdFxuKiBjb25zdCBoaXRsTWlkZGxld2FyZSA9IGh1bWFuSW5UaGVMb29wTWlkZGxld2FyZSh7XG4qICAgaW50ZXJydXB0T246IHtcbiogICAgIFwiZXhlY3V0ZV9zcWxcIjoge1xuKiAgICAgICBhbGxvd2VkRGVjaXNpb25zOiBbXCJhcHByb3ZlXCIsIFwiZWRpdFwiLCBcInJlamVjdFwiXSxcbiogICAgICAgZGVzY3JpcHRpb246IFwi8J+aqCBTUUwgcXVlcnkgcmVxdWlyZXMgREJBIGFwcHJvdmFsXFxuUGxlYXNlIHJldmlldyBmb3Igc2FmZXR5IGFuZCBwZXJmb3JtYW5jZVwiXG4qICAgICB9LFxuKiAgICAgXCJyZWFkX3NjaGVtYVwiOiBmYWxzZSwgIC8vIFJlYWRpbmcgbWV0YWRhdGEgaXMgc2FmZVxuKiAgICAgXCJkZWxldGVfcmVjb3Jkc1wiOiB7XG4qICAgICAgIGFsbG93ZWREZWNpc2lvbnM6IFtcImFwcHJvdmVcIiwgXCJyZWplY3RcIl0sXG4qICAgICAgIGRlc2NyaXB0aW9uOiBcIuKblCBERVNUUlVDVElWRSBPUEVSQVRJT04gLSBSZXF1aXJlcyBtYW5hZ2VyIGFwcHJvdmFsXCJcbiogICAgIH1cbiogICB9LFxuKiAgIGRlc2NyaXB0aW9uUHJlZml4OiBcIkRhdGFiYXNlIG9wZXJhdGlvbiBwZW5kaW5nIGFwcHJvdmFsXCJcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZVxuKiBVc2luZyBkeW5hbWljIGNhbGxhYmxlIGRlc2NyaXB0aW9uc1xuKiBgYGB0eXBlc2NyaXB0XG4qIGltcG9ydCB7IHR5cGUgRGVzY3JpcHRpb25GYWN0b3J5LCB0eXBlIFRvb2xDYWxsIH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKiBpbXBvcnQgdHlwZSB7IEFnZW50QnVpbHRJblN0YXRlLCBSdW50aW1lIH0gZnJvbSBcImxhbmdjaGFpbi9hZ2VudHNcIjtcbipcbiogLy8gRGVmaW5lIGEgZHluYW1pYyBkZXNjcmlwdGlvbiBmYWN0b3J5XG4qIGNvbnN0IGZvcm1hdFRvb2xEZXNjcmlwdGlvbjogRGVzY3JpcHRpb25GYWN0b3J5ID0gKFxuKiAgIHRvb2xDYWxsOiBUb29sQ2FsbCxcbiogICBzdGF0ZTogQWdlbnRCdWlsdEluU3RhdGUsXG4qICAgcnVudGltZTogUnVudGltZTx1bmtub3duPlxuKiApID0+IHtcbiogICByZXR1cm4gYFRvb2w6ICR7dG9vbENhbGwubmFtZX1cXG5Bcmd1bWVudHM6XFxuJHtKU09OLnN0cmluZ2lmeSh0b29sQ2FsbC5hcmdzLCBudWxsLCAyKX1gO1xuKiB9O1xuKlxuKiBjb25zdCBoaXRsTWlkZGxld2FyZSA9IGh1bWFuSW5UaGVMb29wTWlkZGxld2FyZSh7XG4qICAgaW50ZXJydXB0T246IHtcbiogICAgIFwid3JpdGVfZmlsZVwiOiB7XG4qICAgICAgIGFsbG93ZWREZWNpc2lvbnM6IFtcImFwcHJvdmVcIiwgXCJlZGl0XCJdLFxuKiAgICAgICAvLyBVc2UgZHluYW1pYyBkZXNjcmlwdGlvbiB0aGF0IGNhbiBhY2Nlc3MgdG9vbCBjYWxsLCBzdGF0ZSwgYW5kIHJ1bnRpbWVcbiogICAgICAgZGVzY3JpcHRpb246IGZvcm1hdFRvb2xEZXNjcmlwdGlvblxuKiAgICAgfSxcbiogICAgIC8vIE9yIHVzZSBhbiBpbmxpbmUgZnVuY3Rpb25cbiogICAgIFwic2VuZF9lbWFpbFwiOiB7XG4qICAgICAgIGFsbG93ZWREZWNpc2lvbnM6IFtcImFwcHJvdmVcIiwgXCJyZWplY3RcIl0sXG4qICAgICAgIGRlc2NyaXB0aW9uOiAodG9vbENhbGwsIHN0YXRlLCBydW50aW1lKSA9PiB7XG4qICAgICAgICAgY29uc3QgeyB0bywgc3ViamVjdCB9ID0gdG9vbENhbGwuYXJncztcbiogICAgICAgICByZXR1cm4gYEVtYWlsIHRvICR7dG99XFxuU3ViamVjdDogJHtzdWJqZWN0fVxcblxcblJlcXVpcmVzIGFwcHJvdmFsIGJlZm9yZSBzZW5kaW5nYDtcbiogICAgICAgfVxuKiAgICAgfVxuKiAgIH1cbiogfSk7XG4qIGBgYFxuKlxuKiBAcmVtYXJrc1xuKiAtIFRvb2wgY2FsbHMgYXJlIHByb2Nlc3NlZCBpbiB0aGUgb3JkZXIgdGhleSBhcHBlYXIgaW4gdGhlIEFJIG1lc3NhZ2VcbiogLSBBdXRvLWFwcHJvdmVkIHRvb2xzIGV4ZWN1dGUgaW1tZWRpYXRlbHkgd2l0aG91dCBpbnRlcnJ1cHRpb25cbiogLSBNdWx0aXBsZSB0b29scyByZXF1aXJpbmcgYXBwcm92YWwgYXJlIGJ1bmRsZWQgaW50byBhIHNpbmdsZSBpbnRlcnJ1cHQgcmVxdWVzdFxuKiAtIFRoZSBtaWRkbGV3YXJlIG9wZXJhdGVzIGluIHRoZSBgYWZ0ZXJNb2RlbGAgcGhhc2UsIGludGVyY2VwdGluZyBiZWZvcmUgdG9vbCBleGVjdXRpb25cbiogLSBSZXF1aXJlcyBhIGNoZWNrcG9pbnRlciB0byBtYWludGFpbiBzdGF0ZSBhY3Jvc3MgaW50ZXJydXB0aW9uc1xuKlxuKiBAc2VlIHtAbGluayBjcmVhdGVBZ2VudH0gZm9yIGFnZW50IGNyZWF0aW9uXG4qIEBzZWUge0BsaW5rIENvbW1hbmR9IGZvciByZXN1bWluZyBpbnRlcnJ1cHRlZCBleGVjdXRpb25cbiogQHB1YmxpY1xuKi9cbmZ1bmN0aW9uIGh1bWFuSW5UaGVMb29wTWlkZGxld2FyZShvcHRpb25zKSB7XG5cdGNvbnN0IGNyZWF0ZUFjdGlvbkFuZENvbmZpZyA9IGFzeW5jICh0b29sQ2FsbCwgY29uZmlnLCBzdGF0ZSwgcnVudGltZSkgPT4ge1xuXHRcdGNvbnN0IHRvb2xOYW1lID0gdG9vbENhbGwubmFtZTtcblx0XHRjb25zdCB0b29sQXJncyA9IHRvb2xDYWxsLmFyZ3M7XG5cdFx0Y29uc3QgZGVzY3JpcHRpb25WYWx1ZSA9IGNvbmZpZy5kZXNjcmlwdGlvbjtcblx0XHRsZXQgZGVzY3JpcHRpb247XG5cdFx0aWYgKHR5cGVvZiBkZXNjcmlwdGlvblZhbHVlID09PSBcImZ1bmN0aW9uXCIpIGRlc2NyaXB0aW9uID0gYXdhaXQgZGVzY3JpcHRpb25WYWx1ZSh0b29sQ2FsbCwgc3RhdGUsIHJ1bnRpbWUpO1xuXHRcdGVsc2UgaWYgKGRlc2NyaXB0aW9uVmFsdWUgIT09IHZvaWQgMCkgZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvblZhbHVlO1xuXHRcdGVsc2UgZGVzY3JpcHRpb24gPSBgJHtvcHRpb25zLmRlc2NyaXB0aW9uUHJlZml4ID8/IFwiVG9vbCBleGVjdXRpb24gcmVxdWlyZXMgYXBwcm92YWxcIn1cXG5cXG5Ub29sOiAke3Rvb2xOYW1lfVxcbkFyZ3M6ICR7SlNPTi5zdHJpbmdpZnkodG9vbEFyZ3MsIG51bGwsIDIpfWA7XG5cdFx0LyoqXG5cdFx0KiBDcmVhdGUgQWN0aW9uUmVxdWVzdCB3aXRoIGRlc2NyaXB0aW9uXG5cdFx0Ki9cblx0XHRjb25zdCBhY3Rpb25SZXF1ZXN0ID0ge1xuXHRcdFx0bmFtZTogdG9vbE5hbWUsXG5cdFx0XHRhcmdzOiB0b29sQXJncyxcblx0XHRcdGRlc2NyaXB0aW9uXG5cdFx0fTtcblx0XHQvKipcblx0XHQqIENyZWF0ZSBSZXZpZXdDb25maWdcblx0XHQqL1xuXHRcdGNvbnN0IHJldmlld0NvbmZpZyA9IHtcblx0XHRcdGFjdGlvbk5hbWU6IHRvb2xOYW1lLFxuXHRcdFx0YWxsb3dlZERlY2lzaW9uczogY29uZmlnLmFsbG93ZWREZWNpc2lvbnNcblx0XHR9O1xuXHRcdGlmIChjb25maWcuYXJnc1NjaGVtYSkgcmV2aWV3Q29uZmlnLmFyZ3NTY2hlbWEgPSBjb25maWcuYXJnc1NjaGVtYTtcblx0XHRyZXR1cm4ge1xuXHRcdFx0YWN0aW9uUmVxdWVzdCxcblx0XHRcdHJldmlld0NvbmZpZ1xuXHRcdH07XG5cdH07XG5cdGNvbnN0IHByb2Nlc3NEZWNpc2lvbiA9IChkZWNpc2lvbiwgdG9vbENhbGwsIGNvbmZpZykgPT4ge1xuXHRcdGNvbnN0IGFsbG93ZWREZWNpc2lvbnMgPSBjb25maWcuYWxsb3dlZERlY2lzaW9ucztcblx0XHRpZiAoZGVjaXNpb24udHlwZSA9PT0gXCJhcHByb3ZlXCIgJiYgYWxsb3dlZERlY2lzaW9ucy5pbmNsdWRlcyhcImFwcHJvdmVcIikpIHJldHVybiB7XG5cdFx0XHRyZXZpc2VkVG9vbENhbGw6IHRvb2xDYWxsLFxuXHRcdFx0dG9vbE1lc3NhZ2U6IG51bGxcblx0XHR9O1xuXHRcdGlmIChkZWNpc2lvbi50eXBlID09PSBcImVkaXRcIiAmJiBhbGxvd2VkRGVjaXNpb25zLmluY2x1ZGVzKFwiZWRpdFwiKSkge1xuXHRcdFx0Y29uc3QgZWRpdGVkQWN0aW9uID0gZGVjaXNpb24uZWRpdGVkQWN0aW9uO1xuXHRcdFx0LyoqXG5cdFx0XHQqIFZhbGlkYXRlIGVkaXRlZCBhY3Rpb24gc3RydWN0dXJlXG5cdFx0XHQqL1xuXHRcdFx0aWYgKCFlZGl0ZWRBY3Rpb24gfHwgdHlwZW9mIGVkaXRlZEFjdGlvbi5uYW1lICE9PSBcInN0cmluZ1wiKSB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZWRpdGVkIGFjdGlvbiBmb3IgdG9vbCBcIiR7dG9vbENhbGwubmFtZX1cIjogbmFtZSBtdXN0IGJlIGEgc3RyaW5nYCk7XG5cdFx0XHRpZiAoIWVkaXRlZEFjdGlvbi5hcmdzIHx8IHR5cGVvZiBlZGl0ZWRBY3Rpb24uYXJncyAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGVkaXRlZCBhY3Rpb24gZm9yIHRvb2wgXCIke3Rvb2xDYWxsLm5hbWV9XCI6IGFyZ3MgbXVzdCBiZSBhbiBvYmplY3RgKTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHJldmlzZWRUb29sQ2FsbDoge1xuXHRcdFx0XHRcdHR5cGU6IFwidG9vbF9jYWxsXCIsXG5cdFx0XHRcdFx0bmFtZTogZWRpdGVkQWN0aW9uLm5hbWUsXG5cdFx0XHRcdFx0YXJnczogZWRpdGVkQWN0aW9uLmFyZ3MsXG5cdFx0XHRcdFx0aWQ6IHRvb2xDYWxsLmlkXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHRvb2xNZXNzYWdlOiBudWxsXG5cdFx0XHR9O1xuXHRcdH1cblx0XHRpZiAoZGVjaXNpb24udHlwZSA9PT0gXCJyZWplY3RcIiAmJiBhbGxvd2VkRGVjaXNpb25zLmluY2x1ZGVzKFwicmVqZWN0XCIpKSB7XG5cdFx0XHQvKipcblx0XHRcdCogVmFsaWRhdGUgdGhhdCBtZXNzYWdlIGlzIGEgc3RyaW5nIGlmIHByb3ZpZGVkXG5cdFx0XHQqL1xuXHRcdFx0aWYgKGRlY2lzaW9uLm1lc3NhZ2UgIT09IHZvaWQgMCAmJiB0eXBlb2YgZGVjaXNpb24ubWVzc2FnZSAhPT0gXCJzdHJpbmdcIikgdGhyb3cgbmV3IEVycm9yKGBUb29sIGNhbGwgcmVzcG9uc2UgZm9yIFwiJHt0b29sQ2FsbC5uYW1lfVwiIG11c3QgYmUgYSBzdHJpbmcsIGdvdCAke3R5cGVvZiBkZWNpc2lvbi5tZXNzYWdlfWApO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0cmV2aXNlZFRvb2xDYWxsOiB0b29sQ2FsbCxcblx0XHRcdFx0dG9vbE1lc3NhZ2U6IG5ldyBUb29sTWVzc2FnZSh7XG5cdFx0XHRcdFx0Y29udGVudDogZGVjaXNpb24ubWVzc2FnZSA/PyBgVXNlciByZWplY3RlZCB0aGUgdG9vbCBjYWxsIGZvciBcXGAke3Rvb2xDYWxsLm5hbWV9XFxgIHdpdGggaWQgJHt0b29sQ2FsbC5pZH1gLFxuXHRcdFx0XHRcdG5hbWU6IHRvb2xDYWxsLm5hbWUsXG5cdFx0XHRcdFx0dG9vbF9jYWxsX2lkOiB0b29sQ2FsbC5pZCxcblx0XHRcdFx0XHRzdGF0dXM6IFwiZXJyb3JcIlxuXHRcdFx0XHR9KVxuXHRcdFx0fTtcblx0XHR9XG5cdFx0Y29uc3QgbXNnID0gYFVuZXhwZWN0ZWQgaHVtYW4gZGVjaXNpb246ICR7SlNPTi5zdHJpbmdpZnkoZGVjaXNpb24pfS4gRGVjaXNpb24gdHlwZSAnJHtkZWNpc2lvbi50eXBlfScgaXMgbm90IGFsbG93ZWQgZm9yIHRvb2wgJyR7dG9vbENhbGwubmFtZX0nLiBFeHBlY3RlZCBvbmUgb2YgJHtKU09OLnN0cmluZ2lmeShhbGxvd2VkRGVjaXNpb25zKX0gYmFzZWQgb24gdGhlIHRvb2wncyBjb25maWd1cmF0aW9uLmA7XG5cdFx0dGhyb3cgbmV3IEVycm9yKG1zZyk7XG5cdH07XG5cdHJldHVybiBjcmVhdGVNaWRkbGV3YXJlKHtcblx0XHRuYW1lOiBcIkh1bWFuSW5UaGVMb29wTWlkZGxld2FyZVwiLFxuXHRcdGNvbnRleHRTY2hlbWEsXG5cdFx0YWZ0ZXJNb2RlbDoge1xuXHRcdFx0Y2FuSnVtcFRvOiBbXCJtb2RlbFwiXSxcblx0XHRcdGhvb2s6IGFzeW5jIChzdGF0ZSwgcnVudGltZSkgPT4ge1xuXHRcdFx0XHRjb25zdCBjb25maWcgPSBpbnRlcm9wUGFyc2UoY29udGV4dFNjaGVtYSwge1xuXHRcdFx0XHRcdC4uLm9wdGlvbnMsXG5cdFx0XHRcdFx0Li4ucnVudGltZS5jb250ZXh0IHx8IHt9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAoIWNvbmZpZykgcmV0dXJuO1xuXHRcdFx0XHRjb25zdCB7IG1lc3NhZ2VzIH0gPSBzdGF0ZTtcblx0XHRcdFx0aWYgKCFtZXNzYWdlcy5sZW5ndGgpIHJldHVybjtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogRG9uJ3QgZG8gYW55dGhpbmcgaWYgdGhlIGxhc3QgbWVzc2FnZSBpc24ndCBhbiBBSSBtZXNzYWdlIHdpdGggdG9vbCBjYWxscy5cblx0XHRcdFx0Ki9cblx0XHRcdFx0Y29uc3QgbGFzdE1lc3NhZ2UgPSBbLi4ubWVzc2FnZXNdLnJldmVyc2UoKS5maW5kKChtc2cpID0+IEFJTWVzc2FnZS5pc0luc3RhbmNlKG1zZykpO1xuXHRcdFx0XHRpZiAoIWxhc3RNZXNzYWdlIHx8ICFsYXN0TWVzc2FnZS50b29sX2NhbGxzPy5sZW5ndGgpIHJldHVybjtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogSWYgdGhlIHVzZXIgb21pdHMgdGhlIGludGVycnVwdE9uIGNvbmZpZywgd2UgZG9uJ3QgZG8gYW55dGhpbmcuXG5cdFx0XHRcdCovXG5cdFx0XHRcdGlmICghY29uZmlnLmludGVycnVwdE9uKSByZXR1cm47XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIFJlc29sdmUgcGVyLXRvb2wgY29uZmlncyAoYm9vbGVhbiB0cnVlIC0+IGFsbCBkZWNpc2lvbnMgYWxsb3dlZDsgZmFsc2UgLT4gYXV0by1hcHByb3ZlKVxuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCByZXNvbHZlZENvbmZpZ3MgPSB7fTtcblx0XHRcdFx0Zm9yIChjb25zdCBbdG9vbE5hbWUsIHRvb2xDb25maWddIG9mIE9iamVjdC5lbnRyaWVzKGNvbmZpZy5pbnRlcnJ1cHRPbikpIGlmICh0eXBlb2YgdG9vbENvbmZpZyA9PT0gXCJib29sZWFuXCIpIHtcblx0XHRcdFx0XHRpZiAodG9vbENvbmZpZyA9PT0gdHJ1ZSkgcmVzb2x2ZWRDb25maWdzW3Rvb2xOYW1lXSA9IHsgYWxsb3dlZERlY2lzaW9uczogWy4uLkFMTE9XRURfREVDSVNJT05TXSB9O1xuXHRcdFx0XHR9IGVsc2UgaWYgKHRvb2xDb25maWcuYWxsb3dlZERlY2lzaW9ucykgcmVzb2x2ZWRDb25maWdzW3Rvb2xOYW1lXSA9IHRvb2xDb25maWc7XG5cdFx0XHRcdGNvbnN0IGludGVycnVwdFRvb2xDYWxscyA9IFtdO1xuXHRcdFx0XHRjb25zdCBhdXRvQXBwcm92ZWRUb29sQ2FsbHMgPSBbXTtcblx0XHRcdFx0Zm9yIChjb25zdCB0b29sQ2FsbCBvZiBsYXN0TWVzc2FnZS50b29sX2NhbGxzKSBpZiAodG9vbENhbGwubmFtZSBpbiByZXNvbHZlZENvbmZpZ3MpIGludGVycnVwdFRvb2xDYWxscy5wdXNoKHRvb2xDYWxsKTtcblx0XHRcdFx0ZWxzZSBhdXRvQXBwcm92ZWRUb29sQ2FsbHMucHVzaCh0b29sQ2FsbCk7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIE5vIGludGVycnVwdCB0b29sIGNhbGxzLCBzbyB3ZSBjYW4ganVzdCByZXR1cm4uXG5cdFx0XHRcdCovXG5cdFx0XHRcdGlmICghaW50ZXJydXB0VG9vbENhbGxzLmxlbmd0aCkgcmV0dXJuO1xuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBDcmVhdGUgYWN0aW9uIHJlcXVlc3RzIGFuZCByZXZpZXcgY29uZmlncyBmb3IgYWxsIHRvb2xzIHRoYXQgbmVlZCBhcHByb3ZhbFxuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCBhY3Rpb25SZXF1ZXN0cyA9IFtdO1xuXHRcdFx0XHRjb25zdCByZXZpZXdDb25maWdzID0gW107XG5cdFx0XHRcdGZvciAoY29uc3QgdG9vbENhbGwgb2YgaW50ZXJydXB0VG9vbENhbGxzKSB7XG5cdFx0XHRcdFx0Y29uc3QgaW50ZXJydXB0Q29uZmlnID0gcmVzb2x2ZWRDb25maWdzW3Rvb2xDYWxsLm5hbWVdO1xuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCogQ3JlYXRlIEFjdGlvblJlcXVlc3QgYW5kIFJldmlld0NvbmZpZyB1c2luZyBoZWxwZXIgbWV0aG9kXG5cdFx0XHRcdFx0Ki9cblx0XHRcdFx0XHRjb25zdCB7IGFjdGlvblJlcXVlc3QsIHJldmlld0NvbmZpZyB9ID0gYXdhaXQgY3JlYXRlQWN0aW9uQW5kQ29uZmlnKHRvb2xDYWxsLCBpbnRlcnJ1cHRDb25maWcsIHN0YXRlLCBydW50aW1lKTtcblx0XHRcdFx0XHRhY3Rpb25SZXF1ZXN0cy5wdXNoKGFjdGlvblJlcXVlc3QpO1xuXHRcdFx0XHRcdHJldmlld0NvbmZpZ3MucHVzaChyZXZpZXdDb25maWcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNvbnN0IGRlY2lzaW9ucyA9IChhd2FpdCBpbnRlcnJ1cHQoe1xuXHRcdFx0XHRcdGFjdGlvblJlcXVlc3RzLFxuXHRcdFx0XHRcdHJldmlld0NvbmZpZ3Ncblx0XHRcdFx0fSkpLmRlY2lzaW9ucztcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogVmFsaWRhdGUgdGhhdCBkZWNpc2lvbnMgaXMgYSB2YWxpZCBhcnJheSBiZWZvcmUgY2hlY2tpbmcgbGVuZ3RoXG5cdFx0XHRcdCovXG5cdFx0XHRcdGlmICghZGVjaXNpb25zIHx8ICFBcnJheS5pc0FycmF5KGRlY2lzaW9ucykpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgSElUTFJlc3BvbnNlOiBkZWNpc2lvbnMgbXVzdCBiZSBhIG5vbi1lbXB0eSBhcnJheVwiKTtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogVmFsaWRhdGUgdGhhdCB0aGUgbnVtYmVyIG9mIGRlY2lzaW9ucyBtYXRjaGVzIHRoZSBudW1iZXIgb2YgaW50ZXJydXB0IHRvb2wgY2FsbHNcblx0XHRcdFx0Ki9cblx0XHRcdFx0aWYgKGRlY2lzaW9ucy5sZW5ndGggIT09IGludGVycnVwdFRvb2xDYWxscy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcihgTnVtYmVyIG9mIGh1bWFuIGRlY2lzaW9ucyAoJHtkZWNpc2lvbnMubGVuZ3RofSkgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIGhhbmdpbmcgdG9vbCBjYWxscyAoJHtpbnRlcnJ1cHRUb29sQ2FsbHMubGVuZ3RofSkuYCk7XG5cdFx0XHRcdGNvbnN0IHJldmlzZWRUb29sQ2FsbHMgPSBbLi4uYXV0b0FwcHJvdmVkVG9vbENhbGxzXTtcblx0XHRcdFx0Y29uc3QgYXJ0aWZpY2lhbFRvb2xNZXNzYWdlcyA9IFtdO1xuXHRcdFx0XHRjb25zdCBoYXNSZWplY3RlZFRvb2xDYWxscyA9IGRlY2lzaW9ucy5zb21lKChkZWNpc2lvbikgPT4gZGVjaXNpb24udHlwZSA9PT0gXCJyZWplY3RcIik7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIFByb2Nlc3MgZWFjaCBkZWNpc2lvbiB1c2luZyBoZWxwZXIgbWV0aG9kXG5cdFx0XHRcdCovXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgZGVjaXNpb25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0Y29uc3QgZGVjaXNpb24gPSBkZWNpc2lvbnNbaV07XG5cdFx0XHRcdFx0Y29uc3QgdG9vbENhbGwgPSBpbnRlcnJ1cHRUb29sQ2FsbHNbaV07XG5cdFx0XHRcdFx0Y29uc3QgaW50ZXJydXB0Q29uZmlnID0gcmVzb2x2ZWRDb25maWdzW3Rvb2xDYWxsLm5hbWVdO1xuXHRcdFx0XHRcdGNvbnN0IHsgcmV2aXNlZFRvb2xDYWxsLCB0b29sTWVzc2FnZSB9ID0gcHJvY2Vzc0RlY2lzaW9uKGRlY2lzaW9uLCB0b29sQ2FsbCwgaW50ZXJydXB0Q29uZmlnKTtcblx0XHRcdFx0XHRpZiAocmV2aXNlZFRvb2xDYWxsICYmICghaGFzUmVqZWN0ZWRUb29sQ2FsbHMgfHwgZGVjaXNpb24udHlwZSA9PT0gXCJyZWplY3RcIikpIHJldmlzZWRUb29sQ2FsbHMucHVzaChyZXZpc2VkVG9vbENhbGwpO1xuXHRcdFx0XHRcdGlmICh0b29sTWVzc2FnZSkgYXJ0aWZpY2lhbFRvb2xNZXNzYWdlcy5wdXNoKHRvb2xNZXNzYWdlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBVcGRhdGUgdGhlIEFJIG1lc3NhZ2UgdG8gb25seSBpbmNsdWRlIGFwcHJvdmVkIHRvb2wgY2FsbHNcblx0XHRcdFx0Ki9cblx0XHRcdFx0aWYgKEFJTWVzc2FnZS5pc0luc3RhbmNlKGxhc3RNZXNzYWdlKSkgbGFzdE1lc3NhZ2UudG9vbF9jYWxscyA9IHJldmlzZWRUb29sQ2FsbHM7XG5cdFx0XHRcdGNvbnN0IGp1bXBUbyA9IGhhc1JlamVjdGVkVG9vbENhbGxzID8gXCJtb2RlbFwiIDogdm9pZCAwO1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdG1lc3NhZ2VzOiBbbGFzdE1lc3NhZ2UsIC4uLmFydGlmaWNpYWxUb29sTWVzc2FnZXNdLFxuXHRcdFx0XHRcdGp1bXBUb1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgaHVtYW5JblRoZUxvb3BNaWRkbGV3YXJlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1oaXRsLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/hitl.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/index.js":
/*!************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/index.js ***!
  \************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _hitl_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./hitl.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/hitl.js\");\n/* harmony import */ var _summarization_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./summarization.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/summarization.js\");\n/* harmony import */ var _dynamicSystemPrompt_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./dynamicSystemPrompt.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/dynamicSystemPrompt.js\");\n/* harmony import */ var _llmToolSelector_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./llmToolSelector.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/llmToolSelector.js\");\n/* harmony import */ var _pii_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./pii.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/pii.js\");\n/* harmony import */ var _piiRedaction_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./piiRedaction.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/piiRedaction.js\");\n/* harmony import */ var _contextEditing_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./contextEditing.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/contextEditing.js\");\n/* harmony import */ var _toolCallLimit_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./toolCallLimit.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolCallLimit.js\");\n/* harmony import */ var _todoListMiddleware_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./todoListMiddleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/todoListMiddleware.js\");\n/* harmony import */ var _modelCallLimit_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./modelCallLimit.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelCallLimit.js\");\n/* harmony import */ var _modelFallback_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./modelFallback.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelFallback.js\");\n/* harmony import */ var _modelRetry_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./modelRetry.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelRetry.js\");\n/* harmony import */ var _toolRetry_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./toolRetry.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolRetry.js\");\n/* harmony import */ var _toolEmulator_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./toolEmulator.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolEmulator.js\");\n/* harmony import */ var _provider_openai_moderation_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./provider/openai/moderation.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/openai/moderation.js\");\n/* harmony import */ var _provider_anthropic_promptCaching_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./provider/anthropic/promptCaching.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/anthropic/promptCaching.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0Q7QUFDRDtBQUNRO0FBQ1k7QUFDUjtBQUNzRztBQUM1RztBQUN1QjtBQUNPO0FBQ1E7QUFDbEM7QUFDRjtBQUNOO0FBQ0Y7QUFDTTtBQUNrQjtBQUNZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL21pZGRsZXdhcmUvaW5kZXguanM/NTE3YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb3VudFRva2Vuc0FwcHJveGltYXRlbHkgfSBmcm9tIFwiLi91dGlscy5qc1wiO1xuaW1wb3J0IHsgaHVtYW5JblRoZUxvb3BNaWRkbGV3YXJlIH0gZnJvbSBcIi4vaGl0bC5qc1wiO1xuaW1wb3J0IHsgc3VtbWFyaXphdGlvbk1pZGRsZXdhcmUgfSBmcm9tIFwiLi9zdW1tYXJpemF0aW9uLmpzXCI7XG5pbXBvcnQgeyBkeW5hbWljU3lzdGVtUHJvbXB0TWlkZGxld2FyZSB9IGZyb20gXCIuL2R5bmFtaWNTeXN0ZW1Qcm9tcHQuanNcIjtcbmltcG9ydCB7IGxsbVRvb2xTZWxlY3Rvck1pZGRsZXdhcmUgfSBmcm9tIFwiLi9sbG1Ub29sU2VsZWN0b3IuanNcIjtcbmltcG9ydCB7IFBJSURldGVjdGlvbkVycm9yLCBhcHBseVN0cmF0ZWd5LCBkZXRlY3RDcmVkaXRDYXJkLCBkZXRlY3RFbWFpbCwgZGV0ZWN0SVAsIGRldGVjdE1hY0FkZHJlc3MsIGRldGVjdFVybCwgcGlpTWlkZGxld2FyZSwgcmVzb2x2ZVJlZGFjdGlvblJ1bGUgfSBmcm9tIFwiLi9waWkuanNcIjtcbmltcG9ydCB7IHBpaVJlZGFjdGlvbk1pZGRsZXdhcmUgfSBmcm9tIFwiLi9waWlSZWRhY3Rpb24uanNcIjtcbmltcG9ydCB7IENsZWFyVG9vbFVzZXNFZGl0LCBjb250ZXh0RWRpdGluZ01pZGRsZXdhcmUgfSBmcm9tIFwiLi9jb250ZXh0RWRpdGluZy5qc1wiO1xuaW1wb3J0IHsgVG9vbENhbGxMaW1pdEV4Y2VlZGVkRXJyb3IsIHRvb2xDYWxsTGltaXRNaWRkbGV3YXJlIH0gZnJvbSBcIi4vdG9vbENhbGxMaW1pdC5qc1wiO1xuaW1wb3J0IHsgVE9ET19MSVNUX01JRERMRVdBUkVfU1lTVEVNX1BST01QVCwgdG9kb0xpc3RNaWRkbGV3YXJlIH0gZnJvbSBcIi4vdG9kb0xpc3RNaWRkbGV3YXJlLmpzXCI7XG5pbXBvcnQgeyBtb2RlbENhbGxMaW1pdE1pZGRsZXdhcmUgfSBmcm9tIFwiLi9tb2RlbENhbGxMaW1pdC5qc1wiO1xuaW1wb3J0IHsgbW9kZWxGYWxsYmFja01pZGRsZXdhcmUgfSBmcm9tIFwiLi9tb2RlbEZhbGxiYWNrLmpzXCI7XG5pbXBvcnQgeyBtb2RlbFJldHJ5TWlkZGxld2FyZSB9IGZyb20gXCIuL21vZGVsUmV0cnkuanNcIjtcbmltcG9ydCB7IHRvb2xSZXRyeU1pZGRsZXdhcmUgfSBmcm9tIFwiLi90b29sUmV0cnkuanNcIjtcbmltcG9ydCB7IHRvb2xFbXVsYXRvck1pZGRsZXdhcmUgfSBmcm9tIFwiLi90b29sRW11bGF0b3IuanNcIjtcbmltcG9ydCB7IG9wZW5BSU1vZGVyYXRpb25NaWRkbGV3YXJlIH0gZnJvbSBcIi4vcHJvdmlkZXIvb3BlbmFpL21vZGVyYXRpb24uanNcIjtcbmltcG9ydCB7IGFudGhyb3BpY1Byb21wdENhY2hpbmdNaWRkbGV3YXJlIH0gZnJvbSBcIi4vcHJvdmlkZXIvYW50aHJvcGljL3Byb21wdENhY2hpbmcuanNcIjtcblxuZXhwb3J0IHsgIH07Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/llmToolSelector.js":
/*!**********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/llmToolSelector.js ***!
  \**********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   llmToolSelectorMiddleware: () => (/* binding */ llmToolSelectorMiddleware)\n/* harmony export */ });\n/* harmony import */ var _chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chat_models/universal.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n/* harmony import */ var _langchain_core_language_models_base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/core/language_models/base */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/language_models/base.js\");\n\n\n\n\n\n\n//#region src/agents/middleware/llmToolSelector.ts\nconst DEFAULT_SYSTEM_PROMPT = \"Your goal is to select the most relevant tools for answering the user's query.\";\n/**\n* Create a structured output schema for tool selection.\n*\n* @param tools - Available tools to include in the schema.\n* @returns Zod schema where each tool name is a literal with its description.\n*/\nfunction createToolSelectionResponse(tools) {\n\tif (!tools || tools.length === 0) throw new Error(\"Invalid usage: tools must be non-empty\");\n\tconst toolLiterals = tools.map((tool) => zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.literal(tool.name));\n\tconst toolEnum = zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.union(toolLiterals);\n\treturn zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.object({ tools: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.array(toolEnum).describe(\"Tools to use. Place the most relevant tools first.\") });\n}\n/**\n* Options for configuring the LLM Tool Selector middleware.\n*/\nconst LLMToolSelectorOptionsSchema = zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.object({\n\tmodel: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.string().or(zod_v3__WEBPACK_IMPORTED_MODULE_3__.z[\"instanceof\"](_langchain_core_language_models_base__WEBPACK_IMPORTED_MODULE_4__.BaseLanguageModel)).optional(),\n\tsystemPrompt: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.string().optional(),\n\tmaxTools: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.number().optional(),\n\talwaysInclude: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.array(zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.string()).optional()\n});\n/**\n* Middleware for selecting tools using an LLM-based strategy.\n*\n* When an agent has many tools available, this middleware filters them down\n* to only the most relevant ones for the user's query. This reduces token usage\n* and helps the main model focus on the right tools.\n*\n* @param options - Configuration options for the middleware\n* @param options.model - The language model to use for tool selection (default: the provided model from the agent options).\n* @param options.systemPrompt - Instructions for the selection model.\n* @param options.maxTools - Maximum number of tools to select. If the model selects more,\n*   only the first maxTools will be used. No limit if not specified.\n* @param options.alwaysInclude - Tool names to always include regardless of selection.\n*   These do not count against the maxTools limit.\n*\n* @example\n* Limit to 3 tools:\n* ```ts\n* import { llmToolSelectorMiddleware } from \"langchain/agents/middleware\";\n*\n* const middleware = llmToolSelectorMiddleware({ maxTools: 3 });\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   tools: [tool1, tool2, tool3, tool4, tool5],\n*   middleware: [middleware],\n* });\n* ```\n*\n* @example\n* Use a smaller model for selection:\n* ```ts\n* const middleware = llmToolSelectorMiddleware({\n*   model: \"openai:gpt-4o-mini\",\n*   maxTools: 2\n* });\n* ```\n*/\nfunction llmToolSelectorMiddleware(options) {\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_1__.createMiddleware)({\n\t\tname: \"LLMToolSelector\",\n\t\tcontextSchema: LLMToolSelectorOptionsSchema,\n\t\tasync wrapModelCall(request, handler) {\n\t\t\tconst selectionRequest = await prepareSelectionRequest(request, options, request.runtime);\n\t\t\tif (!selectionRequest) return handler(request);\n\t\t\tconst toolSelectionSchema = createToolSelectionResponse(selectionRequest.availableTools);\n\t\t\tconst response = await (await selectionRequest.model.withStructuredOutput?.(toolSelectionSchema))?.invoke([{\n\t\t\t\trole: \"system\",\n\t\t\t\tcontent: selectionRequest.systemMessage\n\t\t\t}, selectionRequest.lastUserMessage]);\n\t\t\tif (!response || typeof response !== \"object\" || !(\"tools\" in response)) throw new Error(`Expected object response with tools array, got ${typeof response}`);\n\t\t\treturn handler(processSelectionResponse(response, selectionRequest.availableTools, selectionRequest.validToolNames, request, options));\n\t\t}\n\t});\n}\n/**\n* Prepare inputs for tool selection.\n*\n* @param request - The model request to process.\n* @param options - Configuration options.\n* @param runtime - Runtime context.\n* @returns SelectionRequest with prepared inputs, or null if no selection is needed.\n*/\nasync function prepareSelectionRequest(request, options, runtime) {\n\tconst model = runtime.context.model ?? options.model;\n\tconst maxTools = runtime.context.maxTools ?? options.maxTools;\n\tconst alwaysInclude = runtime.context.alwaysInclude ?? options.alwaysInclude ?? [];\n\tconst systemPrompt = runtime.context.systemPrompt ?? options.systemPrompt ?? DEFAULT_SYSTEM_PROMPT;\n\t/**\n\t* If no tools available, return null\n\t*/\n\tif (!request.tools || request.tools.length === 0) return;\n\t/**\n\t* Filter to only StructuredToolInterface instances (exclude provider-specific tool dicts)\n\t*/\n\tconst baseTools = request.tools.filter((tool) => typeof tool === \"object\" && \"name\" in tool && \"description\" in tool && typeof tool.name === \"string\");\n\t/**\n\t* Validate that alwaysInclude tools exist\n\t*/\n\tif (alwaysInclude.length > 0) {\n\t\tconst availableToolNames = new Set(baseTools.map((tool) => tool.name));\n\t\tconst missingTools = alwaysInclude.filter((name) => !availableToolNames.has(name));\n\t\tif (missingTools.length > 0) throw new Error(`Tools in alwaysInclude not found in request: ${missingTools.join(\", \")}. Available tools: ${Array.from(availableToolNames).sort().join(\", \")}`);\n\t}\n\t/**\n\t* Separate tools that are always included from those available for selection\n\t*/\n\tconst availableTools = baseTools.filter((tool) => !alwaysInclude.includes(tool.name));\n\t/**\n\t* If no tools available for selection, return null\n\t*/\n\tif (availableTools.length === 0) return;\n\tlet systemMessage = systemPrompt;\n\t/**\n\t* If there's a maxTools limit, append instructions to the system prompt\n\t*/\n\tif (maxTools !== void 0) systemMessage += `\nIMPORTANT: List the tool names in order of relevance, with the most relevant first. If you exceed the maximum number of tools, only the first ${maxTools} will be used.`;\n\t/**\n\t* Get the last user message from the conversation history\n\t*/\n\tlet lastUserMessage;\n\tfor (const message of request.messages) if (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.HumanMessage.isInstance(message)) lastUserMessage = message;\n\tif (!lastUserMessage) throw new Error(\"No user message found in request messages\");\n\tconst modelInstance = !model ? request.model : typeof model === \"string\" ? await (0,_chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__.initChatModel)(model) : model;\n\tconst validToolNames = availableTools.map((tool) => tool.name);\n\treturn {\n\t\tavailableTools,\n\t\tsystemMessage,\n\t\tlastUserMessage,\n\t\tmodel: modelInstance,\n\t\tvalidToolNames\n\t};\n}\n/**\n* Process the selection response and return filtered ModelRequest.\n*\n* @param response - The structured output response from the model.\n* @param availableTools - Tools available for selection.\n* @param validToolNames - Valid tool names that can be selected.\n* @param request - Original model request.\n* @param options - Configuration options.\n* @returns Modified ModelRequest with filtered tools.\n*/\nfunction processSelectionResponse(response, availableTools, validToolNames, request, options) {\n\tconst maxTools = options.maxTools;\n\tconst alwaysInclude = options.alwaysInclude ?? [];\n\tconst selectedToolNames = [];\n\tconst invalidToolSelections = [];\n\tfor (const toolName of response.tools) {\n\t\tif (!validToolNames.includes(toolName)) {\n\t\t\tinvalidToolSelections.push(toolName);\n\t\t\tcontinue;\n\t\t}\n\t\t/**\n\t\t* Only add if not already selected and within maxTools limit\n\t\t*/\n\t\tif (!selectedToolNames.includes(toolName) && (maxTools === void 0 || selectedToolNames.length < maxTools)) selectedToolNames.push(toolName);\n\t}\n\tif (invalidToolSelections.length > 0) throw new Error(`Model selected invalid tools: ${invalidToolSelections.join(\", \")}`);\n\t/**\n\t* Filter tools based on selection\n\t*/\n\tconst selectedTools = availableTools.filter((tool) => selectedToolNames.includes(tool.name));\n\t/**\n\t* Append always-included tools\n\t*/\n\tconst alwaysIncludedTools = (request.tools ?? []).filter((tool) => typeof tool === \"object\" && \"name\" in tool && typeof tool.name === \"string\" && alwaysInclude.includes(tool.name));\n\tselectedTools.push(...alwaysIncludedTools);\n\t/**\n\t* Also preserve any provider-specific tool dicts from the original request\n\t*/\n\tconst providerTools = (request.tools ?? []).filter((tool) => !(typeof tool === \"object\" && \"name\" in tool && \"description\" in tool && typeof tool.name === \"string\"));\n\treturn {\n\t\t...request,\n\t\ttools: [...selectedTools, ...providerTools]\n\t};\n}\n\n//#endregion\n\n//# sourceMappingURL=llmToolSelector.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9sbG1Ub29sU2VsZWN0b3IuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQStEO0FBQ1g7QUFDSTtBQUM3QjtBQUM4Qzs7QUFFekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsNkNBQVM7QUFDbkQsa0JBQWtCLDJDQUFPO0FBQ3pCLFFBQVEsNENBQVEsR0FBRyxPQUFPLDJDQUFPLDJFQUEyRTtBQUM1RztBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyw0Q0FBUTtBQUM3QyxRQUFRLDRDQUFRLE1BQU0sbURBQVksQ0FBQyxtRkFBaUI7QUFDcEQsZUFBZSw0Q0FBUTtBQUN2QixXQUFXLDRDQUFRO0FBQ25CLGdCQUFnQiwyQ0FBTyxDQUFDLDRDQUFRO0FBQ2hDLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDRCQUE0QjtBQUN2QztBQUNBLGlEQUFpRCxhQUFhO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGdFQUFnQjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osOElBQThJLGdCQUFnQjtBQUM5SjtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0ZBQStGLHdCQUF3QixxQkFBcUIsaURBQWlEO0FBQzdMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnSkFBZ0osVUFBVTtBQUMxSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxrRUFBWTtBQUN6RDtBQUNBLGtGQUFrRix3RUFBYTtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdGQUF3RixpQ0FBaUM7QUFDekg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ3FDO0FBQ3JDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL21pZGRsZXdhcmUvbGxtVG9vbFNlbGVjdG9yLmpzP2E2YmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5pdENoYXRNb2RlbCB9IGZyb20gXCIuLi8uLi9jaGF0X21vZGVscy91bml2ZXJzYWwuanNcIjtcbmltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUgfSBmcm9tIFwiLi4vbWlkZGxld2FyZS5qc1wiO1xuaW1wb3J0IHsgSHVtYW5NZXNzYWdlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9tZXNzYWdlc1wiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2QvdjNcIjtcbmltcG9ydCB7IEJhc2VMYW5ndWFnZU1vZGVsIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9sYW5ndWFnZV9tb2RlbHMvYmFzZVwiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9taWRkbGV3YXJlL2xsbVRvb2xTZWxlY3Rvci50c1xuY29uc3QgREVGQVVMVF9TWVNURU1fUFJPTVBUID0gXCJZb3VyIGdvYWwgaXMgdG8gc2VsZWN0IHRoZSBtb3N0IHJlbGV2YW50IHRvb2xzIGZvciBhbnN3ZXJpbmcgdGhlIHVzZXIncyBxdWVyeS5cIjtcbi8qKlxuKiBDcmVhdGUgYSBzdHJ1Y3R1cmVkIG91dHB1dCBzY2hlbWEgZm9yIHRvb2wgc2VsZWN0aW9uLlxuKlxuKiBAcGFyYW0gdG9vbHMgLSBBdmFpbGFibGUgdG9vbHMgdG8gaW5jbHVkZSBpbiB0aGUgc2NoZW1hLlxuKiBAcmV0dXJucyBab2Qgc2NoZW1hIHdoZXJlIGVhY2ggdG9vbCBuYW1lIGlzIGEgbGl0ZXJhbCB3aXRoIGl0cyBkZXNjcmlwdGlvbi5cbiovXG5mdW5jdGlvbiBjcmVhdGVUb29sU2VsZWN0aW9uUmVzcG9uc2UodG9vbHMpIHtcblx0aWYgKCF0b29scyB8fCB0b29scy5sZW5ndGggPT09IDApIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdXNhZ2U6IHRvb2xzIG11c3QgYmUgbm9uLWVtcHR5XCIpO1xuXHRjb25zdCB0b29sTGl0ZXJhbHMgPSB0b29scy5tYXAoKHRvb2wpID0+IHoubGl0ZXJhbCh0b29sLm5hbWUpKTtcblx0Y29uc3QgdG9vbEVudW0gPSB6LnVuaW9uKHRvb2xMaXRlcmFscyk7XG5cdHJldHVybiB6Lm9iamVjdCh7IHRvb2xzOiB6LmFycmF5KHRvb2xFbnVtKS5kZXNjcmliZShcIlRvb2xzIHRvIHVzZS4gUGxhY2UgdGhlIG1vc3QgcmVsZXZhbnQgdG9vbHMgZmlyc3QuXCIpIH0pO1xufVxuLyoqXG4qIE9wdGlvbnMgZm9yIGNvbmZpZ3VyaW5nIHRoZSBMTE0gVG9vbCBTZWxlY3RvciBtaWRkbGV3YXJlLlxuKi9cbmNvbnN0IExMTVRvb2xTZWxlY3Rvck9wdGlvbnNTY2hlbWEgPSB6Lm9iamVjdCh7XG5cdG1vZGVsOiB6LnN0cmluZygpLm9yKHouaW5zdGFuY2VvZihCYXNlTGFuZ3VhZ2VNb2RlbCkpLm9wdGlvbmFsKCksXG5cdHN5c3RlbVByb21wdDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuXHRtYXhUb29sczogei5udW1iZXIoKS5vcHRpb25hbCgpLFxuXHRhbHdheXNJbmNsdWRlOiB6LmFycmF5KHouc3RyaW5nKCkpLm9wdGlvbmFsKClcbn0pO1xuLyoqXG4qIE1pZGRsZXdhcmUgZm9yIHNlbGVjdGluZyB0b29scyB1c2luZyBhbiBMTE0tYmFzZWQgc3RyYXRlZ3kuXG4qXG4qIFdoZW4gYW4gYWdlbnQgaGFzIG1hbnkgdG9vbHMgYXZhaWxhYmxlLCB0aGlzIG1pZGRsZXdhcmUgZmlsdGVycyB0aGVtIGRvd25cbiogdG8gb25seSB0aGUgbW9zdCByZWxldmFudCBvbmVzIGZvciB0aGUgdXNlcidzIHF1ZXJ5LiBUaGlzIHJlZHVjZXMgdG9rZW4gdXNhZ2VcbiogYW5kIGhlbHBzIHRoZSBtYWluIG1vZGVsIGZvY3VzIG9uIHRoZSByaWdodCB0b29scy5cbipcbiogQHBhcmFtIG9wdGlvbnMgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSBtaWRkbGV3YXJlXG4qIEBwYXJhbSBvcHRpb25zLm1vZGVsIC0gVGhlIGxhbmd1YWdlIG1vZGVsIHRvIHVzZSBmb3IgdG9vbCBzZWxlY3Rpb24gKGRlZmF1bHQ6IHRoZSBwcm92aWRlZCBtb2RlbCBmcm9tIHRoZSBhZ2VudCBvcHRpb25zKS5cbiogQHBhcmFtIG9wdGlvbnMuc3lzdGVtUHJvbXB0IC0gSW5zdHJ1Y3Rpb25zIGZvciB0aGUgc2VsZWN0aW9uIG1vZGVsLlxuKiBAcGFyYW0gb3B0aW9ucy5tYXhUb29scyAtIE1heGltdW0gbnVtYmVyIG9mIHRvb2xzIHRvIHNlbGVjdC4gSWYgdGhlIG1vZGVsIHNlbGVjdHMgbW9yZSxcbiogICBvbmx5IHRoZSBmaXJzdCBtYXhUb29scyB3aWxsIGJlIHVzZWQuIE5vIGxpbWl0IGlmIG5vdCBzcGVjaWZpZWQuXG4qIEBwYXJhbSBvcHRpb25zLmFsd2F5c0luY2x1ZGUgLSBUb29sIG5hbWVzIHRvIGFsd2F5cyBpbmNsdWRlIHJlZ2FyZGxlc3Mgb2Ygc2VsZWN0aW9uLlxuKiAgIFRoZXNlIGRvIG5vdCBjb3VudCBhZ2FpbnN0IHRoZSBtYXhUb29scyBsaW1pdC5cbipcbiogQGV4YW1wbGVcbiogTGltaXQgdG8gMyB0b29sczpcbiogYGBgdHNcbiogaW1wb3J0IHsgbGxtVG9vbFNlbGVjdG9yTWlkZGxld2FyZSB9IGZyb20gXCJsYW5nY2hhaW4vYWdlbnRzL21pZGRsZXdhcmVcIjtcbipcbiogY29uc3QgbWlkZGxld2FyZSA9IGxsbVRvb2xTZWxlY3Rvck1pZGRsZXdhcmUoeyBtYXhUb29sczogMyB9KTtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIHRvb2xzOiBbdG9vbDEsIHRvb2wyLCB0b29sMywgdG9vbDQsIHRvb2w1XSxcbiogICBtaWRkbGV3YXJlOiBbbWlkZGxld2FyZV0sXG4qIH0pO1xuKiBgYGBcbipcbiogQGV4YW1wbGVcbiogVXNlIGEgc21hbGxlciBtb2RlbCBmb3Igc2VsZWN0aW9uOlxuKiBgYGB0c1xuKiBjb25zdCBtaWRkbGV3YXJlID0gbGxtVG9vbFNlbGVjdG9yTWlkZGxld2FyZSh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00by1taW5pXCIsXG4qICAgbWF4VG9vbHM6IDJcbiogfSk7XG4qIGBgYFxuKi9cbmZ1bmN0aW9uIGxsbVRvb2xTZWxlY3Rvck1pZGRsZXdhcmUob3B0aW9ucykge1xuXHRyZXR1cm4gY3JlYXRlTWlkZGxld2FyZSh7XG5cdFx0bmFtZTogXCJMTE1Ub29sU2VsZWN0b3JcIixcblx0XHRjb250ZXh0U2NoZW1hOiBMTE1Ub29sU2VsZWN0b3JPcHRpb25zU2NoZW1hLFxuXHRcdGFzeW5jIHdyYXBNb2RlbENhbGwocmVxdWVzdCwgaGFuZGxlcikge1xuXHRcdFx0Y29uc3Qgc2VsZWN0aW9uUmVxdWVzdCA9IGF3YWl0IHByZXBhcmVTZWxlY3Rpb25SZXF1ZXN0KHJlcXVlc3QsIG9wdGlvbnMsIHJlcXVlc3QucnVudGltZSk7XG5cdFx0XHRpZiAoIXNlbGVjdGlvblJlcXVlc3QpIHJldHVybiBoYW5kbGVyKHJlcXVlc3QpO1xuXHRcdFx0Y29uc3QgdG9vbFNlbGVjdGlvblNjaGVtYSA9IGNyZWF0ZVRvb2xTZWxlY3Rpb25SZXNwb25zZShzZWxlY3Rpb25SZXF1ZXN0LmF2YWlsYWJsZVRvb2xzKTtcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgKGF3YWl0IHNlbGVjdGlvblJlcXVlc3QubW9kZWwud2l0aFN0cnVjdHVyZWRPdXRwdXQ/Lih0b29sU2VsZWN0aW9uU2NoZW1hKSk/Lmludm9rZShbe1xuXHRcdFx0XHRyb2xlOiBcInN5c3RlbVwiLFxuXHRcdFx0XHRjb250ZW50OiBzZWxlY3Rpb25SZXF1ZXN0LnN5c3RlbU1lc3NhZ2Vcblx0XHRcdH0sIHNlbGVjdGlvblJlcXVlc3QubGFzdFVzZXJNZXNzYWdlXSk7XG5cdFx0XHRpZiAoIXJlc3BvbnNlIHx8IHR5cGVvZiByZXNwb25zZSAhPT0gXCJvYmplY3RcIiB8fCAhKFwidG9vbHNcIiBpbiByZXNwb25zZSkpIHRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgb2JqZWN0IHJlc3BvbnNlIHdpdGggdG9vbHMgYXJyYXksIGdvdCAke3R5cGVvZiByZXNwb25zZX1gKTtcblx0XHRcdHJldHVybiBoYW5kbGVyKHByb2Nlc3NTZWxlY3Rpb25SZXNwb25zZShyZXNwb25zZSwgc2VsZWN0aW9uUmVxdWVzdC5hdmFpbGFibGVUb29scywgc2VsZWN0aW9uUmVxdWVzdC52YWxpZFRvb2xOYW1lcywgcmVxdWVzdCwgb3B0aW9ucykpO1xuXHRcdH1cblx0fSk7XG59XG4vKipcbiogUHJlcGFyZSBpbnB1dHMgZm9yIHRvb2wgc2VsZWN0aW9uLlxuKlxuKiBAcGFyYW0gcmVxdWVzdCAtIFRoZSBtb2RlbCByZXF1ZXN0IHRvIHByb2Nlc3MuXG4qIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zLlxuKiBAcGFyYW0gcnVudGltZSAtIFJ1bnRpbWUgY29udGV4dC5cbiogQHJldHVybnMgU2VsZWN0aW9uUmVxdWVzdCB3aXRoIHByZXBhcmVkIGlucHV0cywgb3IgbnVsbCBpZiBubyBzZWxlY3Rpb24gaXMgbmVlZGVkLlxuKi9cbmFzeW5jIGZ1bmN0aW9uIHByZXBhcmVTZWxlY3Rpb25SZXF1ZXN0KHJlcXVlc3QsIG9wdGlvbnMsIHJ1bnRpbWUpIHtcblx0Y29uc3QgbW9kZWwgPSBydW50aW1lLmNvbnRleHQubW9kZWwgPz8gb3B0aW9ucy5tb2RlbDtcblx0Y29uc3QgbWF4VG9vbHMgPSBydW50aW1lLmNvbnRleHQubWF4VG9vbHMgPz8gb3B0aW9ucy5tYXhUb29scztcblx0Y29uc3QgYWx3YXlzSW5jbHVkZSA9IHJ1bnRpbWUuY29udGV4dC5hbHdheXNJbmNsdWRlID8/IG9wdGlvbnMuYWx3YXlzSW5jbHVkZSA/PyBbXTtcblx0Y29uc3Qgc3lzdGVtUHJvbXB0ID0gcnVudGltZS5jb250ZXh0LnN5c3RlbVByb21wdCA/PyBvcHRpb25zLnN5c3RlbVByb21wdCA/PyBERUZBVUxUX1NZU1RFTV9QUk9NUFQ7XG5cdC8qKlxuXHQqIElmIG5vIHRvb2xzIGF2YWlsYWJsZSwgcmV0dXJuIG51bGxcblx0Ki9cblx0aWYgKCFyZXF1ZXN0LnRvb2xzIHx8IHJlcXVlc3QudG9vbHMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cdC8qKlxuXHQqIEZpbHRlciB0byBvbmx5IFN0cnVjdHVyZWRUb29sSW50ZXJmYWNlIGluc3RhbmNlcyAoZXhjbHVkZSBwcm92aWRlci1zcGVjaWZpYyB0b29sIGRpY3RzKVxuXHQqL1xuXHRjb25zdCBiYXNlVG9vbHMgPSByZXF1ZXN0LnRvb2xzLmZpbHRlcigodG9vbCkgPT4gdHlwZW9mIHRvb2wgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gdG9vbCAmJiBcImRlc2NyaXB0aW9uXCIgaW4gdG9vbCAmJiB0eXBlb2YgdG9vbC5uYW1lID09PSBcInN0cmluZ1wiKTtcblx0LyoqXG5cdCogVmFsaWRhdGUgdGhhdCBhbHdheXNJbmNsdWRlIHRvb2xzIGV4aXN0XG5cdCovXG5cdGlmIChhbHdheXNJbmNsdWRlLmxlbmd0aCA+IDApIHtcblx0XHRjb25zdCBhdmFpbGFibGVUb29sTmFtZXMgPSBuZXcgU2V0KGJhc2VUb29scy5tYXAoKHRvb2wpID0+IHRvb2wubmFtZSkpO1xuXHRcdGNvbnN0IG1pc3NpbmdUb29scyA9IGFsd2F5c0luY2x1ZGUuZmlsdGVyKChuYW1lKSA9PiAhYXZhaWxhYmxlVG9vbE5hbWVzLmhhcyhuYW1lKSk7XG5cdFx0aWYgKG1pc3NpbmdUb29scy5sZW5ndGggPiAwKSB0aHJvdyBuZXcgRXJyb3IoYFRvb2xzIGluIGFsd2F5c0luY2x1ZGUgbm90IGZvdW5kIGluIHJlcXVlc3Q6ICR7bWlzc2luZ1Rvb2xzLmpvaW4oXCIsIFwiKX0uIEF2YWlsYWJsZSB0b29sczogJHtBcnJheS5mcm9tKGF2YWlsYWJsZVRvb2xOYW1lcykuc29ydCgpLmpvaW4oXCIsIFwiKX1gKTtcblx0fVxuXHQvKipcblx0KiBTZXBhcmF0ZSB0b29scyB0aGF0IGFyZSBhbHdheXMgaW5jbHVkZWQgZnJvbSB0aG9zZSBhdmFpbGFibGUgZm9yIHNlbGVjdGlvblxuXHQqL1xuXHRjb25zdCBhdmFpbGFibGVUb29scyA9IGJhc2VUb29scy5maWx0ZXIoKHRvb2wpID0+ICFhbHdheXNJbmNsdWRlLmluY2x1ZGVzKHRvb2wubmFtZSkpO1xuXHQvKipcblx0KiBJZiBubyB0b29scyBhdmFpbGFibGUgZm9yIHNlbGVjdGlvbiwgcmV0dXJuIG51bGxcblx0Ki9cblx0aWYgKGF2YWlsYWJsZVRvb2xzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXHRsZXQgc3lzdGVtTWVzc2FnZSA9IHN5c3RlbVByb21wdDtcblx0LyoqXG5cdCogSWYgdGhlcmUncyBhIG1heFRvb2xzIGxpbWl0LCBhcHBlbmQgaW5zdHJ1Y3Rpb25zIHRvIHRoZSBzeXN0ZW0gcHJvbXB0XG5cdCovXG5cdGlmIChtYXhUb29scyAhPT0gdm9pZCAwKSBzeXN0ZW1NZXNzYWdlICs9IGBcbklNUE9SVEFOVDogTGlzdCB0aGUgdG9vbCBuYW1lcyBpbiBvcmRlciBvZiByZWxldmFuY2UsIHdpdGggdGhlIG1vc3QgcmVsZXZhbnQgZmlyc3QuIElmIHlvdSBleGNlZWQgdGhlIG1heGltdW0gbnVtYmVyIG9mIHRvb2xzLCBvbmx5IHRoZSBmaXJzdCAke21heFRvb2xzfSB3aWxsIGJlIHVzZWQuYDtcblx0LyoqXG5cdCogR2V0IHRoZSBsYXN0IHVzZXIgbWVzc2FnZSBmcm9tIHRoZSBjb252ZXJzYXRpb24gaGlzdG9yeVxuXHQqL1xuXHRsZXQgbGFzdFVzZXJNZXNzYWdlO1xuXHRmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgcmVxdWVzdC5tZXNzYWdlcykgaWYgKEh1bWFuTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2UpKSBsYXN0VXNlck1lc3NhZ2UgPSBtZXNzYWdlO1xuXHRpZiAoIWxhc3RVc2VyTWVzc2FnZSkgdGhyb3cgbmV3IEVycm9yKFwiTm8gdXNlciBtZXNzYWdlIGZvdW5kIGluIHJlcXVlc3QgbWVzc2FnZXNcIik7XG5cdGNvbnN0IG1vZGVsSW5zdGFuY2UgPSAhbW9kZWwgPyByZXF1ZXN0Lm1vZGVsIDogdHlwZW9mIG1vZGVsID09PSBcInN0cmluZ1wiID8gYXdhaXQgaW5pdENoYXRNb2RlbChtb2RlbCkgOiBtb2RlbDtcblx0Y29uc3QgdmFsaWRUb29sTmFtZXMgPSBhdmFpbGFibGVUb29scy5tYXAoKHRvb2wpID0+IHRvb2wubmFtZSk7XG5cdHJldHVybiB7XG5cdFx0YXZhaWxhYmxlVG9vbHMsXG5cdFx0c3lzdGVtTWVzc2FnZSxcblx0XHRsYXN0VXNlck1lc3NhZ2UsXG5cdFx0bW9kZWw6IG1vZGVsSW5zdGFuY2UsXG5cdFx0dmFsaWRUb29sTmFtZXNcblx0fTtcbn1cbi8qKlxuKiBQcm9jZXNzIHRoZSBzZWxlY3Rpb24gcmVzcG9uc2UgYW5kIHJldHVybiBmaWx0ZXJlZCBNb2RlbFJlcXVlc3QuXG4qXG4qIEBwYXJhbSByZXNwb25zZSAtIFRoZSBzdHJ1Y3R1cmVkIG91dHB1dCByZXNwb25zZSBmcm9tIHRoZSBtb2RlbC5cbiogQHBhcmFtIGF2YWlsYWJsZVRvb2xzIC0gVG9vbHMgYXZhaWxhYmxlIGZvciBzZWxlY3Rpb24uXG4qIEBwYXJhbSB2YWxpZFRvb2xOYW1lcyAtIFZhbGlkIHRvb2wgbmFtZXMgdGhhdCBjYW4gYmUgc2VsZWN0ZWQuXG4qIEBwYXJhbSByZXF1ZXN0IC0gT3JpZ2luYWwgbW9kZWwgcmVxdWVzdC5cbiogQHBhcmFtIG9wdGlvbnMgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMuXG4qIEByZXR1cm5zIE1vZGlmaWVkIE1vZGVsUmVxdWVzdCB3aXRoIGZpbHRlcmVkIHRvb2xzLlxuKi9cbmZ1bmN0aW9uIHByb2Nlc3NTZWxlY3Rpb25SZXNwb25zZShyZXNwb25zZSwgYXZhaWxhYmxlVG9vbHMsIHZhbGlkVG9vbE5hbWVzLCByZXF1ZXN0LCBvcHRpb25zKSB7XG5cdGNvbnN0IG1heFRvb2xzID0gb3B0aW9ucy5tYXhUb29scztcblx0Y29uc3QgYWx3YXlzSW5jbHVkZSA9IG9wdGlvbnMuYWx3YXlzSW5jbHVkZSA/PyBbXTtcblx0Y29uc3Qgc2VsZWN0ZWRUb29sTmFtZXMgPSBbXTtcblx0Y29uc3QgaW52YWxpZFRvb2xTZWxlY3Rpb25zID0gW107XG5cdGZvciAoY29uc3QgdG9vbE5hbWUgb2YgcmVzcG9uc2UudG9vbHMpIHtcblx0XHRpZiAoIXZhbGlkVG9vbE5hbWVzLmluY2x1ZGVzKHRvb2xOYW1lKSkge1xuXHRcdFx0aW52YWxpZFRvb2xTZWxlY3Rpb25zLnB1c2godG9vbE5hbWUpO1xuXHRcdFx0Y29udGludWU7XG5cdFx0fVxuXHRcdC8qKlxuXHRcdCogT25seSBhZGQgaWYgbm90IGFscmVhZHkgc2VsZWN0ZWQgYW5kIHdpdGhpbiBtYXhUb29scyBsaW1pdFxuXHRcdCovXG5cdFx0aWYgKCFzZWxlY3RlZFRvb2xOYW1lcy5pbmNsdWRlcyh0b29sTmFtZSkgJiYgKG1heFRvb2xzID09PSB2b2lkIDAgfHwgc2VsZWN0ZWRUb29sTmFtZXMubGVuZ3RoIDwgbWF4VG9vbHMpKSBzZWxlY3RlZFRvb2xOYW1lcy5wdXNoKHRvb2xOYW1lKTtcblx0fVxuXHRpZiAoaW52YWxpZFRvb2xTZWxlY3Rpb25zLmxlbmd0aCA+IDApIHRocm93IG5ldyBFcnJvcihgTW9kZWwgc2VsZWN0ZWQgaW52YWxpZCB0b29sczogJHtpbnZhbGlkVG9vbFNlbGVjdGlvbnMuam9pbihcIiwgXCIpfWApO1xuXHQvKipcblx0KiBGaWx0ZXIgdG9vbHMgYmFzZWQgb24gc2VsZWN0aW9uXG5cdCovXG5cdGNvbnN0IHNlbGVjdGVkVG9vbHMgPSBhdmFpbGFibGVUb29scy5maWx0ZXIoKHRvb2wpID0+IHNlbGVjdGVkVG9vbE5hbWVzLmluY2x1ZGVzKHRvb2wubmFtZSkpO1xuXHQvKipcblx0KiBBcHBlbmQgYWx3YXlzLWluY2x1ZGVkIHRvb2xzXG5cdCovXG5cdGNvbnN0IGFsd2F5c0luY2x1ZGVkVG9vbHMgPSAocmVxdWVzdC50b29scyA/PyBbXSkuZmlsdGVyKCh0b29sKSA9PiB0eXBlb2YgdG9vbCA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiB0b29sICYmIHR5cGVvZiB0b29sLm5hbWUgPT09IFwic3RyaW5nXCIgJiYgYWx3YXlzSW5jbHVkZS5pbmNsdWRlcyh0b29sLm5hbWUpKTtcblx0c2VsZWN0ZWRUb29scy5wdXNoKC4uLmFsd2F5c0luY2x1ZGVkVG9vbHMpO1xuXHQvKipcblx0KiBBbHNvIHByZXNlcnZlIGFueSBwcm92aWRlci1zcGVjaWZpYyB0b29sIGRpY3RzIGZyb20gdGhlIG9yaWdpbmFsIHJlcXVlc3Rcblx0Ki9cblx0Y29uc3QgcHJvdmlkZXJUb29scyA9IChyZXF1ZXN0LnRvb2xzID8/IFtdKS5maWx0ZXIoKHRvb2wpID0+ICEodHlwZW9mIHRvb2wgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gdG9vbCAmJiBcImRlc2NyaXB0aW9uXCIgaW4gdG9vbCAmJiB0eXBlb2YgdG9vbC5uYW1lID09PSBcInN0cmluZ1wiKSk7XG5cdHJldHVybiB7XG5cdFx0Li4ucmVxdWVzdCxcblx0XHR0b29sczogWy4uLnNlbGVjdGVkVG9vbHMsIC4uLnByb3ZpZGVyVG9vbHNdXG5cdH07XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgbGxtVG9vbFNlbGVjdG9yTWlkZGxld2FyZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGxtVG9vbFNlbGVjdG9yLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/llmToolSelector.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelCallLimit.js":
/*!*********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelCallLimit.js ***!
  \*********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   modelCallLimitMiddleware: () => (/* binding */ modelCallLimitMiddleware)\n/* harmony export */ });\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n\n\n//#region src/agents/middleware/modelCallLimit.ts\nconst DEFAULT_EXIT_BEHAVIOR = \"end\";\nconst contextSchema = zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.object({\n\tthreadLimit: zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.number().optional(),\n\trunLimit: zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.number().optional(),\n\texitBehavior: zod_v3__WEBPACK_IMPORTED_MODULE_2__.z[\"enum\"]([\"error\", \"end\"]).optional()\n});\n/**\n* Middleware state schema to track the number of model calls made at the thread and run level.\n*/\nconst stateSchema = zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.object({\n\tthreadModelCallCount: zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.number().default(0),\n\trunModelCallCount: zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.number().default(0)\n});\n/**\n* Error thrown when the model call limit is exceeded.\n*\n* @param threadLimit - The maximum number of model calls allowed per thread.\n* @param runLimit - The maximum number of model calls allowed per run.\n* @param threadCount - The number of model calls made at the thread level.\n* @param runCount - The number of model calls made at the run level.\n*/\nvar ModelCallLimitMiddlewareError = class extends Error {\n\tconstructor({ threadLimit, runLimit, threadCount, runCount }) {\n\t\tconst exceededHint = [];\n\t\tif (typeof threadLimit === \"number\" && typeof threadCount === \"number\") exceededHint.push(`thread level call limit reached with ${threadCount} model calls`);\n\t\tif (typeof runLimit === \"number\" && typeof runCount === \"number\") exceededHint.push(`run level call limit reached with ${runCount} model calls`);\n\t\tsuper(`Model call limits exceeded${exceededHint.length > 0 ? `: ${exceededHint.join(\", \")}` : \"\"}`);\n\t\tthis.name = \"ModelCallLimitMiddlewareError\";\n\t}\n};\n/**\n* Creates a middleware to limit the number of model calls at both thread and run levels.\n*\n* This middleware helps prevent excessive model API calls by enforcing limits on how many\n* times the model can be invoked. It supports two types of limits:\n*\n* - **Thread-level limit**: Restricts the total number of model calls across an entire conversation thread\n* - **Run-level limit**: Restricts the number of model calls within a single agent run/invocation\n*\n* ## How It Works\n*\n* The middleware intercepts model requests before they are sent and checks the current call counts\n* against the configured limits. If either limit is exceeded, it throws a `ModelCallLimitMiddlewareError`\n* to stop execution and prevent further API calls.\n*\n* ## Use Cases\n*\n* - **Cost Control**: Prevent runaway costs from excessive model calls in production\n* - **Testing**: Ensure agents don't make too many calls during development/testing\n* - **Safety**: Limit potential infinite loops or recursive agent behaviors\n* - **Rate Limiting**: Enforce organizational policies on model usage per conversation\n*\n* @param middlewareOptions - Configuration options for the call limits\n* @param middlewareOptions.threadLimit - Maximum number of model calls allowed per thread (optional)\n* @param middlewareOptions.runLimit - Maximum number of model calls allowed per run (optional)\n*\n* @returns A middleware instance that can be passed to `createAgent`\n*\n* @throws {ModelCallLimitMiddlewareError} When either the thread or run limit is exceeded\n*\n* @example\n* ```typescript\n* import { createAgent, modelCallLimitMiddleware } from \"langchain\";\n*\n* // Limit to 10 calls per thread and 3 calls per run\n* const agent = createAgent({\n*   model: \"openai:gpt-4o-mini\",\n*   tools: [myTool],\n*   middleware: [\n*     modelCallLimitMiddleware({\n*       threadLimit: 10,\n*       runLimit: 3\n*     })\n*   ]\n* });\n* ```\n*\n* @example\n* ```typescript\n* // Limits can also be configured at runtime via context\n* const result = await agent.invoke(\n*   { messages: [\"Hello\"] },\n*   {\n*     configurable: {\n*       threadLimit: 5  // Override the default limit for this run\n*     }\n*   }\n* );\n* ```\n*/\nfunction modelCallLimitMiddleware(middlewareOptions) {\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)({\n\t\tname: \"ModelCallLimitMiddleware\",\n\t\tcontextSchema,\n\t\tstateSchema,\n\t\tbeforeModel: {\n\t\t\tcanJumpTo: [\"end\"],\n\t\t\thook: (state, runtime) => {\n\t\t\t\tlet exitBehavior = runtime.context.exitBehavior ?? middlewareOptions?.exitBehavior ?? DEFAULT_EXIT_BEHAVIOR;\n\t\t\t\tif (exitBehavior === \"throw\") {\n\t\t\t\t\tconsole.warn(\"The 'throw' exit behavior is deprecated. Please use 'error' instead.\");\n\t\t\t\t\texitBehavior = \"error\";\n\t\t\t\t}\n\t\t\t\tconst threadLimit = runtime.context.threadLimit ?? middlewareOptions?.threadLimit;\n\t\t\t\tconst runLimit = runtime.context.runLimit ?? middlewareOptions?.runLimit;\n\t\t\t\tconst threadCount = state.threadModelCallCount;\n\t\t\t\tconst runCount = state.runModelCallCount;\n\t\t\t\tif (typeof threadLimit === \"number\" && threadLimit <= threadCount) {\n\t\t\t\t\tconst error = new ModelCallLimitMiddlewareError({\n\t\t\t\t\t\tthreadLimit,\n\t\t\t\t\t\tthreadCount\n\t\t\t\t\t});\n\t\t\t\t\tif (exitBehavior === \"end\") return {\n\t\t\t\t\t\tjumpTo: \"end\",\n\t\t\t\t\t\tmessages: [new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage(error.message)]\n\t\t\t\t\t};\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t\tif (typeof runLimit === \"number\" && runLimit <= runCount) {\n\t\t\t\t\tconst error = new ModelCallLimitMiddlewareError({\n\t\t\t\t\t\trunLimit,\n\t\t\t\t\t\trunCount\n\t\t\t\t\t});\n\t\t\t\t\tif (exitBehavior === \"end\") return {\n\t\t\t\t\t\tjumpTo: \"end\",\n\t\t\t\t\t\tmessages: [new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage(error.message)]\n\t\t\t\t\t};\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t\treturn state;\n\t\t\t}\n\t\t},\n\t\tafterModel: (state) => ({\n\t\t\trunModelCallCount: state.runModelCallCount + 1,\n\t\t\tthreadModelCallCount: state.threadModelCallCount + 1\n\t\t}),\n\t\tafterAgent: () => ({ runModelCallCount: 0 })\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=modelCallLimit.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9tb2RlbENhbGxMaW1pdC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQW9EO0FBQ0M7QUFDMUI7O0FBRTNCO0FBQ0E7QUFDQSxzQkFBc0IsNENBQVE7QUFDOUIsY0FBYyw0Q0FBUTtBQUN0QixXQUFXLDRDQUFRO0FBQ25CLGVBQWUsNkNBQU07QUFDckIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiw0Q0FBUTtBQUM1Qix1QkFBdUIsNENBQVE7QUFDL0Isb0JBQW9CLDRDQUFRO0FBQzVCLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDhDQUE4QztBQUM3RDtBQUNBLG9JQUFvSSxhQUFhO0FBQ2pKLDJIQUEySCxVQUFVO0FBQ3JJLHFDQUFxQywrQkFBK0Isd0JBQXdCLE9BQU87QUFDbkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLCtCQUErQjtBQUMxQztBQUNBO0FBQ0E7QUFDQSxXQUFXLHdDQUF3QztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxxQkFBcUI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxnRUFBZ0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLHFCQUFxQiwrREFBUztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EscUJBQXFCLCtEQUFTO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILHVCQUF1QixzQkFBc0I7QUFDN0MsRUFBRTtBQUNGOztBQUVBO0FBQ29DO0FBQ3BDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL21pZGRsZXdhcmUvbW9kZWxDYWxsTGltaXQuanM/Mjk3OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVNaWRkbGV3YXJlIH0gZnJvbSBcIi4uL21pZGRsZXdhcmUuanNcIjtcbmltcG9ydCB7IEFJTWVzc2FnZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXNcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kL3YzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL21pZGRsZXdhcmUvbW9kZWxDYWxsTGltaXQudHNcbmNvbnN0IERFRkFVTFRfRVhJVF9CRUhBVklPUiA9IFwiZW5kXCI7XG5jb25zdCBjb250ZXh0U2NoZW1hID0gei5vYmplY3Qoe1xuXHR0aHJlYWRMaW1pdDogei5udW1iZXIoKS5vcHRpb25hbCgpLFxuXHRydW5MaW1pdDogei5udW1iZXIoKS5vcHRpb25hbCgpLFxuXHRleGl0QmVoYXZpb3I6IHouZW51bShbXCJlcnJvclwiLCBcImVuZFwiXSkub3B0aW9uYWwoKVxufSk7XG4vKipcbiogTWlkZGxld2FyZSBzdGF0ZSBzY2hlbWEgdG8gdHJhY2sgdGhlIG51bWJlciBvZiBtb2RlbCBjYWxscyBtYWRlIGF0IHRoZSB0aHJlYWQgYW5kIHJ1biBsZXZlbC5cbiovXG5jb25zdCBzdGF0ZVNjaGVtYSA9IHoub2JqZWN0KHtcblx0dGhyZWFkTW9kZWxDYWxsQ291bnQ6IHoubnVtYmVyKCkuZGVmYXVsdCgwKSxcblx0cnVuTW9kZWxDYWxsQ291bnQ6IHoubnVtYmVyKCkuZGVmYXVsdCgwKVxufSk7XG4vKipcbiogRXJyb3IgdGhyb3duIHdoZW4gdGhlIG1vZGVsIGNhbGwgbGltaXQgaXMgZXhjZWVkZWQuXG4qXG4qIEBwYXJhbSB0aHJlYWRMaW1pdCAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiBtb2RlbCBjYWxscyBhbGxvd2VkIHBlciB0aHJlYWQuXG4qIEBwYXJhbSBydW5MaW1pdCAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiBtb2RlbCBjYWxscyBhbGxvd2VkIHBlciBydW4uXG4qIEBwYXJhbSB0aHJlYWRDb3VudCAtIFRoZSBudW1iZXIgb2YgbW9kZWwgY2FsbHMgbWFkZSBhdCB0aGUgdGhyZWFkIGxldmVsLlxuKiBAcGFyYW0gcnVuQ291bnQgLSBUaGUgbnVtYmVyIG9mIG1vZGVsIGNhbGxzIG1hZGUgYXQgdGhlIHJ1biBsZXZlbC5cbiovXG52YXIgTW9kZWxDYWxsTGltaXRNaWRkbGV3YXJlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcblx0Y29uc3RydWN0b3IoeyB0aHJlYWRMaW1pdCwgcnVuTGltaXQsIHRocmVhZENvdW50LCBydW5Db3VudCB9KSB7XG5cdFx0Y29uc3QgZXhjZWVkZWRIaW50ID0gW107XG5cdFx0aWYgKHR5cGVvZiB0aHJlYWRMaW1pdCA9PT0gXCJudW1iZXJcIiAmJiB0eXBlb2YgdGhyZWFkQ291bnQgPT09IFwibnVtYmVyXCIpIGV4Y2VlZGVkSGludC5wdXNoKGB0aHJlYWQgbGV2ZWwgY2FsbCBsaW1pdCByZWFjaGVkIHdpdGggJHt0aHJlYWRDb3VudH0gbW9kZWwgY2FsbHNgKTtcblx0XHRpZiAodHlwZW9mIHJ1bkxpbWl0ID09PSBcIm51bWJlclwiICYmIHR5cGVvZiBydW5Db3VudCA9PT0gXCJudW1iZXJcIikgZXhjZWVkZWRIaW50LnB1c2goYHJ1biBsZXZlbCBjYWxsIGxpbWl0IHJlYWNoZWQgd2l0aCAke3J1bkNvdW50fSBtb2RlbCBjYWxsc2ApO1xuXHRcdHN1cGVyKGBNb2RlbCBjYWxsIGxpbWl0cyBleGNlZWRlZCR7ZXhjZWVkZWRIaW50Lmxlbmd0aCA+IDAgPyBgOiAke2V4Y2VlZGVkSGludC5qb2luKFwiLCBcIil9YCA6IFwiXCJ9YCk7XG5cdFx0dGhpcy5uYW1lID0gXCJNb2RlbENhbGxMaW1pdE1pZGRsZXdhcmVFcnJvclwiO1xuXHR9XG59O1xuLyoqXG4qIENyZWF0ZXMgYSBtaWRkbGV3YXJlIHRvIGxpbWl0IHRoZSBudW1iZXIgb2YgbW9kZWwgY2FsbHMgYXQgYm90aCB0aHJlYWQgYW5kIHJ1biBsZXZlbHMuXG4qXG4qIFRoaXMgbWlkZGxld2FyZSBoZWxwcyBwcmV2ZW50IGV4Y2Vzc2l2ZSBtb2RlbCBBUEkgY2FsbHMgYnkgZW5mb3JjaW5nIGxpbWl0cyBvbiBob3cgbWFueVxuKiB0aW1lcyB0aGUgbW9kZWwgY2FuIGJlIGludm9rZWQuIEl0IHN1cHBvcnRzIHR3byB0eXBlcyBvZiBsaW1pdHM6XG4qXG4qIC0gKipUaHJlYWQtbGV2ZWwgbGltaXQqKjogUmVzdHJpY3RzIHRoZSB0b3RhbCBudW1iZXIgb2YgbW9kZWwgY2FsbHMgYWNyb3NzIGFuIGVudGlyZSBjb252ZXJzYXRpb24gdGhyZWFkXG4qIC0gKipSdW4tbGV2ZWwgbGltaXQqKjogUmVzdHJpY3RzIHRoZSBudW1iZXIgb2YgbW9kZWwgY2FsbHMgd2l0aGluIGEgc2luZ2xlIGFnZW50IHJ1bi9pbnZvY2F0aW9uXG4qXG4qICMjIEhvdyBJdCBXb3Jrc1xuKlxuKiBUaGUgbWlkZGxld2FyZSBpbnRlcmNlcHRzIG1vZGVsIHJlcXVlc3RzIGJlZm9yZSB0aGV5IGFyZSBzZW50IGFuZCBjaGVja3MgdGhlIGN1cnJlbnQgY2FsbCBjb3VudHNcbiogYWdhaW5zdCB0aGUgY29uZmlndXJlZCBsaW1pdHMuIElmIGVpdGhlciBsaW1pdCBpcyBleGNlZWRlZCwgaXQgdGhyb3dzIGEgYE1vZGVsQ2FsbExpbWl0TWlkZGxld2FyZUVycm9yYFxuKiB0byBzdG9wIGV4ZWN1dGlvbiBhbmQgcHJldmVudCBmdXJ0aGVyIEFQSSBjYWxscy5cbipcbiogIyMgVXNlIENhc2VzXG4qXG4qIC0gKipDb3N0IENvbnRyb2wqKjogUHJldmVudCBydW5hd2F5IGNvc3RzIGZyb20gZXhjZXNzaXZlIG1vZGVsIGNhbGxzIGluIHByb2R1Y3Rpb25cbiogLSAqKlRlc3RpbmcqKjogRW5zdXJlIGFnZW50cyBkb24ndCBtYWtlIHRvbyBtYW55IGNhbGxzIGR1cmluZyBkZXZlbG9wbWVudC90ZXN0aW5nXG4qIC0gKipTYWZldHkqKjogTGltaXQgcG90ZW50aWFsIGluZmluaXRlIGxvb3BzIG9yIHJlY3Vyc2l2ZSBhZ2VudCBiZWhhdmlvcnNcbiogLSAqKlJhdGUgTGltaXRpbmcqKjogRW5mb3JjZSBvcmdhbml6YXRpb25hbCBwb2xpY2llcyBvbiBtb2RlbCB1c2FnZSBwZXIgY29udmVyc2F0aW9uXG4qXG4qIEBwYXJhbSBtaWRkbGV3YXJlT3B0aW9ucyAtIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIGNhbGwgbGltaXRzXG4qIEBwYXJhbSBtaWRkbGV3YXJlT3B0aW9ucy50aHJlYWRMaW1pdCAtIE1heGltdW0gbnVtYmVyIG9mIG1vZGVsIGNhbGxzIGFsbG93ZWQgcGVyIHRocmVhZCAob3B0aW9uYWwpXG4qIEBwYXJhbSBtaWRkbGV3YXJlT3B0aW9ucy5ydW5MaW1pdCAtIE1heGltdW0gbnVtYmVyIG9mIG1vZGVsIGNhbGxzIGFsbG93ZWQgcGVyIHJ1biAob3B0aW9uYWwpXG4qXG4qIEByZXR1cm5zIEEgbWlkZGxld2FyZSBpbnN0YW5jZSB0aGF0IGNhbiBiZSBwYXNzZWQgdG8gYGNyZWF0ZUFnZW50YFxuKlxuKiBAdGhyb3dzIHtNb2RlbENhbGxMaW1pdE1pZGRsZXdhcmVFcnJvcn0gV2hlbiBlaXRoZXIgdGhlIHRocmVhZCBvciBydW4gbGltaXQgaXMgZXhjZWVkZWRcbipcbiogQGV4YW1wbGVcbiogYGBgdHlwZXNjcmlwdFxuKiBpbXBvcnQgeyBjcmVhdGVBZ2VudCwgbW9kZWxDYWxsTGltaXRNaWRkbGV3YXJlIH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKlxuKiAvLyBMaW1pdCB0byAxMCBjYWxscyBwZXIgdGhyZWFkIGFuZCAzIGNhbGxzIHBlciBydW5cbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00by1taW5pXCIsXG4qICAgdG9vbHM6IFtteVRvb2xdLFxuKiAgIG1pZGRsZXdhcmU6IFtcbiogICAgIG1vZGVsQ2FsbExpbWl0TWlkZGxld2FyZSh7XG4qICAgICAgIHRocmVhZExpbWl0OiAxMCxcbiogICAgICAgcnVuTGltaXQ6IDNcbiogICAgIH0pXG4qICAgXVxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlXG4qIGBgYHR5cGVzY3JpcHRcbiogLy8gTGltaXRzIGNhbiBhbHNvIGJlIGNvbmZpZ3VyZWQgYXQgcnVudGltZSB2aWEgY29udGV4dFxuKiBjb25zdCByZXN1bHQgPSBhd2FpdCBhZ2VudC5pbnZva2UoXG4qICAgeyBtZXNzYWdlczogW1wiSGVsbG9cIl0gfSxcbiogICB7XG4qICAgICBjb25maWd1cmFibGU6IHtcbiogICAgICAgdGhyZWFkTGltaXQ6IDUgIC8vIE92ZXJyaWRlIHRoZSBkZWZhdWx0IGxpbWl0IGZvciB0aGlzIHJ1blxuKiAgICAgfVxuKiAgIH1cbiogKTtcbiogYGBgXG4qL1xuZnVuY3Rpb24gbW9kZWxDYWxsTGltaXRNaWRkbGV3YXJlKG1pZGRsZXdhcmVPcHRpb25zKSB7XG5cdHJldHVybiBjcmVhdGVNaWRkbGV3YXJlKHtcblx0XHRuYW1lOiBcIk1vZGVsQ2FsbExpbWl0TWlkZGxld2FyZVwiLFxuXHRcdGNvbnRleHRTY2hlbWEsXG5cdFx0c3RhdGVTY2hlbWEsXG5cdFx0YmVmb3JlTW9kZWw6IHtcblx0XHRcdGNhbkp1bXBUbzogW1wiZW5kXCJdLFxuXHRcdFx0aG9vazogKHN0YXRlLCBydW50aW1lKSA9PiB7XG5cdFx0XHRcdGxldCBleGl0QmVoYXZpb3IgPSBydW50aW1lLmNvbnRleHQuZXhpdEJlaGF2aW9yID8/IG1pZGRsZXdhcmVPcHRpb25zPy5leGl0QmVoYXZpb3IgPz8gREVGQVVMVF9FWElUX0JFSEFWSU9SO1xuXHRcdFx0XHRpZiAoZXhpdEJlaGF2aW9yID09PSBcInRocm93XCIpIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJUaGUgJ3Rocm93JyBleGl0IGJlaGF2aW9yIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgJ2Vycm9yJyBpbnN0ZWFkLlwiKTtcblx0XHRcdFx0XHRleGl0QmVoYXZpb3IgPSBcImVycm9yXCI7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3QgdGhyZWFkTGltaXQgPSBydW50aW1lLmNvbnRleHQudGhyZWFkTGltaXQgPz8gbWlkZGxld2FyZU9wdGlvbnM/LnRocmVhZExpbWl0O1xuXHRcdFx0XHRjb25zdCBydW5MaW1pdCA9IHJ1bnRpbWUuY29udGV4dC5ydW5MaW1pdCA/PyBtaWRkbGV3YXJlT3B0aW9ucz8ucnVuTGltaXQ7XG5cdFx0XHRcdGNvbnN0IHRocmVhZENvdW50ID0gc3RhdGUudGhyZWFkTW9kZWxDYWxsQ291bnQ7XG5cdFx0XHRcdGNvbnN0IHJ1bkNvdW50ID0gc3RhdGUucnVuTW9kZWxDYWxsQ291bnQ7XG5cdFx0XHRcdGlmICh0eXBlb2YgdGhyZWFkTGltaXQgPT09IFwibnVtYmVyXCIgJiYgdGhyZWFkTGltaXQgPD0gdGhyZWFkQ291bnQpIHtcblx0XHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBNb2RlbENhbGxMaW1pdE1pZGRsZXdhcmVFcnJvcih7XG5cdFx0XHRcdFx0XHR0aHJlYWRMaW1pdCxcblx0XHRcdFx0XHRcdHRocmVhZENvdW50XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0aWYgKGV4aXRCZWhhdmlvciA9PT0gXCJlbmRcIikgcmV0dXJuIHtcblx0XHRcdFx0XHRcdGp1bXBUbzogXCJlbmRcIixcblx0XHRcdFx0XHRcdG1lc3NhZ2VzOiBbbmV3IEFJTWVzc2FnZShlcnJvci5tZXNzYWdlKV1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0eXBlb2YgcnVuTGltaXQgPT09IFwibnVtYmVyXCIgJiYgcnVuTGltaXQgPD0gcnVuQ291bnQpIHtcblx0XHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBNb2RlbENhbGxMaW1pdE1pZGRsZXdhcmVFcnJvcih7XG5cdFx0XHRcdFx0XHRydW5MaW1pdCxcblx0XHRcdFx0XHRcdHJ1bkNvdW50XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0aWYgKGV4aXRCZWhhdmlvciA9PT0gXCJlbmRcIikgcmV0dXJuIHtcblx0XHRcdFx0XHRcdGp1bXBUbzogXCJlbmRcIixcblx0XHRcdFx0XHRcdG1lc3NhZ2VzOiBbbmV3IEFJTWVzc2FnZShlcnJvci5tZXNzYWdlKV1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBzdGF0ZTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGFmdGVyTW9kZWw6IChzdGF0ZSkgPT4gKHtcblx0XHRcdHJ1bk1vZGVsQ2FsbENvdW50OiBzdGF0ZS5ydW5Nb2RlbENhbGxDb3VudCArIDEsXG5cdFx0XHR0aHJlYWRNb2RlbENhbGxDb3VudDogc3RhdGUudGhyZWFkTW9kZWxDYWxsQ291bnQgKyAxXG5cdFx0fSksXG5cdFx0YWZ0ZXJBZ2VudDogKCkgPT4gKHsgcnVuTW9kZWxDYWxsQ291bnQ6IDAgfSlcblx0fSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgbW9kZWxDYWxsTGltaXRNaWRkbGV3YXJlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2RlbENhbGxMaW1pdC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelCallLimit.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelFallback.js":
/*!********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelFallback.js ***!
  \********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   modelFallbackMiddleware: () => (/* binding */ modelFallbackMiddleware)\n/* harmony export */ });\n/* harmony import */ var _chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chat_models/universal.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n\n\n\n//#region src/agents/middleware/modelFallback.ts\n/**\n* Middleware that provides automatic model fallback on errors.\n*\n* This middleware attempts to retry failed model calls with alternative models\n* in sequence. When a model call fails, it tries the next model in the fallback\n* list until either a call succeeds or all models have been exhausted.\n*\n* @example\n* ```ts\n* import { createAgent, modelFallbackMiddleware } from \"langchain\";\n*\n* // Create middleware with fallback models (not including primary)\n* const fallback = modelFallbackMiddleware(\n*   \"openai:gpt-4o-mini\",  // First fallback\n*   \"anthropic:claude-sonnet-4-5-20250929\",  // Second fallback\n* );\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",  // Primary model\n*   middleware: [fallback],\n*   tools: [],\n* });\n*\n* // If gpt-4o fails, automatically tries gpt-4o-mini, then claude\n* const result = await agent.invoke({\n*   messages: [{ role: \"user\", content: \"Hello\" }]\n* });\n* ```\n*\n* @param fallbackModels - The fallback models to try, in order.\n* @returns A middleware instance that handles model failures with fallbacks\n*/\nfunction modelFallbackMiddleware(...fallbackModels) {\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_1__.createMiddleware)({\n\t\tname: \"modelFallbackMiddleware\",\n\t\twrapModelCall: async (request, handler) => {\n\t\t\t/**\n\t\t\t* Try the primary model first\n\t\t\t*/\n\t\t\ttry {\n\t\t\t\treturn await handler(request);\n\t\t\t} catch (error) {\n\t\t\t\t/**\n\t\t\t\t* If primary model fails, try fallback models in sequence\n\t\t\t\t*/\n\t\t\t\tfor (let i = 0; i < fallbackModels.length; i++) try {\n\t\t\t\t\tconst fallbackModel = fallbackModels[i];\n\t\t\t\t\tconst model = typeof fallbackModel === \"string\" ? await (0,_chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__.initChatModel)(fallbackModel) : fallbackModel;\n\t\t\t\t\treturn await handler({\n\t\t\t\t\t\t...request,\n\t\t\t\t\t\tmodel\n\t\t\t\t\t});\n\t\t\t\t} catch (fallbackError) {\n\t\t\t\t\t/**\n\t\t\t\t\t* If this is the last fallback, throw the error\n\t\t\t\t\t*/\n\t\t\t\t\tif (i === fallbackModels.length - 1) throw fallbackError;\n\t\t\t\t}\n\t\t\t\t/**\n\t\t\t\t* If no fallbacks were provided, re-throw the original error\n\t\t\t\t*/\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=modelFallback.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9tb2RlbEZhbGxiYWNrLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUErRDtBQUNYOztBQUVwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsdUNBQXVDO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGdDQUFnQztBQUNqRCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxnRUFBZ0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJCQUEyQjtBQUMvQztBQUNBLDZEQUE2RCx3RUFBYTtBQUMxRTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDbUM7QUFDbkMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9tb2RlbEZhbGxiYWNrLmpzP2FiODEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5pdENoYXRNb2RlbCB9IGZyb20gXCIuLi8uLi9jaGF0X21vZGVscy91bml2ZXJzYWwuanNcIjtcbmltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUgfSBmcm9tIFwiLi4vbWlkZGxld2FyZS5qc1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9taWRkbGV3YXJlL21vZGVsRmFsbGJhY2sudHNcbi8qKlxuKiBNaWRkbGV3YXJlIHRoYXQgcHJvdmlkZXMgYXV0b21hdGljIG1vZGVsIGZhbGxiYWNrIG9uIGVycm9ycy5cbipcbiogVGhpcyBtaWRkbGV3YXJlIGF0dGVtcHRzIHRvIHJldHJ5IGZhaWxlZCBtb2RlbCBjYWxscyB3aXRoIGFsdGVybmF0aXZlIG1vZGVsc1xuKiBpbiBzZXF1ZW5jZS4gV2hlbiBhIG1vZGVsIGNhbGwgZmFpbHMsIGl0IHRyaWVzIHRoZSBuZXh0IG1vZGVsIGluIHRoZSBmYWxsYmFja1xuKiBsaXN0IHVudGlsIGVpdGhlciBhIGNhbGwgc3VjY2VlZHMgb3IgYWxsIG1vZGVscyBoYXZlIGJlZW4gZXhoYXVzdGVkLlxuKlxuKiBAZXhhbXBsZVxuKiBgYGB0c1xuKiBpbXBvcnQgeyBjcmVhdGVBZ2VudCwgbW9kZWxGYWxsYmFja01pZGRsZXdhcmUgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qXG4qIC8vIENyZWF0ZSBtaWRkbGV3YXJlIHdpdGggZmFsbGJhY2sgbW9kZWxzIChub3QgaW5jbHVkaW5nIHByaW1hcnkpXG4qIGNvbnN0IGZhbGxiYWNrID0gbW9kZWxGYWxsYmFja01pZGRsZXdhcmUoXG4qICAgXCJvcGVuYWk6Z3B0LTRvLW1pbmlcIiwgIC8vIEZpcnN0IGZhbGxiYWNrXG4qICAgXCJhbnRocm9waWM6Y2xhdWRlLXNvbm5ldC00LTUtMjAyNTA5MjlcIiwgIC8vIFNlY29uZCBmYWxsYmFja1xuKiApO1xuKlxuKiBjb25zdCBhZ2VudCA9IGNyZWF0ZUFnZW50KHtcbiogICBtb2RlbDogXCJvcGVuYWk6Z3B0LTRvXCIsICAvLyBQcmltYXJ5IG1vZGVsXG4qICAgbWlkZGxld2FyZTogW2ZhbGxiYWNrXSxcbiogICB0b29sczogW10sXG4qIH0pO1xuKlxuKiAvLyBJZiBncHQtNG8gZmFpbHMsIGF1dG9tYXRpY2FsbHkgdHJpZXMgZ3B0LTRvLW1pbmksIHRoZW4gY2xhdWRlXG4qIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFnZW50Lmludm9rZSh7XG4qICAgbWVzc2FnZXM6IFt7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBcIkhlbGxvXCIgfV1cbiogfSk7XG4qIGBgYFxuKlxuKiBAcGFyYW0gZmFsbGJhY2tNb2RlbHMgLSBUaGUgZmFsbGJhY2sgbW9kZWxzIHRvIHRyeSwgaW4gb3JkZXIuXG4qIEByZXR1cm5zIEEgbWlkZGxld2FyZSBpbnN0YW5jZSB0aGF0IGhhbmRsZXMgbW9kZWwgZmFpbHVyZXMgd2l0aCBmYWxsYmFja3NcbiovXG5mdW5jdGlvbiBtb2RlbEZhbGxiYWNrTWlkZGxld2FyZSguLi5mYWxsYmFja01vZGVscykge1xuXHRyZXR1cm4gY3JlYXRlTWlkZGxld2FyZSh7XG5cdFx0bmFtZTogXCJtb2RlbEZhbGxiYWNrTWlkZGxld2FyZVwiLFxuXHRcdHdyYXBNb2RlbENhbGw6IGFzeW5jIChyZXF1ZXN0LCBoYW5kbGVyKSA9PiB7XG5cdFx0XHQvKipcblx0XHRcdCogVHJ5IHRoZSBwcmltYXJ5IG1vZGVsIGZpcnN0XG5cdFx0XHQqL1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0cmV0dXJuIGF3YWl0IGhhbmRsZXIocmVxdWVzdCk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBJZiBwcmltYXJ5IG1vZGVsIGZhaWxzLCB0cnkgZmFsbGJhY2sgbW9kZWxzIGluIHNlcXVlbmNlXG5cdFx0XHRcdCovXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgZmFsbGJhY2tNb2RlbHMubGVuZ3RoOyBpKyspIHRyeSB7XG5cdFx0XHRcdFx0Y29uc3QgZmFsbGJhY2tNb2RlbCA9IGZhbGxiYWNrTW9kZWxzW2ldO1xuXHRcdFx0XHRcdGNvbnN0IG1vZGVsID0gdHlwZW9mIGZhbGxiYWNrTW9kZWwgPT09IFwic3RyaW5nXCIgPyBhd2FpdCBpbml0Q2hhdE1vZGVsKGZhbGxiYWNrTW9kZWwpIDogZmFsbGJhY2tNb2RlbDtcblx0XHRcdFx0XHRyZXR1cm4gYXdhaXQgaGFuZGxlcih7XG5cdFx0XHRcdFx0XHQuLi5yZXF1ZXN0LFxuXHRcdFx0XHRcdFx0bW9kZWxcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBjYXRjaCAoZmFsbGJhY2tFcnJvcikge1xuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCogSWYgdGhpcyBpcyB0aGUgbGFzdCBmYWxsYmFjaywgdGhyb3cgdGhlIGVycm9yXG5cdFx0XHRcdFx0Ki9cblx0XHRcdFx0XHRpZiAoaSA9PT0gZmFsbGJhY2tNb2RlbHMubGVuZ3RoIC0gMSkgdGhyb3cgZmFsbGJhY2tFcnJvcjtcblx0XHRcdFx0fVxuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBJZiBubyBmYWxsYmFja3Mgd2VyZSBwcm92aWRlZCwgcmUtdGhyb3cgdGhlIG9yaWdpbmFsIGVycm9yXG5cdFx0XHRcdCovXG5cdFx0XHRcdHRocm93IGVycm9yO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgbW9kZWxGYWxsYmFja01pZGRsZXdhcmUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZGVsRmFsbGJhY2suanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelFallback.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelRetry.js":
/*!*****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelRetry.js ***!
  \*****************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   modelRetryMiddleware: () => (/* binding */ modelRetryMiddleware)\n/* harmony export */ });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _constants_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constants.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/constants.js\");\n/* harmony import */ var _error_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./error.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/error.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n\n\n\n\n\n//#region src/agents/middleware/modelRetry.ts\n/**\n* Model retry middleware for agents.\n*/\n/**\n* Configuration options for the Model Retry Middleware.\n*/\nconst ModelRetryMiddlewareOptionsSchema = zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.object({ onFailure: zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.union([\n\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z.literal(\"error\"),\n\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z.literal(\"continue\"),\n\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z[\"function\"]().args(zod_v3__WEBPACK_IMPORTED_MODULE_5__.z[\"instanceof\"](Error)).returns(zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.string())\n]).default(\"continue\") }).merge(_constants_js__WEBPACK_IMPORTED_MODULE_2__.RetrySchema);\n/**\n* Middleware that automatically retries failed model calls with configurable backoff.\n*\n* Supports retrying on specific exceptions and exponential backoff.\n*\n* @example Basic usage with default settings (2 retries, exponential backoff)\n* ```ts\n* import { createAgent, modelRetryMiddleware } from \"langchain\";\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   tools: [searchTool],\n*   middleware: [modelRetryMiddleware()],\n* });\n* ```\n*\n* @example Retry specific exceptions only\n* ```ts\n* import { modelRetryMiddleware } from \"langchain\";\n*\n* const retry = modelRetryMiddleware({\n*   maxRetries: 4,\n*   retryOn: [TimeoutError, NetworkError],\n*   backoffFactor: 1.5,\n* });\n* ```\n*\n* @example Custom exception filtering\n* ```ts\n* function shouldRetry(error: Error): boolean {\n*   // Only retry on rate limit errors\n*   if (error.name === \"RateLimitError\") {\n*     return true;\n*   }\n*   // Or check for specific HTTP status codes\n*   if (error.name === \"HTTPError\" && \"statusCode\" in error) {\n*     const statusCode = (error as any).statusCode;\n*     return statusCode === 429 || statusCode === 503;\n*   }\n*   return false;\n* }\n*\n* const retry = modelRetryMiddleware({\n*   maxRetries: 3,\n*   retryOn: shouldRetry,\n* });\n* ```\n*\n* @example Return error message instead of raising\n* ```ts\n* const retry = modelRetryMiddleware({\n*   maxRetries: 4,\n*   onFailure: \"continue\", // Return AIMessage with error instead of throwing\n* });\n* ```\n*\n* @example Custom error message formatting\n* ```ts\n* const formatError = (error: Error) =>\n*   `Model call failed: ${error.message}. Please try again later.`;\n*\n* const retry = modelRetryMiddleware({\n*   maxRetries: 4,\n*   onFailure: formatError,\n* });\n* ```\n*\n* @example Constant backoff (no exponential growth)\n* ```ts\n* const retry = modelRetryMiddleware({\n*   maxRetries: 5,\n*   backoffFactor: 0.0, // No exponential growth\n*   initialDelayMs: 2000, // Always wait 2 seconds\n* });\n* ```\n*\n* @example Raise exception on failure\n* ```ts\n* const retry = modelRetryMiddleware({\n*   maxRetries: 2,\n*   onFailure: \"error\", // Re-raise exception instead of returning message\n* });\n* ```\n*\n* @param config - Configuration options for the retry middleware\n* @returns A middleware instance that handles model failures with retries\n*/\nfunction modelRetryMiddleware(config = {}) {\n\tconst { success, error, data } = ModelRetryMiddlewareOptionsSchema.safeParse(config);\n\tif (!success) throw new _error_js__WEBPACK_IMPORTED_MODULE_3__.InvalidRetryConfigError(error);\n\tconst { maxRetries, retryOn, onFailure, backoffFactor, initialDelayMs, maxDelayMs, jitter } = data;\n\t/**\n\t* Check if the exception should trigger a retry.\n\t*/\n\tconst shouldRetryException = (error) => {\n\t\tif (typeof retryOn === \"function\") return retryOn(error);\n\t\treturn retryOn.some((ErrorConstructor) => error.constructor === ErrorConstructor);\n\t};\n\tconst delayConfig = {\n\t\tbackoffFactor,\n\t\tinitialDelayMs,\n\t\tmaxDelayMs,\n\t\tjitter\n\t};\n\t/**\n\t* Format the failure message when retries are exhausted.\n\t*/\n\tconst formatFailureMessage = (error, attemptsMade) => {\n\t\tconst errorType = error.constructor.name;\n\t\treturn `Model call failed after ${attemptsMade} ${attemptsMade === 1 ? \"attempt\" : \"attempts\"} with ${errorType}: ${error.message}`;\n\t};\n\t/**\n\t* Handle failure when all retries are exhausted.\n\t*/\n\tconst handleFailure = (error, attemptsMade) => {\n\t\tif (onFailure === \"error\") throw error;\n\t\tlet content;\n\t\tif (typeof onFailure === \"function\") content = onFailure(error);\n\t\telse content = formatFailureMessage(error, attemptsMade);\n\t\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.AIMessage({ content });\n\t};\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_1__.createMiddleware)({\n\t\tname: \"modelRetryMiddleware\",\n\t\tcontextSchema: ModelRetryMiddlewareOptionsSchema,\n\t\twrapModelCall: async (request, handler) => {\n\t\t\tfor (let attempt = 0; attempt <= maxRetries; attempt++) try {\n\t\t\t\treturn await handler(request);\n\t\t\t} catch (error) {\n\t\t\t\tconst attemptsMade = attempt + 1;\n\t\t\t\tconst err = error && typeof error === \"object\" && \"message\" in error ? error : new Error(String(error));\n\t\t\t\tif (!shouldRetryException(err)) return handleFailure(err, attemptsMade);\n\t\t\t\tif (attempt < maxRetries) {\n\t\t\t\t\tconst delay = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.calculateRetryDelay)(delayConfig, attempt);\n\t\t\t\t\tif (delay > 0) await (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.sleep)(delay);\n\t\t\t\t} else return handleFailure(err, attemptsMade);\n\t\t\t}\n\t\t\tthrow new Error(\"Unexpected: retry loop completed without returning\");\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=modelRetry.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9tb2RlbFJldHJ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBd0Q7QUFDSjtBQUNQO0FBQ1E7QUFDQTtBQUMxQjs7QUFFM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsNENBQVEsR0FBRyxXQUFXLDJDQUFPO0FBQ3ZFLENBQUMsNkNBQVM7QUFDVixDQUFDLDZDQUFTO0FBQ1YsQ0FBQyxpREFBVSxRQUFRLG1EQUFZLGlCQUFpQiw0Q0FBUTtBQUN4RCx3QkFBd0IsUUFBUSxzREFBVztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsb0NBQW9DO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHVCQUF1QjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixjQUFjO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QyxTQUFTLHVCQUF1QjtBQUNoQyx5QkFBeUIsOERBQXVCO0FBQ2hELFNBQVMsb0ZBQW9GO0FBQzdGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxjQUFjLEVBQUUsNkNBQTZDLE9BQU8sVUFBVSxJQUFJLGNBQWM7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSwrREFBUyxHQUFHLFNBQVM7QUFDbEM7QUFDQSxRQUFRLGdFQUFnQjtBQUN4QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDhEQUFtQjtBQUN0QywwQkFBMEIsZ0RBQUs7QUFDL0IsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNnQztBQUNoQyIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL25vZGVfbW9kdWxlcy8ucG5wbS9sYW5nY2hhaW5AMS4yLjI2X0BsYW5nY2hhaW4rY29yZUAxLjEuMjhfb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX19vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fcmVfZXgyYjV5M3R6ZjdoMmN4bW11aTVxb2lhc3kvbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2FnZW50cy9taWRkbGV3YXJlL21vZGVsUmV0cnkuanM/MDFjYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjYWxjdWxhdGVSZXRyeURlbGF5LCBzbGVlcCB9IGZyb20gXCIuL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyBjcmVhdGVNaWRkbGV3YXJlIH0gZnJvbSBcIi4uL21pZGRsZXdhcmUuanNcIjtcbmltcG9ydCB7IFJldHJ5U2NoZW1hIH0gZnJvbSBcIi4vY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgeyBJbnZhbGlkUmV0cnlDb25maWdFcnJvciB9IGZyb20gXCIuL2Vycm9yLmpzXCI7XG5pbXBvcnQgeyBBSU1lc3NhZ2UgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL21lc3NhZ2VzXCI7XG5pbXBvcnQgeyB6IH0gZnJvbSBcInpvZC92M1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9taWRkbGV3YXJlL21vZGVsUmV0cnkudHNcbi8qKlxuKiBNb2RlbCByZXRyeSBtaWRkbGV3YXJlIGZvciBhZ2VudHMuXG4qL1xuLyoqXG4qIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIE1vZGVsIFJldHJ5IE1pZGRsZXdhcmUuXG4qL1xuY29uc3QgTW9kZWxSZXRyeU1pZGRsZXdhcmVPcHRpb25zU2NoZW1hID0gei5vYmplY3QoeyBvbkZhaWx1cmU6IHoudW5pb24oW1xuXHR6LmxpdGVyYWwoXCJlcnJvclwiKSxcblx0ei5saXRlcmFsKFwiY29udGludWVcIiksXG5cdHouZnVuY3Rpb24oKS5hcmdzKHouaW5zdGFuY2VvZihFcnJvcikpLnJldHVybnMoei5zdHJpbmcoKSlcbl0pLmRlZmF1bHQoXCJjb250aW51ZVwiKSB9KS5tZXJnZShSZXRyeVNjaGVtYSk7XG4vKipcbiogTWlkZGxld2FyZSB0aGF0IGF1dG9tYXRpY2FsbHkgcmV0cmllcyBmYWlsZWQgbW9kZWwgY2FsbHMgd2l0aCBjb25maWd1cmFibGUgYmFja29mZi5cbipcbiogU3VwcG9ydHMgcmV0cnlpbmcgb24gc3BlY2lmaWMgZXhjZXB0aW9ucyBhbmQgZXhwb25lbnRpYWwgYmFja29mZi5cbipcbiogQGV4YW1wbGUgQmFzaWMgdXNhZ2Ugd2l0aCBkZWZhdWx0IHNldHRpbmdzICgyIHJldHJpZXMsIGV4cG9uZW50aWFsIGJhY2tvZmYpXG4qIGBgYHRzXG4qIGltcG9ydCB7IGNyZWF0ZUFnZW50LCBtb2RlbFJldHJ5TWlkZGxld2FyZSB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIHRvb2xzOiBbc2VhcmNoVG9vbF0sXG4qICAgbWlkZGxld2FyZTogW21vZGVsUmV0cnlNaWRkbGV3YXJlKCldLFxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlIFJldHJ5IHNwZWNpZmljIGV4Y2VwdGlvbnMgb25seVxuKiBgYGB0c1xuKiBpbXBvcnQgeyBtb2RlbFJldHJ5TWlkZGxld2FyZSB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbipcbiogY29uc3QgcmV0cnkgPSBtb2RlbFJldHJ5TWlkZGxld2FyZSh7XG4qICAgbWF4UmV0cmllczogNCxcbiogICByZXRyeU9uOiBbVGltZW91dEVycm9yLCBOZXR3b3JrRXJyb3JdLFxuKiAgIGJhY2tvZmZGYWN0b3I6IDEuNSxcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBDdXN0b20gZXhjZXB0aW9uIGZpbHRlcmluZ1xuKiBgYGB0c1xuKiBmdW5jdGlvbiBzaG91bGRSZXRyeShlcnJvcjogRXJyb3IpOiBib29sZWFuIHtcbiogICAvLyBPbmx5IHJldHJ5IG9uIHJhdGUgbGltaXQgZXJyb3JzXG4qICAgaWYgKGVycm9yLm5hbWUgPT09IFwiUmF0ZUxpbWl0RXJyb3JcIikge1xuKiAgICAgcmV0dXJuIHRydWU7XG4qICAgfVxuKiAgIC8vIE9yIGNoZWNrIGZvciBzcGVjaWZpYyBIVFRQIHN0YXR1cyBjb2Rlc1xuKiAgIGlmIChlcnJvci5uYW1lID09PSBcIkhUVFBFcnJvclwiICYmIFwic3RhdHVzQ29kZVwiIGluIGVycm9yKSB7XG4qICAgICBjb25zdCBzdGF0dXNDb2RlID0gKGVycm9yIGFzIGFueSkuc3RhdHVzQ29kZTtcbiogICAgIHJldHVybiBzdGF0dXNDb2RlID09PSA0MjkgfHwgc3RhdHVzQ29kZSA9PT0gNTAzO1xuKiAgIH1cbiogICByZXR1cm4gZmFsc2U7XG4qIH1cbipcbiogY29uc3QgcmV0cnkgPSBtb2RlbFJldHJ5TWlkZGxld2FyZSh7XG4qICAgbWF4UmV0cmllczogMyxcbiogICByZXRyeU9uOiBzaG91bGRSZXRyeSxcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBSZXR1cm4gZXJyb3IgbWVzc2FnZSBpbnN0ZWFkIG9mIHJhaXNpbmdcbiogYGBgdHNcbiogY29uc3QgcmV0cnkgPSBtb2RlbFJldHJ5TWlkZGxld2FyZSh7XG4qICAgbWF4UmV0cmllczogNCxcbiogICBvbkZhaWx1cmU6IFwiY29udGludWVcIiwgLy8gUmV0dXJuIEFJTWVzc2FnZSB3aXRoIGVycm9yIGluc3RlYWQgb2YgdGhyb3dpbmdcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBDdXN0b20gZXJyb3IgbWVzc2FnZSBmb3JtYXR0aW5nXG4qIGBgYHRzXG4qIGNvbnN0IGZvcm1hdEVycm9yID0gKGVycm9yOiBFcnJvcikgPT5cbiogICBgTW9kZWwgY2FsbCBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX0uIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuYDtcbipcbiogY29uc3QgcmV0cnkgPSBtb2RlbFJldHJ5TWlkZGxld2FyZSh7XG4qICAgbWF4UmV0cmllczogNCxcbiogICBvbkZhaWx1cmU6IGZvcm1hdEVycm9yLFxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlIENvbnN0YW50IGJhY2tvZmYgKG5vIGV4cG9uZW50aWFsIGdyb3d0aClcbiogYGBgdHNcbiogY29uc3QgcmV0cnkgPSBtb2RlbFJldHJ5TWlkZGxld2FyZSh7XG4qICAgbWF4UmV0cmllczogNSxcbiogICBiYWNrb2ZmRmFjdG9yOiAwLjAsIC8vIE5vIGV4cG9uZW50aWFsIGdyb3d0aFxuKiAgIGluaXRpYWxEZWxheU1zOiAyMDAwLCAvLyBBbHdheXMgd2FpdCAyIHNlY29uZHNcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBSYWlzZSBleGNlcHRpb24gb24gZmFpbHVyZVxuKiBgYGB0c1xuKiBjb25zdCByZXRyeSA9IG1vZGVsUmV0cnlNaWRkbGV3YXJlKHtcbiogICBtYXhSZXRyaWVzOiAyLFxuKiAgIG9uRmFpbHVyZTogXCJlcnJvclwiLCAvLyBSZS1yYWlzZSBleGNlcHRpb24gaW5zdGVhZCBvZiByZXR1cm5pbmcgbWVzc2FnZVxuKiB9KTtcbiogYGBgXG4qXG4qIEBwYXJhbSBjb25maWcgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSByZXRyeSBtaWRkbGV3YXJlXG4qIEByZXR1cm5zIEEgbWlkZGxld2FyZSBpbnN0YW5jZSB0aGF0IGhhbmRsZXMgbW9kZWwgZmFpbHVyZXMgd2l0aCByZXRyaWVzXG4qL1xuZnVuY3Rpb24gbW9kZWxSZXRyeU1pZGRsZXdhcmUoY29uZmlnID0ge30pIHtcblx0Y29uc3QgeyBzdWNjZXNzLCBlcnJvciwgZGF0YSB9ID0gTW9kZWxSZXRyeU1pZGRsZXdhcmVPcHRpb25zU2NoZW1hLnNhZmVQYXJzZShjb25maWcpO1xuXHRpZiAoIXN1Y2Nlc3MpIHRocm93IG5ldyBJbnZhbGlkUmV0cnlDb25maWdFcnJvcihlcnJvcik7XG5cdGNvbnN0IHsgbWF4UmV0cmllcywgcmV0cnlPbiwgb25GYWlsdXJlLCBiYWNrb2ZmRmFjdG9yLCBpbml0aWFsRGVsYXlNcywgbWF4RGVsYXlNcywgaml0dGVyIH0gPSBkYXRhO1xuXHQvKipcblx0KiBDaGVjayBpZiB0aGUgZXhjZXB0aW9uIHNob3VsZCB0cmlnZ2VyIGEgcmV0cnkuXG5cdCovXG5cdGNvbnN0IHNob3VsZFJldHJ5RXhjZXB0aW9uID0gKGVycm9yKSA9PiB7XG5cdFx0aWYgKHR5cGVvZiByZXRyeU9uID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiByZXRyeU9uKGVycm9yKTtcblx0XHRyZXR1cm4gcmV0cnlPbi5zb21lKChFcnJvckNvbnN0cnVjdG9yKSA9PiBlcnJvci5jb25zdHJ1Y3RvciA9PT0gRXJyb3JDb25zdHJ1Y3Rvcik7XG5cdH07XG5cdGNvbnN0IGRlbGF5Q29uZmlnID0ge1xuXHRcdGJhY2tvZmZGYWN0b3IsXG5cdFx0aW5pdGlhbERlbGF5TXMsXG5cdFx0bWF4RGVsYXlNcyxcblx0XHRqaXR0ZXJcblx0fTtcblx0LyoqXG5cdCogRm9ybWF0IHRoZSBmYWlsdXJlIG1lc3NhZ2Ugd2hlbiByZXRyaWVzIGFyZSBleGhhdXN0ZWQuXG5cdCovXG5cdGNvbnN0IGZvcm1hdEZhaWx1cmVNZXNzYWdlID0gKGVycm9yLCBhdHRlbXB0c01hZGUpID0+IHtcblx0XHRjb25zdCBlcnJvclR5cGUgPSBlcnJvci5jb25zdHJ1Y3Rvci5uYW1lO1xuXHRcdHJldHVybiBgTW9kZWwgY2FsbCBmYWlsZWQgYWZ0ZXIgJHthdHRlbXB0c01hZGV9ICR7YXR0ZW1wdHNNYWRlID09PSAxID8gXCJhdHRlbXB0XCIgOiBcImF0dGVtcHRzXCJ9IHdpdGggJHtlcnJvclR5cGV9OiAke2Vycm9yLm1lc3NhZ2V9YDtcblx0fTtcblx0LyoqXG5cdCogSGFuZGxlIGZhaWx1cmUgd2hlbiBhbGwgcmV0cmllcyBhcmUgZXhoYXVzdGVkLlxuXHQqL1xuXHRjb25zdCBoYW5kbGVGYWlsdXJlID0gKGVycm9yLCBhdHRlbXB0c01hZGUpID0+IHtcblx0XHRpZiAob25GYWlsdXJlID09PSBcImVycm9yXCIpIHRocm93IGVycm9yO1xuXHRcdGxldCBjb250ZW50O1xuXHRcdGlmICh0eXBlb2Ygb25GYWlsdXJlID09PSBcImZ1bmN0aW9uXCIpIGNvbnRlbnQgPSBvbkZhaWx1cmUoZXJyb3IpO1xuXHRcdGVsc2UgY29udGVudCA9IGZvcm1hdEZhaWx1cmVNZXNzYWdlKGVycm9yLCBhdHRlbXB0c01hZGUpO1xuXHRcdHJldHVybiBuZXcgQUlNZXNzYWdlKHsgY29udGVudCB9KTtcblx0fTtcblx0cmV0dXJuIGNyZWF0ZU1pZGRsZXdhcmUoe1xuXHRcdG5hbWU6IFwibW9kZWxSZXRyeU1pZGRsZXdhcmVcIixcblx0XHRjb250ZXh0U2NoZW1hOiBNb2RlbFJldHJ5TWlkZGxld2FyZU9wdGlvbnNTY2hlbWEsXG5cdFx0d3JhcE1vZGVsQ2FsbDogYXN5bmMgKHJlcXVlc3QsIGhhbmRsZXIpID0+IHtcblx0XHRcdGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDw9IG1heFJldHJpZXM7IGF0dGVtcHQrKykgdHJ5IHtcblx0XHRcdFx0cmV0dXJuIGF3YWl0IGhhbmRsZXIocmVxdWVzdCk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRjb25zdCBhdHRlbXB0c01hZGUgPSBhdHRlbXB0ICsgMTtcblx0XHRcdFx0Y29uc3QgZXJyID0gZXJyb3IgJiYgdHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiICYmIFwibWVzc2FnZVwiIGluIGVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSk7XG5cdFx0XHRcdGlmICghc2hvdWxkUmV0cnlFeGNlcHRpb24oZXJyKSkgcmV0dXJuIGhhbmRsZUZhaWx1cmUoZXJyLCBhdHRlbXB0c01hZGUpO1xuXHRcdFx0XHRpZiAoYXR0ZW1wdCA8IG1heFJldHJpZXMpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGNhbGN1bGF0ZVJldHJ5RGVsYXkoZGVsYXlDb25maWcsIGF0dGVtcHQpO1xuXHRcdFx0XHRcdGlmIChkZWxheSA+IDApIGF3YWl0IHNsZWVwKGRlbGF5KTtcblx0XHRcdFx0fSBlbHNlIHJldHVybiBoYW5kbGVGYWlsdXJlKGVyciwgYXR0ZW1wdHNNYWRlKTtcblx0XHRcdH1cblx0XHRcdHRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQ6IHJldHJ5IGxvb3AgY29tcGxldGVkIHdpdGhvdXQgcmV0dXJuaW5nXCIpO1xuXHRcdH1cblx0fSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgbW9kZWxSZXRyeU1pZGRsZXdhcmUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZGVsUmV0cnkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelRetry.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/pii.js":
/*!**********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/pii.js ***!
  \**********************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PIIDetectionError: () => (/* binding */ PIIDetectionError),\n/* harmony export */   applyStrategy: () => (/* binding */ applyStrategy),\n/* harmony export */   detectCreditCard: () => (/* binding */ detectCreditCard),\n/* harmony export */   detectEmail: () => (/* binding */ detectEmail),\n/* harmony export */   detectIP: () => (/* binding */ detectIP),\n/* harmony export */   detectMacAddress: () => (/* binding */ detectMacAddress),\n/* harmony export */   detectUrl: () => (/* binding */ detectUrl),\n/* harmony export */   piiMiddleware: () => (/* binding */ piiMiddleware),\n/* harmony export */   resolveRedactionRule: () => (/* binding */ resolveRedactionRule)\n/* harmony export */ });\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n/* harmony import */ var _langchain_core_utils_hash__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/utils/hash */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/hash.js\");\n\n\n\n\n\n//#region src/agents/middleware/pii.ts\n/**\n* Error thrown when PII is detected and strategy is 'block'\n*/\nvar PIIDetectionError = class extends Error {\n\tconstructor(piiType, matches) {\n\t\tsuper(`PII detected: ${piiType} found ${matches.length} occurrence(s)`);\n\t\tthis.piiType = piiType;\n\t\tthis.matches = matches;\n\t\tthis.name = \"PIIDetectionError\";\n\t}\n};\n/**\n* Email detection regex pattern\n*/\nconst EMAIL_PATTERN = /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}\\b/g;\n/**\n* Credit card detection regex pattern (basic, will be validated with Luhn)\n*/\nconst CREDIT_CARD_PATTERN = /\\b(?:\\d{4}[-\\s]?){3}\\d{4}\\b/g;\n/**\n* IP address detection regex pattern\n*/\nconst IP_PATTERN = /\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b/g;\n/**\n* MAC address detection regex pattern\n*/\nconst MAC_ADDRESS_PATTERN = /\\b(?:[0-9A-Fa-f]{2}[:-]){5}(?:[0-9A-Fa-f]{2})\\b/g;\n/**\n* URL detection regex pattern\n*/\nconst URL_PATTERN = /(?:https?:\\/\\/|www\\.)[^\\s<>\"{}|\\\\^`[\\]]+/gi;\n/**\n* Luhn algorithm for credit card validation\n*/\nfunction luhnCheck(cardNumber) {\n\tconst digits = cardNumber.replace(/\\D/g, \"\");\n\tlet sum = 0;\n\tlet isEven = false;\n\tfor (let i = digits.length - 1; i >= 0; i--) {\n\t\tlet digit = parseInt(digits[i], 10);\n\t\tif (isEven) {\n\t\t\tdigit *= 2;\n\t\t\tif (digit > 9) digit -= 9;\n\t\t}\n\t\tsum += digit;\n\t\tisEven = !isEven;\n\t}\n\treturn sum % 10 === 0;\n}\n/**\n* Convert regex match to PIIMatch\n*/\nfunction regexMatchToPIIMatch(match) {\n\treturn {\n\t\ttext: match[0],\n\t\tstart: match.index ?? 0,\n\t\tend: (match.index ?? 0) + match[0].length\n\t};\n}\n/**\n* Detect email addresses in content\n*/\nfunction detectEmail(content) {\n\tconst matches = [];\n\tconst regex = new RegExp(EMAIL_PATTERN);\n\tlet match;\n\twhile ((match = regex.exec(content)) !== null) matches.push(regexMatchToPIIMatch(match));\n\treturn matches;\n}\n/**\n* Detect credit card numbers in content (validated with Luhn algorithm)\n*/\nfunction detectCreditCard(content) {\n\tconst matches = [];\n\tconst regex = new RegExp(CREDIT_CARD_PATTERN);\n\tlet match;\n\twhile ((match = regex.exec(content)) !== null) {\n\t\tconst cardNumber = match[0].replace(/\\D/g, \"\");\n\t\tif (cardNumber.length >= 13 && cardNumber.length <= 19 && luhnCheck(cardNumber)) matches.push(regexMatchToPIIMatch(match));\n\t}\n\treturn matches;\n}\n/**\n* Detect IP addresses in content (validated)\n*/\nfunction detectIP(content) {\n\tconst matches = [];\n\tconst regex = new RegExp(IP_PATTERN);\n\tlet match;\n\twhile ((match = regex.exec(content)) !== null) {\n\t\tconst parts = match[0].split(\".\");\n\t\tif (parts.length === 4 && parts.every((part) => {\n\t\t\tconst num = parseInt(part, 10);\n\t\t\treturn num >= 0 && num <= 255;\n\t\t})) matches.push(regexMatchToPIIMatch(match));\n\t}\n\treturn matches;\n}\n/**\n* Detect MAC addresses in content\n*/\nfunction detectMacAddress(content) {\n\tconst matches = [];\n\tconst regex = new RegExp(MAC_ADDRESS_PATTERN);\n\tlet match;\n\twhile ((match = regex.exec(content)) !== null) matches.push(regexMatchToPIIMatch(match));\n\treturn matches;\n}\n/**\n* Detect URLs in content\n*/\nfunction detectUrl(content) {\n\tconst matches = [];\n\tconst regex = new RegExp(URL_PATTERN);\n\tlet match;\n\twhile ((match = regex.exec(content)) !== null) matches.push(regexMatchToPIIMatch(match));\n\treturn matches;\n}\n/**\n* Built-in detector map\n*/\nconst BUILT_IN_DETECTORS = {\n\temail: detectEmail,\n\tcredit_card: detectCreditCard,\n\tip: detectIP,\n\tmac_address: detectMacAddress,\n\turl: detectUrl\n};\n/**\n* Resolve a redaction rule to a concrete detector function\n*/\nfunction resolveRedactionRule(config) {\n\tlet detector;\n\tif (config.detector) if (typeof config.detector === \"string\") {\n\t\tconst regex = new RegExp(config.detector, \"g\");\n\t\tdetector = (content) => {\n\t\t\tconst matches = [];\n\t\t\tlet match;\n\t\t\tconst regexCopy = new RegExp(regex);\n\t\t\twhile ((match = regexCopy.exec(content)) !== null) matches.push(regexMatchToPIIMatch(match));\n\t\t\treturn matches;\n\t\t};\n\t} else if (config.detector instanceof RegExp) detector = (content) => {\n\t\tif (!(config.detector instanceof RegExp)) throw new Error(\"Detector is required\");\n\t\tconst matches = [];\n\t\tlet match;\n\t\twhile ((match = config.detector.exec(content)) !== null) matches.push(regexMatchToPIIMatch(match));\n\t\treturn matches;\n\t};\n\telse detector = config.detector;\n\telse {\n\t\tconst builtInType = config.piiType;\n\t\tif (!BUILT_IN_DETECTORS[builtInType]) throw new Error(`Unknown PII type: ${config.piiType}. Must be one of: ${Object.keys(BUILT_IN_DETECTORS).join(\", \")}, or provide a custom detector.`);\n\t\tdetector = BUILT_IN_DETECTORS[builtInType];\n\t}\n\treturn {\n\t\tpiiType: config.piiType,\n\t\tstrategy: config.strategy,\n\t\tdetector\n\t};\n}\n/**\n* Apply redact strategy: replace with [REDACTED_TYPE]\n*/\nfunction applyRedactStrategy(content, matches, piiType) {\n\tlet result = content;\n\tfor (let i = matches.length - 1; i >= 0; i--) {\n\t\tconst match = matches[i];\n\t\tconst replacement = `[REDACTED_${piiType.toUpperCase()}]`;\n\t\tresult = result.slice(0, match.start) + replacement + result.slice(match.end);\n\t}\n\treturn result;\n}\n/**\n* Apply mask strategy: partially mask PII (show last few characters)\n*/\nfunction applyMaskStrategy(content, matches, piiType) {\n\tlet result = content;\n\tfor (let i = matches.length - 1; i >= 0; i--) {\n\t\tconst match = matches[i];\n\t\tconst text = match.text;\n\t\tlet masked;\n\t\tif (piiType === \"credit_card\") masked = `****-****-****-${text.replace(/\\D/g, \"\").slice(-4)}`;\n\t\telse if (piiType === \"email\") {\n\t\t\tconst [local, domain] = text.split(\"@\");\n\t\t\tif (local && domain) masked = `${local[0]}***@${domain}`;\n\t\t\telse masked = \"***\";\n\t\t} else {\n\t\t\tconst visibleChars = Math.min(4, text.length);\n\t\t\tmasked = `${\"*\".repeat(Math.max(0, text.length - visibleChars))}${text.slice(-visibleChars)}`;\n\t\t}\n\t\tresult = result.slice(0, match.start) + masked + result.slice(match.end);\n\t}\n\treturn result;\n}\n/**\n* Apply hash strategy: replace with deterministic hash\n*/\nfunction applyHashStrategy(content, matches, piiType) {\n\tlet result = content;\n\tfor (let i = matches.length - 1; i >= 0; i--) {\n\t\tconst match = matches[i];\n\t\tconst replacement = `<${piiType}_hash:${(0,_langchain_core_utils_hash__WEBPACK_IMPORTED_MODULE_3__.sha256)(match.text).slice(0, 8)}>`;\n\t\tresult = result.slice(0, match.start) + replacement + result.slice(match.end);\n\t}\n\treturn result;\n}\n/**\n* Apply strategy to content based on matches\n*/\nfunction applyStrategy(content, matches, strategy, piiType) {\n\tif (matches.length === 0) return content;\n\tswitch (strategy) {\n\t\tcase \"block\": throw new PIIDetectionError(piiType, matches);\n\t\tcase \"redact\": return applyRedactStrategy(content, matches, piiType);\n\t\tcase \"mask\": return applyMaskStrategy(content, matches, piiType);\n\t\tcase \"hash\": return applyHashStrategy(content, matches, piiType);\n\t\tdefault: throw new Error(`Unknown strategy: ${strategy}`);\n\t}\n}\n/**\n* Configuration schema for PII middleware\n*/\nconst contextSchema = zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.object({\n\tapplyToInput: zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.boolean().optional(),\n\tapplyToOutput: zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.boolean().optional(),\n\tapplyToToolResults: zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.boolean().optional()\n});\n/**\n* Process content for PII detection and apply strategy\n*/\nfunction processContent(content, rule) {\n\tconst matches = rule.detector(content);\n\tif (matches.length === 0) return {\n\t\tcontent,\n\t\tmatches: []\n\t};\n\treturn {\n\t\tcontent: applyStrategy(content, matches, rule.strategy, rule.piiType),\n\t\tmatches\n\t};\n}\n/**\n* Creates a middleware that detects and handles personally identifiable information (PII)\n* in conversations.\n*\n* This middleware detects common PII types and applies configurable strategies to handle them.\n* It can detect emails, credit cards, IP addresses, MAC addresses, and URLs in both user input\n* and agent output.\n*\n* Built-in PII types:\n* - `email`: Email addresses\n* - `credit_card`: Credit card numbers (validated with Luhn algorithm)\n* - `ip`: IP addresses (validated)\n* - `mac_address`: MAC addresses\n* - `url`: URLs (both `http`/`https` and bare URLs)\n*\n* Strategies:\n* - `block`: Raise an exception when PII is detected\n* - `redact`: Replace PII with `[REDACTED_TYPE]` placeholders\n* - `mask`: Partially mask PII (e.g., `****-****-****-1234` for credit card)\n* - `hash`: Replace PII with deterministic hash (e.g., `<email_hash:a1b2c3d4>`)\n*\n* Strategy Selection Guide:\n* | Strategy | Preserves Identity? | Best For                                |\n* | -------- | ------------------- | --------------------------------------- |\n* | `block`  | N/A                 | Avoid PII completely                    |\n* | `redact` | No                  | General compliance, log sanitization    |\n* | `mask`   | No                  | Human readability, customer service UIs |\n* | `hash`   | Yes (pseudonymous)  | Analytics, debugging                    |\n*\n* @param piiType - Type of PII to detect. Can be a built-in type (`email`, `credit_card`, `ip`, `mac_address`, `url`) or a custom type name.\n* @param options - Configuration options\n* @param options.strategy - How to handle detected PII. Defaults to `\"redact\"`.\n* @param options.detector - Custom detector function or regex pattern string. If not provided, uses built-in detector for the `piiType`.\n* @param options.applyToInput - Whether to check user messages before model call. Defaults to `true`.\n* @param options.applyToOutput - Whether to check AI messages after model call. Defaults to `false`.\n* @param options.applyToToolResults - Whether to check tool result messages after tool execution. Defaults to `false`.\n*\n* @returns Middleware instance for use with `createAgent`\n*\n* @throws {PIIDetectionError} When PII is detected and strategy is `'block'`\n* @throws {Error} If `piiType` is not built-in and no detector is provided\n*\n* @example Basic usage\n* ```typescript\n* import { piiMiddleware } from \"langchain\";\n* import { createAgent } from \"langchain\";\n*\n* // Redact all emails in user input\n* const agent = createAgent({\n*   model: \"openai:gpt-4\",\n*   middleware: [\n*     piiMiddleware(\"email\", { strategy: \"redact\" }),\n*   ],\n* });\n* ```\n*\n* @example Different strategies for different PII types\n* ```typescript\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   middleware: [\n*     piiMiddleware(\"credit_card\", { strategy: \"mask\" }),\n*     piiMiddleware(\"url\", { strategy: \"redact\" }),\n*     piiMiddleware(\"ip\", { strategy: \"hash\" }),\n*   ],\n* });\n* ```\n*\n* @example Custom PII type with regex\n* ```typescript\n* const agent = createAgent({\n*   model: \"openai:gpt-4\",\n*   middleware: [\n*     piiMiddleware(\"api_key\", {\n*       detector: \"sk-[a-zA-Z0-9]{32}\",\n*       strategy: \"block\",\n*     }),\n*   ],\n* });\n* ```\n*\n* @public\n*/\nfunction piiMiddleware(piiType, options = {}) {\n\tconst { strategy = \"redact\", detector } = options;\n\tconst resolvedRule = resolveRedactionRule({\n\t\tpiiType,\n\t\tstrategy,\n\t\tdetector\n\t});\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)({\n\t\tname: `PIIMiddleware[${resolvedRule.piiType}]`,\n\t\tcontextSchema,\n\t\tbeforeModel: async (state, runtime) => {\n\t\t\tconst applyToInput = runtime.context.applyToInput ?? options.applyToInput ?? true;\n\t\t\tconst applyToToolResults = runtime.context.applyToToolResults ?? options.applyToToolResults ?? false;\n\t\t\tif (!applyToInput && !applyToToolResults) return;\n\t\t\tconst messages = state.messages;\n\t\t\tif (!messages || messages.length === 0) return;\n\t\t\tconst newMessages = [...messages];\n\t\t\tlet anyModified = false;\n\t\t\tif (applyToInput) {\n\t\t\t\tlet lastUserIdx = null;\n\t\t\t\tfor (let i = messages.length - 1; i >= 0; i--) if (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.HumanMessage.isInstance(messages[i])) {\n\t\t\t\t\tlastUserIdx = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (lastUserIdx !== null) {\n\t\t\t\t\tconst lastUserMsg = messages[lastUserIdx];\n\t\t\t\t\tif (lastUserMsg && lastUserMsg.content) {\n\t\t\t\t\t\tconst { content: newContent, matches } = processContent(String(lastUserMsg.content), resolvedRule);\n\t\t\t\t\t\tif (matches.length > 0) {\n\t\t\t\t\t\t\tnewMessages[lastUserIdx] = new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.HumanMessage({\n\t\t\t\t\t\t\t\tcontent: newContent,\n\t\t\t\t\t\t\t\tid: lastUserMsg.id,\n\t\t\t\t\t\t\t\tname: lastUserMsg.name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tanyModified = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (applyToToolResults) {\n\t\t\t\tlet lastAiIdx = null;\n\t\t\t\tfor (let i = messages.length - 1; i >= 0; i--) if (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance(messages[i])) {\n\t\t\t\t\tlastAiIdx = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (lastAiIdx !== null) for (let i = lastAiIdx + 1; i < messages.length; i++) {\n\t\t\t\t\tconst msg = messages[i];\n\t\t\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.ToolMessage.isInstance(msg)) {\n\t\t\t\t\t\tif (!msg.content) continue;\n\t\t\t\t\t\tconst { content: newContent, matches } = processContent(String(msg.content), resolvedRule);\n\t\t\t\t\t\tif (matches.length > 0) {\n\t\t\t\t\t\t\tnewMessages[i] = new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.ToolMessage({\n\t\t\t\t\t\t\t\tcontent: newContent,\n\t\t\t\t\t\t\t\tid: msg.id,\n\t\t\t\t\t\t\t\tname: msg.name,\n\t\t\t\t\t\t\t\ttool_call_id: msg.tool_call_id\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tanyModified = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (anyModified) return { messages: newMessages };\n\t\t},\n\t\tafterModel: async (state, runtime) => {\n\t\t\tif (!(runtime.context.applyToOutput ?? options.applyToOutput ?? false)) return;\n\t\t\tconst messages = state.messages;\n\t\t\tif (!messages || messages.length === 0) return;\n\t\t\tlet lastAiIdx = null;\n\t\t\tlet lastAiMsg = null;\n\t\t\tfor (let i = messages.length - 1; i >= 0; i--) if (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance(messages[i])) {\n\t\t\t\tlastAiMsg = messages[i];\n\t\t\t\tlastAiIdx = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (lastAiIdx === null || !lastAiMsg || !lastAiMsg.content) return;\n\t\t\tconst { content: newContent, matches } = processContent(String(lastAiMsg.content), resolvedRule);\n\t\t\tif (matches.length === 0) return;\n\t\t\tconst updatedMessage = new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage({\n\t\t\t\tcontent: newContent,\n\t\t\t\tid: lastAiMsg.id,\n\t\t\t\tname: lastAiMsg.name,\n\t\t\t\ttool_calls: lastAiMsg.tool_calls\n\t\t\t});\n\t\t\tconst newMessages = [...messages];\n\t\t\tnewMessages[lastAiIdx] = updatedMessage;\n\t\t\treturn { messages: newMessages };\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=pii.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9waWkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFvRDtBQUM0QjtBQUNyRDtBQUN5Qjs7QUFFcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLFNBQVMsUUFBUSxnQkFBZ0I7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSxHQUFHO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUU7QUFDdEQ7QUFDQTtBQUNBO0FBQ0EscUVBQXFFLEVBQUU7QUFDdkU7QUFDQTtBQUNBO0FBQ0EsOENBQThDLEVBQUUsTUFBTSxFQUFFLGVBQWUsRUFBRTtBQUN6RTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsUUFBUTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSxlQUFlLG9CQUFvQiwyQ0FBMkM7QUFDM0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsUUFBUTtBQUMxQztBQUNBLG1DQUFtQyxzQkFBc0I7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLFFBQVE7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsNERBQTRELGtDQUFrQztBQUM5RjtBQUNBO0FBQ0Esb0NBQW9DLFNBQVMsTUFBTSxPQUFPO0FBQzFEO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsZUFBZSxvREFBb0QsRUFBRSwwQkFBMEI7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsUUFBUTtBQUMxQztBQUNBLDBCQUEwQixRQUFRLFFBQVEsa0VBQU0seUJBQXlCO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsU0FBUztBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLDRDQUFRO0FBQzlCLGVBQWUsNkNBQVM7QUFDeEIsZ0JBQWdCLDZDQUFTO0FBQ3pCLHFCQUFxQiw2Q0FBUztBQUM5QixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsbUJBQW1CO0FBQzlCLFdBQVcsT0FBTztBQUNsQjtBQUNBO0FBQ0E7QUFDQSxXQUFXLGdCQUFnQjtBQUMzQixXQUFXLGNBQWM7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixvQkFBb0I7QUFDbkQ7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsa0JBQWtCO0FBQ3ZELDZCQUE2QixvQkFBb0I7QUFDakQsNEJBQTRCLGtCQUFrQjtBQUM5QztBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLEdBQUc7QUFDckM7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEM7QUFDNUMsU0FBUyxnQ0FBZ0M7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0YsUUFBUSxnRUFBZ0I7QUFDeEIseUJBQXlCLHFCQUFxQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLFFBQVEsU0FBUyxrRUFBWTtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLCtCQUErQjtBQUM3QztBQUNBLHNDQUFzQyxrRUFBWTtBQUNsRDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsUUFBUSxTQUFTLCtEQUFTO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxxQkFBcUI7QUFDN0U7QUFDQSxTQUFTLGlFQUFXO0FBQ3BCO0FBQ0EsY0FBYywrQkFBK0I7QUFDN0M7QUFDQSw0QkFBNEIsaUVBQVc7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLFFBQVEsU0FBUywrREFBUztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVywrQkFBK0I7QUFDMUM7QUFDQSw4QkFBOEIsK0RBQVM7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUN1SjtBQUN2SiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL25vZGVfbW9kdWxlcy8ucG5wbS9sYW5nY2hhaW5AMS4yLjI2X0BsYW5nY2hhaW4rY29yZUAxLjEuMjhfb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX19vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fcmVfZXgyYjV5M3R6ZjdoMmN4bW11aTVxb2lhc3kvbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2FnZW50cy9taWRkbGV3YXJlL3BpaS5qcz81NTVhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUgfSBmcm9tIFwiLi4vbWlkZGxld2FyZS5qc1wiO1xuaW1wb3J0IHsgQUlNZXNzYWdlLCBIdW1hbk1lc3NhZ2UsIFRvb2xNZXNzYWdlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9tZXNzYWdlc1wiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2QvdjNcIjtcbmltcG9ydCB7IHNoYTI1NiB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvdXRpbHMvaGFzaFwiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9taWRkbGV3YXJlL3BpaS50c1xuLyoqXG4qIEVycm9yIHRocm93biB3aGVuIFBJSSBpcyBkZXRlY3RlZCBhbmQgc3RyYXRlZ3kgaXMgJ2Jsb2NrJ1xuKi9cbnZhciBQSUlEZXRlY3Rpb25FcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuXHRjb25zdHJ1Y3RvcihwaWlUeXBlLCBtYXRjaGVzKSB7XG5cdFx0c3VwZXIoYFBJSSBkZXRlY3RlZDogJHtwaWlUeXBlfSBmb3VuZCAke21hdGNoZXMubGVuZ3RofSBvY2N1cnJlbmNlKHMpYCk7XG5cdFx0dGhpcy5waWlUeXBlID0gcGlpVHlwZTtcblx0XHR0aGlzLm1hdGNoZXMgPSBtYXRjaGVzO1xuXHRcdHRoaXMubmFtZSA9IFwiUElJRGV0ZWN0aW9uRXJyb3JcIjtcblx0fVxufTtcbi8qKlxuKiBFbWFpbCBkZXRlY3Rpb24gcmVnZXggcGF0dGVyblxuKi9cbmNvbnN0IEVNQUlMX1BBVFRFUk4gPSAvXFxiW0EtWmEtejAtOS5fJSstXStAW0EtWmEtejAtOS4tXStcXC5bQS1aYS16XXsyLH1cXGIvZztcbi8qKlxuKiBDcmVkaXQgY2FyZCBkZXRlY3Rpb24gcmVnZXggcGF0dGVybiAoYmFzaWMsIHdpbGwgYmUgdmFsaWRhdGVkIHdpdGggTHVobilcbiovXG5jb25zdCBDUkVESVRfQ0FSRF9QQVRURVJOID0gL1xcYig/OlxcZHs0fVstXFxzXT8pezN9XFxkezR9XFxiL2c7XG4vKipcbiogSVAgYWRkcmVzcyBkZXRlY3Rpb24gcmVnZXggcGF0dGVyblxuKi9cbmNvbnN0IElQX1BBVFRFUk4gPSAvXFxiKD86KD86MjVbMC01XXwyWzAtNF1bMC05XXxbMDFdP1swLTldWzAtOV0/KVxcLil7M30oPzoyNVswLTVdfDJbMC00XVswLTldfFswMV0/WzAtOV1bMC05XT8pXFxiL2c7XG4vKipcbiogTUFDIGFkZHJlc3MgZGV0ZWN0aW9uIHJlZ2V4IHBhdHRlcm5cbiovXG5jb25zdCBNQUNfQUREUkVTU19QQVRURVJOID0gL1xcYig/OlswLTlBLUZhLWZdezJ9WzotXSl7NX0oPzpbMC05QS1GYS1mXXsyfSlcXGIvZztcbi8qKlxuKiBVUkwgZGV0ZWN0aW9uIHJlZ2V4IHBhdHRlcm5cbiovXG5jb25zdCBVUkxfUEFUVEVSTiA9IC8oPzpodHRwcz86XFwvXFwvfHd3d1xcLilbXlxcczw+XCJ7fXxcXFxcXmBbXFxdXSsvZ2k7XG4vKipcbiogTHVobiBhbGdvcml0aG0gZm9yIGNyZWRpdCBjYXJkIHZhbGlkYXRpb25cbiovXG5mdW5jdGlvbiBsdWhuQ2hlY2soY2FyZE51bWJlcikge1xuXHRjb25zdCBkaWdpdHMgPSBjYXJkTnVtYmVyLnJlcGxhY2UoL1xcRC9nLCBcIlwiKTtcblx0bGV0IHN1bSA9IDA7XG5cdGxldCBpc0V2ZW4gPSBmYWxzZTtcblx0Zm9yIChsZXQgaSA9IGRpZ2l0cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdGxldCBkaWdpdCA9IHBhcnNlSW50KGRpZ2l0c1tpXSwgMTApO1xuXHRcdGlmIChpc0V2ZW4pIHtcblx0XHRcdGRpZ2l0ICo9IDI7XG5cdFx0XHRpZiAoZGlnaXQgPiA5KSBkaWdpdCAtPSA5O1xuXHRcdH1cblx0XHRzdW0gKz0gZGlnaXQ7XG5cdFx0aXNFdmVuID0gIWlzRXZlbjtcblx0fVxuXHRyZXR1cm4gc3VtICUgMTAgPT09IDA7XG59XG4vKipcbiogQ29udmVydCByZWdleCBtYXRjaCB0byBQSUlNYXRjaFxuKi9cbmZ1bmN0aW9uIHJlZ2V4TWF0Y2hUb1BJSU1hdGNoKG1hdGNoKSB7XG5cdHJldHVybiB7XG5cdFx0dGV4dDogbWF0Y2hbMF0sXG5cdFx0c3RhcnQ6IG1hdGNoLmluZGV4ID8/IDAsXG5cdFx0ZW5kOiAobWF0Y2guaW5kZXggPz8gMCkgKyBtYXRjaFswXS5sZW5ndGhcblx0fTtcbn1cbi8qKlxuKiBEZXRlY3QgZW1haWwgYWRkcmVzc2VzIGluIGNvbnRlbnRcbiovXG5mdW5jdGlvbiBkZXRlY3RFbWFpbChjb250ZW50KSB7XG5cdGNvbnN0IG1hdGNoZXMgPSBbXTtcblx0Y29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKEVNQUlMX1BBVFRFUk4pO1xuXHRsZXQgbWF0Y2g7XG5cdHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKGNvbnRlbnQpKSAhPT0gbnVsbCkgbWF0Y2hlcy5wdXNoKHJlZ2V4TWF0Y2hUb1BJSU1hdGNoKG1hdGNoKSk7XG5cdHJldHVybiBtYXRjaGVzO1xufVxuLyoqXG4qIERldGVjdCBjcmVkaXQgY2FyZCBudW1iZXJzIGluIGNvbnRlbnQgKHZhbGlkYXRlZCB3aXRoIEx1aG4gYWxnb3JpdGhtKVxuKi9cbmZ1bmN0aW9uIGRldGVjdENyZWRpdENhcmQoY29udGVudCkge1xuXHRjb25zdCBtYXRjaGVzID0gW107XG5cdGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChDUkVESVRfQ0FSRF9QQVRURVJOKTtcblx0bGV0IG1hdGNoO1xuXHR3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhjb250ZW50KSkgIT09IG51bGwpIHtcblx0XHRjb25zdCBjYXJkTnVtYmVyID0gbWF0Y2hbMF0ucmVwbGFjZSgvXFxEL2csIFwiXCIpO1xuXHRcdGlmIChjYXJkTnVtYmVyLmxlbmd0aCA+PSAxMyAmJiBjYXJkTnVtYmVyLmxlbmd0aCA8PSAxOSAmJiBsdWhuQ2hlY2soY2FyZE51bWJlcikpIG1hdGNoZXMucHVzaChyZWdleE1hdGNoVG9QSUlNYXRjaChtYXRjaCkpO1xuXHR9XG5cdHJldHVybiBtYXRjaGVzO1xufVxuLyoqXG4qIERldGVjdCBJUCBhZGRyZXNzZXMgaW4gY29udGVudCAodmFsaWRhdGVkKVxuKi9cbmZ1bmN0aW9uIGRldGVjdElQKGNvbnRlbnQpIHtcblx0Y29uc3QgbWF0Y2hlcyA9IFtdO1xuXHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoSVBfUEFUVEVSTik7XG5cdGxldCBtYXRjaDtcblx0d2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XG5cdFx0Y29uc3QgcGFydHMgPSBtYXRjaFswXS5zcGxpdChcIi5cIik7XG5cdFx0aWYgKHBhcnRzLmxlbmd0aCA9PT0gNCAmJiBwYXJ0cy5ldmVyeSgocGFydCkgPT4ge1xuXHRcdFx0Y29uc3QgbnVtID0gcGFyc2VJbnQocGFydCwgMTApO1xuXHRcdFx0cmV0dXJuIG51bSA+PSAwICYmIG51bSA8PSAyNTU7XG5cdFx0fSkpIG1hdGNoZXMucHVzaChyZWdleE1hdGNoVG9QSUlNYXRjaChtYXRjaCkpO1xuXHR9XG5cdHJldHVybiBtYXRjaGVzO1xufVxuLyoqXG4qIERldGVjdCBNQUMgYWRkcmVzc2VzIGluIGNvbnRlbnRcbiovXG5mdW5jdGlvbiBkZXRlY3RNYWNBZGRyZXNzKGNvbnRlbnQpIHtcblx0Y29uc3QgbWF0Y2hlcyA9IFtdO1xuXHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoTUFDX0FERFJFU1NfUEFUVEVSTik7XG5cdGxldCBtYXRjaDtcblx0d2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSBtYXRjaGVzLnB1c2gocmVnZXhNYXRjaFRvUElJTWF0Y2gobWF0Y2gpKTtcblx0cmV0dXJuIG1hdGNoZXM7XG59XG4vKipcbiogRGV0ZWN0IFVSTHMgaW4gY29udGVudFxuKi9cbmZ1bmN0aW9uIGRldGVjdFVybChjb250ZW50KSB7XG5cdGNvbnN0IG1hdGNoZXMgPSBbXTtcblx0Y29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKFVSTF9QQVRURVJOKTtcblx0bGV0IG1hdGNoO1xuXHR3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhjb250ZW50KSkgIT09IG51bGwpIG1hdGNoZXMucHVzaChyZWdleE1hdGNoVG9QSUlNYXRjaChtYXRjaCkpO1xuXHRyZXR1cm4gbWF0Y2hlcztcbn1cbi8qKlxuKiBCdWlsdC1pbiBkZXRlY3RvciBtYXBcbiovXG5jb25zdCBCVUlMVF9JTl9ERVRFQ1RPUlMgPSB7XG5cdGVtYWlsOiBkZXRlY3RFbWFpbCxcblx0Y3JlZGl0X2NhcmQ6IGRldGVjdENyZWRpdENhcmQsXG5cdGlwOiBkZXRlY3RJUCxcblx0bWFjX2FkZHJlc3M6IGRldGVjdE1hY0FkZHJlc3MsXG5cdHVybDogZGV0ZWN0VXJsXG59O1xuLyoqXG4qIFJlc29sdmUgYSByZWRhY3Rpb24gcnVsZSB0byBhIGNvbmNyZXRlIGRldGVjdG9yIGZ1bmN0aW9uXG4qL1xuZnVuY3Rpb24gcmVzb2x2ZVJlZGFjdGlvblJ1bGUoY29uZmlnKSB7XG5cdGxldCBkZXRlY3Rvcjtcblx0aWYgKGNvbmZpZy5kZXRlY3RvcikgaWYgKHR5cGVvZiBjb25maWcuZGV0ZWN0b3IgPT09IFwic3RyaW5nXCIpIHtcblx0XHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoY29uZmlnLmRldGVjdG9yLCBcImdcIik7XG5cdFx0ZGV0ZWN0b3IgPSAoY29udGVudCkgPT4ge1xuXHRcdFx0Y29uc3QgbWF0Y2hlcyA9IFtdO1xuXHRcdFx0bGV0IG1hdGNoO1xuXHRcdFx0Y29uc3QgcmVnZXhDb3B5ID0gbmV3IFJlZ0V4cChyZWdleCk7XG5cdFx0XHR3aGlsZSAoKG1hdGNoID0gcmVnZXhDb3B5LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSBtYXRjaGVzLnB1c2gocmVnZXhNYXRjaFRvUElJTWF0Y2gobWF0Y2gpKTtcblx0XHRcdHJldHVybiBtYXRjaGVzO1xuXHRcdH07XG5cdH0gZWxzZSBpZiAoY29uZmlnLmRldGVjdG9yIGluc3RhbmNlb2YgUmVnRXhwKSBkZXRlY3RvciA9IChjb250ZW50KSA9PiB7XG5cdFx0aWYgKCEoY29uZmlnLmRldGVjdG9yIGluc3RhbmNlb2YgUmVnRXhwKSkgdGhyb3cgbmV3IEVycm9yKFwiRGV0ZWN0b3IgaXMgcmVxdWlyZWRcIik7XG5cdFx0Y29uc3QgbWF0Y2hlcyA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblx0XHR3aGlsZSAoKG1hdGNoID0gY29uZmlnLmRldGVjdG9yLmV4ZWMoY29udGVudCkpICE9PSBudWxsKSBtYXRjaGVzLnB1c2gocmVnZXhNYXRjaFRvUElJTWF0Y2gobWF0Y2gpKTtcblx0XHRyZXR1cm4gbWF0Y2hlcztcblx0fTtcblx0ZWxzZSBkZXRlY3RvciA9IGNvbmZpZy5kZXRlY3Rvcjtcblx0ZWxzZSB7XG5cdFx0Y29uc3QgYnVpbHRJblR5cGUgPSBjb25maWcucGlpVHlwZTtcblx0XHRpZiAoIUJVSUxUX0lOX0RFVEVDVE9SU1tidWlsdEluVHlwZV0pIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBQSUkgdHlwZTogJHtjb25maWcucGlpVHlwZX0uIE11c3QgYmUgb25lIG9mOiAke09iamVjdC5rZXlzKEJVSUxUX0lOX0RFVEVDVE9SUykuam9pbihcIiwgXCIpfSwgb3IgcHJvdmlkZSBhIGN1c3RvbSBkZXRlY3Rvci5gKTtcblx0XHRkZXRlY3RvciA9IEJVSUxUX0lOX0RFVEVDVE9SU1tidWlsdEluVHlwZV07XG5cdH1cblx0cmV0dXJuIHtcblx0XHRwaWlUeXBlOiBjb25maWcucGlpVHlwZSxcblx0XHRzdHJhdGVneTogY29uZmlnLnN0cmF0ZWd5LFxuXHRcdGRldGVjdG9yXG5cdH07XG59XG4vKipcbiogQXBwbHkgcmVkYWN0IHN0cmF0ZWd5OiByZXBsYWNlIHdpdGggW1JFREFDVEVEX1RZUEVdXG4qL1xuZnVuY3Rpb24gYXBwbHlSZWRhY3RTdHJhdGVneShjb250ZW50LCBtYXRjaGVzLCBwaWlUeXBlKSB7XG5cdGxldCByZXN1bHQgPSBjb250ZW50O1xuXHRmb3IgKGxldCBpID0gbWF0Y2hlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdGNvbnN0IG1hdGNoID0gbWF0Y2hlc1tpXTtcblx0XHRjb25zdCByZXBsYWNlbWVudCA9IGBbUkVEQUNURURfJHtwaWlUeXBlLnRvVXBwZXJDYXNlKCl9XWA7XG5cdFx0cmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsIG1hdGNoLnN0YXJ0KSArIHJlcGxhY2VtZW50ICsgcmVzdWx0LnNsaWNlKG1hdGNoLmVuZCk7XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn1cbi8qKlxuKiBBcHBseSBtYXNrIHN0cmF0ZWd5OiBwYXJ0aWFsbHkgbWFzayBQSUkgKHNob3cgbGFzdCBmZXcgY2hhcmFjdGVycylcbiovXG5mdW5jdGlvbiBhcHBseU1hc2tTdHJhdGVneShjb250ZW50LCBtYXRjaGVzLCBwaWlUeXBlKSB7XG5cdGxldCByZXN1bHQgPSBjb250ZW50O1xuXHRmb3IgKGxldCBpID0gbWF0Y2hlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdGNvbnN0IG1hdGNoID0gbWF0Y2hlc1tpXTtcblx0XHRjb25zdCB0ZXh0ID0gbWF0Y2gudGV4dDtcblx0XHRsZXQgbWFza2VkO1xuXHRcdGlmIChwaWlUeXBlID09PSBcImNyZWRpdF9jYXJkXCIpIG1hc2tlZCA9IGAqKioqLSoqKiotKioqKi0ke3RleHQucmVwbGFjZSgvXFxEL2csIFwiXCIpLnNsaWNlKC00KX1gO1xuXHRcdGVsc2UgaWYgKHBpaVR5cGUgPT09IFwiZW1haWxcIikge1xuXHRcdFx0Y29uc3QgW2xvY2FsLCBkb21haW5dID0gdGV4dC5zcGxpdChcIkBcIik7XG5cdFx0XHRpZiAobG9jYWwgJiYgZG9tYWluKSBtYXNrZWQgPSBgJHtsb2NhbFswXX0qKipAJHtkb21haW59YDtcblx0XHRcdGVsc2UgbWFza2VkID0gXCIqKipcIjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdmlzaWJsZUNoYXJzID0gTWF0aC5taW4oNCwgdGV4dC5sZW5ndGgpO1xuXHRcdFx0bWFza2VkID0gYCR7XCIqXCIucmVwZWF0KE1hdGgubWF4KDAsIHRleHQubGVuZ3RoIC0gdmlzaWJsZUNoYXJzKSl9JHt0ZXh0LnNsaWNlKC12aXNpYmxlQ2hhcnMpfWA7XG5cdFx0fVxuXHRcdHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLCBtYXRjaC5zdGFydCkgKyBtYXNrZWQgKyByZXN1bHQuc2xpY2UobWF0Y2guZW5kKTtcblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufVxuLyoqXG4qIEFwcGx5IGhhc2ggc3RyYXRlZ3k6IHJlcGxhY2Ugd2l0aCBkZXRlcm1pbmlzdGljIGhhc2hcbiovXG5mdW5jdGlvbiBhcHBseUhhc2hTdHJhdGVneShjb250ZW50LCBtYXRjaGVzLCBwaWlUeXBlKSB7XG5cdGxldCByZXN1bHQgPSBjb250ZW50O1xuXHRmb3IgKGxldCBpID0gbWF0Y2hlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdGNvbnN0IG1hdGNoID0gbWF0Y2hlc1tpXTtcblx0XHRjb25zdCByZXBsYWNlbWVudCA9IGA8JHtwaWlUeXBlfV9oYXNoOiR7c2hhMjU2KG1hdGNoLnRleHQpLnNsaWNlKDAsIDgpfT5gO1xuXHRcdHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLCBtYXRjaC5zdGFydCkgKyByZXBsYWNlbWVudCArIHJlc3VsdC5zbGljZShtYXRjaC5lbmQpO1xuXHR9XG5cdHJldHVybiByZXN1bHQ7XG59XG4vKipcbiogQXBwbHkgc3RyYXRlZ3kgdG8gY29udGVudCBiYXNlZCBvbiBtYXRjaGVzXG4qL1xuZnVuY3Rpb24gYXBwbHlTdHJhdGVneShjb250ZW50LCBtYXRjaGVzLCBzdHJhdGVneSwgcGlpVHlwZSkge1xuXHRpZiAobWF0Y2hlcy5sZW5ndGggPT09IDApIHJldHVybiBjb250ZW50O1xuXHRzd2l0Y2ggKHN0cmF0ZWd5KSB7XG5cdFx0Y2FzZSBcImJsb2NrXCI6IHRocm93IG5ldyBQSUlEZXRlY3Rpb25FcnJvcihwaWlUeXBlLCBtYXRjaGVzKTtcblx0XHRjYXNlIFwicmVkYWN0XCI6IHJldHVybiBhcHBseVJlZGFjdFN0cmF0ZWd5KGNvbnRlbnQsIG1hdGNoZXMsIHBpaVR5cGUpO1xuXHRcdGNhc2UgXCJtYXNrXCI6IHJldHVybiBhcHBseU1hc2tTdHJhdGVneShjb250ZW50LCBtYXRjaGVzLCBwaWlUeXBlKTtcblx0XHRjYXNlIFwiaGFzaFwiOiByZXR1cm4gYXBwbHlIYXNoU3RyYXRlZ3koY29udGVudCwgbWF0Y2hlcywgcGlpVHlwZSk7XG5cdFx0ZGVmYXVsdDogdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHN0cmF0ZWd5OiAke3N0cmF0ZWd5fWApO1xuXHR9XG59XG4vKipcbiogQ29uZmlndXJhdGlvbiBzY2hlbWEgZm9yIFBJSSBtaWRkbGV3YXJlXG4qL1xuY29uc3QgY29udGV4dFNjaGVtYSA9IHoub2JqZWN0KHtcblx0YXBwbHlUb0lucHV0OiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuXHRhcHBseVRvT3V0cHV0OiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuXHRhcHBseVRvVG9vbFJlc3VsdHM6IHouYm9vbGVhbigpLm9wdGlvbmFsKClcbn0pO1xuLyoqXG4qIFByb2Nlc3MgY29udGVudCBmb3IgUElJIGRldGVjdGlvbiBhbmQgYXBwbHkgc3RyYXRlZ3lcbiovXG5mdW5jdGlvbiBwcm9jZXNzQ29udGVudChjb250ZW50LCBydWxlKSB7XG5cdGNvbnN0IG1hdGNoZXMgPSBydWxlLmRldGVjdG9yKGNvbnRlbnQpO1xuXHRpZiAobWF0Y2hlcy5sZW5ndGggPT09IDApIHJldHVybiB7XG5cdFx0Y29udGVudCxcblx0XHRtYXRjaGVzOiBbXVxuXHR9O1xuXHRyZXR1cm4ge1xuXHRcdGNvbnRlbnQ6IGFwcGx5U3RyYXRlZ3koY29udGVudCwgbWF0Y2hlcywgcnVsZS5zdHJhdGVneSwgcnVsZS5waWlUeXBlKSxcblx0XHRtYXRjaGVzXG5cdH07XG59XG4vKipcbiogQ3JlYXRlcyBhIG1pZGRsZXdhcmUgdGhhdCBkZXRlY3RzIGFuZCBoYW5kbGVzIHBlcnNvbmFsbHkgaWRlbnRpZmlhYmxlIGluZm9ybWF0aW9uIChQSUkpXG4qIGluIGNvbnZlcnNhdGlvbnMuXG4qXG4qIFRoaXMgbWlkZGxld2FyZSBkZXRlY3RzIGNvbW1vbiBQSUkgdHlwZXMgYW5kIGFwcGxpZXMgY29uZmlndXJhYmxlIHN0cmF0ZWdpZXMgdG8gaGFuZGxlIHRoZW0uXG4qIEl0IGNhbiBkZXRlY3QgZW1haWxzLCBjcmVkaXQgY2FyZHMsIElQIGFkZHJlc3NlcywgTUFDIGFkZHJlc3NlcywgYW5kIFVSTHMgaW4gYm90aCB1c2VyIGlucHV0XG4qIGFuZCBhZ2VudCBvdXRwdXQuXG4qXG4qIEJ1aWx0LWluIFBJSSB0eXBlczpcbiogLSBgZW1haWxgOiBFbWFpbCBhZGRyZXNzZXNcbiogLSBgY3JlZGl0X2NhcmRgOiBDcmVkaXQgY2FyZCBudW1iZXJzICh2YWxpZGF0ZWQgd2l0aCBMdWhuIGFsZ29yaXRobSlcbiogLSBgaXBgOiBJUCBhZGRyZXNzZXMgKHZhbGlkYXRlZClcbiogLSBgbWFjX2FkZHJlc3NgOiBNQUMgYWRkcmVzc2VzXG4qIC0gYHVybGA6IFVSTHMgKGJvdGggYGh0dHBgL2BodHRwc2AgYW5kIGJhcmUgVVJMcylcbipcbiogU3RyYXRlZ2llczpcbiogLSBgYmxvY2tgOiBSYWlzZSBhbiBleGNlcHRpb24gd2hlbiBQSUkgaXMgZGV0ZWN0ZWRcbiogLSBgcmVkYWN0YDogUmVwbGFjZSBQSUkgd2l0aCBgW1JFREFDVEVEX1RZUEVdYCBwbGFjZWhvbGRlcnNcbiogLSBgbWFza2A6IFBhcnRpYWxseSBtYXNrIFBJSSAoZS5nLiwgYCoqKiotKioqKi0qKioqLTEyMzRgIGZvciBjcmVkaXQgY2FyZClcbiogLSBgaGFzaGA6IFJlcGxhY2UgUElJIHdpdGggZGV0ZXJtaW5pc3RpYyBoYXNoIChlLmcuLCBgPGVtYWlsX2hhc2g6YTFiMmMzZDQ+YClcbipcbiogU3RyYXRlZ3kgU2VsZWN0aW9uIEd1aWRlOlxuKiB8IFN0cmF0ZWd5IHwgUHJlc2VydmVzIElkZW50aXR5PyB8IEJlc3QgRm9yICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4qIHwgLS0tLS0tLS0gfCAtLS0tLS0tLS0tLS0tLS0tLS0tIHwgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHxcbiogfCBgYmxvY2tgICB8IE4vQSAgICAgICAgICAgICAgICAgfCBBdm9pZCBQSUkgY29tcGxldGVseSAgICAgICAgICAgICAgICAgICAgfFxuKiB8IGByZWRhY3RgIHwgTm8gICAgICAgICAgICAgICAgICB8IEdlbmVyYWwgY29tcGxpYW5jZSwgbG9nIHNhbml0aXphdGlvbiAgICB8XG4qIHwgYG1hc2tgICAgfCBObyAgICAgICAgICAgICAgICAgIHwgSHVtYW4gcmVhZGFiaWxpdHksIGN1c3RvbWVyIHNlcnZpY2UgVUlzIHxcbiogfCBgaGFzaGAgICB8IFllcyAocHNldWRvbnltb3VzKSAgfCBBbmFseXRpY3MsIGRlYnVnZ2luZyAgICAgICAgICAgICAgICAgICAgfFxuKlxuKiBAcGFyYW0gcGlpVHlwZSAtIFR5cGUgb2YgUElJIHRvIGRldGVjdC4gQ2FuIGJlIGEgYnVpbHQtaW4gdHlwZSAoYGVtYWlsYCwgYGNyZWRpdF9jYXJkYCwgYGlwYCwgYG1hY19hZGRyZXNzYCwgYHVybGApIG9yIGEgY3VzdG9tIHR5cGUgbmFtZS5cbiogQHBhcmFtIG9wdGlvbnMgLSBDb25maWd1cmF0aW9uIG9wdGlvbnNcbiogQHBhcmFtIG9wdGlvbnMuc3RyYXRlZ3kgLSBIb3cgdG8gaGFuZGxlIGRldGVjdGVkIFBJSS4gRGVmYXVsdHMgdG8gYFwicmVkYWN0XCJgLlxuKiBAcGFyYW0gb3B0aW9ucy5kZXRlY3RvciAtIEN1c3RvbSBkZXRlY3RvciBmdW5jdGlvbiBvciByZWdleCBwYXR0ZXJuIHN0cmluZy4gSWYgbm90IHByb3ZpZGVkLCB1c2VzIGJ1aWx0LWluIGRldGVjdG9yIGZvciB0aGUgYHBpaVR5cGVgLlxuKiBAcGFyYW0gb3B0aW9ucy5hcHBseVRvSW5wdXQgLSBXaGV0aGVyIHRvIGNoZWNrIHVzZXIgbWVzc2FnZXMgYmVmb3JlIG1vZGVsIGNhbGwuIERlZmF1bHRzIHRvIGB0cnVlYC5cbiogQHBhcmFtIG9wdGlvbnMuYXBwbHlUb091dHB1dCAtIFdoZXRoZXIgdG8gY2hlY2sgQUkgbWVzc2FnZXMgYWZ0ZXIgbW9kZWwgY2FsbC4gRGVmYXVsdHMgdG8gYGZhbHNlYC5cbiogQHBhcmFtIG9wdGlvbnMuYXBwbHlUb1Rvb2xSZXN1bHRzIC0gV2hldGhlciB0byBjaGVjayB0b29sIHJlc3VsdCBtZXNzYWdlcyBhZnRlciB0b29sIGV4ZWN1dGlvbi4gRGVmYXVsdHMgdG8gYGZhbHNlYC5cbipcbiogQHJldHVybnMgTWlkZGxld2FyZSBpbnN0YW5jZSBmb3IgdXNlIHdpdGggYGNyZWF0ZUFnZW50YFxuKlxuKiBAdGhyb3dzIHtQSUlEZXRlY3Rpb25FcnJvcn0gV2hlbiBQSUkgaXMgZGV0ZWN0ZWQgYW5kIHN0cmF0ZWd5IGlzIGAnYmxvY2snYFxuKiBAdGhyb3dzIHtFcnJvcn0gSWYgYHBpaVR5cGVgIGlzIG5vdCBidWlsdC1pbiBhbmQgbm8gZGV0ZWN0b3IgaXMgcHJvdmlkZWRcbipcbiogQGV4YW1wbGUgQmFzaWMgdXNhZ2VcbiogYGBgdHlwZXNjcmlwdFxuKiBpbXBvcnQgeyBwaWlNaWRkbGV3YXJlIH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKiBpbXBvcnQgeyBjcmVhdGVBZ2VudCB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbipcbiogLy8gUmVkYWN0IGFsbCBlbWFpbHMgaW4gdXNlciBpbnB1dFxuKiBjb25zdCBhZ2VudCA9IGNyZWF0ZUFnZW50KHtcbiogICBtb2RlbDogXCJvcGVuYWk6Z3B0LTRcIixcbiogICBtaWRkbGV3YXJlOiBbXG4qICAgICBwaWlNaWRkbGV3YXJlKFwiZW1haWxcIiwgeyBzdHJhdGVneTogXCJyZWRhY3RcIiB9KSxcbiogICBdLFxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlIERpZmZlcmVudCBzdHJhdGVnaWVzIGZvciBkaWZmZXJlbnQgUElJIHR5cGVzXG4qIGBgYHR5cGVzY3JpcHRcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIG1pZGRsZXdhcmU6IFtcbiogICAgIHBpaU1pZGRsZXdhcmUoXCJjcmVkaXRfY2FyZFwiLCB7IHN0cmF0ZWd5OiBcIm1hc2tcIiB9KSxcbiogICAgIHBpaU1pZGRsZXdhcmUoXCJ1cmxcIiwgeyBzdHJhdGVneTogXCJyZWRhY3RcIiB9KSxcbiogICAgIHBpaU1pZGRsZXdhcmUoXCJpcFwiLCB7IHN0cmF0ZWd5OiBcImhhc2hcIiB9KSxcbiogICBdLFxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlIEN1c3RvbSBQSUkgdHlwZSB3aXRoIHJlZ2V4XG4qIGBgYHR5cGVzY3JpcHRcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00XCIsXG4qICAgbWlkZGxld2FyZTogW1xuKiAgICAgcGlpTWlkZGxld2FyZShcImFwaV9rZXlcIiwge1xuKiAgICAgICBkZXRlY3RvcjogXCJzay1bYS16QS1aMC05XXszMn1cIixcbiogICAgICAgc3RyYXRlZ3k6IFwiYmxvY2tcIixcbiogICAgIH0pLFxuKiAgIF0sXG4qIH0pO1xuKiBgYGBcbipcbiogQHB1YmxpY1xuKi9cbmZ1bmN0aW9uIHBpaU1pZGRsZXdhcmUocGlpVHlwZSwgb3B0aW9ucyA9IHt9KSB7XG5cdGNvbnN0IHsgc3RyYXRlZ3kgPSBcInJlZGFjdFwiLCBkZXRlY3RvciB9ID0gb3B0aW9ucztcblx0Y29uc3QgcmVzb2x2ZWRSdWxlID0gcmVzb2x2ZVJlZGFjdGlvblJ1bGUoe1xuXHRcdHBpaVR5cGUsXG5cdFx0c3RyYXRlZ3ksXG5cdFx0ZGV0ZWN0b3Jcblx0fSk7XG5cdHJldHVybiBjcmVhdGVNaWRkbGV3YXJlKHtcblx0XHRuYW1lOiBgUElJTWlkZGxld2FyZVske3Jlc29sdmVkUnVsZS5waWlUeXBlfV1gLFxuXHRcdGNvbnRleHRTY2hlbWEsXG5cdFx0YmVmb3JlTW9kZWw6IGFzeW5jIChzdGF0ZSwgcnVudGltZSkgPT4ge1xuXHRcdFx0Y29uc3QgYXBwbHlUb0lucHV0ID0gcnVudGltZS5jb250ZXh0LmFwcGx5VG9JbnB1dCA/PyBvcHRpb25zLmFwcGx5VG9JbnB1dCA/PyB0cnVlO1xuXHRcdFx0Y29uc3QgYXBwbHlUb1Rvb2xSZXN1bHRzID0gcnVudGltZS5jb250ZXh0LmFwcGx5VG9Ub29sUmVzdWx0cyA/PyBvcHRpb25zLmFwcGx5VG9Ub29sUmVzdWx0cyA/PyBmYWxzZTtcblx0XHRcdGlmICghYXBwbHlUb0lucHV0ICYmICFhcHBseVRvVG9vbFJlc3VsdHMpIHJldHVybjtcblx0XHRcdGNvbnN0IG1lc3NhZ2VzID0gc3RhdGUubWVzc2FnZXM7XG5cdFx0XHRpZiAoIW1lc3NhZ2VzIHx8IG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXHRcdFx0Y29uc3QgbmV3TWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdFx0bGV0IGFueU1vZGlmaWVkID0gZmFsc2U7XG5cdFx0XHRpZiAoYXBwbHlUb0lucHV0KSB7XG5cdFx0XHRcdGxldCBsYXN0VXNlcklkeCA9IG51bGw7XG5cdFx0XHRcdGZvciAobGV0IGkgPSBtZXNzYWdlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKEh1bWFuTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2VzW2ldKSkge1xuXHRcdFx0XHRcdGxhc3RVc2VySWR4ID0gaTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAobGFzdFVzZXJJZHggIT09IG51bGwpIHtcblx0XHRcdFx0XHRjb25zdCBsYXN0VXNlck1zZyA9IG1lc3NhZ2VzW2xhc3RVc2VySWR4XTtcblx0XHRcdFx0XHRpZiAobGFzdFVzZXJNc2cgJiYgbGFzdFVzZXJNc2cuY29udGVudCkge1xuXHRcdFx0XHRcdFx0Y29uc3QgeyBjb250ZW50OiBuZXdDb250ZW50LCBtYXRjaGVzIH0gPSBwcm9jZXNzQ29udGVudChTdHJpbmcobGFzdFVzZXJNc2cuY29udGVudCksIHJlc29sdmVkUnVsZSk7XG5cdFx0XHRcdFx0XHRpZiAobWF0Y2hlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdG5ld01lc3NhZ2VzW2xhc3RVc2VySWR4XSA9IG5ldyBIdW1hbk1lc3NhZ2Uoe1xuXHRcdFx0XHRcdFx0XHRcdGNvbnRlbnQ6IG5ld0NvbnRlbnQsXG5cdFx0XHRcdFx0XHRcdFx0aWQ6IGxhc3RVc2VyTXNnLmlkLFxuXHRcdFx0XHRcdFx0XHRcdG5hbWU6IGxhc3RVc2VyTXNnLm5hbWVcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGFueU1vZGlmaWVkID0gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmIChhcHBseVRvVG9vbFJlc3VsdHMpIHtcblx0XHRcdFx0bGV0IGxhc3RBaUlkeCA9IG51bGw7XG5cdFx0XHRcdGZvciAobGV0IGkgPSBtZXNzYWdlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKEFJTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2VzW2ldKSkge1xuXHRcdFx0XHRcdGxhc3RBaUlkeCA9IGk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGxhc3RBaUlkeCAhPT0gbnVsbCkgZm9yIChsZXQgaSA9IGxhc3RBaUlkeCArIDE7IGkgPCBtZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGNvbnN0IG1zZyA9IG1lc3NhZ2VzW2ldO1xuXHRcdFx0XHRcdGlmIChUb29sTWVzc2FnZS5pc0luc3RhbmNlKG1zZykpIHtcblx0XHRcdFx0XHRcdGlmICghbXNnLmNvbnRlbnQpIGNvbnRpbnVlO1xuXHRcdFx0XHRcdFx0Y29uc3QgeyBjb250ZW50OiBuZXdDb250ZW50LCBtYXRjaGVzIH0gPSBwcm9jZXNzQ29udGVudChTdHJpbmcobXNnLmNvbnRlbnQpLCByZXNvbHZlZFJ1bGUpO1xuXHRcdFx0XHRcdFx0aWYgKG1hdGNoZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRuZXdNZXNzYWdlc1tpXSA9IG5ldyBUb29sTWVzc2FnZSh7XG5cdFx0XHRcdFx0XHRcdFx0Y29udGVudDogbmV3Q29udGVudCxcblx0XHRcdFx0XHRcdFx0XHRpZDogbXNnLmlkLFxuXHRcdFx0XHRcdFx0XHRcdG5hbWU6IG1zZy5uYW1lLFxuXHRcdFx0XHRcdFx0XHRcdHRvb2xfY2FsbF9pZDogbXNnLnRvb2xfY2FsbF9pZFxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YW55TW9kaWZpZWQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKGFueU1vZGlmaWVkKSByZXR1cm4geyBtZXNzYWdlczogbmV3TWVzc2FnZXMgfTtcblx0XHR9LFxuXHRcdGFmdGVyTW9kZWw6IGFzeW5jIChzdGF0ZSwgcnVudGltZSkgPT4ge1xuXHRcdFx0aWYgKCEocnVudGltZS5jb250ZXh0LmFwcGx5VG9PdXRwdXQgPz8gb3B0aW9ucy5hcHBseVRvT3V0cHV0ID8/IGZhbHNlKSkgcmV0dXJuO1xuXHRcdFx0Y29uc3QgbWVzc2FnZXMgPSBzdGF0ZS5tZXNzYWdlcztcblx0XHRcdGlmICghbWVzc2FnZXMgfHwgbWVzc2FnZXMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cdFx0XHRsZXQgbGFzdEFpSWR4ID0gbnVsbDtcblx0XHRcdGxldCBsYXN0QWlNc2cgPSBudWxsO1xuXHRcdFx0Zm9yIChsZXQgaSA9IG1lc3NhZ2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoQUlNZXNzYWdlLmlzSW5zdGFuY2UobWVzc2FnZXNbaV0pKSB7XG5cdFx0XHRcdGxhc3RBaU1zZyA9IG1lc3NhZ2VzW2ldO1xuXHRcdFx0XHRsYXN0QWlJZHggPSBpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGlmIChsYXN0QWlJZHggPT09IG51bGwgfHwgIWxhc3RBaU1zZyB8fCAhbGFzdEFpTXNnLmNvbnRlbnQpIHJldHVybjtcblx0XHRcdGNvbnN0IHsgY29udGVudDogbmV3Q29udGVudCwgbWF0Y2hlcyB9ID0gcHJvY2Vzc0NvbnRlbnQoU3RyaW5nKGxhc3RBaU1zZy5jb250ZW50KSwgcmVzb2x2ZWRSdWxlKTtcblx0XHRcdGlmIChtYXRjaGVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXHRcdFx0Y29uc3QgdXBkYXRlZE1lc3NhZ2UgPSBuZXcgQUlNZXNzYWdlKHtcblx0XHRcdFx0Y29udGVudDogbmV3Q29udGVudCxcblx0XHRcdFx0aWQ6IGxhc3RBaU1zZy5pZCxcblx0XHRcdFx0bmFtZTogbGFzdEFpTXNnLm5hbWUsXG5cdFx0XHRcdHRvb2xfY2FsbHM6IGxhc3RBaU1zZy50b29sX2NhbGxzXG5cdFx0XHR9KTtcblx0XHRcdGNvbnN0IG5ld01lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzXTtcblx0XHRcdG5ld01lc3NhZ2VzW2xhc3RBaUlkeF0gPSB1cGRhdGVkTWVzc2FnZTtcblx0XHRcdHJldHVybiB7IG1lc3NhZ2VzOiBuZXdNZXNzYWdlcyB9O1xuXHRcdH1cblx0fSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgUElJRGV0ZWN0aW9uRXJyb3IsIGFwcGx5U3RyYXRlZ3ksIGRldGVjdENyZWRpdENhcmQsIGRldGVjdEVtYWlsLCBkZXRlY3RJUCwgZGV0ZWN0TWFjQWRkcmVzcywgZGV0ZWN0VXJsLCBwaWlNaWRkbGV3YXJlLCByZXNvbHZlUmVkYWN0aW9uUnVsZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGlpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/pii.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/piiRedaction.js":
/*!*******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/piiRedaction.js ***!
  \*******************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   piiRedactionMiddleware: () => (/* binding */ piiRedactionMiddleware)\n/* harmony export */ });\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n\n\n//#region src/agents/middleware/piiRedaction.ts\n/**\n* Configuration schema for the Input Guardrails middleware\n*/\nconst contextSchema = zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.object({ rules: zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.record(zod_v3__WEBPACK_IMPORTED_MODULE_2__.z.string(), zod_v3__WEBPACK_IMPORTED_MODULE_2__.z[\"instanceof\"](RegExp).describe(\"Regular expression pattern to match PII\")).optional() });\n/**\n* Generate a unique ID for a redaction\n*/\nfunction generateRedactionId() {\n\treturn Math.random().toString(36).substring(2, 11);\n}\n/**\n* Apply PII detection rules to text with ID tracking\n*/\nfunction applyPIIRules(text, rules, redactionMap) {\n\tlet processedText = text;\n\tfor (const [name, pattern] of Object.entries(rules)) {\n\t\tconst replacement = name.toUpperCase().replace(/[^a-zA-Z0-9_-]/g, \"\");\n\t\tprocessedText = processedText.replace(pattern, (match) => {\n\t\t\tconst id = generateRedactionId();\n\t\t\tredactionMap[id] = match;\n\t\t\treturn `[REDACTED_${replacement}_${id}]`;\n\t\t});\n\t}\n\treturn processedText;\n}\n/**\n* Process a single human message for PII detection and redaction\n*/\nasync function processMessage(message, config) {\n\t/**\n\t* handle basic message types\n\t*/\n\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.HumanMessage.isInstance(message) || _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.ToolMessage.isInstance(message) || _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.SystemMessage.isInstance(message)) {\n\t\tconst content = message.content;\n\t\tconst processedContent = await applyPIIRules(content, config.rules, config.redactionMap);\n\t\tif (processedContent !== content) {\n\t\t\tconst MessageConstructor = Object.getPrototypeOf(message).constructor;\n\t\t\treturn new MessageConstructor({\n\t\t\t\t...message,\n\t\t\t\tcontent: processedContent\n\t\t\t});\n\t\t}\n\t\treturn message;\n\t}\n\t/**\n\t* Handle AI messages\n\t*/\n\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance(message)) {\n\t\tconst content = typeof message.content === \"string\" ? message.content : JSON.stringify(message.content);\n\t\tconst toolCalls = JSON.stringify(message.tool_calls);\n\t\tconst processedContent = await applyPIIRules(content, config.rules, config.redactionMap);\n\t\tconst processedToolCalls = await applyPIIRules(toolCalls, config.rules, config.redactionMap);\n\t\tif (processedContent !== content || processedToolCalls !== toolCalls) return new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage({\n\t\t\t...message,\n\t\t\tcontent: typeof message.content === \"string\" ? processedContent : JSON.parse(processedContent),\n\t\t\ttool_calls: JSON.parse(processedToolCalls)\n\t\t});\n\t\treturn message;\n\t}\n\tthrow new Error(`Unsupported message type: ${message.type}`);\n}\n/**\n* Restore original values from redacted text using the redaction map\n*/\nfunction restoreRedactedValues(text, redactionMap) {\n\tlet restoredText = text;\n\trestoredText = restoredText.replace(/\\[REDACTED_[A-Z_]+_(\\w+)\\]/g, (match, id) => {\n\t\tif (redactionMap[id]) return redactionMap[id];\n\t\treturn match;\n\t});\n\treturn restoredText;\n}\n/**\n* Restore redacted values in a message (creates a new message object)\n*/\nfunction restoreMessage(message, redactionMap) {\n\t/**\n\t* handle basic message types\n\t*/\n\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.HumanMessage.isInstance(message) || _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.ToolMessage.isInstance(message) || _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.SystemMessage.isInstance(message)) {\n\t\tconst content = message.content;\n\t\tconst restoredContent = restoreRedactedValues(content, redactionMap);\n\t\tif (restoredContent !== content) {\n\t\t\tconst MessageConstructor = Object.getPrototypeOf(message).constructor;\n\t\t\treturn {\n\t\t\t\tmessage: new MessageConstructor({\n\t\t\t\t\t...message,\n\t\t\t\t\tcontent: restoredContent\n\t\t\t\t}),\n\t\t\t\tchanged: true\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tmessage,\n\t\t\tchanged: false\n\t\t};\n\t}\n\t/**\n\t* handle AI messages\n\t*/\n\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance(message)) {\n\t\tconst content = typeof message.content === \"string\" ? message.content : JSON.stringify(message.content);\n\t\tconst toolCalls = JSON.stringify(message.tool_calls);\n\t\tconst processedContent = restoreRedactedValues(content, redactionMap);\n\t\tconst processedToolCalls = restoreRedactedValues(toolCalls, redactionMap);\n\t\tif (processedContent !== content || processedToolCalls !== toolCalls) return {\n\t\t\tmessage: new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage({\n\t\t\t\t...message,\n\t\t\t\tcontent: typeof message.content === \"string\" ? processedContent : JSON.parse(processedContent),\n\t\t\t\ttool_calls: JSON.parse(processedToolCalls)\n\t\t\t}),\n\t\t\tchanged: true\n\t\t};\n\t\treturn {\n\t\t\tmessage,\n\t\t\tchanged: false\n\t\t};\n\t}\n\tthrow new Error(`Unsupported message type: ${message.type}`);\n}\n/**\n* Creates a middleware that detects and redacts personally identifiable information (PII)\n* from messages before they are sent to model providers, and restores original values\n* in model responses for tool execution.\n*\n* ## Mechanism\n*\n* The middleware intercepts agent execution at two points:\n*\n* ### Request Phase (`wrapModelCall`)\n* - Applies regex-based pattern matching to all message content (HumanMessage, ToolMessage, SystemMessage, AIMessage)\n* - Processes both message text and AIMessage tool call arguments\n* - Each matched pattern generates:\n*   - Unique identifier: `generateRedactionId()` â `\"abc123\"`\n*   - Redaction marker: `[REDACTED_{RULE_NAME}_{ID}]` â `\"[REDACTED_SSN_abc123]\"`\n*   - Redaction map entry: `{ \"abc123\": \"123-45-6789\" }`\n* - Returns modified request with redacted message content\n*\n* ### Response Phase (`afterModel`)\n* - Scans AIMessage responses for redaction markers matching pattern: `/\\[REDACTED_[A-Z_]+_(\\w+)\\]/g`\n* - Replaces markers with original values from redaction map\n* - Handles both standard responses and structured output (via tool calls or JSON content)\n* - For structured output, restores values in both the tool call arguments and the `structuredResponse` state field\n* - Returns new message instances via RemoveMessage/AIMessage to update state\n*\n* ## Data Flow\n*\n* ```\n* User Input: \"My SSN is 123-45-6789\"\n*     â [beforeModel]\n* Model Request: \"My SSN is [REDACTED_SSN_abc123]\"\n*     â [model invocation]\n* Model Response: tool_call({ \"ssn\": \"[REDACTED_SSN_abc123]\" })\n*     â [afterModel]\n* Tool Execution: tool({ \"ssn\": \"123-45-6789\" })\n* ```\n*\n* ## Limitations\n*\n* This middleware provides model provider isolation only. PII may still be present in:\n* - LangGraph state checkpoints (memory, databases)\n* - Network traffic between client and application server\n* - Application logs and trace data\n* - Tool execution arguments and responses\n* - Final agent output\n*\n* For comprehensive PII protection, implement additional controls at the application,\n* network, and storage layers.\n*\n* @param options - Configuration options\n* @param options.rules - Record of detection rules mapping rule names to regex patterns.\n*   Rule names are normalized to uppercase and used in redaction markers.\n*   Patterns must use the global flag (`/pattern/g`) to match all occurrences.\n*\n* @returns Middleware instance for use with `createAgent`\n*\n* @example Basic usage with custom rules\n* ```typescript\n* import { piiRedactionMiddleware } from \"langchain\";\n* import { createAgent } from \"langchain\";\n* import { tool } from \"@langchain/core/tools\";\n* import { z } from \"zod/v3\";\n*\n* const PII_RULES = {\n*   ssn: /\\b\\d{3}-?\\d{2}-?\\d{4}\\b/g,\n*   email: /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}\\b/g,\n*   phone: /\\b\\d{3}[-.]?\\d{3}[-.]?\\d{4}\\b/g,\n* };\n*\n* const lookupUser = tool(async ({ ssn }) => {\n*   // Receives original value: \"123-45-6789\"\n*   return { name: \"John Doe\", account: \"active\" };\n* }, {\n*   name: \"lookup_user\",\n*   description: \"Look up user by SSN\",\n*   schema: z.object({ ssn: z.string() })\n* });\n*\n* const agent = createAgent({\n*   model: new ChatOpenAI({ model: \"gpt-4\" }),\n*   tools: [lookupUser],\n*   middleware: [piiRedactionMiddleware({ rules: PII_RULES })]\n* });\n*\n* const result = await agent.invoke({\n*   messages: [new HumanMessage(\"Look up SSN 123-45-6789\")]\n* });\n* // Model request: \"Look up SSN [REDACTED_SSN_abc123]\"\n* // Model response: tool_call({ \"ssn\": \"[REDACTED_SSN_abc123]\" })\n* // Tool receives: { \"ssn\": \"123-45-6789\" }\n* ```\n*\n* @example Runtime rule configuration via context\n* ```typescript\n* const agent = createAgent({\n*   model: new ChatOpenAI({ model: \"gpt-4\" }),\n*   tools: [someTool],\n*   middleware: [piiRedactionMiddleware()]\n* });\n*\n* // Configure rules at runtime via middleware context\n* const result = await agent.invoke(\n*   { messages: [new HumanMessage(\"...\")] },\n*   {\n*     configurable: {\n*       PIIRedactionMiddleware: {\n*         rules: {\n*           ssn: /\\b\\d{3}-?\\d{2}-?\\d{4}\\b/g,\n*           email: /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}\\b/g,\n*         }\n*       }\n*     }\n*   }\n* );\n* ```\n*\n* @example Custom rule patterns\n* ```typescript\n* const customRules = {\n*   employee_id: /EMP-\\d{6}/g,\n*   api_key: /sk-[a-zA-Z0-9]{32}/g,\n*   credit_card: /\\b\\d{4}[- ]?\\d{4}[- ]?\\d{4}[- ]?\\d{4}\\b/g,\n* };\n*\n* const middleware = piiRedactionMiddleware({ rules: customRules });\n* // Generates markers like: [REDACTED_EMPLOYEE_ID_xyz789]\n* ```\n*\n* @deprecated\n*/\nfunction piiRedactionMiddleware(options = {}) {\n\tconst redactionMap = {};\n\tconsole.warn(\"DEPRECATED: piiRedactionMiddleware is deprecated. Please use piiMiddleware instead, go to https://docs.langchain.com/oss/javascript/langchain/middleware/built-in#pii-detection for more information.\");\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)({\n\t\tname: \"PIIRedactionMiddleware\",\n\t\tcontextSchema,\n\t\twrapModelCall: async (request, handler) => {\n\t\t\t/**\n\t\t\t* Merge options with context, following bigTool.ts pattern\n\t\t\t*/\n\t\t\tconst rules = request.runtime.context.rules ?? options.rules ?? {};\n\t\t\t/**\n\t\t\t* If no rules are provided, skip processing\n\t\t\t*/\n\t\t\tif (Object.keys(rules).length === 0) return handler(request);\n\t\t\tconst processedMessages = await Promise.all(request.state.messages.map((message) => processMessage(message, {\n\t\t\t\trules,\n\t\t\t\tredactionMap\n\t\t\t})));\n\t\t\treturn handler({\n\t\t\t\t...request,\n\t\t\t\tmessages: processedMessages\n\t\t\t});\n\t\t},\n\t\tafterModel: async (state) => {\n\t\t\t/**\n\t\t\t* If no redactions were made, skip processing\n\t\t\t*/\n\t\t\tif (Object.keys(redactionMap).length === 0) return;\n\t\t\tconst lastMessage = state.messages.at(-1);\n\t\t\tif (!_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance(lastMessage)) return;\n\t\t\t/**\n\t\t\t* In cases where we do structured output via tool calls, we also have to look at the second last message\n\t\t\t* as we add a custom last message to the messages array.\n\t\t\t*/\n\t\t\tconst secondLastMessage = state.messages.at(-2);\n\t\t\tconst { message: restoredLastMessage, changed } = restoreMessage(lastMessage, redactionMap);\n\t\t\tif (!changed) return;\n\t\t\t/**\n\t\t\t* Identify if the last message is a structured response and restore the values if so\n\t\t\t*/\n\t\t\tlet structuredResponse;\n\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance(lastMessage) && lastMessage?.tool_calls?.length === 0 && typeof lastMessage.content === \"string\" && lastMessage.content.startsWith(\"{\") && lastMessage.content.endsWith(\"}\")) try {\n\t\t\t\tstructuredResponse = JSON.parse(restoreRedactedValues(lastMessage.content, redactionMap));\n\t\t\t} catch {}\n\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance(secondLastMessage) && secondLastMessage?.tool_calls?.length !== 0 && secondLastMessage?.tool_calls?.some((call) => call.name.startsWith(\"extract-\"))) {\n\t\t\t\tconst { message: restoredSecondLastMessage, changed: changedSecondLastMessage } = restoreMessage(secondLastMessage, redactionMap);\n\t\t\t\tconst structuredResponseRedacted = secondLastMessage.tool_calls?.find((call) => call.name.startsWith(\"extract-\"))?.args;\n\t\t\t\tconst structuredResponse = structuredResponseRedacted ? JSON.parse(restoreRedactedValues(JSON.stringify(structuredResponseRedacted), redactionMap)) : void 0;\n\t\t\t\tif (changed || changedSecondLastMessage) return {\n\t\t\t\t\t...state,\n\t\t\t\t\t...structuredResponse ? { structuredResponse } : {},\n\t\t\t\t\tmessages: [\n\t\t\t\t\t\tnew _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.RemoveMessage({ id: secondLastMessage.id }),\n\t\t\t\t\t\tnew _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.RemoveMessage({ id: lastMessage.id }),\n\t\t\t\t\t\trestoredSecondLastMessage,\n\t\t\t\t\t\trestoredLastMessage\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\t...structuredResponse ? { structuredResponse } : {},\n\t\t\t\tmessages: [new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.RemoveMessage({ id: lastMessage.id }), restoredLastMessage]\n\t\t\t};\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=piiRedaction.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9waWlSZWRhY3Rpb24uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFvRDtBQUMwRDtBQUNuRjs7QUFFM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsNENBQVEsR0FBRyxPQUFPLDRDQUFRLENBQUMsNENBQVEsSUFBSSxtREFBWSwwRUFBMEU7QUFDbko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsWUFBWSxHQUFHLEdBQUc7QUFDekMsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxrRUFBWSx3QkFBd0IsaUVBQVcsd0JBQXdCLG1FQUFhO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssK0RBQVM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1GQUFtRiwrREFBUztBQUM1RjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLDhDQUE4QyxhQUFhO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLGtFQUFZLHdCQUF3QixpRUFBVyx3QkFBd0IsbUVBQWE7QUFDekY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSywrREFBUztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsK0RBQVM7QUFDekI7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGFBQWE7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFVBQVUsRUFBRSxHQUFHO0FBQ25ELDhCQUE4Qix5QkFBeUI7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsZ0NBQWdDO0FBQzlEO0FBQ0EseUJBQXlCLHNCQUFzQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx5QkFBeUI7QUFDcEMsV0FBVyxjQUFjO0FBQ3pCLFdBQVcsT0FBTztBQUNsQixXQUFXLElBQUk7QUFDZjtBQUNBO0FBQ0EsZUFBZSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUU7QUFDL0IseURBQXlELEdBQUc7QUFDNUQsaUJBQWlCLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRTtBQUN2QztBQUNBO0FBQ0EsbUNBQW1DLEtBQUs7QUFDeEM7QUFDQSxhQUFhO0FBQ2IsR0FBRztBQUNIO0FBQ0E7QUFDQSx1QkFBdUIsaUJBQWlCO0FBQ3hDLEdBQUc7QUFDSDtBQUNBO0FBQ0EsNEJBQTRCLGdCQUFnQjtBQUM1QztBQUNBLDBDQUEwQyxrQkFBa0I7QUFDNUQsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLGlDQUFpQyxnQ0FBZ0M7QUFDakUsc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsZ0JBQWdCO0FBQzVDO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBTSxxQ0FBcUM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFO0FBQ3ZDLGlFQUFpRSxHQUFHO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLEVBQUU7QUFDM0IsNkJBQTZCLEdBQUc7QUFDaEMsdUJBQXVCLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUU7QUFDdkQ7QUFDQTtBQUNBLDhDQUE4QyxvQkFBb0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0EsUUFBUSxnRUFBZ0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQVM7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsd0NBQXdDO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLCtEQUFTLGlKQUFpSixxQ0FBcUM7QUFDdE07QUFDQSxLQUFLO0FBQ0wsT0FBTywrREFBUztBQUNoQixZQUFZLHdFQUF3RTtBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixxQkFBcUIsSUFBSTtBQUN4RDtBQUNBLFVBQVUsbUVBQWEsR0FBRywwQkFBMEI7QUFDcEQsVUFBVSxtRUFBYSxHQUFHLG9CQUFvQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixxQkFBcUIsSUFBSTtBQUN2RCxtQkFBbUIsbUVBQWEsR0FBRyxvQkFBb0I7QUFDdkQ7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNrQztBQUNsQyIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL25vZGVfbW9kdWxlcy8ucG5wbS9sYW5nY2hhaW5AMS4yLjI2X0BsYW5nY2hhaW4rY29yZUAxLjEuMjhfb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX19vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fcmVfZXgyYjV5M3R6ZjdoMmN4bW11aTVxb2lhc3kvbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2FnZW50cy9taWRkbGV3YXJlL3BpaVJlZGFjdGlvbi5qcz9kYTU4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUgfSBmcm9tIFwiLi4vbWlkZGxld2FyZS5qc1wiO1xuaW1wb3J0IHsgQUlNZXNzYWdlLCBIdW1hbk1lc3NhZ2UsIFJlbW92ZU1lc3NhZ2UsIFN5c3RlbU1lc3NhZ2UsIFRvb2xNZXNzYWdlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9tZXNzYWdlc1wiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2QvdjNcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvbWlkZGxld2FyZS9waWlSZWRhY3Rpb24udHNcbi8qKlxuKiBDb25maWd1cmF0aW9uIHNjaGVtYSBmb3IgdGhlIElucHV0IEd1YXJkcmFpbHMgbWlkZGxld2FyZVxuKi9cbmNvbnN0IGNvbnRleHRTY2hlbWEgPSB6Lm9iamVjdCh7IHJ1bGVzOiB6LnJlY29yZCh6LnN0cmluZygpLCB6Lmluc3RhbmNlb2YoUmVnRXhwKS5kZXNjcmliZShcIlJlZ3VsYXIgZXhwcmVzc2lvbiBwYXR0ZXJuIHRvIG1hdGNoIFBJSVwiKSkub3B0aW9uYWwoKSB9KTtcbi8qKlxuKiBHZW5lcmF0ZSBhIHVuaXF1ZSBJRCBmb3IgYSByZWRhY3Rpb25cbiovXG5mdW5jdGlvbiBnZW5lcmF0ZVJlZGFjdGlvbklkKCkge1xuXHRyZXR1cm4gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDExKTtcbn1cbi8qKlxuKiBBcHBseSBQSUkgZGV0ZWN0aW9uIHJ1bGVzIHRvIHRleHQgd2l0aCBJRCB0cmFja2luZ1xuKi9cbmZ1bmN0aW9uIGFwcGx5UElJUnVsZXModGV4dCwgcnVsZXMsIHJlZGFjdGlvbk1hcCkge1xuXHRsZXQgcHJvY2Vzc2VkVGV4dCA9IHRleHQ7XG5cdGZvciAoY29uc3QgW25hbWUsIHBhdHRlcm5dIG9mIE9iamVjdC5lbnRyaWVzKHJ1bGVzKSkge1xuXHRcdGNvbnN0IHJlcGxhY2VtZW50ID0gbmFtZS50b1VwcGVyQ2FzZSgpLnJlcGxhY2UoL1teYS16QS1aMC05Xy1dL2csIFwiXCIpO1xuXHRcdHByb2Nlc3NlZFRleHQgPSBwcm9jZXNzZWRUZXh0LnJlcGxhY2UocGF0dGVybiwgKG1hdGNoKSA9PiB7XG5cdFx0XHRjb25zdCBpZCA9IGdlbmVyYXRlUmVkYWN0aW9uSWQoKTtcblx0XHRcdHJlZGFjdGlvbk1hcFtpZF0gPSBtYXRjaDtcblx0XHRcdHJldHVybiBgW1JFREFDVEVEXyR7cmVwbGFjZW1lbnR9XyR7aWR9XWA7XG5cdFx0fSk7XG5cdH1cblx0cmV0dXJuIHByb2Nlc3NlZFRleHQ7XG59XG4vKipcbiogUHJvY2VzcyBhIHNpbmdsZSBodW1hbiBtZXNzYWdlIGZvciBQSUkgZGV0ZWN0aW9uIGFuZCByZWRhY3Rpb25cbiovXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzTWVzc2FnZShtZXNzYWdlLCBjb25maWcpIHtcblx0LyoqXG5cdCogaGFuZGxlIGJhc2ljIG1lc3NhZ2UgdHlwZXNcblx0Ki9cblx0aWYgKEh1bWFuTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2UpIHx8IFRvb2xNZXNzYWdlLmlzSW5zdGFuY2UobWVzc2FnZSkgfHwgU3lzdGVtTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2UpKSB7XG5cdFx0Y29uc3QgY29udGVudCA9IG1lc3NhZ2UuY29udGVudDtcblx0XHRjb25zdCBwcm9jZXNzZWRDb250ZW50ID0gYXdhaXQgYXBwbHlQSUlSdWxlcyhjb250ZW50LCBjb25maWcucnVsZXMsIGNvbmZpZy5yZWRhY3Rpb25NYXApO1xuXHRcdGlmIChwcm9jZXNzZWRDb250ZW50ICE9PSBjb250ZW50KSB7XG5cdFx0XHRjb25zdCBNZXNzYWdlQ29uc3RydWN0b3IgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YobWVzc2FnZSkuY29uc3RydWN0b3I7XG5cdFx0XHRyZXR1cm4gbmV3IE1lc3NhZ2VDb25zdHJ1Y3Rvcih7XG5cdFx0XHRcdC4uLm1lc3NhZ2UsXG5cdFx0XHRcdGNvbnRlbnQ6IHByb2Nlc3NlZENvbnRlbnRcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRyZXR1cm4gbWVzc2FnZTtcblx0fVxuXHQvKipcblx0KiBIYW5kbGUgQUkgbWVzc2FnZXNcblx0Ki9cblx0aWYgKEFJTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2UpKSB7XG5cdFx0Y29uc3QgY29udGVudCA9IHR5cGVvZiBtZXNzYWdlLmNvbnRlbnQgPT09IFwic3RyaW5nXCIgPyBtZXNzYWdlLmNvbnRlbnQgOiBKU09OLnN0cmluZ2lmeShtZXNzYWdlLmNvbnRlbnQpO1xuXHRcdGNvbnN0IHRvb2xDYWxscyA9IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UudG9vbF9jYWxscyk7XG5cdFx0Y29uc3QgcHJvY2Vzc2VkQ29udGVudCA9IGF3YWl0IGFwcGx5UElJUnVsZXMoY29udGVudCwgY29uZmlnLnJ1bGVzLCBjb25maWcucmVkYWN0aW9uTWFwKTtcblx0XHRjb25zdCBwcm9jZXNzZWRUb29sQ2FsbHMgPSBhd2FpdCBhcHBseVBJSVJ1bGVzKHRvb2xDYWxscywgY29uZmlnLnJ1bGVzLCBjb25maWcucmVkYWN0aW9uTWFwKTtcblx0XHRpZiAocHJvY2Vzc2VkQ29udGVudCAhPT0gY29udGVudCB8fCBwcm9jZXNzZWRUb29sQ2FsbHMgIT09IHRvb2xDYWxscykgcmV0dXJuIG5ldyBBSU1lc3NhZ2Uoe1xuXHRcdFx0Li4ubWVzc2FnZSxcblx0XHRcdGNvbnRlbnQ6IHR5cGVvZiBtZXNzYWdlLmNvbnRlbnQgPT09IFwic3RyaW5nXCIgPyBwcm9jZXNzZWRDb250ZW50IDogSlNPTi5wYXJzZShwcm9jZXNzZWRDb250ZW50KSxcblx0XHRcdHRvb2xfY2FsbHM6IEpTT04ucGFyc2UocHJvY2Vzc2VkVG9vbENhbGxzKVxuXHRcdH0pO1xuXHRcdHJldHVybiBtZXNzYWdlO1xuXHR9XG5cdHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgbWVzc2FnZSB0eXBlOiAke21lc3NhZ2UudHlwZX1gKTtcbn1cbi8qKlxuKiBSZXN0b3JlIG9yaWdpbmFsIHZhbHVlcyBmcm9tIHJlZGFjdGVkIHRleHQgdXNpbmcgdGhlIHJlZGFjdGlvbiBtYXBcbiovXG5mdW5jdGlvbiByZXN0b3JlUmVkYWN0ZWRWYWx1ZXModGV4dCwgcmVkYWN0aW9uTWFwKSB7XG5cdGxldCByZXN0b3JlZFRleHQgPSB0ZXh0O1xuXHRyZXN0b3JlZFRleHQgPSByZXN0b3JlZFRleHQucmVwbGFjZSgvXFxbUkVEQUNURURfW0EtWl9dK18oXFx3KylcXF0vZywgKG1hdGNoLCBpZCkgPT4ge1xuXHRcdGlmIChyZWRhY3Rpb25NYXBbaWRdKSByZXR1cm4gcmVkYWN0aW9uTWFwW2lkXTtcblx0XHRyZXR1cm4gbWF0Y2g7XG5cdH0pO1xuXHRyZXR1cm4gcmVzdG9yZWRUZXh0O1xufVxuLyoqXG4qIFJlc3RvcmUgcmVkYWN0ZWQgdmFsdWVzIGluIGEgbWVzc2FnZSAoY3JlYXRlcyBhIG5ldyBtZXNzYWdlIG9iamVjdClcbiovXG5mdW5jdGlvbiByZXN0b3JlTWVzc2FnZShtZXNzYWdlLCByZWRhY3Rpb25NYXApIHtcblx0LyoqXG5cdCogaGFuZGxlIGJhc2ljIG1lc3NhZ2UgdHlwZXNcblx0Ki9cblx0aWYgKEh1bWFuTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2UpIHx8IFRvb2xNZXNzYWdlLmlzSW5zdGFuY2UobWVzc2FnZSkgfHwgU3lzdGVtTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2UpKSB7XG5cdFx0Y29uc3QgY29udGVudCA9IG1lc3NhZ2UuY29udGVudDtcblx0XHRjb25zdCByZXN0b3JlZENvbnRlbnQgPSByZXN0b3JlUmVkYWN0ZWRWYWx1ZXMoY29udGVudCwgcmVkYWN0aW9uTWFwKTtcblx0XHRpZiAocmVzdG9yZWRDb250ZW50ICE9PSBjb250ZW50KSB7XG5cdFx0XHRjb25zdCBNZXNzYWdlQ29uc3RydWN0b3IgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YobWVzc2FnZSkuY29uc3RydWN0b3I7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRtZXNzYWdlOiBuZXcgTWVzc2FnZUNvbnN0cnVjdG9yKHtcblx0XHRcdFx0XHQuLi5tZXNzYWdlLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IHJlc3RvcmVkQ29udGVudFxuXHRcdFx0XHR9KSxcblx0XHRcdFx0Y2hhbmdlZDogdHJ1ZVxuXHRcdFx0fTtcblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdG1lc3NhZ2UsXG5cdFx0XHRjaGFuZ2VkOiBmYWxzZVxuXHRcdH07XG5cdH1cblx0LyoqXG5cdCogaGFuZGxlIEFJIG1lc3NhZ2VzXG5cdCovXG5cdGlmIChBSU1lc3NhZ2UuaXNJbnN0YW5jZShtZXNzYWdlKSkge1xuXHRcdGNvbnN0IGNvbnRlbnQgPSB0eXBlb2YgbWVzc2FnZS5jb250ZW50ID09PSBcInN0cmluZ1wiID8gbWVzc2FnZS5jb250ZW50IDogSlNPTi5zdHJpbmdpZnkobWVzc2FnZS5jb250ZW50KTtcblx0XHRjb25zdCB0b29sQ2FsbHMgPSBKU09OLnN0cmluZ2lmeShtZXNzYWdlLnRvb2xfY2FsbHMpO1xuXHRcdGNvbnN0IHByb2Nlc3NlZENvbnRlbnQgPSByZXN0b3JlUmVkYWN0ZWRWYWx1ZXMoY29udGVudCwgcmVkYWN0aW9uTWFwKTtcblx0XHRjb25zdCBwcm9jZXNzZWRUb29sQ2FsbHMgPSByZXN0b3JlUmVkYWN0ZWRWYWx1ZXModG9vbENhbGxzLCByZWRhY3Rpb25NYXApO1xuXHRcdGlmIChwcm9jZXNzZWRDb250ZW50ICE9PSBjb250ZW50IHx8IHByb2Nlc3NlZFRvb2xDYWxscyAhPT0gdG9vbENhbGxzKSByZXR1cm4ge1xuXHRcdFx0bWVzc2FnZTogbmV3IEFJTWVzc2FnZSh7XG5cdFx0XHRcdC4uLm1lc3NhZ2UsXG5cdFx0XHRcdGNvbnRlbnQ6IHR5cGVvZiBtZXNzYWdlLmNvbnRlbnQgPT09IFwic3RyaW5nXCIgPyBwcm9jZXNzZWRDb250ZW50IDogSlNPTi5wYXJzZShwcm9jZXNzZWRDb250ZW50KSxcblx0XHRcdFx0dG9vbF9jYWxsczogSlNPTi5wYXJzZShwcm9jZXNzZWRUb29sQ2FsbHMpXG5cdFx0XHR9KSxcblx0XHRcdGNoYW5nZWQ6IHRydWVcblx0XHR9O1xuXHRcdHJldHVybiB7XG5cdFx0XHRtZXNzYWdlLFxuXHRcdFx0Y2hhbmdlZDogZmFsc2Vcblx0XHR9O1xuXHR9XG5cdHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgbWVzc2FnZSB0eXBlOiAke21lc3NhZ2UudHlwZX1gKTtcbn1cbi8qKlxuKiBDcmVhdGVzIGEgbWlkZGxld2FyZSB0aGF0IGRldGVjdHMgYW5kIHJlZGFjdHMgcGVyc29uYWxseSBpZGVudGlmaWFibGUgaW5mb3JtYXRpb24gKFBJSSlcbiogZnJvbSBtZXNzYWdlcyBiZWZvcmUgdGhleSBhcmUgc2VudCB0byBtb2RlbCBwcm92aWRlcnMsIGFuZCByZXN0b3JlcyBvcmlnaW5hbCB2YWx1ZXNcbiogaW4gbW9kZWwgcmVzcG9uc2VzIGZvciB0b29sIGV4ZWN1dGlvbi5cbipcbiogIyMgTWVjaGFuaXNtXG4qXG4qIFRoZSBtaWRkbGV3YXJlIGludGVyY2VwdHMgYWdlbnQgZXhlY3V0aW9uIGF0IHR3byBwb2ludHM6XG4qXG4qICMjIyBSZXF1ZXN0IFBoYXNlIChgd3JhcE1vZGVsQ2FsbGApXG4qIC0gQXBwbGllcyByZWdleC1iYXNlZCBwYXR0ZXJuIG1hdGNoaW5nIHRvIGFsbCBtZXNzYWdlIGNvbnRlbnQgKEh1bWFuTWVzc2FnZSwgVG9vbE1lc3NhZ2UsIFN5c3RlbU1lc3NhZ2UsIEFJTWVzc2FnZSlcbiogLSBQcm9jZXNzZXMgYm90aCBtZXNzYWdlIHRleHQgYW5kIEFJTWVzc2FnZSB0b29sIGNhbGwgYXJndW1lbnRzXG4qIC0gRWFjaCBtYXRjaGVkIHBhdHRlcm4gZ2VuZXJhdGVzOlxuKiAgIC0gVW5pcXVlIGlkZW50aWZpZXI6IGBnZW5lcmF0ZVJlZGFjdGlvbklkKClgIOKGkiBgXCJhYmMxMjNcImBcbiogICAtIFJlZGFjdGlvbiBtYXJrZXI6IGBbUkVEQUNURURfe1JVTEVfTkFNRX1fe0lEfV1gIOKGkiBgXCJbUkVEQUNURURfU1NOX2FiYzEyM11cImBcbiogICAtIFJlZGFjdGlvbiBtYXAgZW50cnk6IGB7IFwiYWJjMTIzXCI6IFwiMTIzLTQ1LTY3ODlcIiB9YFxuKiAtIFJldHVybnMgbW9kaWZpZWQgcmVxdWVzdCB3aXRoIHJlZGFjdGVkIG1lc3NhZ2UgY29udGVudFxuKlxuKiAjIyMgUmVzcG9uc2UgUGhhc2UgKGBhZnRlck1vZGVsYClcbiogLSBTY2FucyBBSU1lc3NhZ2UgcmVzcG9uc2VzIGZvciByZWRhY3Rpb24gbWFya2VycyBtYXRjaGluZyBwYXR0ZXJuOiBgL1xcW1JFREFDVEVEX1tBLVpfXStfKFxcdyspXFxdL2dgXG4qIC0gUmVwbGFjZXMgbWFya2VycyB3aXRoIG9yaWdpbmFsIHZhbHVlcyBmcm9tIHJlZGFjdGlvbiBtYXBcbiogLSBIYW5kbGVzIGJvdGggc3RhbmRhcmQgcmVzcG9uc2VzIGFuZCBzdHJ1Y3R1cmVkIG91dHB1dCAodmlhIHRvb2wgY2FsbHMgb3IgSlNPTiBjb250ZW50KVxuKiAtIEZvciBzdHJ1Y3R1cmVkIG91dHB1dCwgcmVzdG9yZXMgdmFsdWVzIGluIGJvdGggdGhlIHRvb2wgY2FsbCBhcmd1bWVudHMgYW5kIHRoZSBgc3RydWN0dXJlZFJlc3BvbnNlYCBzdGF0ZSBmaWVsZFxuKiAtIFJldHVybnMgbmV3IG1lc3NhZ2UgaW5zdGFuY2VzIHZpYSBSZW1vdmVNZXNzYWdlL0FJTWVzc2FnZSB0byB1cGRhdGUgc3RhdGVcbipcbiogIyMgRGF0YSBGbG93XG4qXG4qIGBgYFxuKiBVc2VyIElucHV0OiBcIk15IFNTTiBpcyAxMjMtNDUtNjc4OVwiXG4qICAgICDihpMgW2JlZm9yZU1vZGVsXVxuKiBNb2RlbCBSZXF1ZXN0OiBcIk15IFNTTiBpcyBbUkVEQUNURURfU1NOX2FiYzEyM11cIlxuKiAgICAg4oaTIFttb2RlbCBpbnZvY2F0aW9uXVxuKiBNb2RlbCBSZXNwb25zZTogdG9vbF9jYWxsKHsgXCJzc25cIjogXCJbUkVEQUNURURfU1NOX2FiYzEyM11cIiB9KVxuKiAgICAg4oaTIFthZnRlck1vZGVsXVxuKiBUb29sIEV4ZWN1dGlvbjogdG9vbCh7IFwic3NuXCI6IFwiMTIzLTQ1LTY3ODlcIiB9KVxuKiBgYGBcbipcbiogIyMgTGltaXRhdGlvbnNcbipcbiogVGhpcyBtaWRkbGV3YXJlIHByb3ZpZGVzIG1vZGVsIHByb3ZpZGVyIGlzb2xhdGlvbiBvbmx5LiBQSUkgbWF5IHN0aWxsIGJlIHByZXNlbnQgaW46XG4qIC0gTGFuZ0dyYXBoIHN0YXRlIGNoZWNrcG9pbnRzIChtZW1vcnksIGRhdGFiYXNlcylcbiogLSBOZXR3b3JrIHRyYWZmaWMgYmV0d2VlbiBjbGllbnQgYW5kIGFwcGxpY2F0aW9uIHNlcnZlclxuKiAtIEFwcGxpY2F0aW9uIGxvZ3MgYW5kIHRyYWNlIGRhdGFcbiogLSBUb29sIGV4ZWN1dGlvbiBhcmd1bWVudHMgYW5kIHJlc3BvbnNlc1xuKiAtIEZpbmFsIGFnZW50IG91dHB1dFxuKlxuKiBGb3IgY29tcHJlaGVuc2l2ZSBQSUkgcHJvdGVjdGlvbiwgaW1wbGVtZW50IGFkZGl0aW9uYWwgY29udHJvbHMgYXQgdGhlIGFwcGxpY2F0aW9uLFxuKiBuZXR3b3JrLCBhbmQgc3RvcmFnZSBsYXllcnMuXG4qXG4qIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zXG4qIEBwYXJhbSBvcHRpb25zLnJ1bGVzIC0gUmVjb3JkIG9mIGRldGVjdGlvbiBydWxlcyBtYXBwaW5nIHJ1bGUgbmFtZXMgdG8gcmVnZXggcGF0dGVybnMuXG4qICAgUnVsZSBuYW1lcyBhcmUgbm9ybWFsaXplZCB0byB1cHBlcmNhc2UgYW5kIHVzZWQgaW4gcmVkYWN0aW9uIG1hcmtlcnMuXG4qICAgUGF0dGVybnMgbXVzdCB1c2UgdGhlIGdsb2JhbCBmbGFnIChgL3BhdHRlcm4vZ2ApIHRvIG1hdGNoIGFsbCBvY2N1cnJlbmNlcy5cbipcbiogQHJldHVybnMgTWlkZGxld2FyZSBpbnN0YW5jZSBmb3IgdXNlIHdpdGggYGNyZWF0ZUFnZW50YFxuKlxuKiBAZXhhbXBsZSBCYXNpYyB1c2FnZSB3aXRoIGN1c3RvbSBydWxlc1xuKiBgYGB0eXBlc2NyaXB0XG4qIGltcG9ydCB7IHBpaVJlZGFjdGlvbk1pZGRsZXdhcmUgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qIGltcG9ydCB7IGNyZWF0ZUFnZW50IH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKiBpbXBvcnQgeyB0b29sIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS90b29sc1wiO1xuKiBpbXBvcnQgeyB6IH0gZnJvbSBcInpvZC92M1wiO1xuKlxuKiBjb25zdCBQSUlfUlVMRVMgPSB7XG4qICAgc3NuOiAvXFxiXFxkezN9LT9cXGR7Mn0tP1xcZHs0fVxcYi9nLFxuKiAgIGVtYWlsOiAvXFxiW0EtWmEtejAtOS5fJSstXStAW0EtWmEtejAtOS4tXStcXC5bQS1aYS16XXsyLH1cXGIvZyxcbiogICBwaG9uZTogL1xcYlxcZHszfVstLl0/XFxkezN9Wy0uXT9cXGR7NH1cXGIvZyxcbiogfTtcbipcbiogY29uc3QgbG9va3VwVXNlciA9IHRvb2woYXN5bmMgKHsgc3NuIH0pID0+IHtcbiogICAvLyBSZWNlaXZlcyBvcmlnaW5hbCB2YWx1ZTogXCIxMjMtNDUtNjc4OVwiXG4qICAgcmV0dXJuIHsgbmFtZTogXCJKb2huIERvZVwiLCBhY2NvdW50OiBcImFjdGl2ZVwiIH07XG4qIH0sIHtcbiogICBuYW1lOiBcImxvb2t1cF91c2VyXCIsXG4qICAgZGVzY3JpcHRpb246IFwiTG9vayB1cCB1c2VyIGJ5IFNTTlwiLFxuKiAgIHNjaGVtYTogei5vYmplY3QoeyBzc246IHouc3RyaW5nKCkgfSlcbiogfSk7XG4qXG4qIGNvbnN0IGFnZW50ID0gY3JlYXRlQWdlbnQoe1xuKiAgIG1vZGVsOiBuZXcgQ2hhdE9wZW5BSSh7IG1vZGVsOiBcImdwdC00XCIgfSksXG4qICAgdG9vbHM6IFtsb29rdXBVc2VyXSxcbiogICBtaWRkbGV3YXJlOiBbcGlpUmVkYWN0aW9uTWlkZGxld2FyZSh7IHJ1bGVzOiBQSUlfUlVMRVMgfSldXG4qIH0pO1xuKlxuKiBjb25zdCByZXN1bHQgPSBhd2FpdCBhZ2VudC5pbnZva2Uoe1xuKiAgIG1lc3NhZ2VzOiBbbmV3IEh1bWFuTWVzc2FnZShcIkxvb2sgdXAgU1NOIDEyMy00NS02Nzg5XCIpXVxuKiB9KTtcbiogLy8gTW9kZWwgcmVxdWVzdDogXCJMb29rIHVwIFNTTiBbUkVEQUNURURfU1NOX2FiYzEyM11cIlxuKiAvLyBNb2RlbCByZXNwb25zZTogdG9vbF9jYWxsKHsgXCJzc25cIjogXCJbUkVEQUNURURfU1NOX2FiYzEyM11cIiB9KVxuKiAvLyBUb29sIHJlY2VpdmVzOiB7IFwic3NuXCI6IFwiMTIzLTQ1LTY3ODlcIiB9XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBSdW50aW1lIHJ1bGUgY29uZmlndXJhdGlvbiB2aWEgY29udGV4dFxuKiBgYGB0eXBlc2NyaXB0XG4qIGNvbnN0IGFnZW50ID0gY3JlYXRlQWdlbnQoe1xuKiAgIG1vZGVsOiBuZXcgQ2hhdE9wZW5BSSh7IG1vZGVsOiBcImdwdC00XCIgfSksXG4qICAgdG9vbHM6IFtzb21lVG9vbF0sXG4qICAgbWlkZGxld2FyZTogW3BpaVJlZGFjdGlvbk1pZGRsZXdhcmUoKV1cbiogfSk7XG4qXG4qIC8vIENvbmZpZ3VyZSBydWxlcyBhdCBydW50aW1lIHZpYSBtaWRkbGV3YXJlIGNvbnRleHRcbiogY29uc3QgcmVzdWx0ID0gYXdhaXQgYWdlbnQuaW52b2tlKFxuKiAgIHsgbWVzc2FnZXM6IFtuZXcgSHVtYW5NZXNzYWdlKFwiLi4uXCIpXSB9LFxuKiAgIHtcbiogICAgIGNvbmZpZ3VyYWJsZToge1xuKiAgICAgICBQSUlSZWRhY3Rpb25NaWRkbGV3YXJlOiB7XG4qICAgICAgICAgcnVsZXM6IHtcbiogICAgICAgICAgIHNzbjogL1xcYlxcZHszfS0/XFxkezJ9LT9cXGR7NH1cXGIvZyxcbiogICAgICAgICAgIGVtYWlsOiAvXFxiW0EtWmEtejAtOS5fJSstXStAW0EtWmEtejAtOS4tXStcXC5bQS1aYS16XXsyLH1cXGIvZyxcbiogICAgICAgICB9XG4qICAgICAgIH1cbiogICAgIH1cbiogICB9XG4qICk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBDdXN0b20gcnVsZSBwYXR0ZXJuc1xuKiBgYGB0eXBlc2NyaXB0XG4qIGNvbnN0IGN1c3RvbVJ1bGVzID0ge1xuKiAgIGVtcGxveWVlX2lkOiAvRU1QLVxcZHs2fS9nLFxuKiAgIGFwaV9rZXk6IC9zay1bYS16QS1aMC05XXszMn0vZyxcbiogICBjcmVkaXRfY2FyZDogL1xcYlxcZHs0fVstIF0/XFxkezR9Wy0gXT9cXGR7NH1bLSBdP1xcZHs0fVxcYi9nLFxuKiB9O1xuKlxuKiBjb25zdCBtaWRkbGV3YXJlID0gcGlpUmVkYWN0aW9uTWlkZGxld2FyZSh7IHJ1bGVzOiBjdXN0b21SdWxlcyB9KTtcbiogLy8gR2VuZXJhdGVzIG1hcmtlcnMgbGlrZTogW1JFREFDVEVEX0VNUExPWUVFX0lEX3h5ejc4OV1cbiogYGBgXG4qXG4qIEBkZXByZWNhdGVkXG4qL1xuZnVuY3Rpb24gcGlpUmVkYWN0aW9uTWlkZGxld2FyZShvcHRpb25zID0ge30pIHtcblx0Y29uc3QgcmVkYWN0aW9uTWFwID0ge307XG5cdGNvbnNvbGUud2FybihcIkRFUFJFQ0FURUQ6IHBpaVJlZGFjdGlvbk1pZGRsZXdhcmUgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBwaWlNaWRkbGV3YXJlIGluc3RlYWQsIGdvIHRvIGh0dHBzOi8vZG9jcy5sYW5nY2hhaW4uY29tL29zcy9qYXZhc2NyaXB0L2xhbmdjaGFpbi9taWRkbGV3YXJlL2J1aWx0LWluI3BpaS1kZXRlY3Rpb24gZm9yIG1vcmUgaW5mb3JtYXRpb24uXCIpO1xuXHRyZXR1cm4gY3JlYXRlTWlkZGxld2FyZSh7XG5cdFx0bmFtZTogXCJQSUlSZWRhY3Rpb25NaWRkbGV3YXJlXCIsXG5cdFx0Y29udGV4dFNjaGVtYSxcblx0XHR3cmFwTW9kZWxDYWxsOiBhc3luYyAocmVxdWVzdCwgaGFuZGxlcikgPT4ge1xuXHRcdFx0LyoqXG5cdFx0XHQqIE1lcmdlIG9wdGlvbnMgd2l0aCBjb250ZXh0LCBmb2xsb3dpbmcgYmlnVG9vbC50cyBwYXR0ZXJuXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3QgcnVsZXMgPSByZXF1ZXN0LnJ1bnRpbWUuY29udGV4dC5ydWxlcyA/PyBvcHRpb25zLnJ1bGVzID8/IHt9O1xuXHRcdFx0LyoqXG5cdFx0XHQqIElmIG5vIHJ1bGVzIGFyZSBwcm92aWRlZCwgc2tpcCBwcm9jZXNzaW5nXG5cdFx0XHQqL1xuXHRcdFx0aWYgKE9iamVjdC5rZXlzKHJ1bGVzKS5sZW5ndGggPT09IDApIHJldHVybiBoYW5kbGVyKHJlcXVlc3QpO1xuXHRcdFx0Y29uc3QgcHJvY2Vzc2VkTWVzc2FnZXMgPSBhd2FpdCBQcm9taXNlLmFsbChyZXF1ZXN0LnN0YXRlLm1lc3NhZ2VzLm1hcCgobWVzc2FnZSkgPT4gcHJvY2Vzc01lc3NhZ2UobWVzc2FnZSwge1xuXHRcdFx0XHRydWxlcyxcblx0XHRcdFx0cmVkYWN0aW9uTWFwXG5cdFx0XHR9KSkpO1xuXHRcdFx0cmV0dXJuIGhhbmRsZXIoe1xuXHRcdFx0XHQuLi5yZXF1ZXN0LFxuXHRcdFx0XHRtZXNzYWdlczogcHJvY2Vzc2VkTWVzc2FnZXNcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0YWZ0ZXJNb2RlbDogYXN5bmMgKHN0YXRlKSA9PiB7XG5cdFx0XHQvKipcblx0XHRcdCogSWYgbm8gcmVkYWN0aW9ucyB3ZXJlIG1hZGUsIHNraXAgcHJvY2Vzc2luZ1xuXHRcdFx0Ki9cblx0XHRcdGlmIChPYmplY3Qua2V5cyhyZWRhY3Rpb25NYXApLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXHRcdFx0Y29uc3QgbGFzdE1lc3NhZ2UgPSBzdGF0ZS5tZXNzYWdlcy5hdCgtMSk7XG5cdFx0XHRpZiAoIUFJTWVzc2FnZS5pc0luc3RhbmNlKGxhc3RNZXNzYWdlKSkgcmV0dXJuO1xuXHRcdFx0LyoqXG5cdFx0XHQqIEluIGNhc2VzIHdoZXJlIHdlIGRvIHN0cnVjdHVyZWQgb3V0cHV0IHZpYSB0b29sIGNhbGxzLCB3ZSBhbHNvIGhhdmUgdG8gbG9vayBhdCB0aGUgc2Vjb25kIGxhc3QgbWVzc2FnZVxuXHRcdFx0KiBhcyB3ZSBhZGQgYSBjdXN0b20gbGFzdCBtZXNzYWdlIHRvIHRoZSBtZXNzYWdlcyBhcnJheS5cblx0XHRcdCovXG5cdFx0XHRjb25zdCBzZWNvbmRMYXN0TWVzc2FnZSA9IHN0YXRlLm1lc3NhZ2VzLmF0KC0yKTtcblx0XHRcdGNvbnN0IHsgbWVzc2FnZTogcmVzdG9yZWRMYXN0TWVzc2FnZSwgY2hhbmdlZCB9ID0gcmVzdG9yZU1lc3NhZ2UobGFzdE1lc3NhZ2UsIHJlZGFjdGlvbk1hcCk7XG5cdFx0XHRpZiAoIWNoYW5nZWQpIHJldHVybjtcblx0XHRcdC8qKlxuXHRcdFx0KiBJZGVudGlmeSBpZiB0aGUgbGFzdCBtZXNzYWdlIGlzIGEgc3RydWN0dXJlZCByZXNwb25zZSBhbmQgcmVzdG9yZSB0aGUgdmFsdWVzIGlmIHNvXG5cdFx0XHQqL1xuXHRcdFx0bGV0IHN0cnVjdHVyZWRSZXNwb25zZTtcblx0XHRcdGlmIChBSU1lc3NhZ2UuaXNJbnN0YW5jZShsYXN0TWVzc2FnZSkgJiYgbGFzdE1lc3NhZ2U/LnRvb2xfY2FsbHM/Lmxlbmd0aCA9PT0gMCAmJiB0eXBlb2YgbGFzdE1lc3NhZ2UuY29udGVudCA9PT0gXCJzdHJpbmdcIiAmJiBsYXN0TWVzc2FnZS5jb250ZW50LnN0YXJ0c1dpdGgoXCJ7XCIpICYmIGxhc3RNZXNzYWdlLmNvbnRlbnQuZW5kc1dpdGgoXCJ9XCIpKSB0cnkge1xuXHRcdFx0XHRzdHJ1Y3R1cmVkUmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3RvcmVSZWRhY3RlZFZhbHVlcyhsYXN0TWVzc2FnZS5jb250ZW50LCByZWRhY3Rpb25NYXApKTtcblx0XHRcdH0gY2F0Y2gge31cblx0XHRcdGlmIChBSU1lc3NhZ2UuaXNJbnN0YW5jZShzZWNvbmRMYXN0TWVzc2FnZSkgJiYgc2Vjb25kTGFzdE1lc3NhZ2U/LnRvb2xfY2FsbHM/Lmxlbmd0aCAhPT0gMCAmJiBzZWNvbmRMYXN0TWVzc2FnZT8udG9vbF9jYWxscz8uc29tZSgoY2FsbCkgPT4gY2FsbC5uYW1lLnN0YXJ0c1dpdGgoXCJleHRyYWN0LVwiKSkpIHtcblx0XHRcdFx0Y29uc3QgeyBtZXNzYWdlOiByZXN0b3JlZFNlY29uZExhc3RNZXNzYWdlLCBjaGFuZ2VkOiBjaGFuZ2VkU2Vjb25kTGFzdE1lc3NhZ2UgfSA9IHJlc3RvcmVNZXNzYWdlKHNlY29uZExhc3RNZXNzYWdlLCByZWRhY3Rpb25NYXApO1xuXHRcdFx0XHRjb25zdCBzdHJ1Y3R1cmVkUmVzcG9uc2VSZWRhY3RlZCA9IHNlY29uZExhc3RNZXNzYWdlLnRvb2xfY2FsbHM/LmZpbmQoKGNhbGwpID0+IGNhbGwubmFtZS5zdGFydHNXaXRoKFwiZXh0cmFjdC1cIikpPy5hcmdzO1xuXHRcdFx0XHRjb25zdCBzdHJ1Y3R1cmVkUmVzcG9uc2UgPSBzdHJ1Y3R1cmVkUmVzcG9uc2VSZWRhY3RlZCA/IEpTT04ucGFyc2UocmVzdG9yZVJlZGFjdGVkVmFsdWVzKEpTT04uc3RyaW5naWZ5KHN0cnVjdHVyZWRSZXNwb25zZVJlZGFjdGVkKSwgcmVkYWN0aW9uTWFwKSkgOiB2b2lkIDA7XG5cdFx0XHRcdGlmIChjaGFuZ2VkIHx8IGNoYW5nZWRTZWNvbmRMYXN0TWVzc2FnZSkgcmV0dXJuIHtcblx0XHRcdFx0XHQuLi5zdGF0ZSxcblx0XHRcdFx0XHQuLi5zdHJ1Y3R1cmVkUmVzcG9uc2UgPyB7IHN0cnVjdHVyZWRSZXNwb25zZSB9IDoge30sXG5cdFx0XHRcdFx0bWVzc2FnZXM6IFtcblx0XHRcdFx0XHRcdG5ldyBSZW1vdmVNZXNzYWdlKHsgaWQ6IHNlY29uZExhc3RNZXNzYWdlLmlkIH0pLFxuXHRcdFx0XHRcdFx0bmV3IFJlbW92ZU1lc3NhZ2UoeyBpZDogbGFzdE1lc3NhZ2UuaWQgfSksXG5cdFx0XHRcdFx0XHRyZXN0b3JlZFNlY29uZExhc3RNZXNzYWdlLFxuXHRcdFx0XHRcdFx0cmVzdG9yZWRMYXN0TWVzc2FnZVxuXHRcdFx0XHRcdF1cblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0XHQuLi5zdHJ1Y3R1cmVkUmVzcG9uc2UgPyB7IHN0cnVjdHVyZWRSZXNwb25zZSB9IDoge30sXG5cdFx0XHRcdG1lc3NhZ2VzOiBbbmV3IFJlbW92ZU1lc3NhZ2UoeyBpZDogbGFzdE1lc3NhZ2UuaWQgfSksIHJlc3RvcmVkTGFzdE1lc3NhZ2VdXG5cdFx0XHR9O1xuXHRcdH1cblx0fSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgcGlpUmVkYWN0aW9uTWlkZGxld2FyZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGlpUmVkYWN0aW9uLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/piiRedaction.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/anthropic/promptCaching.js":
/*!***************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/anthropic/promptCaching.js ***!
  \***************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   anthropicPromptCachingMiddleware: () => (/* binding */ anthropicPromptCachingMiddleware)\n/* harmony export */ });\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n\n//#region src/agents/middleware/provider/anthropic/promptCaching.ts\nconst DEFAULT_ENABLE_CACHING = true;\nconst DEFAULT_TTL = \"5m\";\nconst DEFAULT_MIN_MESSAGES_TO_CACHE = 3;\nconst DEFAULT_UNSUPPORTED_MODEL_BEHAVIOR = \"warn\";\nconst contextSchema = zod_v3__WEBPACK_IMPORTED_MODULE_1__.z.object({\n\tenableCaching: zod_v3__WEBPACK_IMPORTED_MODULE_1__.z.boolean().optional(),\n\tttl: zod_v3__WEBPACK_IMPORTED_MODULE_1__.z[\"enum\"]([\"5m\", \"1h\"]).optional(),\n\tminMessagesToCache: zod_v3__WEBPACK_IMPORTED_MODULE_1__.z.number().optional(),\n\tunsupportedModelBehavior: zod_v3__WEBPACK_IMPORTED_MODULE_1__.z[\"enum\"]([\n\t\t\"ignore\",\n\t\t\"warn\",\n\t\t\"raise\"\n\t]).optional()\n});\nvar PromptCachingMiddlewareError = class extends Error {\n\tconstructor(message) {\n\t\tsuper(message);\n\t\tthis.name = \"PromptCachingMiddlewareError\";\n\t}\n};\n/**\n* Creates a prompt caching middleware for Anthropic models to optimize API usage.\n*\n* This middleware automatically adds cache control headers to the last messages when using Anthropic models,\n* enabling their prompt caching feature. This can significantly reduce costs for applications with repetitive\n* prompts, long system messages, or extensive conversation histories.\n*\n* ## How It Works\n*\n* The middleware intercepts model requests and adds cache control metadata that tells Anthropic's\n* API to cache processed prompt prefixes. On subsequent requests with matching prefixes, the\n* cached representations are reused, skipping redundant token processing.\n*\n* ## Benefits\n*\n* - **Cost Reduction**: Avoid reprocessing the same tokens repeatedly (up to 90% savings on cached portions)\n* - **Lower Latency**: Cached prompts are processed faster as embeddings are pre-computed\n* - **Better Scalability**: Reduced computational load enables handling more requests\n* - **Consistent Performance**: Stable response times for repetitive queries\n*\n* @param middlewareOptions - Configuration options for the caching behavior\n* @param middlewareOptions.enableCaching - Whether to enable prompt caching (default: `true`)\n* @param middlewareOptions.ttl - Cache time-to-live: `\"5m\"` for 5 minutes or `\"1h\"` for 1 hour (default: `\"5m\"`)\n* @param middlewareOptions.minMessagesToCache - Minimum number of messages required before caching is applied (default: `3`)\n* @param middlewareOptions.unsupportedModelBehavior - The behavior to take when an unsupported model is used (default: `\"warn\"`)\n*\n* @returns A middleware instance that can be passed to `createAgent`\n*\n* @throws {Error} If used with non-Anthropic models\n*\n* @example\n* Basic usage with default settings\n* ```typescript\n* import { createAgent } from \"langchain\";\n* import { anthropicPromptCachingMiddleware } from \"langchain\";\n*\n* const agent = createAgent({\n*   model: \"anthropic:claude-sonnet-4-5\",\n*   middleware: [\n*     anthropicPromptCachingMiddleware()\n*   ]\n* });\n* ```\n*\n* @example\n* Custom configuration for longer conversations\n* ```typescript\n* const cachingMiddleware = anthropicPromptCachingMiddleware({\n*   ttl: \"1h\",  // Cache for 1 hour instead of default 5 minutes\n*   minMessagesToCache: 5  // Only cache after 5 messages\n* });\n*\n* const agent = createAgent({\n*   model: \"anthropic:claude-sonnet-4-5\",\n*   systemPrompt: \"You are a helpful assistant with deep knowledge of...\", // Long system prompt\n*   middleware: [cachingMiddleware]\n* });\n* ```\n*\n* @example\n* Conditional caching based on runtime context\n* ```typescript\n* const agent = createAgent({\n*   model: \"anthropic:claude-sonnet-4-5\",\n*   middleware: [\n*     anthropicPromptCachingMiddleware({\n*       enableCaching: true,\n*       ttl: \"5m\"\n*     })\n*   ]\n* });\n*\n* // Disable caching for specific requests\n* await agent.invoke(\n*   { messages: [new HumanMessage(\"Process this without caching\")] },\n*   {\n*     configurable: {\n*       middleware_context: { enableCaching: false }\n*     }\n*   }\n* );\n* ```\n*\n* @example\n* Optimal setup for customer support chatbot\n* ```typescript\n* const supportAgent = createAgent({\n*   model: \"anthropic:claude-sonnet-4-5\",\n*   systemPrompt: `You are a customer support agent for ACME Corp.\n*\n*     Company policies:\n*     - Always be polite and professional\n*     - Refer to knowledge base for product information\n*     - Escalate billing issues to human agents\n*     ... (extensive policies and guidelines)\n*   `,\n*   tools: [searchKnowledgeBase, createTicket, checkOrderStatus],\n*   middleware: [\n*     anthropicPromptCachingMiddleware({\n*       ttl: \"1h\",  // Long TTL for stable system prompt\n*       minMessagesToCache: 1  // Cache immediately due to large system prompt\n*     })\n*   ]\n* });\n* ```\n*\n* @remarks\n* - **Anthropic Only**: This middleware only works with Anthropic models and will throw an error if used with other providers\n* - **Automatic Application**: Caching is applied automatically when message count exceeds `minMessagesToCache`\n* - **Cache Scope**: Caches are isolated per API key and cannot be shared across different keys\n* - **TTL Options**: Only supports \"5m\" (5 minutes) and \"1h\" (1 hour) as TTL values per Anthropic's API\n* - **Best Use Cases**: Long system prompts, multi-turn conversations, repetitive queries, RAG applications\n* - **Cost Impact**: Cached tokens are billed at 10% of the base input token price, cache writes are billed at 25% of the base\n*\n* @see {@link createAgent} for agent creation\n* @see {@link https://docs.anthropic.com/en/docs/build-with-claude/prompt-caching} Anthropic's prompt caching documentation\n* @public\n*/\nfunction anthropicPromptCachingMiddleware(middlewareOptions) {\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)({\n\t\tname: \"PromptCachingMiddleware\",\n\t\tcontextSchema,\n\t\twrapModelCall: (request, handler) => {\n\t\t\t/**\n\t\t\t* Prefer runtime context values over middleware options values over defaults\n\t\t\t*/\n\t\t\tconst enableCaching = request.runtime.context.enableCaching ?? middlewareOptions?.enableCaching ?? DEFAULT_ENABLE_CACHING;\n\t\t\tconst ttl = request.runtime.context.ttl ?? middlewareOptions?.ttl ?? DEFAULT_TTL;\n\t\t\tconst minMessagesToCache = request.runtime.context.minMessagesToCache ?? middlewareOptions?.minMessagesToCache ?? DEFAULT_MIN_MESSAGES_TO_CACHE;\n\t\t\tconst unsupportedModelBehavior = request.runtime.context.unsupportedModelBehavior ?? middlewareOptions?.unsupportedModelBehavior ?? DEFAULT_UNSUPPORTED_MODEL_BEHAVIOR;\n\t\t\tif (!enableCaching || !request.model) return handler(request);\n\t\t\tif (!(request.model.getName() === \"ChatAnthropic\" || request.model.getName() === \"ConfigurableModel\" && request.model._defaultConfig?.modelProvider === \"anthropic\")) {\n\t\t\t\tconst modelName = request.model.getName();\n\t\t\t\tconst baseMessage = `Unsupported model '${request.model.getName() === \"ConfigurableModel\" ? `${modelName} (${request.model._defaultConfig?.modelProvider})` : modelName}'. Prompt caching requires an Anthropic model`;\n\t\t\t\tif (unsupportedModelBehavior === \"raise\") throw new PromptCachingMiddlewareError(`${baseMessage} (e.g., 'anthropic:claude-4-0-sonnet').`);\n\t\t\t\telse if (unsupportedModelBehavior === \"warn\") console.warn(`PromptCachingMiddleware: Skipping caching for ${modelName}. Consider switching to an Anthropic model for caching benefits.`);\n\t\t\t\treturn handler(request);\n\t\t\t}\n\t\t\tif (request.state.messages.length + (request.systemPrompt ? 1 : 0) < minMessagesToCache) return handler(request);\n\t\t\t/**\n\t\t\t* The cache_control is applied at the final message formatting layer in ChatAnthropic,\n\t\t\t* which avoids issues with message content block manipulation during earlier\n\t\t\t* processing stages (e.g., streaming response reassembly).\n\t\t\t*\n\t\t\t* @see https://docs.anthropic.com/en/docs/build-with-claude/prompt-caching\n\t\t\t*/\n\t\t\treturn handler({\n\t\t\t\t...request,\n\t\t\t\tmodelSettings: {\n\t\t\t\t\t...request.modelSettings,\n\t\t\t\t\tcache_control: {\n\t\t\t\t\t\ttype: \"ephemeral\",\n\t\t\t\t\t\tttl\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=promptCaching.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9wcm92aWRlci9hbnRocm9waWMvcHJvbXB0Q2FjaGluZy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMEQ7QUFDL0I7O0FBRTNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsNENBQVE7QUFDOUIsZ0JBQWdCLDZDQUFTO0FBQ3pCLE1BQU0sNkNBQU07QUFDWixxQkFBcUIsNENBQVE7QUFDN0IsMkJBQTJCLDZDQUFNO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxjQUFjO0FBQ3pCLFdBQVcsbUNBQW1DO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFNLDhEQUE4RDtBQUNwRTtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLG1CQUFtQjtBQUMzQixRQUFRLDJFQUEyRTtBQUNuRjtBQUNBO0FBQ0E7QUFDQSxRQUFRLGdFQUFnQjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxxREFBcUQsV0FBVyxHQUFHLDRDQUE0QyxlQUFlO0FBQzVLLHdGQUF3RixhQUFhO0FBQ3JHLGdIQUFnSCxVQUFVO0FBQzFIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQzRDO0FBQzVDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL21pZGRsZXdhcmUvcHJvdmlkZXIvYW50aHJvcGljL3Byb21wdENhY2hpbmcuanM/M2E4MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVNaWRkbGV3YXJlIH0gZnJvbSBcIi4uLy4uLy4uL21pZGRsZXdhcmUuanNcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kL3YzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL21pZGRsZXdhcmUvcHJvdmlkZXIvYW50aHJvcGljL3Byb21wdENhY2hpbmcudHNcbmNvbnN0IERFRkFVTFRfRU5BQkxFX0NBQ0hJTkcgPSB0cnVlO1xuY29uc3QgREVGQVVMVF9UVEwgPSBcIjVtXCI7XG5jb25zdCBERUZBVUxUX01JTl9NRVNTQUdFU19UT19DQUNIRSA9IDM7XG5jb25zdCBERUZBVUxUX1VOU1VQUE9SVEVEX01PREVMX0JFSEFWSU9SID0gXCJ3YXJuXCI7XG5jb25zdCBjb250ZXh0U2NoZW1hID0gei5vYmplY3Qoe1xuXHRlbmFibGVDYWNoaW5nOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuXHR0dGw6IHouZW51bShbXCI1bVwiLCBcIjFoXCJdKS5vcHRpb25hbCgpLFxuXHRtaW5NZXNzYWdlc1RvQ2FjaGU6IHoubnVtYmVyKCkub3B0aW9uYWwoKSxcblx0dW5zdXBwb3J0ZWRNb2RlbEJlaGF2aW9yOiB6LmVudW0oW1xuXHRcdFwiaWdub3JlXCIsXG5cdFx0XCJ3YXJuXCIsXG5cdFx0XCJyYWlzZVwiXG5cdF0pLm9wdGlvbmFsKClcbn0pO1xudmFyIFByb21wdENhY2hpbmdNaWRkbGV3YXJlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcblx0Y29uc3RydWN0b3IobWVzc2FnZSkge1xuXHRcdHN1cGVyKG1lc3NhZ2UpO1xuXHRcdHRoaXMubmFtZSA9IFwiUHJvbXB0Q2FjaGluZ01pZGRsZXdhcmVFcnJvclwiO1xuXHR9XG59O1xuLyoqXG4qIENyZWF0ZXMgYSBwcm9tcHQgY2FjaGluZyBtaWRkbGV3YXJlIGZvciBBbnRocm9waWMgbW9kZWxzIHRvIG9wdGltaXplIEFQSSB1c2FnZS5cbipcbiogVGhpcyBtaWRkbGV3YXJlIGF1dG9tYXRpY2FsbHkgYWRkcyBjYWNoZSBjb250cm9sIGhlYWRlcnMgdG8gdGhlIGxhc3QgbWVzc2FnZXMgd2hlbiB1c2luZyBBbnRocm9waWMgbW9kZWxzLFxuKiBlbmFibGluZyB0aGVpciBwcm9tcHQgY2FjaGluZyBmZWF0dXJlLiBUaGlzIGNhbiBzaWduaWZpY2FudGx5IHJlZHVjZSBjb3N0cyBmb3IgYXBwbGljYXRpb25zIHdpdGggcmVwZXRpdGl2ZVxuKiBwcm9tcHRzLCBsb25nIHN5c3RlbSBtZXNzYWdlcywgb3IgZXh0ZW5zaXZlIGNvbnZlcnNhdGlvbiBoaXN0b3JpZXMuXG4qXG4qICMjIEhvdyBJdCBXb3Jrc1xuKlxuKiBUaGUgbWlkZGxld2FyZSBpbnRlcmNlcHRzIG1vZGVsIHJlcXVlc3RzIGFuZCBhZGRzIGNhY2hlIGNvbnRyb2wgbWV0YWRhdGEgdGhhdCB0ZWxscyBBbnRocm9waWMnc1xuKiBBUEkgdG8gY2FjaGUgcHJvY2Vzc2VkIHByb21wdCBwcmVmaXhlcy4gT24gc3Vic2VxdWVudCByZXF1ZXN0cyB3aXRoIG1hdGNoaW5nIHByZWZpeGVzLCB0aGVcbiogY2FjaGVkIHJlcHJlc2VudGF0aW9ucyBhcmUgcmV1c2VkLCBza2lwcGluZyByZWR1bmRhbnQgdG9rZW4gcHJvY2Vzc2luZy5cbipcbiogIyMgQmVuZWZpdHNcbipcbiogLSAqKkNvc3QgUmVkdWN0aW9uKio6IEF2b2lkIHJlcHJvY2Vzc2luZyB0aGUgc2FtZSB0b2tlbnMgcmVwZWF0ZWRseSAodXAgdG8gOTAlIHNhdmluZ3Mgb24gY2FjaGVkIHBvcnRpb25zKVxuKiAtICoqTG93ZXIgTGF0ZW5jeSoqOiBDYWNoZWQgcHJvbXB0cyBhcmUgcHJvY2Vzc2VkIGZhc3RlciBhcyBlbWJlZGRpbmdzIGFyZSBwcmUtY29tcHV0ZWRcbiogLSAqKkJldHRlciBTY2FsYWJpbGl0eSoqOiBSZWR1Y2VkIGNvbXB1dGF0aW9uYWwgbG9hZCBlbmFibGVzIGhhbmRsaW5nIG1vcmUgcmVxdWVzdHNcbiogLSAqKkNvbnNpc3RlbnQgUGVyZm9ybWFuY2UqKjogU3RhYmxlIHJlc3BvbnNlIHRpbWVzIGZvciByZXBldGl0aXZlIHF1ZXJpZXNcbipcbiogQHBhcmFtIG1pZGRsZXdhcmVPcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgY2FjaGluZyBiZWhhdmlvclxuKiBAcGFyYW0gbWlkZGxld2FyZU9wdGlvbnMuZW5hYmxlQ2FjaGluZyAtIFdoZXRoZXIgdG8gZW5hYmxlIHByb21wdCBjYWNoaW5nIChkZWZhdWx0OiBgdHJ1ZWApXG4qIEBwYXJhbSBtaWRkbGV3YXJlT3B0aW9ucy50dGwgLSBDYWNoZSB0aW1lLXRvLWxpdmU6IGBcIjVtXCJgIGZvciA1IG1pbnV0ZXMgb3IgYFwiMWhcImAgZm9yIDEgaG91ciAoZGVmYXVsdDogYFwiNW1cImApXG4qIEBwYXJhbSBtaWRkbGV3YXJlT3B0aW9ucy5taW5NZXNzYWdlc1RvQ2FjaGUgLSBNaW5pbXVtIG51bWJlciBvZiBtZXNzYWdlcyByZXF1aXJlZCBiZWZvcmUgY2FjaGluZyBpcyBhcHBsaWVkIChkZWZhdWx0OiBgM2ApXG4qIEBwYXJhbSBtaWRkbGV3YXJlT3B0aW9ucy51bnN1cHBvcnRlZE1vZGVsQmVoYXZpb3IgLSBUaGUgYmVoYXZpb3IgdG8gdGFrZSB3aGVuIGFuIHVuc3VwcG9ydGVkIG1vZGVsIGlzIHVzZWQgKGRlZmF1bHQ6IGBcIndhcm5cImApXG4qXG4qIEByZXR1cm5zIEEgbWlkZGxld2FyZSBpbnN0YW5jZSB0aGF0IGNhbiBiZSBwYXNzZWQgdG8gYGNyZWF0ZUFnZW50YFxuKlxuKiBAdGhyb3dzIHtFcnJvcn0gSWYgdXNlZCB3aXRoIG5vbi1BbnRocm9waWMgbW9kZWxzXG4qXG4qIEBleGFtcGxlXG4qIEJhc2ljIHVzYWdlIHdpdGggZGVmYXVsdCBzZXR0aW5nc1xuKiBgYGB0eXBlc2NyaXB0XG4qIGltcG9ydCB7IGNyZWF0ZUFnZW50IH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKiBpbXBvcnQgeyBhbnRocm9waWNQcm9tcHRDYWNoaW5nTWlkZGxld2FyZSB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwiYW50aHJvcGljOmNsYXVkZS1zb25uZXQtNC01XCIsXG4qICAgbWlkZGxld2FyZTogW1xuKiAgICAgYW50aHJvcGljUHJvbXB0Q2FjaGluZ01pZGRsZXdhcmUoKVxuKiAgIF1cbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZVxuKiBDdXN0b20gY29uZmlndXJhdGlvbiBmb3IgbG9uZ2VyIGNvbnZlcnNhdGlvbnNcbiogYGBgdHlwZXNjcmlwdFxuKiBjb25zdCBjYWNoaW5nTWlkZGxld2FyZSA9IGFudGhyb3BpY1Byb21wdENhY2hpbmdNaWRkbGV3YXJlKHtcbiogICB0dGw6IFwiMWhcIiwgIC8vIENhY2hlIGZvciAxIGhvdXIgaW5zdGVhZCBvZiBkZWZhdWx0IDUgbWludXRlc1xuKiAgIG1pbk1lc3NhZ2VzVG9DYWNoZTogNSAgLy8gT25seSBjYWNoZSBhZnRlciA1IG1lc3NhZ2VzXG4qIH0pO1xuKlxuKiBjb25zdCBhZ2VudCA9IGNyZWF0ZUFnZW50KHtcbiogICBtb2RlbDogXCJhbnRocm9waWM6Y2xhdWRlLXNvbm5ldC00LTVcIixcbiogICBzeXN0ZW1Qcm9tcHQ6IFwiWW91IGFyZSBhIGhlbHBmdWwgYXNzaXN0YW50IHdpdGggZGVlcCBrbm93bGVkZ2Ugb2YuLi5cIiwgLy8gTG9uZyBzeXN0ZW0gcHJvbXB0XG4qICAgbWlkZGxld2FyZTogW2NhY2hpbmdNaWRkbGV3YXJlXVxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlXG4qIENvbmRpdGlvbmFsIGNhY2hpbmcgYmFzZWQgb24gcnVudGltZSBjb250ZXh0XG4qIGBgYHR5cGVzY3JpcHRcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwiYW50aHJvcGljOmNsYXVkZS1zb25uZXQtNC01XCIsXG4qICAgbWlkZGxld2FyZTogW1xuKiAgICAgYW50aHJvcGljUHJvbXB0Q2FjaGluZ01pZGRsZXdhcmUoe1xuKiAgICAgICBlbmFibGVDYWNoaW5nOiB0cnVlLFxuKiAgICAgICB0dGw6IFwiNW1cIlxuKiAgICAgfSlcbiogICBdXG4qIH0pO1xuKlxuKiAvLyBEaXNhYmxlIGNhY2hpbmcgZm9yIHNwZWNpZmljIHJlcXVlc3RzXG4qIGF3YWl0IGFnZW50Lmludm9rZShcbiogICB7IG1lc3NhZ2VzOiBbbmV3IEh1bWFuTWVzc2FnZShcIlByb2Nlc3MgdGhpcyB3aXRob3V0IGNhY2hpbmdcIildIH0sXG4qICAge1xuKiAgICAgY29uZmlndXJhYmxlOiB7XG4qICAgICAgIG1pZGRsZXdhcmVfY29udGV4dDogeyBlbmFibGVDYWNoaW5nOiBmYWxzZSB9XG4qICAgICB9XG4qICAgfVxuKiApO1xuKiBgYGBcbipcbiogQGV4YW1wbGVcbiogT3B0aW1hbCBzZXR1cCBmb3IgY3VzdG9tZXIgc3VwcG9ydCBjaGF0Ym90XG4qIGBgYHR5cGVzY3JpcHRcbiogY29uc3Qgc3VwcG9ydEFnZW50ID0gY3JlYXRlQWdlbnQoe1xuKiAgIG1vZGVsOiBcImFudGhyb3BpYzpjbGF1ZGUtc29ubmV0LTQtNVwiLFxuKiAgIHN5c3RlbVByb21wdDogYFlvdSBhcmUgYSBjdXN0b21lciBzdXBwb3J0IGFnZW50IGZvciBBQ01FIENvcnAuXG4qXG4qICAgICBDb21wYW55IHBvbGljaWVzOlxuKiAgICAgLSBBbHdheXMgYmUgcG9saXRlIGFuZCBwcm9mZXNzaW9uYWxcbiogICAgIC0gUmVmZXIgdG8ga25vd2xlZGdlIGJhc2UgZm9yIHByb2R1Y3QgaW5mb3JtYXRpb25cbiogICAgIC0gRXNjYWxhdGUgYmlsbGluZyBpc3N1ZXMgdG8gaHVtYW4gYWdlbnRzXG4qICAgICAuLi4gKGV4dGVuc2l2ZSBwb2xpY2llcyBhbmQgZ3VpZGVsaW5lcylcbiogICBgLFxuKiAgIHRvb2xzOiBbc2VhcmNoS25vd2xlZGdlQmFzZSwgY3JlYXRlVGlja2V0LCBjaGVja09yZGVyU3RhdHVzXSxcbiogICBtaWRkbGV3YXJlOiBbXG4qICAgICBhbnRocm9waWNQcm9tcHRDYWNoaW5nTWlkZGxld2FyZSh7XG4qICAgICAgIHR0bDogXCIxaFwiLCAgLy8gTG9uZyBUVEwgZm9yIHN0YWJsZSBzeXN0ZW0gcHJvbXB0XG4qICAgICAgIG1pbk1lc3NhZ2VzVG9DYWNoZTogMSAgLy8gQ2FjaGUgaW1tZWRpYXRlbHkgZHVlIHRvIGxhcmdlIHN5c3RlbSBwcm9tcHRcbiogICAgIH0pXG4qICAgXVxuKiB9KTtcbiogYGBgXG4qXG4qIEByZW1hcmtzXG4qIC0gKipBbnRocm9waWMgT25seSoqOiBUaGlzIG1pZGRsZXdhcmUgb25seSB3b3JrcyB3aXRoIEFudGhyb3BpYyBtb2RlbHMgYW5kIHdpbGwgdGhyb3cgYW4gZXJyb3IgaWYgdXNlZCB3aXRoIG90aGVyIHByb3ZpZGVyc1xuKiAtICoqQXV0b21hdGljIEFwcGxpY2F0aW9uKio6IENhY2hpbmcgaXMgYXBwbGllZCBhdXRvbWF0aWNhbGx5IHdoZW4gbWVzc2FnZSBjb3VudCBleGNlZWRzIGBtaW5NZXNzYWdlc1RvQ2FjaGVgXG4qIC0gKipDYWNoZSBTY29wZSoqOiBDYWNoZXMgYXJlIGlzb2xhdGVkIHBlciBBUEkga2V5IGFuZCBjYW5ub3QgYmUgc2hhcmVkIGFjcm9zcyBkaWZmZXJlbnQga2V5c1xuKiAtICoqVFRMIE9wdGlvbnMqKjogT25seSBzdXBwb3J0cyBcIjVtXCIgKDUgbWludXRlcykgYW5kIFwiMWhcIiAoMSBob3VyKSBhcyBUVEwgdmFsdWVzIHBlciBBbnRocm9waWMncyBBUElcbiogLSAqKkJlc3QgVXNlIENhc2VzKio6IExvbmcgc3lzdGVtIHByb21wdHMsIG11bHRpLXR1cm4gY29udmVyc2F0aW9ucywgcmVwZXRpdGl2ZSBxdWVyaWVzLCBSQUcgYXBwbGljYXRpb25zXG4qIC0gKipDb3N0IEltcGFjdCoqOiBDYWNoZWQgdG9rZW5zIGFyZSBiaWxsZWQgYXQgMTAlIG9mIHRoZSBiYXNlIGlucHV0IHRva2VuIHByaWNlLCBjYWNoZSB3cml0ZXMgYXJlIGJpbGxlZCBhdCAyNSUgb2YgdGhlIGJhc2VcbipcbiogQHNlZSB7QGxpbmsgY3JlYXRlQWdlbnR9IGZvciBhZ2VudCBjcmVhdGlvblxuKiBAc2VlIHtAbGluayBodHRwczovL2RvY3MuYW50aHJvcGljLmNvbS9lbi9kb2NzL2J1aWxkLXdpdGgtY2xhdWRlL3Byb21wdC1jYWNoaW5nfSBBbnRocm9waWMncyBwcm9tcHQgY2FjaGluZyBkb2N1bWVudGF0aW9uXG4qIEBwdWJsaWNcbiovXG5mdW5jdGlvbiBhbnRocm9waWNQcm9tcHRDYWNoaW5nTWlkZGxld2FyZShtaWRkbGV3YXJlT3B0aW9ucykge1xuXHRyZXR1cm4gY3JlYXRlTWlkZGxld2FyZSh7XG5cdFx0bmFtZTogXCJQcm9tcHRDYWNoaW5nTWlkZGxld2FyZVwiLFxuXHRcdGNvbnRleHRTY2hlbWEsXG5cdFx0d3JhcE1vZGVsQ2FsbDogKHJlcXVlc3QsIGhhbmRsZXIpID0+IHtcblx0XHRcdC8qKlxuXHRcdFx0KiBQcmVmZXIgcnVudGltZSBjb250ZXh0IHZhbHVlcyBvdmVyIG1pZGRsZXdhcmUgb3B0aW9ucyB2YWx1ZXMgb3ZlciBkZWZhdWx0c1xuXHRcdFx0Ki9cblx0XHRcdGNvbnN0IGVuYWJsZUNhY2hpbmcgPSByZXF1ZXN0LnJ1bnRpbWUuY29udGV4dC5lbmFibGVDYWNoaW5nID8/IG1pZGRsZXdhcmVPcHRpb25zPy5lbmFibGVDYWNoaW5nID8/IERFRkFVTFRfRU5BQkxFX0NBQ0hJTkc7XG5cdFx0XHRjb25zdCB0dGwgPSByZXF1ZXN0LnJ1bnRpbWUuY29udGV4dC50dGwgPz8gbWlkZGxld2FyZU9wdGlvbnM/LnR0bCA/PyBERUZBVUxUX1RUTDtcblx0XHRcdGNvbnN0IG1pbk1lc3NhZ2VzVG9DYWNoZSA9IHJlcXVlc3QucnVudGltZS5jb250ZXh0Lm1pbk1lc3NhZ2VzVG9DYWNoZSA/PyBtaWRkbGV3YXJlT3B0aW9ucz8ubWluTWVzc2FnZXNUb0NhY2hlID8/IERFRkFVTFRfTUlOX01FU1NBR0VTX1RPX0NBQ0hFO1xuXHRcdFx0Y29uc3QgdW5zdXBwb3J0ZWRNb2RlbEJlaGF2aW9yID0gcmVxdWVzdC5ydW50aW1lLmNvbnRleHQudW5zdXBwb3J0ZWRNb2RlbEJlaGF2aW9yID8/IG1pZGRsZXdhcmVPcHRpb25zPy51bnN1cHBvcnRlZE1vZGVsQmVoYXZpb3IgPz8gREVGQVVMVF9VTlNVUFBPUlRFRF9NT0RFTF9CRUhBVklPUjtcblx0XHRcdGlmICghZW5hYmxlQ2FjaGluZyB8fCAhcmVxdWVzdC5tb2RlbCkgcmV0dXJuIGhhbmRsZXIocmVxdWVzdCk7XG5cdFx0XHRpZiAoIShyZXF1ZXN0Lm1vZGVsLmdldE5hbWUoKSA9PT0gXCJDaGF0QW50aHJvcGljXCIgfHwgcmVxdWVzdC5tb2RlbC5nZXROYW1lKCkgPT09IFwiQ29uZmlndXJhYmxlTW9kZWxcIiAmJiByZXF1ZXN0Lm1vZGVsLl9kZWZhdWx0Q29uZmlnPy5tb2RlbFByb3ZpZGVyID09PSBcImFudGhyb3BpY1wiKSkge1xuXHRcdFx0XHRjb25zdCBtb2RlbE5hbWUgPSByZXF1ZXN0Lm1vZGVsLmdldE5hbWUoKTtcblx0XHRcdFx0Y29uc3QgYmFzZU1lc3NhZ2UgPSBgVW5zdXBwb3J0ZWQgbW9kZWwgJyR7cmVxdWVzdC5tb2RlbC5nZXROYW1lKCkgPT09IFwiQ29uZmlndXJhYmxlTW9kZWxcIiA/IGAke21vZGVsTmFtZX0gKCR7cmVxdWVzdC5tb2RlbC5fZGVmYXVsdENvbmZpZz8ubW9kZWxQcm92aWRlcn0pYCA6IG1vZGVsTmFtZX0nLiBQcm9tcHQgY2FjaGluZyByZXF1aXJlcyBhbiBBbnRocm9waWMgbW9kZWxgO1xuXHRcdFx0XHRpZiAodW5zdXBwb3J0ZWRNb2RlbEJlaGF2aW9yID09PSBcInJhaXNlXCIpIHRocm93IG5ldyBQcm9tcHRDYWNoaW5nTWlkZGxld2FyZUVycm9yKGAke2Jhc2VNZXNzYWdlfSAoZS5nLiwgJ2FudGhyb3BpYzpjbGF1ZGUtNC0wLXNvbm5ldCcpLmApO1xuXHRcdFx0XHRlbHNlIGlmICh1bnN1cHBvcnRlZE1vZGVsQmVoYXZpb3IgPT09IFwid2FyblwiKSBjb25zb2xlLndhcm4oYFByb21wdENhY2hpbmdNaWRkbGV3YXJlOiBTa2lwcGluZyBjYWNoaW5nIGZvciAke21vZGVsTmFtZX0uIENvbnNpZGVyIHN3aXRjaGluZyB0byBhbiBBbnRocm9waWMgbW9kZWwgZm9yIGNhY2hpbmcgYmVuZWZpdHMuYCk7XG5cdFx0XHRcdHJldHVybiBoYW5kbGVyKHJlcXVlc3QpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHJlcXVlc3Quc3RhdGUubWVzc2FnZXMubGVuZ3RoICsgKHJlcXVlc3Quc3lzdGVtUHJvbXB0ID8gMSA6IDApIDwgbWluTWVzc2FnZXNUb0NhY2hlKSByZXR1cm4gaGFuZGxlcihyZXF1ZXN0KTtcblx0XHRcdC8qKlxuXHRcdFx0KiBUaGUgY2FjaGVfY29udHJvbCBpcyBhcHBsaWVkIGF0IHRoZSBmaW5hbCBtZXNzYWdlIGZvcm1hdHRpbmcgbGF5ZXIgaW4gQ2hhdEFudGhyb3BpYyxcblx0XHRcdCogd2hpY2ggYXZvaWRzIGlzc3VlcyB3aXRoIG1lc3NhZ2UgY29udGVudCBibG9jayBtYW5pcHVsYXRpb24gZHVyaW5nIGVhcmxpZXJcblx0XHRcdCogcHJvY2Vzc2luZyBzdGFnZXMgKGUuZy4sIHN0cmVhbWluZyByZXNwb25zZSByZWFzc2VtYmx5KS5cblx0XHRcdCpcblx0XHRcdCogQHNlZSBodHRwczovL2RvY3MuYW50aHJvcGljLmNvbS9lbi9kb2NzL2J1aWxkLXdpdGgtY2xhdWRlL3Byb21wdC1jYWNoaW5nXG5cdFx0XHQqL1xuXHRcdFx0cmV0dXJuIGhhbmRsZXIoe1xuXHRcdFx0XHQuLi5yZXF1ZXN0LFxuXHRcdFx0XHRtb2RlbFNldHRpbmdzOiB7XG5cdFx0XHRcdFx0Li4ucmVxdWVzdC5tb2RlbFNldHRpbmdzLFxuXHRcdFx0XHRcdGNhY2hlX2NvbnRyb2w6IHtcblx0XHRcdFx0XHRcdHR5cGU6IFwiZXBoZW1lcmFsXCIsXG5cdFx0XHRcdFx0XHR0dGxcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgYW50aHJvcGljUHJvbXB0Q2FjaGluZ01pZGRsZXdhcmUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb21wdENhY2hpbmcuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/anthropic/promptCaching.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/openai/moderation.js":
/*!*********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/openai/moderation.js ***!
  \*********************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   openAIModerationMiddleware: () => (/* binding */ openAIModerationMiddleware)\n/* harmony export */ });\n/* harmony import */ var _chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../chat_models/universal.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n\n\n\n\n//#region src/agents/middleware/provider/openai/moderation.ts\n/**\n* Check if the model is an OpenAI model that supports moderation.\n* @param model - The model to check.\n* @returns Whether the model is an OpenAI model that supports moderation.\n*/\nfunction isOpenAIModel(model) {\n\tif (!model || typeof model !== \"object\" || model === null || !(\"client\" in model) || !(\"_getClientOptions\" in model) || typeof model._getClientOptions !== \"function\") return false;\n\t/**\n\t* client may not yet be initialized, so we need to check if the model has a _getClientOptions method.\n\t*/\n\tmodel._getClientOptions();\n\treturn typeof model.client === \"object\" && model.client !== null && \"moderations\" in model.client && typeof model.client.moderations === \"object\" && model.client.moderations !== null && \"create\" in model.client.moderations && typeof model.client.moderations.create === \"function\";\n}\n/**\n* Default template for violation messages.\n*/\nconst DEFAULT_VIOLATION_TEMPLATE = \"I'm sorry, but I can't comply with that request. It was flagged for {categories}.\";\n/**\n* Error raised when OpenAI flags content and `exitBehavior` is set to `\"error\"`.\n*/\nvar OpenAIModerationError = class extends Error {\n\tcontent;\n\tstage;\n\tresult;\n\toriginalMessage;\n\tconstructor({ content, stage, result, message }) {\n\t\tsuper(message);\n\t\tthis.name = \"OpenAIModerationError\";\n\t\tthis.content = content;\n\t\tthis.stage = stage;\n\t\tthis.result = result;\n\t\tthis.originalMessage = message;\n\t}\n};\n/**\n* Middleware that moderates agent traffic using OpenAI's moderation endpoint.\n*\n* This middleware checks messages for content policy violations at different stages:\n* - Input: User messages before they reach the model\n* - Output: AI model responses\n* - Tool results: Results returned from tool executions\n*\n* @param options - Configuration options for the middleware\n* @param options.model - OpenAI model to use for moderation. Can be either a model name or a BaseChatModel instance.\n* @param options.moderationModel - Moderation model to use.\n* @param options.checkInput - Whether to check user input messages.\n* @param options.checkOutput - Whether to check model output messages.\n* @param options.checkToolResults - Whether to check tool result messages.\n* @param options.exitBehavior - How to handle violations.\n* @param options.violationMessage - Custom template for violation messages.\n* @returns Middleware function that can be used to moderate agent traffic.\n*\n* @example  Using model instance\n* ```ts\n* import { createAgent, openAIModerationMiddleware } from \"langchain\";\n*\n* const middleware = openAIModerationMiddleware({\n*   checkInput: true,\n*   checkOutput: true,\n*   exitBehavior: \"end\"\n* });\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   tools: [...],\n*   middleware: [middleware],\n* });\n* ```\n*\n* @example Using model name\n* ```ts\n* import { createAgent, openAIModerationMiddleware } from \"langchain\";\n*\n* const middleware = openAIModerationMiddleware({\n*   model: \"gpt-4o-mini\",\n*   checkInput: true,\n*   checkOutput: true,\n*   exitBehavior: \"end\"\n* });\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   tools: [...],\n*   middleware: [middleware],\n* });\n* ```\n*\n* @example Custom violation message\n* ```ts\n* const middleware = openAIModerationMiddleware({\n*   violationMessage: \"Content flagged: {categories}. Scores: {category_scores}\"\n* });\n* ```\n*/\nfunction openAIModerationMiddleware(options) {\n\tconst { model, moderationModel = \"omni-moderation-latest\", checkInput = true, checkOutput = true, checkToolResults = false, exitBehavior = \"end\", violationMessage } = options;\n\tlet openaiModel;\n\tconst initModerationModel = async () => {\n\t\tif (openaiModel) return openaiModel;\n\t\tconst resolvedModel = typeof model === \"string\" ? await (0,_chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__.initChatModel)(model) : model;\n\t\t/**\n\t\t* Check if the model is an OpenAI model.\n\t\t*/\n\t\tif (!resolvedModel.getName().includes(\"ChatOpenAI\")) throw new Error(`Model must be an OpenAI model to use moderation middleware. Got: ${resolvedModel.getName()}`);\n\t\t/**\n\t\t* check if OpenAI model package supports moderation.\n\t\t*/\n\t\tif (!isOpenAIModel(resolvedModel)) throw new Error(\"Model must support moderation to use moderation middleware.\");\n\t\topenaiModel = resolvedModel;\n\t\treturn openaiModel;\n\t};\n\t/**\n\t* Extract text content from a message.\n\t*/\n\tconst extractText = (message) => {\n\t\tif (message.content == null) return null;\n\t\treturn message.text || null;\n\t};\n\t/**\n\t* Find the last index of a message type in the messages array.\n\t*/\n\tconst findLastIndex = (messages, messageType) => {\n\t\tfor (let idx = messages.length - 1; idx >= 0; idx--) if (messageType.isInstance(messages[idx])) return idx;\n\t\treturn null;\n\t};\n\t/**\n\t* Format violation message from moderation result.\n\t*/\n\tconst formatViolationMessage = (content, result) => {\n\t\tconst categories = [];\n\t\tconst categoriesObj = result.categories;\n\t\tfor (const [name, flagged] of Object.entries(categoriesObj)) if (flagged) categories.push(name.replace(/_/g, \" \"));\n\t\tconst categoryLabel = categories.length > 0 ? categories.join(\", \") : \"OpenAI's safety policies\";\n\t\tconst template = violationMessage || DEFAULT_VIOLATION_TEMPLATE;\n\t\tconst scoresJson = JSON.stringify(result.category_scores, null, 2);\n\t\ttry {\n\t\t\treturn template.replace(\"{categories}\", categoryLabel).replace(\"{category_scores}\", scoresJson).replace(\"{original_content}\", content);\n\t\t} catch {\n\t\t\treturn template;\n\t\t}\n\t};\n\tfunction moderateContent(input, params) {\n\t\tconst clientOptions = openaiModel?._getClientOptions?.();\n\t\tconst moderationRequest = {\n\t\t\tinput,\n\t\t\tmodel: params?.model ?? \"omni-moderation-latest\"\n\t\t};\n\t\treturn openaiModel.client.moderations.create(moderationRequest, clientOptions);\n\t}\n\t/**\n\t* Apply violation handling based on exit behavior.\n\t*/\n\tconst applyViolation = (messages, index, stage, content, result) => {\n\t\tconst violationText = formatViolationMessage(content, result);\n\t\tif (exitBehavior === \"error\") throw new OpenAIModerationError({\n\t\t\tcontent,\n\t\t\tstage,\n\t\t\tresult,\n\t\t\tmessage: violationText\n\t\t});\n\t\tif (exitBehavior === \"end\") return {\n\t\t\tjumpTo: \"end\",\n\t\t\tmessages: [new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage({ content: violationText })]\n\t\t};\n\t\tif (index == null) return;\n\t\t/**\n\t\t* Replace the original message with a new message that contains the violation text.\n\t\t*/\n\t\tconst newMessages = [...messages];\n\t\tconst original = newMessages[index];\n\t\tconst MessageConstructor = Object.getPrototypeOf(original).constructor;\n\t\tnewMessages[index] = new MessageConstructor({\n\t\t\t...original,\n\t\t\tcontent: violationText\n\t\t});\n\t\treturn { messages: newMessages };\n\t};\n\t/**\n\t* Moderate user input messages.\n\t*/\n\tconst moderateUserMessage = async (messages) => {\n\t\tconst idx = findLastIndex(messages, _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.HumanMessage);\n\t\tif (idx == null) return null;\n\t\tconst message = messages[idx];\n\t\tconst text = extractText(message);\n\t\tif (!text) return null;\n\t\tawait initModerationModel();\n\t\tconst flaggedResult = (await moderateContent(text, { model: moderationModel })).results.find((result) => result.flagged);\n\t\tif (!flaggedResult) return null;\n\t\treturn applyViolation(messages, idx, \"input\", text, flaggedResult);\n\t};\n\t/**\n\t* Moderate tool result messages.\n\t*/\n\tconst moderateToolMessages = async (messages) => {\n\t\tconst lastAiIdx = findLastIndex(messages, _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage);\n\t\tif (lastAiIdx == null) return null;\n\t\tconst working = [...messages];\n\t\tlet modified = false;\n\t\tfor (let idx = lastAiIdx + 1; idx < working.length; idx++) {\n\t\t\tconst msg = working[idx];\n\t\t\tif (!_langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.ToolMessage.isInstance(msg)) continue;\n\t\t\tconst text = extractText(msg);\n\t\t\tif (!text) continue;\n\t\t\tawait initModerationModel();\n\t\t\tconst flaggedResult = (await moderateContent(text, { model: moderationModel })).results.find((result) => result.flagged);\n\t\t\tif (!flaggedResult) continue;\n\t\t\tconst action = applyViolation(working, idx, \"tool\", text, flaggedResult);\n\t\t\tif (action) {\n\t\t\t\tif (\"jumpTo\" in action) return action;\n\t\t\t\tif (\"messages\" in action) {\n\t\t\t\t\tworking.splice(0, working.length, ...action.messages);\n\t\t\t\t\tmodified = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (modified) return { messages: working };\n\t\treturn null;\n\t};\n\t/**\n\t* Moderate model output messages.\n\t*/\n\tconst moderateOutput = async (messages) => {\n\t\tconst lastAiIdx = findLastIndex(messages, _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage);\n\t\tif (lastAiIdx == null) return null;\n\t\tconst aiMessage = messages[lastAiIdx];\n\t\tconst text = extractText(aiMessage);\n\t\tif (!text) return null;\n\t\tawait initModerationModel();\n\t\tconst flaggedResult = (await moderateContent(text, { model: moderationModel })).results.find((result) => result.flagged);\n\t\tif (!flaggedResult) return null;\n\t\treturn applyViolation(messages, lastAiIdx, \"output\", text, flaggedResult);\n\t};\n\t/**\n\t* Moderate inputs (user messages and tool results) before model call.\n\t*/\n\tconst moderateInputs = async (messages) => {\n\t\tconst working = [...messages];\n\t\tlet modified = false;\n\t\tif (checkToolResults) {\n\t\t\tconst action = await moderateToolMessages(working);\n\t\t\tif (action) {\n\t\t\t\tif (\"jumpTo\" in action) return action;\n\t\t\t\tif (\"messages\" in action) {\n\t\t\t\t\tworking.splice(0, working.length, ...action.messages);\n\t\t\t\t\tmodified = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (checkInput) {\n\t\t\tconst action = await moderateUserMessage(working);\n\t\t\tif (action) {\n\t\t\t\tif (\"jumpTo\" in action) return action;\n\t\t\t\tif (\"messages\" in action) {\n\t\t\t\t\tworking.splice(0, working.length, ...action.messages);\n\t\t\t\t\tmodified = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (modified) return { messages: working };\n\t\treturn null;\n\t};\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_1__.createMiddleware)({\n\t\tname: \"OpenAIModerationMiddleware\",\n\t\tbeforeModel: {\n\t\t\thook: async (state) => {\n\t\t\t\tif (!checkInput && !checkToolResults) return;\n\t\t\t\tconst messages = state.messages || [];\n\t\t\t\tif (messages.length === 0) return;\n\t\t\t\treturn await moderateInputs(messages) ?? void 0;\n\t\t\t},\n\t\t\tcanJumpTo: [\"end\"]\n\t\t},\n\t\tafterModel: {\n\t\t\thook: async (state) => {\n\t\t\t\tif (!checkOutput) return;\n\t\t\t\tconst messages = state.messages || [];\n\t\t\t\tif (messages.length === 0) return;\n\t\t\t\treturn await moderateOutput(messages) ?? void 0;\n\t\t\t},\n\t\t\tcanJumpTo: [\"end\"]\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=moderation.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9wcm92aWRlci9vcGVuYWkvbW9kZXJhdGlvbi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXFFO0FBQ1g7QUFDc0I7O0FBRWhGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5R0FBeUcsV0FBVztBQUNwSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxpQ0FBaUM7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDBDQUEwQztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDBDQUEwQztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLFdBQVcsV0FBVyxnQkFBZ0I7QUFDL0UsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLFNBQVMsNkpBQTZKO0FBQ3RLO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCx3RUFBYTtBQUN2RTtBQUNBO0FBQ0E7QUFDQSwySUFBMkksd0JBQXdCO0FBQ25LO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxVQUFVO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLFdBQVcsNEJBQTRCLGdCQUFnQix5QkFBeUIsaUJBQWlCO0FBQzlILElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLGtCQUFrQiwrREFBUyxHQUFHLHdCQUF3QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGtFQUFZO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsd0JBQXdCO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLCtEQUFTO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxzQkFBc0I7QUFDdEQ7QUFDQSxRQUFRLGlFQUFXO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCx3QkFBd0I7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLCtEQUFTO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsd0JBQXdCO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLFFBQVEsZ0VBQWdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ3NDO0FBQ3RDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL21pZGRsZXdhcmUvcHJvdmlkZXIvb3BlbmFpL21vZGVyYXRpb24uanM/MmZlNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpbml0Q2hhdE1vZGVsIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NoYXRfbW9kZWxzL3VuaXZlcnNhbC5qc1wiO1xuaW1wb3J0IHsgY3JlYXRlTWlkZGxld2FyZSB9IGZyb20gXCIuLi8uLi8uLi9taWRkbGV3YXJlLmpzXCI7XG5pbXBvcnQgeyBBSU1lc3NhZ2UsIEh1bWFuTWVzc2FnZSwgVG9vbE1lc3NhZ2UgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL21lc3NhZ2VzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL21pZGRsZXdhcmUvcHJvdmlkZXIvb3BlbmFpL21vZGVyYXRpb24udHNcbi8qKlxuKiBDaGVjayBpZiB0aGUgbW9kZWwgaXMgYW4gT3BlbkFJIG1vZGVsIHRoYXQgc3VwcG9ydHMgbW9kZXJhdGlvbi5cbiogQHBhcmFtIG1vZGVsIC0gVGhlIG1vZGVsIHRvIGNoZWNrLlxuKiBAcmV0dXJucyBXaGV0aGVyIHRoZSBtb2RlbCBpcyBhbiBPcGVuQUkgbW9kZWwgdGhhdCBzdXBwb3J0cyBtb2RlcmF0aW9uLlxuKi9cbmZ1bmN0aW9uIGlzT3BlbkFJTW9kZWwobW9kZWwpIHtcblx0aWYgKCFtb2RlbCB8fCB0eXBlb2YgbW9kZWwgIT09IFwib2JqZWN0XCIgfHwgbW9kZWwgPT09IG51bGwgfHwgIShcImNsaWVudFwiIGluIG1vZGVsKSB8fCAhKFwiX2dldENsaWVudE9wdGlvbnNcIiBpbiBtb2RlbCkgfHwgdHlwZW9mIG1vZGVsLl9nZXRDbGllbnRPcHRpb25zICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBmYWxzZTtcblx0LyoqXG5cdCogY2xpZW50IG1heSBub3QgeWV0IGJlIGluaXRpYWxpemVkLCBzbyB3ZSBuZWVkIHRvIGNoZWNrIGlmIHRoZSBtb2RlbCBoYXMgYSBfZ2V0Q2xpZW50T3B0aW9ucyBtZXRob2QuXG5cdCovXG5cdG1vZGVsLl9nZXRDbGllbnRPcHRpb25zKCk7XG5cdHJldHVybiB0eXBlb2YgbW9kZWwuY2xpZW50ID09PSBcIm9iamVjdFwiICYmIG1vZGVsLmNsaWVudCAhPT0gbnVsbCAmJiBcIm1vZGVyYXRpb25zXCIgaW4gbW9kZWwuY2xpZW50ICYmIHR5cGVvZiBtb2RlbC5jbGllbnQubW9kZXJhdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgbW9kZWwuY2xpZW50Lm1vZGVyYXRpb25zICE9PSBudWxsICYmIFwiY3JlYXRlXCIgaW4gbW9kZWwuY2xpZW50Lm1vZGVyYXRpb25zICYmIHR5cGVvZiBtb2RlbC5jbGllbnQubW9kZXJhdGlvbnMuY3JlYXRlID09PSBcImZ1bmN0aW9uXCI7XG59XG4vKipcbiogRGVmYXVsdCB0ZW1wbGF0ZSBmb3IgdmlvbGF0aW9uIG1lc3NhZ2VzLlxuKi9cbmNvbnN0IERFRkFVTFRfVklPTEFUSU9OX1RFTVBMQVRFID0gXCJJJ20gc29ycnksIGJ1dCBJIGNhbid0IGNvbXBseSB3aXRoIHRoYXQgcmVxdWVzdC4gSXQgd2FzIGZsYWdnZWQgZm9yIHtjYXRlZ29yaWVzfS5cIjtcbi8qKlxuKiBFcnJvciByYWlzZWQgd2hlbiBPcGVuQUkgZmxhZ3MgY29udGVudCBhbmQgYGV4aXRCZWhhdmlvcmAgaXMgc2V0IHRvIGBcImVycm9yXCJgLlxuKi9cbnZhciBPcGVuQUlNb2RlcmF0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcblx0Y29udGVudDtcblx0c3RhZ2U7XG5cdHJlc3VsdDtcblx0b3JpZ2luYWxNZXNzYWdlO1xuXHRjb25zdHJ1Y3Rvcih7IGNvbnRlbnQsIHN0YWdlLCByZXN1bHQsIG1lc3NhZ2UgfSkge1xuXHRcdHN1cGVyKG1lc3NhZ2UpO1xuXHRcdHRoaXMubmFtZSA9IFwiT3BlbkFJTW9kZXJhdGlvbkVycm9yXCI7XG5cdFx0dGhpcy5jb250ZW50ID0gY29udGVudDtcblx0XHR0aGlzLnN0YWdlID0gc3RhZ2U7XG5cdFx0dGhpcy5yZXN1bHQgPSByZXN1bHQ7XG5cdFx0dGhpcy5vcmlnaW5hbE1lc3NhZ2UgPSBtZXNzYWdlO1xuXHR9XG59O1xuLyoqXG4qIE1pZGRsZXdhcmUgdGhhdCBtb2RlcmF0ZXMgYWdlbnQgdHJhZmZpYyB1c2luZyBPcGVuQUkncyBtb2RlcmF0aW9uIGVuZHBvaW50LlxuKlxuKiBUaGlzIG1pZGRsZXdhcmUgY2hlY2tzIG1lc3NhZ2VzIGZvciBjb250ZW50IHBvbGljeSB2aW9sYXRpb25zIGF0IGRpZmZlcmVudCBzdGFnZXM6XG4qIC0gSW5wdXQ6IFVzZXIgbWVzc2FnZXMgYmVmb3JlIHRoZXkgcmVhY2ggdGhlIG1vZGVsXG4qIC0gT3V0cHV0OiBBSSBtb2RlbCByZXNwb25zZXNcbiogLSBUb29sIHJlc3VsdHM6IFJlc3VsdHMgcmV0dXJuZWQgZnJvbSB0b29sIGV4ZWN1dGlvbnNcbipcbiogQHBhcmFtIG9wdGlvbnMgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSBtaWRkbGV3YXJlXG4qIEBwYXJhbSBvcHRpb25zLm1vZGVsIC0gT3BlbkFJIG1vZGVsIHRvIHVzZSBmb3IgbW9kZXJhdGlvbi4gQ2FuIGJlIGVpdGhlciBhIG1vZGVsIG5hbWUgb3IgYSBCYXNlQ2hhdE1vZGVsIGluc3RhbmNlLlxuKiBAcGFyYW0gb3B0aW9ucy5tb2RlcmF0aW9uTW9kZWwgLSBNb2RlcmF0aW9uIG1vZGVsIHRvIHVzZS5cbiogQHBhcmFtIG9wdGlvbnMuY2hlY2tJbnB1dCAtIFdoZXRoZXIgdG8gY2hlY2sgdXNlciBpbnB1dCBtZXNzYWdlcy5cbiogQHBhcmFtIG9wdGlvbnMuY2hlY2tPdXRwdXQgLSBXaGV0aGVyIHRvIGNoZWNrIG1vZGVsIG91dHB1dCBtZXNzYWdlcy5cbiogQHBhcmFtIG9wdGlvbnMuY2hlY2tUb29sUmVzdWx0cyAtIFdoZXRoZXIgdG8gY2hlY2sgdG9vbCByZXN1bHQgbWVzc2FnZXMuXG4qIEBwYXJhbSBvcHRpb25zLmV4aXRCZWhhdmlvciAtIEhvdyB0byBoYW5kbGUgdmlvbGF0aW9ucy5cbiogQHBhcmFtIG9wdGlvbnMudmlvbGF0aW9uTWVzc2FnZSAtIEN1c3RvbSB0ZW1wbGF0ZSBmb3IgdmlvbGF0aW9uIG1lc3NhZ2VzLlxuKiBAcmV0dXJucyBNaWRkbGV3YXJlIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gbW9kZXJhdGUgYWdlbnQgdHJhZmZpYy5cbipcbiogQGV4YW1wbGUgIFVzaW5nIG1vZGVsIGluc3RhbmNlXG4qIGBgYHRzXG4qIGltcG9ydCB7IGNyZWF0ZUFnZW50LCBvcGVuQUlNb2RlcmF0aW9uTWlkZGxld2FyZSB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbipcbiogY29uc3QgbWlkZGxld2FyZSA9IG9wZW5BSU1vZGVyYXRpb25NaWRkbGV3YXJlKHtcbiogICBjaGVja0lucHV0OiB0cnVlLFxuKiAgIGNoZWNrT3V0cHV0OiB0cnVlLFxuKiAgIGV4aXRCZWhhdmlvcjogXCJlbmRcIlxuKiB9KTtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIHRvb2xzOiBbLi4uXSxcbiogICBtaWRkbGV3YXJlOiBbbWlkZGxld2FyZV0sXG4qIH0pO1xuKiBgYGBcbipcbiogQGV4YW1wbGUgVXNpbmcgbW9kZWwgbmFtZVxuKiBgYGB0c1xuKiBpbXBvcnQgeyBjcmVhdGVBZ2VudCwgb3BlbkFJTW9kZXJhdGlvbk1pZGRsZXdhcmUgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qXG4qIGNvbnN0IG1pZGRsZXdhcmUgPSBvcGVuQUlNb2RlcmF0aW9uTWlkZGxld2FyZSh7XG4qICAgbW9kZWw6IFwiZ3B0LTRvLW1pbmlcIixcbiogICBjaGVja0lucHV0OiB0cnVlLFxuKiAgIGNoZWNrT3V0cHV0OiB0cnVlLFxuKiAgIGV4aXRCZWhhdmlvcjogXCJlbmRcIlxuKiB9KTtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIHRvb2xzOiBbLi4uXSxcbiogICBtaWRkbGV3YXJlOiBbbWlkZGxld2FyZV0sXG4qIH0pO1xuKiBgYGBcbipcbiogQGV4YW1wbGUgQ3VzdG9tIHZpb2xhdGlvbiBtZXNzYWdlXG4qIGBgYHRzXG4qIGNvbnN0IG1pZGRsZXdhcmUgPSBvcGVuQUlNb2RlcmF0aW9uTWlkZGxld2FyZSh7XG4qICAgdmlvbGF0aW9uTWVzc2FnZTogXCJDb250ZW50IGZsYWdnZWQ6IHtjYXRlZ29yaWVzfS4gU2NvcmVzOiB7Y2F0ZWdvcnlfc2NvcmVzfVwiXG4qIH0pO1xuKiBgYGBcbiovXG5mdW5jdGlvbiBvcGVuQUlNb2RlcmF0aW9uTWlkZGxld2FyZShvcHRpb25zKSB7XG5cdGNvbnN0IHsgbW9kZWwsIG1vZGVyYXRpb25Nb2RlbCA9IFwib21uaS1tb2RlcmF0aW9uLWxhdGVzdFwiLCBjaGVja0lucHV0ID0gdHJ1ZSwgY2hlY2tPdXRwdXQgPSB0cnVlLCBjaGVja1Rvb2xSZXN1bHRzID0gZmFsc2UsIGV4aXRCZWhhdmlvciA9IFwiZW5kXCIsIHZpb2xhdGlvbk1lc3NhZ2UgfSA9IG9wdGlvbnM7XG5cdGxldCBvcGVuYWlNb2RlbDtcblx0Y29uc3QgaW5pdE1vZGVyYXRpb25Nb2RlbCA9IGFzeW5jICgpID0+IHtcblx0XHRpZiAob3BlbmFpTW9kZWwpIHJldHVybiBvcGVuYWlNb2RlbDtcblx0XHRjb25zdCByZXNvbHZlZE1vZGVsID0gdHlwZW9mIG1vZGVsID09PSBcInN0cmluZ1wiID8gYXdhaXQgaW5pdENoYXRNb2RlbChtb2RlbCkgOiBtb2RlbDtcblx0XHQvKipcblx0XHQqIENoZWNrIGlmIHRoZSBtb2RlbCBpcyBhbiBPcGVuQUkgbW9kZWwuXG5cdFx0Ki9cblx0XHRpZiAoIXJlc29sdmVkTW9kZWwuZ2V0TmFtZSgpLmluY2x1ZGVzKFwiQ2hhdE9wZW5BSVwiKSkgdGhyb3cgbmV3IEVycm9yKGBNb2RlbCBtdXN0IGJlIGFuIE9wZW5BSSBtb2RlbCB0byB1c2UgbW9kZXJhdGlvbiBtaWRkbGV3YXJlLiBHb3Q6ICR7cmVzb2x2ZWRNb2RlbC5nZXROYW1lKCl9YCk7XG5cdFx0LyoqXG5cdFx0KiBjaGVjayBpZiBPcGVuQUkgbW9kZWwgcGFja2FnZSBzdXBwb3J0cyBtb2RlcmF0aW9uLlxuXHRcdCovXG5cdFx0aWYgKCFpc09wZW5BSU1vZGVsKHJlc29sdmVkTW9kZWwpKSB0aHJvdyBuZXcgRXJyb3IoXCJNb2RlbCBtdXN0IHN1cHBvcnQgbW9kZXJhdGlvbiB0byB1c2UgbW9kZXJhdGlvbiBtaWRkbGV3YXJlLlwiKTtcblx0XHRvcGVuYWlNb2RlbCA9IHJlc29sdmVkTW9kZWw7XG5cdFx0cmV0dXJuIG9wZW5haU1vZGVsO1xuXHR9O1xuXHQvKipcblx0KiBFeHRyYWN0IHRleHQgY29udGVudCBmcm9tIGEgbWVzc2FnZS5cblx0Ki9cblx0Y29uc3QgZXh0cmFjdFRleHQgPSAobWVzc2FnZSkgPT4ge1xuXHRcdGlmIChtZXNzYWdlLmNvbnRlbnQgPT0gbnVsbCkgcmV0dXJuIG51bGw7XG5cdFx0cmV0dXJuIG1lc3NhZ2UudGV4dCB8fCBudWxsO1xuXHR9O1xuXHQvKipcblx0KiBGaW5kIHRoZSBsYXN0IGluZGV4IG9mIGEgbWVzc2FnZSB0eXBlIGluIHRoZSBtZXNzYWdlcyBhcnJheS5cblx0Ki9cblx0Y29uc3QgZmluZExhc3RJbmRleCA9IChtZXNzYWdlcywgbWVzc2FnZVR5cGUpID0+IHtcblx0XHRmb3IgKGxldCBpZHggPSBtZXNzYWdlcy5sZW5ndGggLSAxOyBpZHggPj0gMDsgaWR4LS0pIGlmIChtZXNzYWdlVHlwZS5pc0luc3RhbmNlKG1lc3NhZ2VzW2lkeF0pKSByZXR1cm4gaWR4O1xuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXHQvKipcblx0KiBGb3JtYXQgdmlvbGF0aW9uIG1lc3NhZ2UgZnJvbSBtb2RlcmF0aW9uIHJlc3VsdC5cblx0Ki9cblx0Y29uc3QgZm9ybWF0VmlvbGF0aW9uTWVzc2FnZSA9IChjb250ZW50LCByZXN1bHQpID0+IHtcblx0XHRjb25zdCBjYXRlZ29yaWVzID0gW107XG5cdFx0Y29uc3QgY2F0ZWdvcmllc09iaiA9IHJlc3VsdC5jYXRlZ29yaWVzO1xuXHRcdGZvciAoY29uc3QgW25hbWUsIGZsYWdnZWRdIG9mIE9iamVjdC5lbnRyaWVzKGNhdGVnb3JpZXNPYmopKSBpZiAoZmxhZ2dlZCkgY2F0ZWdvcmllcy5wdXNoKG5hbWUucmVwbGFjZSgvXy9nLCBcIiBcIikpO1xuXHRcdGNvbnN0IGNhdGVnb3J5TGFiZWwgPSBjYXRlZ29yaWVzLmxlbmd0aCA+IDAgPyBjYXRlZ29yaWVzLmpvaW4oXCIsIFwiKSA6IFwiT3BlbkFJJ3Mgc2FmZXR5IHBvbGljaWVzXCI7XG5cdFx0Y29uc3QgdGVtcGxhdGUgPSB2aW9sYXRpb25NZXNzYWdlIHx8IERFRkFVTFRfVklPTEFUSU9OX1RFTVBMQVRFO1xuXHRcdGNvbnN0IHNjb3Jlc0pzb24gPSBKU09OLnN0cmluZ2lmeShyZXN1bHQuY2F0ZWdvcnlfc2NvcmVzLCBudWxsLCAyKTtcblx0XHR0cnkge1xuXHRcdFx0cmV0dXJuIHRlbXBsYXRlLnJlcGxhY2UoXCJ7Y2F0ZWdvcmllc31cIiwgY2F0ZWdvcnlMYWJlbCkucmVwbGFjZShcIntjYXRlZ29yeV9zY29yZXN9XCIsIHNjb3Jlc0pzb24pLnJlcGxhY2UoXCJ7b3JpZ2luYWxfY29udGVudH1cIiwgY29udGVudCk7XG5cdFx0fSBjYXRjaCB7XG5cdFx0XHRyZXR1cm4gdGVtcGxhdGU7XG5cdFx0fVxuXHR9O1xuXHRmdW5jdGlvbiBtb2RlcmF0ZUNvbnRlbnQoaW5wdXQsIHBhcmFtcykge1xuXHRcdGNvbnN0IGNsaWVudE9wdGlvbnMgPSBvcGVuYWlNb2RlbD8uX2dldENsaWVudE9wdGlvbnM/LigpO1xuXHRcdGNvbnN0IG1vZGVyYXRpb25SZXF1ZXN0ID0ge1xuXHRcdFx0aW5wdXQsXG5cdFx0XHRtb2RlbDogcGFyYW1zPy5tb2RlbCA/PyBcIm9tbmktbW9kZXJhdGlvbi1sYXRlc3RcIlxuXHRcdH07XG5cdFx0cmV0dXJuIG9wZW5haU1vZGVsLmNsaWVudC5tb2RlcmF0aW9ucy5jcmVhdGUobW9kZXJhdGlvblJlcXVlc3QsIGNsaWVudE9wdGlvbnMpO1xuXHR9XG5cdC8qKlxuXHQqIEFwcGx5IHZpb2xhdGlvbiBoYW5kbGluZyBiYXNlZCBvbiBleGl0IGJlaGF2aW9yLlxuXHQqL1xuXHRjb25zdCBhcHBseVZpb2xhdGlvbiA9IChtZXNzYWdlcywgaW5kZXgsIHN0YWdlLCBjb250ZW50LCByZXN1bHQpID0+IHtcblx0XHRjb25zdCB2aW9sYXRpb25UZXh0ID0gZm9ybWF0VmlvbGF0aW9uTWVzc2FnZShjb250ZW50LCByZXN1bHQpO1xuXHRcdGlmIChleGl0QmVoYXZpb3IgPT09IFwiZXJyb3JcIikgdGhyb3cgbmV3IE9wZW5BSU1vZGVyYXRpb25FcnJvcih7XG5cdFx0XHRjb250ZW50LFxuXHRcdFx0c3RhZ2UsXG5cdFx0XHRyZXN1bHQsXG5cdFx0XHRtZXNzYWdlOiB2aW9sYXRpb25UZXh0XG5cdFx0fSk7XG5cdFx0aWYgKGV4aXRCZWhhdmlvciA9PT0gXCJlbmRcIikgcmV0dXJuIHtcblx0XHRcdGp1bXBUbzogXCJlbmRcIixcblx0XHRcdG1lc3NhZ2VzOiBbbmV3IEFJTWVzc2FnZSh7IGNvbnRlbnQ6IHZpb2xhdGlvblRleHQgfSldXG5cdFx0fTtcblx0XHRpZiAoaW5kZXggPT0gbnVsbCkgcmV0dXJuO1xuXHRcdC8qKlxuXHRcdCogUmVwbGFjZSB0aGUgb3JpZ2luYWwgbWVzc2FnZSB3aXRoIGEgbmV3IG1lc3NhZ2UgdGhhdCBjb250YWlucyB0aGUgdmlvbGF0aW9uIHRleHQuXG5cdFx0Ki9cblx0XHRjb25zdCBuZXdNZXNzYWdlcyA9IFsuLi5tZXNzYWdlc107XG5cdFx0Y29uc3Qgb3JpZ2luYWwgPSBuZXdNZXNzYWdlc1tpbmRleF07XG5cdFx0Y29uc3QgTWVzc2FnZUNvbnN0cnVjdG9yID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9yaWdpbmFsKS5jb25zdHJ1Y3Rvcjtcblx0XHRuZXdNZXNzYWdlc1tpbmRleF0gPSBuZXcgTWVzc2FnZUNvbnN0cnVjdG9yKHtcblx0XHRcdC4uLm9yaWdpbmFsLFxuXHRcdFx0Y29udGVudDogdmlvbGF0aW9uVGV4dFxuXHRcdH0pO1xuXHRcdHJldHVybiB7IG1lc3NhZ2VzOiBuZXdNZXNzYWdlcyB9O1xuXHR9O1xuXHQvKipcblx0KiBNb2RlcmF0ZSB1c2VyIGlucHV0IG1lc3NhZ2VzLlxuXHQqL1xuXHRjb25zdCBtb2RlcmF0ZVVzZXJNZXNzYWdlID0gYXN5bmMgKG1lc3NhZ2VzKSA9PiB7XG5cdFx0Y29uc3QgaWR4ID0gZmluZExhc3RJbmRleChtZXNzYWdlcywgSHVtYW5NZXNzYWdlKTtcblx0XHRpZiAoaWR4ID09IG51bGwpIHJldHVybiBudWxsO1xuXHRcdGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlc1tpZHhdO1xuXHRcdGNvbnN0IHRleHQgPSBleHRyYWN0VGV4dChtZXNzYWdlKTtcblx0XHRpZiAoIXRleHQpIHJldHVybiBudWxsO1xuXHRcdGF3YWl0IGluaXRNb2RlcmF0aW9uTW9kZWwoKTtcblx0XHRjb25zdCBmbGFnZ2VkUmVzdWx0ID0gKGF3YWl0IG1vZGVyYXRlQ29udGVudCh0ZXh0LCB7IG1vZGVsOiBtb2RlcmF0aW9uTW9kZWwgfSkpLnJlc3VsdHMuZmluZCgocmVzdWx0KSA9PiByZXN1bHQuZmxhZ2dlZCk7XG5cdFx0aWYgKCFmbGFnZ2VkUmVzdWx0KSByZXR1cm4gbnVsbDtcblx0XHRyZXR1cm4gYXBwbHlWaW9sYXRpb24obWVzc2FnZXMsIGlkeCwgXCJpbnB1dFwiLCB0ZXh0LCBmbGFnZ2VkUmVzdWx0KTtcblx0fTtcblx0LyoqXG5cdCogTW9kZXJhdGUgdG9vbCByZXN1bHQgbWVzc2FnZXMuXG5cdCovXG5cdGNvbnN0IG1vZGVyYXRlVG9vbE1lc3NhZ2VzID0gYXN5bmMgKG1lc3NhZ2VzKSA9PiB7XG5cdFx0Y29uc3QgbGFzdEFpSWR4ID0gZmluZExhc3RJbmRleChtZXNzYWdlcywgQUlNZXNzYWdlKTtcblx0XHRpZiAobGFzdEFpSWR4ID09IG51bGwpIHJldHVybiBudWxsO1xuXHRcdGNvbnN0IHdvcmtpbmcgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGxldCBtb2RpZmllZCA9IGZhbHNlO1xuXHRcdGZvciAobGV0IGlkeCA9IGxhc3RBaUlkeCArIDE7IGlkeCA8IHdvcmtpbmcubGVuZ3RoOyBpZHgrKykge1xuXHRcdFx0Y29uc3QgbXNnID0gd29ya2luZ1tpZHhdO1xuXHRcdFx0aWYgKCFUb29sTWVzc2FnZS5pc0luc3RhbmNlKG1zZykpIGNvbnRpbnVlO1xuXHRcdFx0Y29uc3QgdGV4dCA9IGV4dHJhY3RUZXh0KG1zZyk7XG5cdFx0XHRpZiAoIXRleHQpIGNvbnRpbnVlO1xuXHRcdFx0YXdhaXQgaW5pdE1vZGVyYXRpb25Nb2RlbCgpO1xuXHRcdFx0Y29uc3QgZmxhZ2dlZFJlc3VsdCA9IChhd2FpdCBtb2RlcmF0ZUNvbnRlbnQodGV4dCwgeyBtb2RlbDogbW9kZXJhdGlvbk1vZGVsIH0pKS5yZXN1bHRzLmZpbmQoKHJlc3VsdCkgPT4gcmVzdWx0LmZsYWdnZWQpO1xuXHRcdFx0aWYgKCFmbGFnZ2VkUmVzdWx0KSBjb250aW51ZTtcblx0XHRcdGNvbnN0IGFjdGlvbiA9IGFwcGx5VmlvbGF0aW9uKHdvcmtpbmcsIGlkeCwgXCJ0b29sXCIsIHRleHQsIGZsYWdnZWRSZXN1bHQpO1xuXHRcdFx0aWYgKGFjdGlvbikge1xuXHRcdFx0XHRpZiAoXCJqdW1wVG9cIiBpbiBhY3Rpb24pIHJldHVybiBhY3Rpb247XG5cdFx0XHRcdGlmIChcIm1lc3NhZ2VzXCIgaW4gYWN0aW9uKSB7XG5cdFx0XHRcdFx0d29ya2luZy5zcGxpY2UoMCwgd29ya2luZy5sZW5ndGgsIC4uLmFjdGlvbi5tZXNzYWdlcyk7XG5cdFx0XHRcdFx0bW9kaWZpZWQgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChtb2RpZmllZCkgcmV0dXJuIHsgbWVzc2FnZXM6IHdvcmtpbmcgfTtcblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcblx0LyoqXG5cdCogTW9kZXJhdGUgbW9kZWwgb3V0cHV0IG1lc3NhZ2VzLlxuXHQqL1xuXHRjb25zdCBtb2RlcmF0ZU91dHB1dCA9IGFzeW5jIChtZXNzYWdlcykgPT4ge1xuXHRcdGNvbnN0IGxhc3RBaUlkeCA9IGZpbmRMYXN0SW5kZXgobWVzc2FnZXMsIEFJTWVzc2FnZSk7XG5cdFx0aWYgKGxhc3RBaUlkeCA9PSBudWxsKSByZXR1cm4gbnVsbDtcblx0XHRjb25zdCBhaU1lc3NhZ2UgPSBtZXNzYWdlc1tsYXN0QWlJZHhdO1xuXHRcdGNvbnN0IHRleHQgPSBleHRyYWN0VGV4dChhaU1lc3NhZ2UpO1xuXHRcdGlmICghdGV4dCkgcmV0dXJuIG51bGw7XG5cdFx0YXdhaXQgaW5pdE1vZGVyYXRpb25Nb2RlbCgpO1xuXHRcdGNvbnN0IGZsYWdnZWRSZXN1bHQgPSAoYXdhaXQgbW9kZXJhdGVDb250ZW50KHRleHQsIHsgbW9kZWw6IG1vZGVyYXRpb25Nb2RlbCB9KSkucmVzdWx0cy5maW5kKChyZXN1bHQpID0+IHJlc3VsdC5mbGFnZ2VkKTtcblx0XHRpZiAoIWZsYWdnZWRSZXN1bHQpIHJldHVybiBudWxsO1xuXHRcdHJldHVybiBhcHBseVZpb2xhdGlvbihtZXNzYWdlcywgbGFzdEFpSWR4LCBcIm91dHB1dFwiLCB0ZXh0LCBmbGFnZ2VkUmVzdWx0KTtcblx0fTtcblx0LyoqXG5cdCogTW9kZXJhdGUgaW5wdXRzICh1c2VyIG1lc3NhZ2VzIGFuZCB0b29sIHJlc3VsdHMpIGJlZm9yZSBtb2RlbCBjYWxsLlxuXHQqL1xuXHRjb25zdCBtb2RlcmF0ZUlucHV0cyA9IGFzeW5jIChtZXNzYWdlcykgPT4ge1xuXHRcdGNvbnN0IHdvcmtpbmcgPSBbLi4ubWVzc2FnZXNdO1xuXHRcdGxldCBtb2RpZmllZCA9IGZhbHNlO1xuXHRcdGlmIChjaGVja1Rvb2xSZXN1bHRzKSB7XG5cdFx0XHRjb25zdCBhY3Rpb24gPSBhd2FpdCBtb2RlcmF0ZVRvb2xNZXNzYWdlcyh3b3JraW5nKTtcblx0XHRcdGlmIChhY3Rpb24pIHtcblx0XHRcdFx0aWYgKFwianVtcFRvXCIgaW4gYWN0aW9uKSByZXR1cm4gYWN0aW9uO1xuXHRcdFx0XHRpZiAoXCJtZXNzYWdlc1wiIGluIGFjdGlvbikge1xuXHRcdFx0XHRcdHdvcmtpbmcuc3BsaWNlKDAsIHdvcmtpbmcubGVuZ3RoLCAuLi5hY3Rpb24ubWVzc2FnZXMpO1xuXHRcdFx0XHRcdG1vZGlmaWVkID0gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAoY2hlY2tJbnB1dCkge1xuXHRcdFx0Y29uc3QgYWN0aW9uID0gYXdhaXQgbW9kZXJhdGVVc2VyTWVzc2FnZSh3b3JraW5nKTtcblx0XHRcdGlmIChhY3Rpb24pIHtcblx0XHRcdFx0aWYgKFwianVtcFRvXCIgaW4gYWN0aW9uKSByZXR1cm4gYWN0aW9uO1xuXHRcdFx0XHRpZiAoXCJtZXNzYWdlc1wiIGluIGFjdGlvbikge1xuXHRcdFx0XHRcdHdvcmtpbmcuc3BsaWNlKDAsIHdvcmtpbmcubGVuZ3RoLCAuLi5hY3Rpb24ubWVzc2FnZXMpO1xuXHRcdFx0XHRcdG1vZGlmaWVkID0gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAobW9kaWZpZWQpIHJldHVybiB7IG1lc3NhZ2VzOiB3b3JraW5nIH07XG5cdFx0cmV0dXJuIG51bGw7XG5cdH07XG5cdHJldHVybiBjcmVhdGVNaWRkbGV3YXJlKHtcblx0XHRuYW1lOiBcIk9wZW5BSU1vZGVyYXRpb25NaWRkbGV3YXJlXCIsXG5cdFx0YmVmb3JlTW9kZWw6IHtcblx0XHRcdGhvb2s6IGFzeW5jIChzdGF0ZSkgPT4ge1xuXHRcdFx0XHRpZiAoIWNoZWNrSW5wdXQgJiYgIWNoZWNrVG9vbFJlc3VsdHMpIHJldHVybjtcblx0XHRcdFx0Y29uc3QgbWVzc2FnZXMgPSBzdGF0ZS5tZXNzYWdlcyB8fCBbXTtcblx0XHRcdFx0aWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXHRcdFx0XHRyZXR1cm4gYXdhaXQgbW9kZXJhdGVJbnB1dHMobWVzc2FnZXMpID8/IHZvaWQgMDtcblx0XHRcdH0sXG5cdFx0XHRjYW5KdW1wVG86IFtcImVuZFwiXVxuXHRcdH0sXG5cdFx0YWZ0ZXJNb2RlbDoge1xuXHRcdFx0aG9vazogYXN5bmMgKHN0YXRlKSA9PiB7XG5cdFx0XHRcdGlmICghY2hlY2tPdXRwdXQpIHJldHVybjtcblx0XHRcdFx0Y29uc3QgbWVzc2FnZXMgPSBzdGF0ZS5tZXNzYWdlcyB8fCBbXTtcblx0XHRcdFx0aWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXHRcdFx0XHRyZXR1cm4gYXdhaXQgbW9kZXJhdGVPdXRwdXQobWVzc2FnZXMpID8/IHZvaWQgMDtcblx0XHRcdH0sXG5cdFx0XHRjYW5KdW1wVG86IFtcImVuZFwiXVxuXHRcdH1cblx0fSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgb3BlbkFJTW9kZXJhdGlvbk1pZGRsZXdhcmUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZGVyYXRpb24uanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/openai/moderation.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/summarization.js":
/*!********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/summarization.js ***!
  \********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   contextSizeSchema: () => (/* binding */ contextSizeSchema),\n/* harmony export */   getProfileLimits: () => (/* binding */ getProfileLimits),\n/* harmony export */   keepSchema: () => (/* binding */ keepSchema),\n/* harmony export */   summarizationMiddleware: () => (/* binding */ summarizationMiddleware)\n/* harmony export */ });\n/* harmony import */ var _chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chat_models/universal.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/utils.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/runnables/index.js\");\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n/* harmony import */ var _langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @langchain/core/utils/types */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/types/index.js\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/.pnpm/uuid@10.0.0/node_modules/uuid/dist/esm-node/v4.js\");\n/* harmony import */ var _langchain_core_language_models_base__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @langchain/core/language_models/base */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/language_models/base.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n//#region src/agents/middleware/summarization.ts\nconst DEFAULT_SUMMARY_PROMPT = `<role>\nContext Extraction Assistant\n</role>\n\n<primary_objective>\nYour sole objective in this task is to extract the highest quality/most relevant context from the conversation history below.\n</primary_objective>\n\n<objective_information>\nYou're nearing the total number of input tokens you can accept, so you must extract the highest quality/most relevant pieces of information from your conversation history.\nThis context will then overwrite the conversation history presented below. Because of this, ensure the context you extract is only the most important information to your overall goal.\n</objective_information>\n\n<instructions>\nThe conversation history below will be replaced with the context you extract in this step. Because of this, you must do your very best to extract and record all of the most important context from the conversation history.\nYou want to ensure that you don't repeat any actions you've already completed, so the context you extract from the conversation history should be focused on the most important information to your overall goal.\n</instructions>\n\nThe user will message you with the full message history you'll be extracting context from, to then replace. Carefully read over it all, and think deeply about what information is most important to your overall goal that should be saved:\n\nWith all of this in mind, please carefully read over the entire conversation history, and extract the most important and relevant context to replace it so that you can free up space in the conversation history.\nRespond ONLY with the extracted context. Do not include any additional information, or text before or after the extracted context.\n\n<messages>\nMessages to summarize:\n{messages}\n</messages>`;\nconst DEFAULT_SUMMARY_PREFIX = \"Here is a summary of the conversation to date:\";\nconst DEFAULT_MESSAGES_TO_KEEP = 20;\nconst DEFAULT_TRIM_TOKEN_LIMIT = 4e3;\nconst DEFAULT_FALLBACK_MESSAGE_COUNT = 15;\nconst SEARCH_RANGE_FOR_TOOL_PAIRS = 5;\nconst tokenCounterSchema = zod_v3__WEBPACK_IMPORTED_MODULE_9__.z[\"function\"]().args(zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.array(zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.custom())).returns(zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.union([zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number(), zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.promise(zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number())]));\nconst contextSizeSchema = zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.object({\n\tfraction: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number().gt(0, \"Fraction must be greater than 0\").max(1, \"Fraction must be less than or equal to 1\").optional(),\n\ttokens: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number().positive(\"Tokens must be greater than 0\").optional(),\n\tmessages: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number().int(\"Messages must be an integer\").positive(\"Messages must be greater than 0\").optional()\n}).refine((data) => {\n\treturn [\n\t\tdata.fraction,\n\t\tdata.tokens,\n\t\tdata.messages\n\t].filter((v) => v !== void 0).length >= 1;\n}, { message: \"At least one of fraction, tokens, or messages must be provided\" });\nconst keepSchema = zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.object({\n\tfraction: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number().min(0, \"Messages must be non-negative\").max(1, \"Fraction must be less than or equal to 1\").optional(),\n\ttokens: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number().min(0, \"Tokens must be greater than or equal to 0\").optional(),\n\tmessages: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number().int(\"Messages must be an integer\").min(0, \"Messages must be non-negative\").optional()\n}).refine((data) => {\n\treturn [\n\t\tdata.fraction,\n\t\tdata.tokens,\n\t\tdata.messages\n\t].filter((v) => v !== void 0).length === 1;\n}, { message: \"Exactly one of fraction, tokens, or messages must be provided\" });\nconst contextSchema = zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.object({\n\tmodel: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.custom(),\n\ttrigger: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.union([contextSizeSchema, zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.array(contextSizeSchema)]).optional(),\n\tkeep: keepSchema.optional(),\n\ttokenCounter: tokenCounterSchema.optional(),\n\tsummaryPrompt: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.string().default(DEFAULT_SUMMARY_PROMPT),\n\ttrimTokensToSummarize: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number().optional(),\n\tsummaryPrefix: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.string().optional(),\n\tmaxTokensBeforeSummary: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number().optional(),\n\tmessagesToKeep: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.number().optional()\n});\n/**\n* Get max input tokens from model profile or fallback to model name lookup\n*/\nfunction getProfileLimits(input) {\n\tif (\"profile\" in input && typeof input.profile === \"object\" && input.profile && \"maxInputTokens\" in input.profile && (typeof input.profile.maxInputTokens === \"number\" || input.profile.maxInputTokens == null)) return input.profile.maxInputTokens ?? void 0;\n\tif (\"model\" in input && typeof input.model === \"string\") return (0,_langchain_core_language_models_base__WEBPACK_IMPORTED_MODULE_10__.getModelContextSize)(input.model);\n\tif (\"modelName\" in input && typeof input.modelName === \"string\") return (0,_langchain_core_language_models_base__WEBPACK_IMPORTED_MODULE_10__.getModelContextSize)(input.modelName);\n}\n/**\n* Summarization middleware that automatically summarizes conversation history when token limits are approached.\n*\n* This middleware monitors message token counts and automatically summarizes older\n* messages when a threshold is reached, preserving recent messages and maintaining\n* context continuity by ensuring AI/Tool message pairs remain together.\n*\n* @param options Configuration options for the summarization middleware\n* @returns A middleware instance\n*\n* @example\n* ```ts\n* import { summarizationMiddleware } from \"langchain\";\n* import { createAgent } from \"langchain\";\n*\n* // Single condition: trigger if tokens >= 4000 AND messages >= 10\n* const agent1 = createAgent({\n*   llm: model,\n*   tools: [getWeather],\n*   middleware: [\n*     summarizationMiddleware({\n*       model: new ChatOpenAI({ model: \"gpt-4o\" }),\n*       trigger: { tokens: 4000, messages: 10 },\n*       keep: { messages: 20 },\n*     })\n*   ],\n* });\n*\n* // Multiple conditions: trigger if (tokens >= 5000 AND messages >= 3) OR (tokens >= 3000 AND messages >= 6)\n* const agent2 = createAgent({\n*   llm: model,\n*   tools: [getWeather],\n*   middleware: [\n*     summarizationMiddleware({\n*       model: new ChatOpenAI({ model: \"gpt-4o\" }),\n*       trigger: [\n*         { tokens: 5000, messages: 3 },\n*         { tokens: 3000, messages: 6 },\n*       ],\n*       keep: { messages: 20 },\n*     })\n*   ],\n* });\n*\n* ```\n*/\nfunction summarizationMiddleware(options) {\n\t/**\n\t* Parse user options to get their explicit values\n\t*/\n\tconst { data: userOptions, error } = (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_7__.interopSafeParse)(contextSchema, options);\n\tif (error) throw new Error(`Invalid summarization middleware options: ${zod_v4__WEBPACK_IMPORTED_MODULE_8__.z.prettifyError(error)}`);\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_3__.createMiddleware)({\n\t\tname: \"SummarizationMiddleware\",\n\t\tcontextSchema: contextSchema.extend({ model: zod_v3__WEBPACK_IMPORTED_MODULE_9__.z.custom().optional() }),\n\t\tbeforeModel: async (state, runtime) => {\n\t\t\tlet trigger = userOptions.trigger;\n\t\t\tlet keep = userOptions.keep;\n\t\t\t/**\n\t\t\t* Handle deprecated parameters\n\t\t\t*/\n\t\t\tif (userOptions.maxTokensBeforeSummary !== void 0) {\n\t\t\t\tconsole.warn(\"maxTokensBeforeSummary is deprecated. Use `trigger: { tokens: value }` instead.\");\n\t\t\t\tif (trigger === void 0) trigger = { tokens: userOptions.maxTokensBeforeSummary };\n\t\t\t}\n\t\t\t/**\n\t\t\t* Handle deprecated parameters\n\t\t\t*/\n\t\t\tif (userOptions.messagesToKeep !== void 0) {\n\t\t\t\tconsole.warn(\"messagesToKeep is deprecated. Use `keep: { messages: value }` instead.\");\n\t\t\t\tif (!keep || keep && \"messages\" in keep && keep.messages === DEFAULT_MESSAGES_TO_KEEP) keep = { messages: userOptions.messagesToKeep };\n\t\t\t}\n\t\t\t/**\n\t\t\t* Merge context with user options\n\t\t\t*/\n\t\t\tconst resolvedTrigger = runtime.context?.trigger !== void 0 ? runtime.context.trigger : trigger;\n\t\t\tconst resolvedKeep = runtime.context?.keep !== void 0 ? runtime.context.keep : keep ?? { messages: DEFAULT_MESSAGES_TO_KEEP };\n\t\t\tconst validatedKeep = keepSchema.parse(resolvedKeep);\n\t\t\t/**\n\t\t\t* Validate trigger conditions\n\t\t\t*/\n\t\t\tlet triggerConditions = [];\n\t\t\tif (resolvedTrigger === void 0) triggerConditions = [];\n\t\t\telse if (Array.isArray(resolvedTrigger))\n /**\n\t\t\t* It's an array of ContextSize objects\n\t\t\t*/\n\t\t\ttriggerConditions = resolvedTrigger.map((t) => contextSizeSchema.parse(t));\n\t\t\telse\n /**\n\t\t\t* Single ContextSize object - all properties must be satisfied (AND logic)\n\t\t\t*/\n\t\t\ttriggerConditions = [contextSizeSchema.parse(resolvedTrigger)];\n\t\t\t/**\n\t\t\t* Check if profile is required\n\t\t\t*/\n\t\t\tconst requiresProfile = triggerConditions.some((c) => \"fraction\" in c) || \"fraction\" in validatedKeep;\n\t\t\tconst model = typeof userOptions.model === \"string\" ? await (0,_chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__.initChatModel)(userOptions.model) : userOptions.model;\n\t\t\tif (requiresProfile && !getProfileLimits(model)) throw new Error(\"Model profile information is required to use fractional token limits. Use absolute token counts instead.\");\n\t\t\tconst summaryPrompt = runtime.context?.summaryPrompt === DEFAULT_SUMMARY_PROMPT ? userOptions.summaryPrompt ?? DEFAULT_SUMMARY_PROMPT : runtime.context?.summaryPrompt ?? userOptions.summaryPrompt ?? DEFAULT_SUMMARY_PROMPT;\n\t\t\tconst summaryPrefix = runtime.context.summaryPrefix ?? userOptions.summaryPrefix ?? DEFAULT_SUMMARY_PREFIX;\n\t\t\tconst trimTokensToSummarize = runtime.context?.trimTokensToSummarize !== void 0 ? runtime.context.trimTokensToSummarize : userOptions.trimTokensToSummarize ?? DEFAULT_TRIM_TOKEN_LIMIT;\n\t\t\t/**\n\t\t\t* Ensure all messages have IDs\n\t\t\t*/\n\t\t\tensureMessageIds(state.messages);\n\t\t\tconst tokenCounter = runtime.context?.tokenCounter !== void 0 ? runtime.context.tokenCounter : userOptions.tokenCounter ?? _utils_js__WEBPACK_IMPORTED_MODULE_2__.countTokensApproximately;\n\t\t\tconst totalTokens = await tokenCounter(state.messages);\n\t\t\tif (!await shouldSummarize(state.messages, totalTokens, triggerConditions, model)) return;\n\t\t\tconst { systemPrompt, conversationMessages } = splitSystemMessage(state.messages);\n\t\t\tconst cutoffIndex = await determineCutoffIndex(conversationMessages, validatedKeep, tokenCounter, model);\n\t\t\tif (cutoffIndex <= 0) return;\n\t\t\tconst { messagesToSummarize, preservedMessages } = partitionMessages(systemPrompt, conversationMessages, cutoffIndex);\n\t\t\tconst summaryMessage = new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.HumanMessage({\n\t\t\t\tcontent: `${summaryPrefix}\\n\\n${await createSummary(messagesToSummarize, model, summaryPrompt, tokenCounter, trimTokensToSummarize, runtime)}`,\n\t\t\t\tid: (0,uuid__WEBPACK_IMPORTED_MODULE_11__[\"default\"])(),\n\t\t\t\tadditional_kwargs: { lc_source: \"summarization\" }\n\t\t\t});\n\t\t\treturn { messages: [\n\t\t\t\tnew _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.RemoveMessage({ id: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_6__.REMOVE_ALL_MESSAGES }),\n\t\t\t\tsummaryMessage,\n\t\t\t\t...preservedMessages\n\t\t\t] };\n\t\t}\n\t});\n}\n/**\n* Ensure all messages have unique IDs\n*/\nfunction ensureMessageIds(messages) {\n\tfor (const msg of messages) if (!msg.id) msg.id = (0,uuid__WEBPACK_IMPORTED_MODULE_11__[\"default\"])();\n}\n/**\n* Separate system message from conversation messages\n*/\nfunction splitSystemMessage(messages) {\n\tif (messages.length > 0 && _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.SystemMessage.isInstance(messages[0])) return {\n\t\tsystemPrompt: messages[0],\n\t\tconversationMessages: messages.slice(1)\n\t};\n\treturn { conversationMessages: messages };\n}\n/**\n* Partition messages into those to summarize and those to preserve\n*/\nfunction partitionMessages(systemPrompt, conversationMessages, cutoffIndex) {\n\tconst messagesToSummarize = conversationMessages.slice(0, cutoffIndex);\n\tconst preservedMessages = conversationMessages.slice(cutoffIndex);\n\tif (systemPrompt) messagesToSummarize.unshift(systemPrompt);\n\treturn {\n\t\tmessagesToSummarize,\n\t\tpreservedMessages\n\t};\n}\n/**\n* Determine whether summarization should run for the current token usage\n*\n* @param messages - Current messages in the conversation\n* @param totalTokens - Total token count for all messages\n* @param triggerConditions - Array of trigger conditions. Returns true if ANY condition is satisfied (OR logic).\n*                           Within each condition, ALL specified properties must be satisfied (AND logic).\n* @param model - The language model being used\n* @returns true if summarization should be triggered\n*/\nasync function shouldSummarize(messages, totalTokens, triggerConditions, model) {\n\tif (triggerConditions.length === 0) return false;\n\t/**\n\t* Check each condition (OR logic between conditions)\n\t*/\n\tfor (const trigger of triggerConditions) {\n\t\t/**\n\t\t* Within a single condition, all specified properties must be satisfied (AND logic)\n\t\t*/\n\t\tlet conditionMet = true;\n\t\tlet hasAnyProperty = false;\n\t\tif (trigger.messages !== void 0) {\n\t\t\thasAnyProperty = true;\n\t\t\tif (messages.length < trigger.messages) conditionMet = false;\n\t\t}\n\t\tif (trigger.tokens !== void 0) {\n\t\t\thasAnyProperty = true;\n\t\t\tif (totalTokens < trigger.tokens) conditionMet = false;\n\t\t}\n\t\tif (trigger.fraction !== void 0) {\n\t\t\thasAnyProperty = true;\n\t\t\tconst maxInputTokens = getProfileLimits(model);\n\t\t\tif (typeof maxInputTokens === \"number\") {\n\t\t\t\tif (totalTokens < Math.floor(maxInputTokens * trigger.fraction)) conditionMet = false;\n\t\t\t} else\n /**\n\t\t\t* If fraction is specified but we can't get model limits, skip this condition\n\t\t\t*/\n\t\t\tconditionMet = false;\n\t\t}\n\t\t/**\n\t\t* If condition has at least one property and all properties are satisfied, trigger summarization\n\t\t*/\n\t\tif (hasAnyProperty && conditionMet) return true;\n\t}\n\treturn false;\n}\n/**\n* Determine cutoff index respecting retention configuration\n*/\nasync function determineCutoffIndex(messages, keep, tokenCounter, model) {\n\tif (\"tokens\" in keep || \"fraction\" in keep) {\n\t\tconst tokenBasedCutoff = await findTokenBasedCutoff(messages, keep, tokenCounter, model);\n\t\tif (typeof tokenBasedCutoff === \"number\") return tokenBasedCutoff;\n\t\t/**\n\t\t* Fallback to message count if token-based fails\n\t\t*/\n\t\treturn findSafeCutoff(messages, DEFAULT_MESSAGES_TO_KEEP);\n\t}\n\t/**\n\t* find cutoff index based on message count\n\t*/\n\treturn findSafeCutoff(messages, keep.messages ?? DEFAULT_MESSAGES_TO_KEEP);\n}\n/**\n* Find cutoff index based on target token retention\n*/\nasync function findTokenBasedCutoff(messages, keep, tokenCounter, model) {\n\tif (messages.length === 0) return 0;\n\tlet targetTokenCount;\n\tif (\"fraction\" in keep && keep.fraction !== void 0) {\n\t\tconst maxInputTokens = getProfileLimits(model);\n\t\tif (typeof maxInputTokens !== \"number\") return;\n\t\ttargetTokenCount = Math.floor(maxInputTokens * keep.fraction);\n\t} else if (\"tokens\" in keep && keep.tokens !== void 0) targetTokenCount = Math.floor(keep.tokens);\n\telse return;\n\tif (targetTokenCount <= 0) targetTokenCount = 1;\n\tif (await tokenCounter(messages) <= targetTokenCount) return 0;\n\t/**\n\t* Use binary search to identify the earliest message index that keeps the\n\t* suffix within the token budget.\n\t*/\n\tlet left = 0;\n\tlet right = messages.length;\n\tlet cutoffCandidate = messages.length;\n\tconst maxIterations = Math.floor(Math.log2(messages.length)) + 1;\n\tfor (let i = 0; i < maxIterations; i++) {\n\t\tif (left >= right) break;\n\t\tconst mid = Math.floor((left + right) / 2);\n\t\tif (await tokenCounter(messages.slice(mid)) <= targetTokenCount) {\n\t\t\tcutoffCandidate = mid;\n\t\t\tright = mid;\n\t\t} else left = mid + 1;\n\t}\n\tif (cutoffCandidate === messages.length) cutoffCandidate = left;\n\tif (cutoffCandidate >= messages.length) {\n\t\tif (messages.length === 1) return 0;\n\t\tcutoffCandidate = messages.length - 1;\n\t}\n\t/**\n\t* Find safe cutoff point that preserves AI/Tool pairs.\n\t* If cutoff lands on ToolMessage, move backward to include the AIMessage.\n\t*/\n\tconst safeCutoff = findSafeCutoffPoint(messages, cutoffCandidate);\n\t/**\n\t* If findSafeCutoffPoint moved forward (fallback case), verify it's safe.\n\t* If it moved backward, we already have a safe point.\n\t*/\n\tif (safeCutoff <= cutoffCandidate) return safeCutoff;\n\t/**\n\t* Fallback: iterate backward to find a safe cutoff\n\t*/\n\tfor (let i = cutoffCandidate; i >= 0; i--) if (isSafeCutoffPoint(messages, i)) return i;\n\treturn 0;\n}\n/**\n* Find safe cutoff point that preserves AI/Tool message pairs\n*/\nfunction findSafeCutoff(messages, messagesToKeep) {\n\tif (messages.length <= messagesToKeep) return 0;\n\tconst targetCutoff = messages.length - messagesToKeep;\n\t/**\n\t* First, try to find a safe cutoff point using findSafeCutoffPoint.\n\t* This handles the case where cutoff lands on a ToolMessage by moving\n\t* backward to include the corresponding AIMessage.\n\t*/\n\tconst safeCutoff = findSafeCutoffPoint(messages, targetCutoff);\n\t/**\n\t* If findSafeCutoffPoint moved backward (found matching AIMessage), use it.\n\t*/\n\tif (safeCutoff <= targetCutoff) return safeCutoff;\n\t/**\n\t* Fallback: iterate backward to find a safe cutoff\n\t*/\n\tfor (let i = targetCutoff; i >= 0; i--) if (isSafeCutoffPoint(messages, i)) return i;\n\treturn 0;\n}\n/**\n* Check if cutting at index would separate AI/Tool message pairs\n*/\nfunction isSafeCutoffPoint(messages, cutoffIndex) {\n\tif (cutoffIndex >= messages.length) return true;\n\t/**\n\t* Prevent preserved messages from starting with AI message containing tool calls\n\t*/\n\tif (cutoffIndex < messages.length && _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.AIMessage.isInstance(messages[cutoffIndex]) && (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.hasToolCalls)(messages[cutoffIndex])) return false;\n\tconst searchStart = Math.max(0, cutoffIndex - SEARCH_RANGE_FOR_TOOL_PAIRS);\n\tconst searchEnd = Math.min(messages.length, cutoffIndex + SEARCH_RANGE_FOR_TOOL_PAIRS);\n\tfor (let i = searchStart; i < searchEnd; i++) {\n\t\tif (!(0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.hasToolCalls)(messages[i])) continue;\n\t\tconst toolCallIds = extractToolCallIds(messages[i]);\n\t\tif (cutoffSeparatesToolPair(messages, i, cutoffIndex, toolCallIds)) return false;\n\t}\n\treturn true;\n}\n/**\n* Extract tool call IDs from an AI message\n*/\nfunction extractToolCallIds(aiMessage) {\n\tconst toolCallIds = /* @__PURE__ */ new Set();\n\tif (aiMessage.tool_calls) for (const toolCall of aiMessage.tool_calls) {\n\t\tconst id = typeof toolCall === \"object\" && \"id\" in toolCall ? toolCall.id : null;\n\t\tif (id) toolCallIds.add(id);\n\t}\n\treturn toolCallIds;\n}\n/**\n* Find a safe cutoff point that doesn't split AI/Tool message pairs.\n*\n* If the message at `cutoffIndex` is a `ToolMessage`, search backward for the\n* `AIMessage` containing the corresponding `tool_calls` and adjust the cutoff to\n* include it. This ensures tool call requests and responses stay together.\n*\n* Falls back to advancing forward past `ToolMessage` objects only if no matching\n* `AIMessage` is found (edge case).\n*/\nfunction findSafeCutoffPoint(messages, cutoffIndex) {\n\tif (cutoffIndex >= messages.length || !_langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.ToolMessage.isInstance(messages[cutoffIndex])) return cutoffIndex;\n\tconst toolCallIds = /* @__PURE__ */ new Set();\n\tlet idx = cutoffIndex;\n\twhile (idx < messages.length && _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.ToolMessage.isInstance(messages[idx])) {\n\t\tconst toolMsg = messages[idx];\n\t\tif (toolMsg.tool_call_id) toolCallIds.add(toolMsg.tool_call_id);\n\t\tidx++;\n\t}\n\tfor (let i = cutoffIndex - 1; i >= 0; i--) {\n\t\tconst msg = messages[i];\n\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.AIMessage.isInstance(msg) && (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.hasToolCalls)(msg)) {\n\t\t\tconst aiToolCallIds = extractToolCallIds(msg);\n\t\t\tfor (const id of toolCallIds) if (aiToolCallIds.has(id)) return i;\n\t\t}\n\t}\n\treturn idx;\n}\n/**\n* Check if cutoff separates an AI message from its corresponding tool messages\n*/\nfunction cutoffSeparatesToolPair(messages, aiMessageIndex, cutoffIndex, toolCallIds) {\n\tfor (let j = aiMessageIndex + 1; j < messages.length; j++) {\n\t\tconst message = messages[j];\n\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.ToolMessage.isInstance(message) && toolCallIds.has(message.tool_call_id)) {\n\t\t\tif (aiMessageIndex < cutoffIndex !== j < cutoffIndex) return true;\n\t\t}\n\t}\n\treturn false;\n}\n/**\n* Generate summary for the given messages.\n*\n* @param messagesToSummarize - Messages to summarize.\n* @param model - The language model to use for summarization.\n* @param summaryPrompt - The prompt template for summarization.\n* @param tokenCounter - Function to count tokens.\n* @param trimTokensToSummarize - Optional token limit for trimming messages.\n* @param runtime - The runtime environment, used to inherit config so that\n*   LangGraph's handlers can properly track and tag the summarization model call.\n*/\nasync function createSummary(messagesToSummarize, model, summaryPrompt, tokenCounter, trimTokensToSummarize, runtime) {\n\tif (!messagesToSummarize.length) return \"No previous conversation history.\";\n\tconst trimmedMessages = await trimMessagesForSummary(messagesToSummarize, tokenCounter, trimTokensToSummarize);\n\tif (!trimmedMessages.length) return \"Previous conversation was too long to summarize.\";\n\t/**\n\t* Format messages using getBufferString to avoid token inflation from metadata\n\t* when str() / JSON.stringify is called on message objects.\n\t* This produces compact output like:\n\t* ```\n\t* Human: What's the weather?\n\t* AI: Let me check...[tool_calls]\n\t* Tool: 72Â°F and sunny\n\t* ```\n\t*/\n\tconst formattedMessages = (0,_langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.getBufferString)(trimmedMessages);\n\ttry {\n\t\tconst formattedPrompt = summaryPrompt.replace(\"{messages}\", formattedMessages);\n\t\tconst config = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_5__.mergeConfigs)((0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_5__.pickRunnableConfigKeys)(runtime) ?? {}, { metadata: { lc_source: \"summarization\" } });\n\t\tconst content = (await model.invoke(formattedPrompt, config)).content;\n\t\t/**\n\t\t* Handle both string content and MessageContent array\n\t\t*/\n\t\tif (typeof content === \"string\") return content.trim();\n\t\telse if (Array.isArray(content)) return content.map((item) => {\n\t\t\tif (typeof item === \"string\") return item;\n\t\t\tif (typeof item === \"object\" && item !== null && \"text\" in item) return item.text;\n\t\t\treturn \"\";\n\t\t}).join(\"\").trim();\n\t\treturn \"Error generating summary: Invalid response format\";\n\t} catch (e) {\n\t\treturn `Error generating summary: ${e}`;\n\t}\n}\n/**\n* Trim messages to fit within summary generation limits\n*/\nasync function trimMessagesForSummary(messages, tokenCounter, trimTokensToSummarize) {\n\tif (trimTokensToSummarize === void 0) return messages;\n\ttry {\n\t\treturn await (0,_langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.trimMessages)(messages, {\n\t\t\tmaxTokens: trimTokensToSummarize,\n\t\t\ttokenCounter: async (msgs) => tokenCounter(msgs),\n\t\t\tstrategy: \"last\",\n\t\t\tallowPartial: true,\n\t\t\tincludeSystem: true\n\t\t});\n\t} catch {\n\t\t/**\n\t\t* Fallback to last N messages if trimming fails\n\t\t*/\n\t\treturn messages.slice(-DEFAULT_FALLBACK_MESSAGE_COUNT);\n\t}\n}\n\n//#endregion\n\n//# sourceMappingURL=summarization.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9zdW1tYXJpemF0aW9uLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Q7QUFDcEI7QUFDVztBQUNGO0FBQ3lGO0FBQzVEO0FBQ3RCO0FBQ0k7QUFDcEM7QUFDTztBQUNSO0FBQ2lEOztBQUUzRTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixpREFBWSxRQUFRLDJDQUFTLENBQUMsNENBQVUsYUFBYSwyQ0FBUyxFQUFFLDRDQUFVLElBQUksNkNBQVcsQ0FBQyw0Q0FBVTtBQUMvSCwwQkFBMEIsNENBQVU7QUFDcEMsV0FBVyw0Q0FBVTtBQUNyQixTQUFTLDRDQUFVO0FBQ25CLFdBQVcsNENBQVU7QUFDckIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLElBQUksMkVBQTJFO0FBQ2hGLG1CQUFtQiw0Q0FBVTtBQUM3QixXQUFXLDRDQUFVO0FBQ3JCLFNBQVMsNENBQVU7QUFDbkIsV0FBVyw0Q0FBVTtBQUNyQixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsSUFBSSwwRUFBMEU7QUFDL0Usc0JBQXNCLDRDQUFVO0FBQ2hDLFFBQVEsNENBQVU7QUFDbEIsVUFBVSwyQ0FBUyxxQkFBcUIsMkNBQVM7QUFDakQ7QUFDQTtBQUNBLGdCQUFnQiw0Q0FBVTtBQUMxQix3QkFBd0IsNENBQVU7QUFDbEMsZ0JBQWdCLDRDQUFVO0FBQzFCLHlCQUF5Qiw0Q0FBVTtBQUNuQyxpQkFBaUIsNENBQVU7QUFDM0IsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsMEZBQW1CO0FBQ3BGLHlFQUF5RSwwRkFBbUI7QUFDNUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDBCQUEwQjtBQUNyQyxXQUFXLGNBQWM7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsaUJBQWlCO0FBQ2pELG1CQUFtQiw0QkFBNEI7QUFDL0MsZ0JBQWdCLGNBQWM7QUFDOUIsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLGlCQUFpQjtBQUNqRDtBQUNBLFlBQVksMkJBQTJCO0FBQ3ZDLFlBQVksMkJBQTJCO0FBQ3ZDO0FBQ0EsZ0JBQWdCLGNBQWM7QUFDOUIsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUywyQkFBMkIsRUFBRSw2RUFBZ0I7QUFDdEQseUVBQXlFLG1EQUFlLFFBQVE7QUFDaEcsUUFBUSxnRUFBZ0I7QUFDeEI7QUFDQSx3Q0FBd0MsT0FBTyw0Q0FBVSxlQUFlO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLGVBQWU7QUFDdkYsd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsaUJBQWlCO0FBQzlFLG9HQUFvRztBQUNwRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEZBQTRGO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0Qsd0VBQWE7QUFDNUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhIQUE4SCwrREFBd0I7QUFDdEo7QUFDQTtBQUNBLFdBQVcscUNBQXFDO0FBQ2hEO0FBQ0E7QUFDQSxXQUFXLHlDQUF5QztBQUNwRCw4QkFBOEIsa0VBQVk7QUFDMUMsZ0JBQWdCLGNBQWMsTUFBTSw2R0FBNkc7QUFDakosUUFBUSxpREFBRTtBQUNWLHlCQUF5QjtBQUN6QixJQUFJO0FBQ0osWUFBWTtBQUNaLFFBQVEsbUVBQWEsR0FBRyxJQUFJLHFFQUFtQixFQUFFO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsaURBQUU7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixtRUFBYTtBQUN6QztBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixtQkFBbUI7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixRQUFRO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixRQUFRO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLCtEQUFTLHNDQUFzQyx1REFBWTtBQUNqRztBQUNBO0FBQ0EsMkJBQTJCLGVBQWU7QUFDMUMsT0FBTyx1REFBWTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsaUVBQVc7QUFDbkQ7QUFDQTtBQUNBLGlDQUFpQyxpRUFBVztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixRQUFRO0FBQ3ZDO0FBQ0EsTUFBTSwrREFBUyxvQkFBb0IsdURBQVk7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MscUJBQXFCO0FBQ3ZEO0FBQ0EsTUFBTSxpRUFBVztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIseUVBQWU7QUFDMUM7QUFDQSxrREFBa0QsU0FBUztBQUMzRCxpQkFBaUIsdUVBQVksQ0FBQyxpRkFBc0IsZUFBZSxJQUFJLFlBQVksOEJBQThCO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSCxzQ0FBc0MsRUFBRTtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxzRUFBWTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDb0Y7QUFDcEYiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS9zdW1tYXJpemF0aW9uLmpzPzJjOTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5pdENoYXRNb2RlbCB9IGZyb20gXCIuLi8uLi9jaGF0X21vZGVscy91bml2ZXJzYWwuanNcIjtcbmltcG9ydCB7IGhhc1Rvb2xDYWxscyB9IGZyb20gXCIuLi91dGlscy5qc1wiO1xuaW1wb3J0IHsgY291bnRUb2tlbnNBcHByb3hpbWF0ZWx5IH0gZnJvbSBcIi4vdXRpbHMuanNcIjtcbmltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUgfSBmcm9tIFwiLi4vbWlkZGxld2FyZS5qc1wiO1xuaW1wb3J0IHsgQUlNZXNzYWdlLCBIdW1hbk1lc3NhZ2UsIFJlbW92ZU1lc3NhZ2UsIFN5c3RlbU1lc3NhZ2UsIFRvb2xNZXNzYWdlLCBnZXRCdWZmZXJTdHJpbmcsIHRyaW1NZXNzYWdlcyB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXNcIjtcbmltcG9ydCB7IG1lcmdlQ29uZmlncywgcGlja1J1bm5hYmxlQ29uZmlnS2V5cyB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvcnVubmFibGVzXCI7XG5pbXBvcnQgeyBSRU1PVkVfQUxMX01FU1NBR0VTIH0gZnJvbSBcIkBsYW5nY2hhaW4vbGFuZ2dyYXBoXCI7XG5pbXBvcnQgeyBpbnRlcm9wU2FmZVBhcnNlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS91dGlscy90eXBlc1wiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2QvdjRcIjtcbmltcG9ydCB7IHogYXMgeiQxIH0gZnJvbSBcInpvZC92M1wiO1xuaW1wb3J0IHsgdjQgfSBmcm9tIFwidXVpZFwiO1xuaW1wb3J0IHsgZ2V0TW9kZWxDb250ZXh0U2l6ZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbGFuZ3VhZ2VfbW9kZWxzL2Jhc2VcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvbWlkZGxld2FyZS9zdW1tYXJpemF0aW9uLnRzXG5jb25zdCBERUZBVUxUX1NVTU1BUllfUFJPTVBUID0gYDxyb2xlPlxuQ29udGV4dCBFeHRyYWN0aW9uIEFzc2lzdGFudFxuPC9yb2xlPlxuXG48cHJpbWFyeV9vYmplY3RpdmU+XG5Zb3VyIHNvbGUgb2JqZWN0aXZlIGluIHRoaXMgdGFzayBpcyB0byBleHRyYWN0IHRoZSBoaWdoZXN0IHF1YWxpdHkvbW9zdCByZWxldmFudCBjb250ZXh0IGZyb20gdGhlIGNvbnZlcnNhdGlvbiBoaXN0b3J5IGJlbG93LlxuPC9wcmltYXJ5X29iamVjdGl2ZT5cblxuPG9iamVjdGl2ZV9pbmZvcm1hdGlvbj5cbllvdSdyZSBuZWFyaW5nIHRoZSB0b3RhbCBudW1iZXIgb2YgaW5wdXQgdG9rZW5zIHlvdSBjYW4gYWNjZXB0LCBzbyB5b3UgbXVzdCBleHRyYWN0IHRoZSBoaWdoZXN0IHF1YWxpdHkvbW9zdCByZWxldmFudCBwaWVjZXMgb2YgaW5mb3JtYXRpb24gZnJvbSB5b3VyIGNvbnZlcnNhdGlvbiBoaXN0b3J5LlxuVGhpcyBjb250ZXh0IHdpbGwgdGhlbiBvdmVyd3JpdGUgdGhlIGNvbnZlcnNhdGlvbiBoaXN0b3J5IHByZXNlbnRlZCBiZWxvdy4gQmVjYXVzZSBvZiB0aGlzLCBlbnN1cmUgdGhlIGNvbnRleHQgeW91IGV4dHJhY3QgaXMgb25seSB0aGUgbW9zdCBpbXBvcnRhbnQgaW5mb3JtYXRpb24gdG8geW91ciBvdmVyYWxsIGdvYWwuXG48L29iamVjdGl2ZV9pbmZvcm1hdGlvbj5cblxuPGluc3RydWN0aW9ucz5cblRoZSBjb252ZXJzYXRpb24gaGlzdG9yeSBiZWxvdyB3aWxsIGJlIHJlcGxhY2VkIHdpdGggdGhlIGNvbnRleHQgeW91IGV4dHJhY3QgaW4gdGhpcyBzdGVwLiBCZWNhdXNlIG9mIHRoaXMsIHlvdSBtdXN0IGRvIHlvdXIgdmVyeSBiZXN0IHRvIGV4dHJhY3QgYW5kIHJlY29yZCBhbGwgb2YgdGhlIG1vc3QgaW1wb3J0YW50IGNvbnRleHQgZnJvbSB0aGUgY29udmVyc2F0aW9uIGhpc3RvcnkuXG5Zb3Ugd2FudCB0byBlbnN1cmUgdGhhdCB5b3UgZG9uJ3QgcmVwZWF0IGFueSBhY3Rpb25zIHlvdSd2ZSBhbHJlYWR5IGNvbXBsZXRlZCwgc28gdGhlIGNvbnRleHQgeW91IGV4dHJhY3QgZnJvbSB0aGUgY29udmVyc2F0aW9uIGhpc3Rvcnkgc2hvdWxkIGJlIGZvY3VzZWQgb24gdGhlIG1vc3QgaW1wb3J0YW50IGluZm9ybWF0aW9uIHRvIHlvdXIgb3ZlcmFsbCBnb2FsLlxuPC9pbnN0cnVjdGlvbnM+XG5cblRoZSB1c2VyIHdpbGwgbWVzc2FnZSB5b3Ugd2l0aCB0aGUgZnVsbCBtZXNzYWdlIGhpc3RvcnkgeW91J2xsIGJlIGV4dHJhY3RpbmcgY29udGV4dCBmcm9tLCB0byB0aGVuIHJlcGxhY2UuIENhcmVmdWxseSByZWFkIG92ZXIgaXQgYWxsLCBhbmQgdGhpbmsgZGVlcGx5IGFib3V0IHdoYXQgaW5mb3JtYXRpb24gaXMgbW9zdCBpbXBvcnRhbnQgdG8geW91ciBvdmVyYWxsIGdvYWwgdGhhdCBzaG91bGQgYmUgc2F2ZWQ6XG5cbldpdGggYWxsIG9mIHRoaXMgaW4gbWluZCwgcGxlYXNlIGNhcmVmdWxseSByZWFkIG92ZXIgdGhlIGVudGlyZSBjb252ZXJzYXRpb24gaGlzdG9yeSwgYW5kIGV4dHJhY3QgdGhlIG1vc3QgaW1wb3J0YW50IGFuZCByZWxldmFudCBjb250ZXh0IHRvIHJlcGxhY2UgaXQgc28gdGhhdCB5b3UgY2FuIGZyZWUgdXAgc3BhY2UgaW4gdGhlIGNvbnZlcnNhdGlvbiBoaXN0b3J5LlxuUmVzcG9uZCBPTkxZIHdpdGggdGhlIGV4dHJhY3RlZCBjb250ZXh0LiBEbyBub3QgaW5jbHVkZSBhbnkgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiwgb3IgdGV4dCBiZWZvcmUgb3IgYWZ0ZXIgdGhlIGV4dHJhY3RlZCBjb250ZXh0LlxuXG48bWVzc2FnZXM+XG5NZXNzYWdlcyB0byBzdW1tYXJpemU6XG57bWVzc2FnZXN9XG48L21lc3NhZ2VzPmA7XG5jb25zdCBERUZBVUxUX1NVTU1BUllfUFJFRklYID0gXCJIZXJlIGlzIGEgc3VtbWFyeSBvZiB0aGUgY29udmVyc2F0aW9uIHRvIGRhdGU6XCI7XG5jb25zdCBERUZBVUxUX01FU1NBR0VTX1RPX0tFRVAgPSAyMDtcbmNvbnN0IERFRkFVTFRfVFJJTV9UT0tFTl9MSU1JVCA9IDRlMztcbmNvbnN0IERFRkFVTFRfRkFMTEJBQ0tfTUVTU0FHRV9DT1VOVCA9IDE1O1xuY29uc3QgU0VBUkNIX1JBTkdFX0ZPUl9UT09MX1BBSVJTID0gNTtcbmNvbnN0IHRva2VuQ291bnRlclNjaGVtYSA9IHokMS5mdW5jdGlvbigpLmFyZ3MoeiQxLmFycmF5KHokMS5jdXN0b20oKSkpLnJldHVybnMoeiQxLnVuaW9uKFt6JDEubnVtYmVyKCksIHokMS5wcm9taXNlKHokMS5udW1iZXIoKSldKSk7XG5jb25zdCBjb250ZXh0U2l6ZVNjaGVtYSA9IHokMS5vYmplY3Qoe1xuXHRmcmFjdGlvbjogeiQxLm51bWJlcigpLmd0KDAsIFwiRnJhY3Rpb24gbXVzdCBiZSBncmVhdGVyIHRoYW4gMFwiKS5tYXgoMSwgXCJGcmFjdGlvbiBtdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byAxXCIpLm9wdGlvbmFsKCksXG5cdHRva2VuczogeiQxLm51bWJlcigpLnBvc2l0aXZlKFwiVG9rZW5zIG11c3QgYmUgZ3JlYXRlciB0aGFuIDBcIikub3B0aW9uYWwoKSxcblx0bWVzc2FnZXM6IHokMS5udW1iZXIoKS5pbnQoXCJNZXNzYWdlcyBtdXN0IGJlIGFuIGludGVnZXJcIikucG9zaXRpdmUoXCJNZXNzYWdlcyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwXCIpLm9wdGlvbmFsKClcbn0pLnJlZmluZSgoZGF0YSkgPT4ge1xuXHRyZXR1cm4gW1xuXHRcdGRhdGEuZnJhY3Rpb24sXG5cdFx0ZGF0YS50b2tlbnMsXG5cdFx0ZGF0YS5tZXNzYWdlc1xuXHRdLmZpbHRlcigodikgPT4gdiAhPT0gdm9pZCAwKS5sZW5ndGggPj0gMTtcbn0sIHsgbWVzc2FnZTogXCJBdCBsZWFzdCBvbmUgb2YgZnJhY3Rpb24sIHRva2Vucywgb3IgbWVzc2FnZXMgbXVzdCBiZSBwcm92aWRlZFwiIH0pO1xuY29uc3Qga2VlcFNjaGVtYSA9IHokMS5vYmplY3Qoe1xuXHRmcmFjdGlvbjogeiQxLm51bWJlcigpLm1pbigwLCBcIk1lc3NhZ2VzIG11c3QgYmUgbm9uLW5lZ2F0aXZlXCIpLm1heCgxLCBcIkZyYWN0aW9uIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDFcIikub3B0aW9uYWwoKSxcblx0dG9rZW5zOiB6JDEubnVtYmVyKCkubWluKDAsIFwiVG9rZW5zIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIDBcIikub3B0aW9uYWwoKSxcblx0bWVzc2FnZXM6IHokMS5udW1iZXIoKS5pbnQoXCJNZXNzYWdlcyBtdXN0IGJlIGFuIGludGVnZXJcIikubWluKDAsIFwiTWVzc2FnZXMgbXVzdCBiZSBub24tbmVnYXRpdmVcIikub3B0aW9uYWwoKVxufSkucmVmaW5lKChkYXRhKSA9PiB7XG5cdHJldHVybiBbXG5cdFx0ZGF0YS5mcmFjdGlvbixcblx0XHRkYXRhLnRva2Vucyxcblx0XHRkYXRhLm1lc3NhZ2VzXG5cdF0uZmlsdGVyKCh2KSA9PiB2ICE9PSB2b2lkIDApLmxlbmd0aCA9PT0gMTtcbn0sIHsgbWVzc2FnZTogXCJFeGFjdGx5IG9uZSBvZiBmcmFjdGlvbiwgdG9rZW5zLCBvciBtZXNzYWdlcyBtdXN0IGJlIHByb3ZpZGVkXCIgfSk7XG5jb25zdCBjb250ZXh0U2NoZW1hID0geiQxLm9iamVjdCh7XG5cdG1vZGVsOiB6JDEuY3VzdG9tKCksXG5cdHRyaWdnZXI6IHokMS51bmlvbihbY29udGV4dFNpemVTY2hlbWEsIHokMS5hcnJheShjb250ZXh0U2l6ZVNjaGVtYSldKS5vcHRpb25hbCgpLFxuXHRrZWVwOiBrZWVwU2NoZW1hLm9wdGlvbmFsKCksXG5cdHRva2VuQ291bnRlcjogdG9rZW5Db3VudGVyU2NoZW1hLm9wdGlvbmFsKCksXG5cdHN1bW1hcnlQcm9tcHQ6IHokMS5zdHJpbmcoKS5kZWZhdWx0KERFRkFVTFRfU1VNTUFSWV9QUk9NUFQpLFxuXHR0cmltVG9rZW5zVG9TdW1tYXJpemU6IHokMS5udW1iZXIoKS5vcHRpb25hbCgpLFxuXHRzdW1tYXJ5UHJlZml4OiB6JDEuc3RyaW5nKCkub3B0aW9uYWwoKSxcblx0bWF4VG9rZW5zQmVmb3JlU3VtbWFyeTogeiQxLm51bWJlcigpLm9wdGlvbmFsKCksXG5cdG1lc3NhZ2VzVG9LZWVwOiB6JDEubnVtYmVyKCkub3B0aW9uYWwoKVxufSk7XG4vKipcbiogR2V0IG1heCBpbnB1dCB0b2tlbnMgZnJvbSBtb2RlbCBwcm9maWxlIG9yIGZhbGxiYWNrIHRvIG1vZGVsIG5hbWUgbG9va3VwXG4qL1xuZnVuY3Rpb24gZ2V0UHJvZmlsZUxpbWl0cyhpbnB1dCkge1xuXHRpZiAoXCJwcm9maWxlXCIgaW4gaW5wdXQgJiYgdHlwZW9mIGlucHV0LnByb2ZpbGUgPT09IFwib2JqZWN0XCIgJiYgaW5wdXQucHJvZmlsZSAmJiBcIm1heElucHV0VG9rZW5zXCIgaW4gaW5wdXQucHJvZmlsZSAmJiAodHlwZW9mIGlucHV0LnByb2ZpbGUubWF4SW5wdXRUb2tlbnMgPT09IFwibnVtYmVyXCIgfHwgaW5wdXQucHJvZmlsZS5tYXhJbnB1dFRva2VucyA9PSBudWxsKSkgcmV0dXJuIGlucHV0LnByb2ZpbGUubWF4SW5wdXRUb2tlbnMgPz8gdm9pZCAwO1xuXHRpZiAoXCJtb2RlbFwiIGluIGlucHV0ICYmIHR5cGVvZiBpbnB1dC5tb2RlbCA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIGdldE1vZGVsQ29udGV4dFNpemUoaW5wdXQubW9kZWwpO1xuXHRpZiAoXCJtb2RlbE5hbWVcIiBpbiBpbnB1dCAmJiB0eXBlb2YgaW5wdXQubW9kZWxOYW1lID09PSBcInN0cmluZ1wiKSByZXR1cm4gZ2V0TW9kZWxDb250ZXh0U2l6ZShpbnB1dC5tb2RlbE5hbWUpO1xufVxuLyoqXG4qIFN1bW1hcml6YXRpb24gbWlkZGxld2FyZSB0aGF0IGF1dG9tYXRpY2FsbHkgc3VtbWFyaXplcyBjb252ZXJzYXRpb24gaGlzdG9yeSB3aGVuIHRva2VuIGxpbWl0cyBhcmUgYXBwcm9hY2hlZC5cbipcbiogVGhpcyBtaWRkbGV3YXJlIG1vbml0b3JzIG1lc3NhZ2UgdG9rZW4gY291bnRzIGFuZCBhdXRvbWF0aWNhbGx5IHN1bW1hcml6ZXMgb2xkZXJcbiogbWVzc2FnZXMgd2hlbiBhIHRocmVzaG9sZCBpcyByZWFjaGVkLCBwcmVzZXJ2aW5nIHJlY2VudCBtZXNzYWdlcyBhbmQgbWFpbnRhaW5pbmdcbiogY29udGV4dCBjb250aW51aXR5IGJ5IGVuc3VyaW5nIEFJL1Rvb2wgbWVzc2FnZSBwYWlycyByZW1haW4gdG9nZXRoZXIuXG4qXG4qIEBwYXJhbSBvcHRpb25zIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIHN1bW1hcml6YXRpb24gbWlkZGxld2FyZVxuKiBAcmV0dXJucyBBIG1pZGRsZXdhcmUgaW5zdGFuY2VcbipcbiogQGV4YW1wbGVcbiogYGBgdHNcbiogaW1wb3J0IHsgc3VtbWFyaXphdGlvbk1pZGRsZXdhcmUgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qIGltcG9ydCB7IGNyZWF0ZUFnZW50IH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKlxuKiAvLyBTaW5nbGUgY29uZGl0aW9uOiB0cmlnZ2VyIGlmIHRva2VucyA+PSA0MDAwIEFORCBtZXNzYWdlcyA+PSAxMFxuKiBjb25zdCBhZ2VudDEgPSBjcmVhdGVBZ2VudCh7XG4qICAgbGxtOiBtb2RlbCxcbiogICB0b29sczogW2dldFdlYXRoZXJdLFxuKiAgIG1pZGRsZXdhcmU6IFtcbiogICAgIHN1bW1hcml6YXRpb25NaWRkbGV3YXJlKHtcbiogICAgICAgbW9kZWw6IG5ldyBDaGF0T3BlbkFJKHsgbW9kZWw6IFwiZ3B0LTRvXCIgfSksXG4qICAgICAgIHRyaWdnZXI6IHsgdG9rZW5zOiA0MDAwLCBtZXNzYWdlczogMTAgfSxcbiogICAgICAga2VlcDogeyBtZXNzYWdlczogMjAgfSxcbiogICAgIH0pXG4qICAgXSxcbiogfSk7XG4qXG4qIC8vIE11bHRpcGxlIGNvbmRpdGlvbnM6IHRyaWdnZXIgaWYgKHRva2VucyA+PSA1MDAwIEFORCBtZXNzYWdlcyA+PSAzKSBPUiAodG9rZW5zID49IDMwMDAgQU5EIG1lc3NhZ2VzID49IDYpXG4qIGNvbnN0IGFnZW50MiA9IGNyZWF0ZUFnZW50KHtcbiogICBsbG06IG1vZGVsLFxuKiAgIHRvb2xzOiBbZ2V0V2VhdGhlcl0sXG4qICAgbWlkZGxld2FyZTogW1xuKiAgICAgc3VtbWFyaXphdGlvbk1pZGRsZXdhcmUoe1xuKiAgICAgICBtb2RlbDogbmV3IENoYXRPcGVuQUkoeyBtb2RlbDogXCJncHQtNG9cIiB9KSxcbiogICAgICAgdHJpZ2dlcjogW1xuKiAgICAgICAgIHsgdG9rZW5zOiA1MDAwLCBtZXNzYWdlczogMyB9LFxuKiAgICAgICAgIHsgdG9rZW5zOiAzMDAwLCBtZXNzYWdlczogNiB9LFxuKiAgICAgICBdLFxuKiAgICAgICBrZWVwOiB7IG1lc3NhZ2VzOiAyMCB9LFxuKiAgICAgfSlcbiogICBdLFxuKiB9KTtcbipcbiogYGBgXG4qL1xuZnVuY3Rpb24gc3VtbWFyaXphdGlvbk1pZGRsZXdhcmUob3B0aW9ucykge1xuXHQvKipcblx0KiBQYXJzZSB1c2VyIG9wdGlvbnMgdG8gZ2V0IHRoZWlyIGV4cGxpY2l0IHZhbHVlc1xuXHQqL1xuXHRjb25zdCB7IGRhdGE6IHVzZXJPcHRpb25zLCBlcnJvciB9ID0gaW50ZXJvcFNhZmVQYXJzZShjb250ZXh0U2NoZW1hLCBvcHRpb25zKTtcblx0aWYgKGVycm9yKSB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc3VtbWFyaXphdGlvbiBtaWRkbGV3YXJlIG9wdGlvbnM6ICR7ei5wcmV0dGlmeUVycm9yKGVycm9yKX1gKTtcblx0cmV0dXJuIGNyZWF0ZU1pZGRsZXdhcmUoe1xuXHRcdG5hbWU6IFwiU3VtbWFyaXphdGlvbk1pZGRsZXdhcmVcIixcblx0XHRjb250ZXh0U2NoZW1hOiBjb250ZXh0U2NoZW1hLmV4dGVuZCh7IG1vZGVsOiB6JDEuY3VzdG9tKCkub3B0aW9uYWwoKSB9KSxcblx0XHRiZWZvcmVNb2RlbDogYXN5bmMgKHN0YXRlLCBydW50aW1lKSA9PiB7XG5cdFx0XHRsZXQgdHJpZ2dlciA9IHVzZXJPcHRpb25zLnRyaWdnZXI7XG5cdFx0XHRsZXQga2VlcCA9IHVzZXJPcHRpb25zLmtlZXA7XG5cdFx0XHQvKipcblx0XHRcdCogSGFuZGxlIGRlcHJlY2F0ZWQgcGFyYW1ldGVyc1xuXHRcdFx0Ki9cblx0XHRcdGlmICh1c2VyT3B0aW9ucy5tYXhUb2tlbnNCZWZvcmVTdW1tYXJ5ICE9PSB2b2lkIDApIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwibWF4VG9rZW5zQmVmb3JlU3VtbWFyeSBpcyBkZXByZWNhdGVkLiBVc2UgYHRyaWdnZXI6IHsgdG9rZW5zOiB2YWx1ZSB9YCBpbnN0ZWFkLlwiKTtcblx0XHRcdFx0aWYgKHRyaWdnZXIgPT09IHZvaWQgMCkgdHJpZ2dlciA9IHsgdG9rZW5zOiB1c2VyT3B0aW9ucy5tYXhUb2tlbnNCZWZvcmVTdW1tYXJ5IH07XG5cdFx0XHR9XG5cdFx0XHQvKipcblx0XHRcdCogSGFuZGxlIGRlcHJlY2F0ZWQgcGFyYW1ldGVyc1xuXHRcdFx0Ki9cblx0XHRcdGlmICh1c2VyT3B0aW9ucy5tZXNzYWdlc1RvS2VlcCAhPT0gdm9pZCAwKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIm1lc3NhZ2VzVG9LZWVwIGlzIGRlcHJlY2F0ZWQuIFVzZSBga2VlcDogeyBtZXNzYWdlczogdmFsdWUgfWAgaW5zdGVhZC5cIik7XG5cdFx0XHRcdGlmICgha2VlcCB8fCBrZWVwICYmIFwibWVzc2FnZXNcIiBpbiBrZWVwICYmIGtlZXAubWVzc2FnZXMgPT09IERFRkFVTFRfTUVTU0FHRVNfVE9fS0VFUCkga2VlcCA9IHsgbWVzc2FnZXM6IHVzZXJPcHRpb25zLm1lc3NhZ2VzVG9LZWVwIH07XG5cdFx0XHR9XG5cdFx0XHQvKipcblx0XHRcdCogTWVyZ2UgY29udGV4dCB3aXRoIHVzZXIgb3B0aW9uc1xuXHRcdFx0Ki9cblx0XHRcdGNvbnN0IHJlc29sdmVkVHJpZ2dlciA9IHJ1bnRpbWUuY29udGV4dD8udHJpZ2dlciAhPT0gdm9pZCAwID8gcnVudGltZS5jb250ZXh0LnRyaWdnZXIgOiB0cmlnZ2VyO1xuXHRcdFx0Y29uc3QgcmVzb2x2ZWRLZWVwID0gcnVudGltZS5jb250ZXh0Py5rZWVwICE9PSB2b2lkIDAgPyBydW50aW1lLmNvbnRleHQua2VlcCA6IGtlZXAgPz8geyBtZXNzYWdlczogREVGQVVMVF9NRVNTQUdFU19UT19LRUVQIH07XG5cdFx0XHRjb25zdCB2YWxpZGF0ZWRLZWVwID0ga2VlcFNjaGVtYS5wYXJzZShyZXNvbHZlZEtlZXApO1xuXHRcdFx0LyoqXG5cdFx0XHQqIFZhbGlkYXRlIHRyaWdnZXIgY29uZGl0aW9uc1xuXHRcdFx0Ki9cblx0XHRcdGxldCB0cmlnZ2VyQ29uZGl0aW9ucyA9IFtdO1xuXHRcdFx0aWYgKHJlc29sdmVkVHJpZ2dlciA9PT0gdm9pZCAwKSB0cmlnZ2VyQ29uZGl0aW9ucyA9IFtdO1xuXHRcdFx0ZWxzZSBpZiAoQXJyYXkuaXNBcnJheShyZXNvbHZlZFRyaWdnZXIpKVxuIC8qKlxuXHRcdFx0KiBJdCdzIGFuIGFycmF5IG9mIENvbnRleHRTaXplIG9iamVjdHNcblx0XHRcdCovXG5cdFx0XHR0cmlnZ2VyQ29uZGl0aW9ucyA9IHJlc29sdmVkVHJpZ2dlci5tYXAoKHQpID0+IGNvbnRleHRTaXplU2NoZW1hLnBhcnNlKHQpKTtcblx0XHRcdGVsc2VcbiAvKipcblx0XHRcdCogU2luZ2xlIENvbnRleHRTaXplIG9iamVjdCAtIGFsbCBwcm9wZXJ0aWVzIG11c3QgYmUgc2F0aXNmaWVkIChBTkQgbG9naWMpXG5cdFx0XHQqL1xuXHRcdFx0dHJpZ2dlckNvbmRpdGlvbnMgPSBbY29udGV4dFNpemVTY2hlbWEucGFyc2UocmVzb2x2ZWRUcmlnZ2VyKV07XG5cdFx0XHQvKipcblx0XHRcdCogQ2hlY2sgaWYgcHJvZmlsZSBpcyByZXF1aXJlZFxuXHRcdFx0Ki9cblx0XHRcdGNvbnN0IHJlcXVpcmVzUHJvZmlsZSA9IHRyaWdnZXJDb25kaXRpb25zLnNvbWUoKGMpID0+IFwiZnJhY3Rpb25cIiBpbiBjKSB8fCBcImZyYWN0aW9uXCIgaW4gdmFsaWRhdGVkS2VlcDtcblx0XHRcdGNvbnN0IG1vZGVsID0gdHlwZW9mIHVzZXJPcHRpb25zLm1vZGVsID09PSBcInN0cmluZ1wiID8gYXdhaXQgaW5pdENoYXRNb2RlbCh1c2VyT3B0aW9ucy5tb2RlbCkgOiB1c2VyT3B0aW9ucy5tb2RlbDtcblx0XHRcdGlmIChyZXF1aXJlc1Byb2ZpbGUgJiYgIWdldFByb2ZpbGVMaW1pdHMobW9kZWwpKSB0aHJvdyBuZXcgRXJyb3IoXCJNb2RlbCBwcm9maWxlIGluZm9ybWF0aW9uIGlzIHJlcXVpcmVkIHRvIHVzZSBmcmFjdGlvbmFsIHRva2VuIGxpbWl0cy4gVXNlIGFic29sdXRlIHRva2VuIGNvdW50cyBpbnN0ZWFkLlwiKTtcblx0XHRcdGNvbnN0IHN1bW1hcnlQcm9tcHQgPSBydW50aW1lLmNvbnRleHQ/LnN1bW1hcnlQcm9tcHQgPT09IERFRkFVTFRfU1VNTUFSWV9QUk9NUFQgPyB1c2VyT3B0aW9ucy5zdW1tYXJ5UHJvbXB0ID8/IERFRkFVTFRfU1VNTUFSWV9QUk9NUFQgOiBydW50aW1lLmNvbnRleHQ/LnN1bW1hcnlQcm9tcHQgPz8gdXNlck9wdGlvbnMuc3VtbWFyeVByb21wdCA/PyBERUZBVUxUX1NVTU1BUllfUFJPTVBUO1xuXHRcdFx0Y29uc3Qgc3VtbWFyeVByZWZpeCA9IHJ1bnRpbWUuY29udGV4dC5zdW1tYXJ5UHJlZml4ID8/IHVzZXJPcHRpb25zLnN1bW1hcnlQcmVmaXggPz8gREVGQVVMVF9TVU1NQVJZX1BSRUZJWDtcblx0XHRcdGNvbnN0IHRyaW1Ub2tlbnNUb1N1bW1hcml6ZSA9IHJ1bnRpbWUuY29udGV4dD8udHJpbVRva2Vuc1RvU3VtbWFyaXplICE9PSB2b2lkIDAgPyBydW50aW1lLmNvbnRleHQudHJpbVRva2Vuc1RvU3VtbWFyaXplIDogdXNlck9wdGlvbnMudHJpbVRva2Vuc1RvU3VtbWFyaXplID8/IERFRkFVTFRfVFJJTV9UT0tFTl9MSU1JVDtcblx0XHRcdC8qKlxuXHRcdFx0KiBFbnN1cmUgYWxsIG1lc3NhZ2VzIGhhdmUgSURzXG5cdFx0XHQqL1xuXHRcdFx0ZW5zdXJlTWVzc2FnZUlkcyhzdGF0ZS5tZXNzYWdlcyk7XG5cdFx0XHRjb25zdCB0b2tlbkNvdW50ZXIgPSBydW50aW1lLmNvbnRleHQ/LnRva2VuQ291bnRlciAhPT0gdm9pZCAwID8gcnVudGltZS5jb250ZXh0LnRva2VuQ291bnRlciA6IHVzZXJPcHRpb25zLnRva2VuQ291bnRlciA/PyBjb3VudFRva2Vuc0FwcHJveGltYXRlbHk7XG5cdFx0XHRjb25zdCB0b3RhbFRva2VucyA9IGF3YWl0IHRva2VuQ291bnRlcihzdGF0ZS5tZXNzYWdlcyk7XG5cdFx0XHRpZiAoIWF3YWl0IHNob3VsZFN1bW1hcml6ZShzdGF0ZS5tZXNzYWdlcywgdG90YWxUb2tlbnMsIHRyaWdnZXJDb25kaXRpb25zLCBtb2RlbCkpIHJldHVybjtcblx0XHRcdGNvbnN0IHsgc3lzdGVtUHJvbXB0LCBjb252ZXJzYXRpb25NZXNzYWdlcyB9ID0gc3BsaXRTeXN0ZW1NZXNzYWdlKHN0YXRlLm1lc3NhZ2VzKTtcblx0XHRcdGNvbnN0IGN1dG9mZkluZGV4ID0gYXdhaXQgZGV0ZXJtaW5lQ3V0b2ZmSW5kZXgoY29udmVyc2F0aW9uTWVzc2FnZXMsIHZhbGlkYXRlZEtlZXAsIHRva2VuQ291bnRlciwgbW9kZWwpO1xuXHRcdFx0aWYgKGN1dG9mZkluZGV4IDw9IDApIHJldHVybjtcblx0XHRcdGNvbnN0IHsgbWVzc2FnZXNUb1N1bW1hcml6ZSwgcHJlc2VydmVkTWVzc2FnZXMgfSA9IHBhcnRpdGlvbk1lc3NhZ2VzKHN5c3RlbVByb21wdCwgY29udmVyc2F0aW9uTWVzc2FnZXMsIGN1dG9mZkluZGV4KTtcblx0XHRcdGNvbnN0IHN1bW1hcnlNZXNzYWdlID0gbmV3IEh1bWFuTWVzc2FnZSh7XG5cdFx0XHRcdGNvbnRlbnQ6IGAke3N1bW1hcnlQcmVmaXh9XFxuXFxuJHthd2FpdCBjcmVhdGVTdW1tYXJ5KG1lc3NhZ2VzVG9TdW1tYXJpemUsIG1vZGVsLCBzdW1tYXJ5UHJvbXB0LCB0b2tlbkNvdW50ZXIsIHRyaW1Ub2tlbnNUb1N1bW1hcml6ZSwgcnVudGltZSl9YCxcblx0XHRcdFx0aWQ6IHY0KCksXG5cdFx0XHRcdGFkZGl0aW9uYWxfa3dhcmdzOiB7IGxjX3NvdXJjZTogXCJzdW1tYXJpemF0aW9uXCIgfVxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4geyBtZXNzYWdlczogW1xuXHRcdFx0XHRuZXcgUmVtb3ZlTWVzc2FnZSh7IGlkOiBSRU1PVkVfQUxMX01FU1NBR0VTIH0pLFxuXHRcdFx0XHRzdW1tYXJ5TWVzc2FnZSxcblx0XHRcdFx0Li4ucHJlc2VydmVkTWVzc2FnZXNcblx0XHRcdF0gfTtcblx0XHR9XG5cdH0pO1xufVxuLyoqXG4qIEVuc3VyZSBhbGwgbWVzc2FnZXMgaGF2ZSB1bmlxdWUgSURzXG4qL1xuZnVuY3Rpb24gZW5zdXJlTWVzc2FnZUlkcyhtZXNzYWdlcykge1xuXHRmb3IgKGNvbnN0IG1zZyBvZiBtZXNzYWdlcykgaWYgKCFtc2cuaWQpIG1zZy5pZCA9IHY0KCk7XG59XG4vKipcbiogU2VwYXJhdGUgc3lzdGVtIG1lc3NhZ2UgZnJvbSBjb252ZXJzYXRpb24gbWVzc2FnZXNcbiovXG5mdW5jdGlvbiBzcGxpdFN5c3RlbU1lc3NhZ2UobWVzc2FnZXMpIHtcblx0aWYgKG1lc3NhZ2VzLmxlbmd0aCA+IDAgJiYgU3lzdGVtTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2VzWzBdKSkgcmV0dXJuIHtcblx0XHRzeXN0ZW1Qcm9tcHQ6IG1lc3NhZ2VzWzBdLFxuXHRcdGNvbnZlcnNhdGlvbk1lc3NhZ2VzOiBtZXNzYWdlcy5zbGljZSgxKVxuXHR9O1xuXHRyZXR1cm4geyBjb252ZXJzYXRpb25NZXNzYWdlczogbWVzc2FnZXMgfTtcbn1cbi8qKlxuKiBQYXJ0aXRpb24gbWVzc2FnZXMgaW50byB0aG9zZSB0byBzdW1tYXJpemUgYW5kIHRob3NlIHRvIHByZXNlcnZlXG4qL1xuZnVuY3Rpb24gcGFydGl0aW9uTWVzc2FnZXMoc3lzdGVtUHJvbXB0LCBjb252ZXJzYXRpb25NZXNzYWdlcywgY3V0b2ZmSW5kZXgpIHtcblx0Y29uc3QgbWVzc2FnZXNUb1N1bW1hcml6ZSA9IGNvbnZlcnNhdGlvbk1lc3NhZ2VzLnNsaWNlKDAsIGN1dG9mZkluZGV4KTtcblx0Y29uc3QgcHJlc2VydmVkTWVzc2FnZXMgPSBjb252ZXJzYXRpb25NZXNzYWdlcy5zbGljZShjdXRvZmZJbmRleCk7XG5cdGlmIChzeXN0ZW1Qcm9tcHQpIG1lc3NhZ2VzVG9TdW1tYXJpemUudW5zaGlmdChzeXN0ZW1Qcm9tcHQpO1xuXHRyZXR1cm4ge1xuXHRcdG1lc3NhZ2VzVG9TdW1tYXJpemUsXG5cdFx0cHJlc2VydmVkTWVzc2FnZXNcblx0fTtcbn1cbi8qKlxuKiBEZXRlcm1pbmUgd2hldGhlciBzdW1tYXJpemF0aW9uIHNob3VsZCBydW4gZm9yIHRoZSBjdXJyZW50IHRva2VuIHVzYWdlXG4qXG4qIEBwYXJhbSBtZXNzYWdlcyAtIEN1cnJlbnQgbWVzc2FnZXMgaW4gdGhlIGNvbnZlcnNhdGlvblxuKiBAcGFyYW0gdG90YWxUb2tlbnMgLSBUb3RhbCB0b2tlbiBjb3VudCBmb3IgYWxsIG1lc3NhZ2VzXG4qIEBwYXJhbSB0cmlnZ2VyQ29uZGl0aW9ucyAtIEFycmF5IG9mIHRyaWdnZXIgY29uZGl0aW9ucy4gUmV0dXJucyB0cnVlIGlmIEFOWSBjb25kaXRpb24gaXMgc2F0aXNmaWVkIChPUiBsb2dpYykuXG4qICAgICAgICAgICAgICAgICAgICAgICAgICAgV2l0aGluIGVhY2ggY29uZGl0aW9uLCBBTEwgc3BlY2lmaWVkIHByb3BlcnRpZXMgbXVzdCBiZSBzYXRpc2ZpZWQgKEFORCBsb2dpYykuXG4qIEBwYXJhbSBtb2RlbCAtIFRoZSBsYW5ndWFnZSBtb2RlbCBiZWluZyB1c2VkXG4qIEByZXR1cm5zIHRydWUgaWYgc3VtbWFyaXphdGlvbiBzaG91bGQgYmUgdHJpZ2dlcmVkXG4qL1xuYXN5bmMgZnVuY3Rpb24gc2hvdWxkU3VtbWFyaXplKG1lc3NhZ2VzLCB0b3RhbFRva2VucywgdHJpZ2dlckNvbmRpdGlvbnMsIG1vZGVsKSB7XG5cdGlmICh0cmlnZ2VyQ29uZGl0aW9ucy5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblx0LyoqXG5cdCogQ2hlY2sgZWFjaCBjb25kaXRpb24gKE9SIGxvZ2ljIGJldHdlZW4gY29uZGl0aW9ucylcblx0Ki9cblx0Zm9yIChjb25zdCB0cmlnZ2VyIG9mIHRyaWdnZXJDb25kaXRpb25zKSB7XG5cdFx0LyoqXG5cdFx0KiBXaXRoaW4gYSBzaW5nbGUgY29uZGl0aW9uLCBhbGwgc3BlY2lmaWVkIHByb3BlcnRpZXMgbXVzdCBiZSBzYXRpc2ZpZWQgKEFORCBsb2dpYylcblx0XHQqL1xuXHRcdGxldCBjb25kaXRpb25NZXQgPSB0cnVlO1xuXHRcdGxldCBoYXNBbnlQcm9wZXJ0eSA9IGZhbHNlO1xuXHRcdGlmICh0cmlnZ2VyLm1lc3NhZ2VzICE9PSB2b2lkIDApIHtcblx0XHRcdGhhc0FueVByb3BlcnR5ID0gdHJ1ZTtcblx0XHRcdGlmIChtZXNzYWdlcy5sZW5ndGggPCB0cmlnZ2VyLm1lc3NhZ2VzKSBjb25kaXRpb25NZXQgPSBmYWxzZTtcblx0XHR9XG5cdFx0aWYgKHRyaWdnZXIudG9rZW5zICE9PSB2b2lkIDApIHtcblx0XHRcdGhhc0FueVByb3BlcnR5ID0gdHJ1ZTtcblx0XHRcdGlmICh0b3RhbFRva2VucyA8IHRyaWdnZXIudG9rZW5zKSBjb25kaXRpb25NZXQgPSBmYWxzZTtcblx0XHR9XG5cdFx0aWYgKHRyaWdnZXIuZnJhY3Rpb24gIT09IHZvaWQgMCkge1xuXHRcdFx0aGFzQW55UHJvcGVydHkgPSB0cnVlO1xuXHRcdFx0Y29uc3QgbWF4SW5wdXRUb2tlbnMgPSBnZXRQcm9maWxlTGltaXRzKG1vZGVsKTtcblx0XHRcdGlmICh0eXBlb2YgbWF4SW5wdXRUb2tlbnMgPT09IFwibnVtYmVyXCIpIHtcblx0XHRcdFx0aWYgKHRvdGFsVG9rZW5zIDwgTWF0aC5mbG9vcihtYXhJbnB1dFRva2VucyAqIHRyaWdnZXIuZnJhY3Rpb24pKSBjb25kaXRpb25NZXQgPSBmYWxzZTtcblx0XHRcdH0gZWxzZVxuIC8qKlxuXHRcdFx0KiBJZiBmcmFjdGlvbiBpcyBzcGVjaWZpZWQgYnV0IHdlIGNhbid0IGdldCBtb2RlbCBsaW1pdHMsIHNraXAgdGhpcyBjb25kaXRpb25cblx0XHRcdCovXG5cdFx0XHRjb25kaXRpb25NZXQgPSBmYWxzZTtcblx0XHR9XG5cdFx0LyoqXG5cdFx0KiBJZiBjb25kaXRpb24gaGFzIGF0IGxlYXN0IG9uZSBwcm9wZXJ0eSBhbmQgYWxsIHByb3BlcnRpZXMgYXJlIHNhdGlzZmllZCwgdHJpZ2dlciBzdW1tYXJpemF0aW9uXG5cdFx0Ki9cblx0XHRpZiAoaGFzQW55UHJvcGVydHkgJiYgY29uZGl0aW9uTWV0KSByZXR1cm4gdHJ1ZTtcblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59XG4vKipcbiogRGV0ZXJtaW5lIGN1dG9mZiBpbmRleCByZXNwZWN0aW5nIHJldGVudGlvbiBjb25maWd1cmF0aW9uXG4qL1xuYXN5bmMgZnVuY3Rpb24gZGV0ZXJtaW5lQ3V0b2ZmSW5kZXgobWVzc2FnZXMsIGtlZXAsIHRva2VuQ291bnRlciwgbW9kZWwpIHtcblx0aWYgKFwidG9rZW5zXCIgaW4ga2VlcCB8fCBcImZyYWN0aW9uXCIgaW4ga2VlcCkge1xuXHRcdGNvbnN0IHRva2VuQmFzZWRDdXRvZmYgPSBhd2FpdCBmaW5kVG9rZW5CYXNlZEN1dG9mZihtZXNzYWdlcywga2VlcCwgdG9rZW5Db3VudGVyLCBtb2RlbCk7XG5cdFx0aWYgKHR5cGVvZiB0b2tlbkJhc2VkQ3V0b2ZmID09PSBcIm51bWJlclwiKSByZXR1cm4gdG9rZW5CYXNlZEN1dG9mZjtcblx0XHQvKipcblx0XHQqIEZhbGxiYWNrIHRvIG1lc3NhZ2UgY291bnQgaWYgdG9rZW4tYmFzZWQgZmFpbHNcblx0XHQqL1xuXHRcdHJldHVybiBmaW5kU2FmZUN1dG9mZihtZXNzYWdlcywgREVGQVVMVF9NRVNTQUdFU19UT19LRUVQKTtcblx0fVxuXHQvKipcblx0KiBmaW5kIGN1dG9mZiBpbmRleCBiYXNlZCBvbiBtZXNzYWdlIGNvdW50XG5cdCovXG5cdHJldHVybiBmaW5kU2FmZUN1dG9mZihtZXNzYWdlcywga2VlcC5tZXNzYWdlcyA/PyBERUZBVUxUX01FU1NBR0VTX1RPX0tFRVApO1xufVxuLyoqXG4qIEZpbmQgY3V0b2ZmIGluZGV4IGJhc2VkIG9uIHRhcmdldCB0b2tlbiByZXRlbnRpb25cbiovXG5hc3luYyBmdW5jdGlvbiBmaW5kVG9rZW5CYXNlZEN1dG9mZihtZXNzYWdlcywga2VlcCwgdG9rZW5Db3VudGVyLCBtb2RlbCkge1xuXHRpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSByZXR1cm4gMDtcblx0bGV0IHRhcmdldFRva2VuQ291bnQ7XG5cdGlmIChcImZyYWN0aW9uXCIgaW4ga2VlcCAmJiBrZWVwLmZyYWN0aW9uICE9PSB2b2lkIDApIHtcblx0XHRjb25zdCBtYXhJbnB1dFRva2VucyA9IGdldFByb2ZpbGVMaW1pdHMobW9kZWwpO1xuXHRcdGlmICh0eXBlb2YgbWF4SW5wdXRUb2tlbnMgIT09IFwibnVtYmVyXCIpIHJldHVybjtcblx0XHR0YXJnZXRUb2tlbkNvdW50ID0gTWF0aC5mbG9vcihtYXhJbnB1dFRva2VucyAqIGtlZXAuZnJhY3Rpb24pO1xuXHR9IGVsc2UgaWYgKFwidG9rZW5zXCIgaW4ga2VlcCAmJiBrZWVwLnRva2VucyAhPT0gdm9pZCAwKSB0YXJnZXRUb2tlbkNvdW50ID0gTWF0aC5mbG9vcihrZWVwLnRva2Vucyk7XG5cdGVsc2UgcmV0dXJuO1xuXHRpZiAodGFyZ2V0VG9rZW5Db3VudCA8PSAwKSB0YXJnZXRUb2tlbkNvdW50ID0gMTtcblx0aWYgKGF3YWl0IHRva2VuQ291bnRlcihtZXNzYWdlcykgPD0gdGFyZ2V0VG9rZW5Db3VudCkgcmV0dXJuIDA7XG5cdC8qKlxuXHQqIFVzZSBiaW5hcnkgc2VhcmNoIHRvIGlkZW50aWZ5IHRoZSBlYXJsaWVzdCBtZXNzYWdlIGluZGV4IHRoYXQga2VlcHMgdGhlXG5cdCogc3VmZml4IHdpdGhpbiB0aGUgdG9rZW4gYnVkZ2V0LlxuXHQqL1xuXHRsZXQgbGVmdCA9IDA7XG5cdGxldCByaWdodCA9IG1lc3NhZ2VzLmxlbmd0aDtcblx0bGV0IGN1dG9mZkNhbmRpZGF0ZSA9IG1lc3NhZ2VzLmxlbmd0aDtcblx0Y29uc3QgbWF4SXRlcmF0aW9ucyA9IE1hdGguZmxvb3IoTWF0aC5sb2cyKG1lc3NhZ2VzLmxlbmd0aCkpICsgMTtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBtYXhJdGVyYXRpb25zOyBpKyspIHtcblx0XHRpZiAobGVmdCA+PSByaWdodCkgYnJlYWs7XG5cdFx0Y29uc3QgbWlkID0gTWF0aC5mbG9vcigobGVmdCArIHJpZ2h0KSAvIDIpO1xuXHRcdGlmIChhd2FpdCB0b2tlbkNvdW50ZXIobWVzc2FnZXMuc2xpY2UobWlkKSkgPD0gdGFyZ2V0VG9rZW5Db3VudCkge1xuXHRcdFx0Y3V0b2ZmQ2FuZGlkYXRlID0gbWlkO1xuXHRcdFx0cmlnaHQgPSBtaWQ7XG5cdFx0fSBlbHNlIGxlZnQgPSBtaWQgKyAxO1xuXHR9XG5cdGlmIChjdXRvZmZDYW5kaWRhdGUgPT09IG1lc3NhZ2VzLmxlbmd0aCkgY3V0b2ZmQ2FuZGlkYXRlID0gbGVmdDtcblx0aWYgKGN1dG9mZkNhbmRpZGF0ZSA+PSBtZXNzYWdlcy5sZW5ndGgpIHtcblx0XHRpZiAobWVzc2FnZXMubGVuZ3RoID09PSAxKSByZXR1cm4gMDtcblx0XHRjdXRvZmZDYW5kaWRhdGUgPSBtZXNzYWdlcy5sZW5ndGggLSAxO1xuXHR9XG5cdC8qKlxuXHQqIEZpbmQgc2FmZSBjdXRvZmYgcG9pbnQgdGhhdCBwcmVzZXJ2ZXMgQUkvVG9vbCBwYWlycy5cblx0KiBJZiBjdXRvZmYgbGFuZHMgb24gVG9vbE1lc3NhZ2UsIG1vdmUgYmFja3dhcmQgdG8gaW5jbHVkZSB0aGUgQUlNZXNzYWdlLlxuXHQqL1xuXHRjb25zdCBzYWZlQ3V0b2ZmID0gZmluZFNhZmVDdXRvZmZQb2ludChtZXNzYWdlcywgY3V0b2ZmQ2FuZGlkYXRlKTtcblx0LyoqXG5cdCogSWYgZmluZFNhZmVDdXRvZmZQb2ludCBtb3ZlZCBmb3J3YXJkIChmYWxsYmFjayBjYXNlKSwgdmVyaWZ5IGl0J3Mgc2FmZS5cblx0KiBJZiBpdCBtb3ZlZCBiYWNrd2FyZCwgd2UgYWxyZWFkeSBoYXZlIGEgc2FmZSBwb2ludC5cblx0Ki9cblx0aWYgKHNhZmVDdXRvZmYgPD0gY3V0b2ZmQ2FuZGlkYXRlKSByZXR1cm4gc2FmZUN1dG9mZjtcblx0LyoqXG5cdCogRmFsbGJhY2s6IGl0ZXJhdGUgYmFja3dhcmQgdG8gZmluZCBhIHNhZmUgY3V0b2ZmXG5cdCovXG5cdGZvciAobGV0IGkgPSBjdXRvZmZDYW5kaWRhdGU7IGkgPj0gMDsgaS0tKSBpZiAoaXNTYWZlQ3V0b2ZmUG9pbnQobWVzc2FnZXMsIGkpKSByZXR1cm4gaTtcblx0cmV0dXJuIDA7XG59XG4vKipcbiogRmluZCBzYWZlIGN1dG9mZiBwb2ludCB0aGF0IHByZXNlcnZlcyBBSS9Ub29sIG1lc3NhZ2UgcGFpcnNcbiovXG5mdW5jdGlvbiBmaW5kU2FmZUN1dG9mZihtZXNzYWdlcywgbWVzc2FnZXNUb0tlZXApIHtcblx0aWYgKG1lc3NhZ2VzLmxlbmd0aCA8PSBtZXNzYWdlc1RvS2VlcCkgcmV0dXJuIDA7XG5cdGNvbnN0IHRhcmdldEN1dG9mZiA9IG1lc3NhZ2VzLmxlbmd0aCAtIG1lc3NhZ2VzVG9LZWVwO1xuXHQvKipcblx0KiBGaXJzdCwgdHJ5IHRvIGZpbmQgYSBzYWZlIGN1dG9mZiBwb2ludCB1c2luZyBmaW5kU2FmZUN1dG9mZlBvaW50LlxuXHQqIFRoaXMgaGFuZGxlcyB0aGUgY2FzZSB3aGVyZSBjdXRvZmYgbGFuZHMgb24gYSBUb29sTWVzc2FnZSBieSBtb3Zpbmdcblx0KiBiYWNrd2FyZCB0byBpbmNsdWRlIHRoZSBjb3JyZXNwb25kaW5nIEFJTWVzc2FnZS5cblx0Ki9cblx0Y29uc3Qgc2FmZUN1dG9mZiA9IGZpbmRTYWZlQ3V0b2ZmUG9pbnQobWVzc2FnZXMsIHRhcmdldEN1dG9mZik7XG5cdC8qKlxuXHQqIElmIGZpbmRTYWZlQ3V0b2ZmUG9pbnQgbW92ZWQgYmFja3dhcmQgKGZvdW5kIG1hdGNoaW5nIEFJTWVzc2FnZSksIHVzZSBpdC5cblx0Ki9cblx0aWYgKHNhZmVDdXRvZmYgPD0gdGFyZ2V0Q3V0b2ZmKSByZXR1cm4gc2FmZUN1dG9mZjtcblx0LyoqXG5cdCogRmFsbGJhY2s6IGl0ZXJhdGUgYmFja3dhcmQgdG8gZmluZCBhIHNhZmUgY3V0b2ZmXG5cdCovXG5cdGZvciAobGV0IGkgPSB0YXJnZXRDdXRvZmY7IGkgPj0gMDsgaS0tKSBpZiAoaXNTYWZlQ3V0b2ZmUG9pbnQobWVzc2FnZXMsIGkpKSByZXR1cm4gaTtcblx0cmV0dXJuIDA7XG59XG4vKipcbiogQ2hlY2sgaWYgY3V0dGluZyBhdCBpbmRleCB3b3VsZCBzZXBhcmF0ZSBBSS9Ub29sIG1lc3NhZ2UgcGFpcnNcbiovXG5mdW5jdGlvbiBpc1NhZmVDdXRvZmZQb2ludChtZXNzYWdlcywgY3V0b2ZmSW5kZXgpIHtcblx0aWYgKGN1dG9mZkluZGV4ID49IG1lc3NhZ2VzLmxlbmd0aCkgcmV0dXJuIHRydWU7XG5cdC8qKlxuXHQqIFByZXZlbnQgcHJlc2VydmVkIG1lc3NhZ2VzIGZyb20gc3RhcnRpbmcgd2l0aCBBSSBtZXNzYWdlIGNvbnRhaW5pbmcgdG9vbCBjYWxsc1xuXHQqL1xuXHRpZiAoY3V0b2ZmSW5kZXggPCBtZXNzYWdlcy5sZW5ndGggJiYgQUlNZXNzYWdlLmlzSW5zdGFuY2UobWVzc2FnZXNbY3V0b2ZmSW5kZXhdKSAmJiBoYXNUb29sQ2FsbHMobWVzc2FnZXNbY3V0b2ZmSW5kZXhdKSkgcmV0dXJuIGZhbHNlO1xuXHRjb25zdCBzZWFyY2hTdGFydCA9IE1hdGgubWF4KDAsIGN1dG9mZkluZGV4IC0gU0VBUkNIX1JBTkdFX0ZPUl9UT09MX1BBSVJTKTtcblx0Y29uc3Qgc2VhcmNoRW5kID0gTWF0aC5taW4obWVzc2FnZXMubGVuZ3RoLCBjdXRvZmZJbmRleCArIFNFQVJDSF9SQU5HRV9GT1JfVE9PTF9QQUlSUyk7XG5cdGZvciAobGV0IGkgPSBzZWFyY2hTdGFydDsgaSA8IHNlYXJjaEVuZDsgaSsrKSB7XG5cdFx0aWYgKCFoYXNUb29sQ2FsbHMobWVzc2FnZXNbaV0pKSBjb250aW51ZTtcblx0XHRjb25zdCB0b29sQ2FsbElkcyA9IGV4dHJhY3RUb29sQ2FsbElkcyhtZXNzYWdlc1tpXSk7XG5cdFx0aWYgKGN1dG9mZlNlcGFyYXRlc1Rvb2xQYWlyKG1lc3NhZ2VzLCBpLCBjdXRvZmZJbmRleCwgdG9vbENhbGxJZHMpKSByZXR1cm4gZmFsc2U7XG5cdH1cblx0cmV0dXJuIHRydWU7XG59XG4vKipcbiogRXh0cmFjdCB0b29sIGNhbGwgSURzIGZyb20gYW4gQUkgbWVzc2FnZVxuKi9cbmZ1bmN0aW9uIGV4dHJhY3RUb29sQ2FsbElkcyhhaU1lc3NhZ2UpIHtcblx0Y29uc3QgdG9vbENhbGxJZHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuXHRpZiAoYWlNZXNzYWdlLnRvb2xfY2FsbHMpIGZvciAoY29uc3QgdG9vbENhbGwgb2YgYWlNZXNzYWdlLnRvb2xfY2FsbHMpIHtcblx0XHRjb25zdCBpZCA9IHR5cGVvZiB0b29sQ2FsbCA9PT0gXCJvYmplY3RcIiAmJiBcImlkXCIgaW4gdG9vbENhbGwgPyB0b29sQ2FsbC5pZCA6IG51bGw7XG5cdFx0aWYgKGlkKSB0b29sQ2FsbElkcy5hZGQoaWQpO1xuXHR9XG5cdHJldHVybiB0b29sQ2FsbElkcztcbn1cbi8qKlxuKiBGaW5kIGEgc2FmZSBjdXRvZmYgcG9pbnQgdGhhdCBkb2Vzbid0IHNwbGl0IEFJL1Rvb2wgbWVzc2FnZSBwYWlycy5cbipcbiogSWYgdGhlIG1lc3NhZ2UgYXQgYGN1dG9mZkluZGV4YCBpcyBhIGBUb29sTWVzc2FnZWAsIHNlYXJjaCBiYWNrd2FyZCBmb3IgdGhlXG4qIGBBSU1lc3NhZ2VgIGNvbnRhaW5pbmcgdGhlIGNvcnJlc3BvbmRpbmcgYHRvb2xfY2FsbHNgIGFuZCBhZGp1c3QgdGhlIGN1dG9mZiB0b1xuKiBpbmNsdWRlIGl0LiBUaGlzIGVuc3VyZXMgdG9vbCBjYWxsIHJlcXVlc3RzIGFuZCByZXNwb25zZXMgc3RheSB0b2dldGhlci5cbipcbiogRmFsbHMgYmFjayB0byBhZHZhbmNpbmcgZm9yd2FyZCBwYXN0IGBUb29sTWVzc2FnZWAgb2JqZWN0cyBvbmx5IGlmIG5vIG1hdGNoaW5nXG4qIGBBSU1lc3NhZ2VgIGlzIGZvdW5kIChlZGdlIGNhc2UpLlxuKi9cbmZ1bmN0aW9uIGZpbmRTYWZlQ3V0b2ZmUG9pbnQobWVzc2FnZXMsIGN1dG9mZkluZGV4KSB7XG5cdGlmIChjdXRvZmZJbmRleCA+PSBtZXNzYWdlcy5sZW5ndGggfHwgIVRvb2xNZXNzYWdlLmlzSW5zdGFuY2UobWVzc2FnZXNbY3V0b2ZmSW5kZXhdKSkgcmV0dXJuIGN1dG9mZkluZGV4O1xuXHRjb25zdCB0b29sQ2FsbElkcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG5cdGxldCBpZHggPSBjdXRvZmZJbmRleDtcblx0d2hpbGUgKGlkeCA8IG1lc3NhZ2VzLmxlbmd0aCAmJiBUb29sTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2VzW2lkeF0pKSB7XG5cdFx0Y29uc3QgdG9vbE1zZyA9IG1lc3NhZ2VzW2lkeF07XG5cdFx0aWYgKHRvb2xNc2cudG9vbF9jYWxsX2lkKSB0b29sQ2FsbElkcy5hZGQodG9vbE1zZy50b29sX2NhbGxfaWQpO1xuXHRcdGlkeCsrO1xuXHR9XG5cdGZvciAobGV0IGkgPSBjdXRvZmZJbmRleCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdFx0Y29uc3QgbXNnID0gbWVzc2FnZXNbaV07XG5cdFx0aWYgKEFJTWVzc2FnZS5pc0luc3RhbmNlKG1zZykgJiYgaGFzVG9vbENhbGxzKG1zZykpIHtcblx0XHRcdGNvbnN0IGFpVG9vbENhbGxJZHMgPSBleHRyYWN0VG9vbENhbGxJZHMobXNnKTtcblx0XHRcdGZvciAoY29uc3QgaWQgb2YgdG9vbENhbGxJZHMpIGlmIChhaVRvb2xDYWxsSWRzLmhhcyhpZCkpIHJldHVybiBpO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gaWR4O1xufVxuLyoqXG4qIENoZWNrIGlmIGN1dG9mZiBzZXBhcmF0ZXMgYW4gQUkgbWVzc2FnZSBmcm9tIGl0cyBjb3JyZXNwb25kaW5nIHRvb2wgbWVzc2FnZXNcbiovXG5mdW5jdGlvbiBjdXRvZmZTZXBhcmF0ZXNUb29sUGFpcihtZXNzYWdlcywgYWlNZXNzYWdlSW5kZXgsIGN1dG9mZkluZGV4LCB0b29sQ2FsbElkcykge1xuXHRmb3IgKGxldCBqID0gYWlNZXNzYWdlSW5kZXggKyAxOyBqIDwgbWVzc2FnZXMubGVuZ3RoOyBqKyspIHtcblx0XHRjb25zdCBtZXNzYWdlID0gbWVzc2FnZXNbal07XG5cdFx0aWYgKFRvb2xNZXNzYWdlLmlzSW5zdGFuY2UobWVzc2FnZSkgJiYgdG9vbENhbGxJZHMuaGFzKG1lc3NhZ2UudG9vbF9jYWxsX2lkKSkge1xuXHRcdFx0aWYgKGFpTWVzc2FnZUluZGV4IDwgY3V0b2ZmSW5kZXggIT09IGogPCBjdXRvZmZJbmRleCkgcmV0dXJuIHRydWU7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBmYWxzZTtcbn1cbi8qKlxuKiBHZW5lcmF0ZSBzdW1tYXJ5IGZvciB0aGUgZ2l2ZW4gbWVzc2FnZXMuXG4qXG4qIEBwYXJhbSBtZXNzYWdlc1RvU3VtbWFyaXplIC0gTWVzc2FnZXMgdG8gc3VtbWFyaXplLlxuKiBAcGFyYW0gbW9kZWwgLSBUaGUgbGFuZ3VhZ2UgbW9kZWwgdG8gdXNlIGZvciBzdW1tYXJpemF0aW9uLlxuKiBAcGFyYW0gc3VtbWFyeVByb21wdCAtIFRoZSBwcm9tcHQgdGVtcGxhdGUgZm9yIHN1bW1hcml6YXRpb24uXG4qIEBwYXJhbSB0b2tlbkNvdW50ZXIgLSBGdW5jdGlvbiB0byBjb3VudCB0b2tlbnMuXG4qIEBwYXJhbSB0cmltVG9rZW5zVG9TdW1tYXJpemUgLSBPcHRpb25hbCB0b2tlbiBsaW1pdCBmb3IgdHJpbW1pbmcgbWVzc2FnZXMuXG4qIEBwYXJhbSBydW50aW1lIC0gVGhlIHJ1bnRpbWUgZW52aXJvbm1lbnQsIHVzZWQgdG8gaW5oZXJpdCBjb25maWcgc28gdGhhdFxuKiAgIExhbmdHcmFwaCdzIGhhbmRsZXJzIGNhbiBwcm9wZXJseSB0cmFjayBhbmQgdGFnIHRoZSBzdW1tYXJpemF0aW9uIG1vZGVsIGNhbGwuXG4qL1xuYXN5bmMgZnVuY3Rpb24gY3JlYXRlU3VtbWFyeShtZXNzYWdlc1RvU3VtbWFyaXplLCBtb2RlbCwgc3VtbWFyeVByb21wdCwgdG9rZW5Db3VudGVyLCB0cmltVG9rZW5zVG9TdW1tYXJpemUsIHJ1bnRpbWUpIHtcblx0aWYgKCFtZXNzYWdlc1RvU3VtbWFyaXplLmxlbmd0aCkgcmV0dXJuIFwiTm8gcHJldmlvdXMgY29udmVyc2F0aW9uIGhpc3RvcnkuXCI7XG5cdGNvbnN0IHRyaW1tZWRNZXNzYWdlcyA9IGF3YWl0IHRyaW1NZXNzYWdlc0ZvclN1bW1hcnkobWVzc2FnZXNUb1N1bW1hcml6ZSwgdG9rZW5Db3VudGVyLCB0cmltVG9rZW5zVG9TdW1tYXJpemUpO1xuXHRpZiAoIXRyaW1tZWRNZXNzYWdlcy5sZW5ndGgpIHJldHVybiBcIlByZXZpb3VzIGNvbnZlcnNhdGlvbiB3YXMgdG9vIGxvbmcgdG8gc3VtbWFyaXplLlwiO1xuXHQvKipcblx0KiBGb3JtYXQgbWVzc2FnZXMgdXNpbmcgZ2V0QnVmZmVyU3RyaW5nIHRvIGF2b2lkIHRva2VuIGluZmxhdGlvbiBmcm9tIG1ldGFkYXRhXG5cdCogd2hlbiBzdHIoKSAvIEpTT04uc3RyaW5naWZ5IGlzIGNhbGxlZCBvbiBtZXNzYWdlIG9iamVjdHMuXG5cdCogVGhpcyBwcm9kdWNlcyBjb21wYWN0IG91dHB1dCBsaWtlOlxuXHQqIGBgYFxuXHQqIEh1bWFuOiBXaGF0J3MgdGhlIHdlYXRoZXI/XG5cdCogQUk6IExldCBtZSBjaGVjay4uLlt0b29sX2NhbGxzXVxuXHQqIFRvb2w6IDcywrBGIGFuZCBzdW5ueVxuXHQqIGBgYFxuXHQqL1xuXHRjb25zdCBmb3JtYXR0ZWRNZXNzYWdlcyA9IGdldEJ1ZmZlclN0cmluZyh0cmltbWVkTWVzc2FnZXMpO1xuXHR0cnkge1xuXHRcdGNvbnN0IGZvcm1hdHRlZFByb21wdCA9IHN1bW1hcnlQcm9tcHQucmVwbGFjZShcInttZXNzYWdlc31cIiwgZm9ybWF0dGVkTWVzc2FnZXMpO1xuXHRcdGNvbnN0IGNvbmZpZyA9IG1lcmdlQ29uZmlncyhwaWNrUnVubmFibGVDb25maWdLZXlzKHJ1bnRpbWUpID8/IHt9LCB7IG1ldGFkYXRhOiB7IGxjX3NvdXJjZTogXCJzdW1tYXJpemF0aW9uXCIgfSB9KTtcblx0XHRjb25zdCBjb250ZW50ID0gKGF3YWl0IG1vZGVsLmludm9rZShmb3JtYXR0ZWRQcm9tcHQsIGNvbmZpZykpLmNvbnRlbnQ7XG5cdFx0LyoqXG5cdFx0KiBIYW5kbGUgYm90aCBzdHJpbmcgY29udGVudCBhbmQgTWVzc2FnZUNvbnRlbnQgYXJyYXlcblx0XHQqL1xuXHRcdGlmICh0eXBlb2YgY29udGVudCA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIGNvbnRlbnQudHJpbSgpO1xuXHRcdGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoY29udGVudCkpIHJldHVybiBjb250ZW50Lm1hcCgoaXRlbSkgPT4ge1xuXHRcdFx0aWYgKHR5cGVvZiBpdGVtID09PSBcInN0cmluZ1wiKSByZXR1cm4gaXRlbTtcblx0XHRcdGlmICh0eXBlb2YgaXRlbSA9PT0gXCJvYmplY3RcIiAmJiBpdGVtICE9PSBudWxsICYmIFwidGV4dFwiIGluIGl0ZW0pIHJldHVybiBpdGVtLnRleHQ7XG5cdFx0XHRyZXR1cm4gXCJcIjtcblx0XHR9KS5qb2luKFwiXCIpLnRyaW0oKTtcblx0XHRyZXR1cm4gXCJFcnJvciBnZW5lcmF0aW5nIHN1bW1hcnk6IEludmFsaWQgcmVzcG9uc2UgZm9ybWF0XCI7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRyZXR1cm4gYEVycm9yIGdlbmVyYXRpbmcgc3VtbWFyeTogJHtlfWA7XG5cdH1cbn1cbi8qKlxuKiBUcmltIG1lc3NhZ2VzIHRvIGZpdCB3aXRoaW4gc3VtbWFyeSBnZW5lcmF0aW9uIGxpbWl0c1xuKi9cbmFzeW5jIGZ1bmN0aW9uIHRyaW1NZXNzYWdlc0ZvclN1bW1hcnkobWVzc2FnZXMsIHRva2VuQ291bnRlciwgdHJpbVRva2Vuc1RvU3VtbWFyaXplKSB7XG5cdGlmICh0cmltVG9rZW5zVG9TdW1tYXJpemUgPT09IHZvaWQgMCkgcmV0dXJuIG1lc3NhZ2VzO1xuXHR0cnkge1xuXHRcdHJldHVybiBhd2FpdCB0cmltTWVzc2FnZXMobWVzc2FnZXMsIHtcblx0XHRcdG1heFRva2VuczogdHJpbVRva2Vuc1RvU3VtbWFyaXplLFxuXHRcdFx0dG9rZW5Db3VudGVyOiBhc3luYyAobXNncykgPT4gdG9rZW5Db3VudGVyKG1zZ3MpLFxuXHRcdFx0c3RyYXRlZ3k6IFwibGFzdFwiLFxuXHRcdFx0YWxsb3dQYXJ0aWFsOiB0cnVlLFxuXHRcdFx0aW5jbHVkZVN5c3RlbTogdHJ1ZVxuXHRcdH0pO1xuXHR9IGNhdGNoIHtcblx0XHQvKipcblx0XHQqIEZhbGxiYWNrIHRvIGxhc3QgTiBtZXNzYWdlcyBpZiB0cmltbWluZyBmYWlsc1xuXHRcdCovXG5cdFx0cmV0dXJuIG1lc3NhZ2VzLnNsaWNlKC1ERUZBVUxUX0ZBTExCQUNLX01FU1NBR0VfQ09VTlQpO1xuXHR9XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgY29udGV4dFNpemVTY2hlbWEsIGdldFByb2ZpbGVMaW1pdHMsIGtlZXBTY2hlbWEsIHN1bW1hcml6YXRpb25NaWRkbGV3YXJlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdW1tYXJpemF0aW9uLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/summarization.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/todoListMiddleware.js":
/*!*************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/todoListMiddleware.js ***!
  \*************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TODO_LIST_MIDDLEWARE_SYSTEM_PROMPT: () => (/* binding */ TODO_LIST_MIDDLEWARE_SYSTEM_PROMPT),\n/* harmony export */   todoListMiddleware: () => (/* binding */ todoListMiddleware)\n/* harmony export */ });\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../index.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/index.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_core_tools__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/tools */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/tools/index.js\");\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n\n\n\n\n\n//#region src/agents/middleware/todoListMiddleware.ts\n/**\n* Description for the write_todos tool\n* Ported exactly from Python WRITE_TODOS_DESCRIPTION\n*/\nconst WRITE_TODOS_DESCRIPTION = `Use this tool to create and manage a structured task list for your current work session. This helps you track progress, organize complex tasks, and demonstrate thoroughness to the user.\nIt also helps the user understand the progress of the task and overall progress of their requests.\nOnly use this tool if you think it will be helpful in staying organized. If the user's request is trivial and takes less than 3 steps, it is better to NOT use this tool and just do the task directly.\n\n## When to Use This Tool\nUse this tool in these scenarios:\n\n1. Complex multi-step tasks - When a task requires 3 or more distinct steps or actions\n2. Non-trivial and complex tasks - Tasks that require careful planning or multiple operations\n3. User explicitly requests todo list - When the user directly asks you to use the todo list\n4. User provides multiple tasks - When users provide a list of things to be done (numbered or comma-separated)\n5. The plan may need future revisions or updates based on results from the first few steps. Keeping track of this in a list is helpful.\n\n## How to Use This Tool\n1. When you start working on a task - Mark it as in_progress BEFORE beginning work.\n2. After completing a task - Mark it as completed and add any new follow-up tasks discovered during implementation.\n3. You can also update future tasks, such as deleting them if they are no longer necessary, or adding new tasks that are necessary. Don't change previously completed tasks.\n4. You can make several updates to the todo list at once. For example, when you complete a task, you can mark the next task you need to start as in_progress.\n\n## When NOT to Use This Tool\nIt is important to skip using this tool when:\n1. There is only a single, straightforward task\n2. The task is trivial and tracking it provides no benefit\n3. The task can be completed in less than 3 trivial steps\n4. The task is purely conversational or informational\n\n## Examples of When to Use the Todo List\n\n<example>\nUser: I want to add a dark mode toggle to the application settings. Make sure you run the tests and build when you're done!\nAssistant: I'll help add a dark mode toggle to your application settings. Let me create a todo list to track this implementation.\n*Creates todo list with the following items:*\n1. Create dark mode toggle component in Settings page\n2. Add dark mode state management (context/store)\n3. Implement CSS-in-JS styles for dark theme\n4. Update existing components to support theme switching\n5. Run tests and build process, addressing any failures or errors that occur\n*Begins working on the first task*\n\n<reasoning>\nThe assistant used the todo list because:\n1. Adding dark mode in it of itself is a multi-step feature requiring UI, state management, and styling changes\n2. The assistant inferred that tests and build need to pass by adding \"Ensure tests and build succeed\" as the final task\n3. Both of the user's requests are complex and require multiple steps to complete.\n</reasoning>\n</example>\n\n<example>\nUser: Help me plan a comprehensive marketing campaign for our new product launch, including social media, email marketing, and press releases.\nAssistant: I'll help you plan a comprehensive marketing campaign for your product launch. Let me create a todo list to organize all the components.\n*Creates todo list with the following items:*\n1. Define target audience and key messaging\n2. Create social media content calendar and posting schedule\n3. Design email marketing sequence and automation flows\n4. Draft press release and identify media contacts\n5. Set up tracking and analytics for campaign performance\n6. Create visual assets and brand materials\n7. Coordinate launch timeline and deliverables\n*Begins working on the first task*\n\n<reasoning>\nThe assistant used the todo list because:\n1. Marketing campaign planning involves multiple distinct channels and activities\n2. Each component requires careful coordination and planning\n3. The systematic approach ensures all aspects of the launch are covered\n</reasoning>\n</example>\n\n<example>\nUser: Help me rename the function getCwd to getCurrentWorkingDirectory across my project\nAssistant: Let me first search through your codebase to find all occurrences of 'getCwd'.\n*Uses search tools to locate all instances of getCwd in the codebase*\nAssistant: I've found 15 instances of 'getCwd' across 8 different files. Let me create a todo list to track these changes.\n*Creates todo list with specific items for each file that needs updating*\n\n<reasoning>\nThe assistant used the todo list because:\n1. The assistant searched to understand the scope of the task\n2. Upon finding multiple occurrences across different files, it determined this was a complex task with multiple steps (>3)\n3. The todo list helps ensure every instance is tracked and updated systematically\n4. This approach prevents missing any occurrences and maintains consistency.\n</reasoning>\n</example>\n\n<example>\nUser: I need help organizing my home office: decluttering the desk, setting up a filing system, organizing digital files, and creating a daily workflow.\nAssistant: I'll help you organize your home office systematically. Let me create a todo list to track each area of organization.\n*Creates todo list with items like: 1) Sort and declutter desk items, 2) Set up physical filing system for documents, 3) Organize digital files and folders, 4) Create daily workflow and productivity systems, 5) Establish maintenance routines*\nLet's start with decluttering your desk space to create a clean foundation for the other organizational systems.\n\n<reasoning>\nThe assistant used the todo list because:\n1. The user provided multiple distinct organizational tasks\n2. Each area requires different approaches and careful planning\n3. Home organization benefits from systematic, step-by-step completion\n4. Progress tracking ensures all areas are addressed thoroughly\n</reasoning>\n</example>\n\n## Examples of When NOT to Use the Todo List\n\n<example>\nUser: How do I print 'Hello World' in Python?\nAssistant: In Python, you can print \"Hello World\" with this simple code:\n\n\\`\\`\\`python\nprint(\"Hello World\")\n\\`\\`\\`\n\nThis will output the text \"Hello World\" to the console when executed.</assistant>\n\n<reasoning>\nThe assistant did not use the todo list because this is a single, trivial task that can be completed in one step. There's no need to track multiple tasks or steps for such a straightforward request.\n</reasoning>\n</example>\n\n<example>\nUser: What's the best way to water houseplants?\nAssistant: The best way to water houseplants depends on the specific plant type, but here are some general guidelines:\n\n- Check soil moisture by inserting your finger about 1-2 inches into the soil\n- Water thoroughly when the top inch feels dry, allowing water to drain from the bottom\n- Use room temperature water and water in the morning when possible\n- Avoid overwatering, which is more harmful than underwatering for most plants\n\nDifferent plants have different needs, so it's important to research your specific varieties for optimal care.\n\n<reasoning>\nThe assistant did not use the todo list because this is an informational request with no actual tasks to complete. The user is simply asking for advice and explanation, not for the assistant to perform multiple steps or activities.\n</reasoning>\n</example>\n\n<example>\nUser: Can you add a comment to the calculateTotal function to explain what it does?\nAssistant: Sure, let me add a comment to the calculateTotal function to explain what it does.\n* Uses the Edit tool to add a comment to the calculateTotal function *\n\n<reasoning>\nThe assistant did not use the todo list because this is a single, straightforward task confined to one location. Adding a comment doesn't require tracking multiple steps or systematic organization.\n</reasoning>\n</example>\n\n<example>\nUser: What time is it in Tokyo right now?\nAssistant: I'll check the current time in Tokyo for you.\n\n*Searches for current time in Tokyo*\n\nThe current time in Tokyo, Japan is [current time]. Tokyo is in the Japan Standard Time (JST) zone, which is UTC+9.\n\n<reasoning>\nThe assistant did not use the todo list because this is a single information lookup with immediate results. There are no multiple steps to track or organize, making the todo list unnecessary for this straightforward request.\n</reasoning>\n</example>\n\n<example>\nUser: I need to write a function that checks if a number is prime and then test it out.\nAssistant: I'll help you write a function that checks if a number is prime and then test it out.\n*Writes function that checks if a number is prime*\n*Tests the function*\n\n<reasoning>\nEven though this is a multi-step task, it is very straightforward and can be completed in two trivial steps (which is less than 3 steps!). Using the todo list here is overkill and wastes time and tokens.\n</reasoning>\n</example>\n\n<example>\nUser: I want you to order a pizza from Dominos, order a burger from McDonald's, and order a salad from Subway.\nAssistant: I'll help you order a pizza from Dominos, order a burger from McDonald's, and order a salad from Subway.\n*Orders a pizza from Dominos*\n*Orders a burger from McDonald's*\n*Orders a salad from Subway*\n\n<reasoning>\nEven though this is a multi-step task, assuming the assistant has the ability to order from these restaurants, it is very straightforward and can be completed in three trivial tool calls. \nUsing the todo list here is overkill and wastes time and tokens. These three tool calls should be made in parallel, in fact.\n</reasoning>\n</example>\n\n\n## Task States and Management\n\n1. **Task States**: Use these states to track progress:\n   - pending: Task not yet started\n   - in_progress: Currently working on (you can have multiple tasks in_progress at a time if they are not related to each other and can be run in parallel)\n   - completed: Task finished successfully\n\n2. **Task Management**:\n   - Update task status in real-time as you work\n   - Mark tasks complete IMMEDIATELY after finishing (don't batch completions)\n   - Complete current tasks before starting new ones\n   - Remove tasks that are no longer relevant from the list entirely\n   - IMPORTANT: When you write this todo list, you should mark your first task (or tasks) as in_progress immediately!.\n   - IMPORTANT: Unless all tasks are completed, you should always have at least one task in_progress to show the user that you are working on something.\n\n3. **Task Completion Requirements**:\n   - ONLY mark a task as completed when you have FULLY accomplished it\n   - If you encounter errors, blockers, or cannot finish, keep the task as in_progress\n   - When blocked, create a new task describing what needs to be resolved\n   - Never mark a task as completed if:\n     - There are unresolved issues or errors\n     - Work is partial or incomplete\n     - You encountered blockers that prevent completion\n     - You couldn't find necessary resources or dependencies\n     - Quality standards haven't been met\n\n4. **Task Breakdown**:\n   - Create specific, actionable items\n   - Break complex tasks into smaller, manageable steps\n   - Use clear, descriptive task names\n\nBeing proactive with task management demonstrates attentiveness and ensures you complete all requirements successfully\nRemember: If you only need to make a few tool calls to complete a task, and it is clear what you need to do, it is better to just do the task directly and NOT call this tool at all.`;\nconst TODO_LIST_MIDDLEWARE_SYSTEM_PROMPT = `## \\`write_todos\\`\n\nYou have access to the \\`write_todos\\` tool to help you manage and plan complex objectives. \nUse this tool for complex objectives to ensure that you are tracking each necessary step and giving the user visibility into your progress.\nThis tool is very helpful for planning complex objectives, and for breaking down these larger complex objectives into smaller steps.\n\nIt is critical that you mark todos as completed as soon as you are done with a step. Do not batch up multiple steps before marking them as completed.\nFor simple objectives that only require a few steps, it is better to just complete the objective directly and NOT use this tool.\nWriting todos takes time and tokens, use it when it is helpful for managing complex many-step problems! But not for simple few-step requests.\n\n## Important To-Do List Usage Notes to Remember\n- The \\`write_todos\\` tool should never be called multiple times in parallel.\n- Don't be afraid to revise the To-Do list as you go. New information may reveal new tasks that need to be done, or old tasks that are irrelevant.`;\nconst TodoStatus = zod_v3__WEBPACK_IMPORTED_MODULE_5__.z[\"enum\"]([\n\t\"pending\",\n\t\"in_progress\",\n\t\"completed\"\n]).describe(\"Status of the todo\");\nconst TodoSchema = zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.object({\n\tcontent: zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.string().describe(\"Content of the todo item\"),\n\tstatus: TodoStatus\n});\nconst stateSchema = zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.object({ todos: zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.array(TodoSchema).default([]) });\n/**\n* Creates a middleware that provides todo list management capabilities to agents.\n*\n* This middleware adds a `write_todos` tool that allows agents to create and manage\n* structured task lists for complex multi-step operations. It's designed to help\n* agents track progress, organize complex tasks, and provide users with visibility\n* into task completion status.\n*\n* The middleware automatically injects system prompts that guide the agent on when\n* and how to use the todo functionality effectively. It also enforces that the\n* `write_todos` tool is called at most once per model turn, since the tool replaces\n* the entire todo list and parallel calls would create ambiguity about precedence.\n*\n* @example\n* ```typescript\n* import { todoListMiddleware, createAgent } from 'langchain';\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   middleware: [todoListMiddleware()],\n* });\n*\n* // Agent now has access to write_todos tool and todo state tracking\n* const result = await agent.invoke({\n*   messages: [new HumanMessage(\"Help me refactor my codebase\")]\n* });\n*\n* console.log(result.todos); // Array of todo items with status tracking\n* ```\n*\n* @returns A configured middleware instance that provides todo management capabilities\n*\n* @see {@link TodoMiddlewareState} for the state schema\n* @see {@link writeTodos} for the tool implementation\n*/\nfunction todoListMiddleware(options) {\n\t/**\n\t* Write todos tool - manages todo list with Command return\n\t*/\n\tconst writeTodos = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_3__.tool)(({ todos }, config) => {\n\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_4__.Command({ update: {\n\t\t\ttodos,\n\t\t\tmessages: [new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.ToolMessage({\n\t\t\t\tcontent: `Updated todo list to ${JSON.stringify(todos)}`,\n\t\t\t\ttool_call_id: config.toolCall?.id\n\t\t\t})]\n\t\t} });\n\t}, {\n\t\tname: \"write_todos\",\n\t\tdescription: options?.toolDescription ?? WRITE_TODOS_DESCRIPTION,\n\t\tschema: zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.object({ todos: zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.array(TodoSchema).describe(\"List of todo items to update\") })\n\t});\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)({\n\t\tname: \"todoListMiddleware\",\n\t\tstateSchema,\n\t\ttools: [writeTodos],\n\t\twrapModelCall: (request, handler) => handler({\n\t\t\t...request,\n\t\t\tsystemMessage: request.systemMessage.concat(`\\n\\n${options?.systemPrompt ?? TODO_LIST_MIDDLEWARE_SYSTEM_PROMPT}`)\n\t\t}),\n\t\tafterModel: (state) => {\n\t\t\t/**\n\t\t\t* Check for parallel write_todos tool calls and return errors if detected.\n\t\t\t*\n\t\t\t* The todo list is designed to be updated at most once per model turn. Since\n\t\t\t* the `write_todos` tool replaces the entire todo list with each call, making\n\t\t\t* multiple parallel calls would create ambiguity about which update should take\n\t\t\t* precedence. This method prevents such conflicts by rejecting any response that\n\t\t\t* contains multiple write_todos tool calls.\n\t\t\t*/\n\t\t\tconst messages = state.messages;\n\t\t\tif (!messages || messages.length === 0) return;\n\t\t\t/**\n\t\t\t* Find the last AI message\n\t\t\t*/\n\t\t\tconst lastAiMsg = [...messages].reverse().find((msg) => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage.isInstance(msg));\n\t\t\tif (!lastAiMsg || !lastAiMsg.tool_calls || lastAiMsg.tool_calls.length === 0) return;\n\t\t\t/**\n\t\t\t* Count write_todos tool calls\n\t\t\t*/\n\t\t\tconst writeTodosCalls = lastAiMsg.tool_calls.filter((tc) => tc.name === writeTodos.name);\n\t\t\tif (writeTodosCalls.length > 1)\n /**\n\t\t\t* Keep the tool calls in the AI message but return error messages\n\t\t\t* This follows the same pattern as HumanInTheLoopMiddleware\n\t\t\t*/\n\t\t\treturn { messages: writeTodosCalls.map((tc) => new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.ToolMessage({\n\t\t\t\tcontent: \"Error: The `write_todos` tool should never be called multiple times in parallel. Please call it only once per model invocation to update the todo list.\",\n\t\t\t\ttool_call_id: tc.id,\n\t\t\t\tstatus: \"error\"\n\t\t\t})) };\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=todoListMiddleware.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS90b2RvTGlzdE1pZGRsZXdhcmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBb0Q7QUFDL0I7QUFDNkM7QUFDckI7QUFDRTtBQUNwQjs7QUFFM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDZDQUFNO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDRDQUFRO0FBQzNCLFVBQVUsNENBQVE7QUFDbEI7QUFDQSxDQUFDO0FBQ0Qsb0JBQW9CLDRDQUFRLEdBQUcsT0FBTywyQ0FBTywwQkFBMEI7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxrQ0FBa0M7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDJCQUEyQjtBQUNuQyxRQUFRLGtCQUFrQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJEQUFJLElBQUksT0FBTztBQUNuQyxhQUFhLHlEQUFPLEdBQUc7QUFDdkI7QUFDQSxrQkFBa0IsaUVBQVc7QUFDN0IscUNBQXFDLHNCQUFzQjtBQUMzRDtBQUNBLElBQUk7QUFDSixLQUFLO0FBQ0wsRUFBRTtBQUNGO0FBQ0E7QUFDQSxVQUFVLDRDQUFRLEdBQUcsT0FBTywyQ0FBTyx1REFBdUQ7QUFDMUYsRUFBRTtBQUNGLFFBQVEsZ0VBQWdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsNERBQTREO0FBQ2xILEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsK0RBQVM7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDBDQUEwQyxpRUFBVztBQUNqRTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDa0U7QUFDbEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS90b2RvTGlzdE1pZGRsZXdhcmUuanM/OWFhMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVNaWRkbGV3YXJlIH0gZnJvbSBcIi4uL21pZGRsZXdhcmUuanNcIjtcbmltcG9ydCBcIi4uL2luZGV4LmpzXCI7XG5pbXBvcnQgeyBBSU1lc3NhZ2UsIFRvb2xNZXNzYWdlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9tZXNzYWdlc1wiO1xuaW1wb3J0IHsgdG9vbCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvdG9vbHNcIjtcbmltcG9ydCB7IENvbW1hbmQgfSBmcm9tIFwiQGxhbmdjaGFpbi9sYW5nZ3JhcGhcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kL3YzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL21pZGRsZXdhcmUvdG9kb0xpc3RNaWRkbGV3YXJlLnRzXG4vKipcbiogRGVzY3JpcHRpb24gZm9yIHRoZSB3cml0ZV90b2RvcyB0b29sXG4qIFBvcnRlZCBleGFjdGx5IGZyb20gUHl0aG9uIFdSSVRFX1RPRE9TX0RFU0NSSVBUSU9OXG4qL1xuY29uc3QgV1JJVEVfVE9ET1NfREVTQ1JJUFRJT04gPSBgVXNlIHRoaXMgdG9vbCB0byBjcmVhdGUgYW5kIG1hbmFnZSBhIHN0cnVjdHVyZWQgdGFzayBsaXN0IGZvciB5b3VyIGN1cnJlbnQgd29yayBzZXNzaW9uLiBUaGlzIGhlbHBzIHlvdSB0cmFjayBwcm9ncmVzcywgb3JnYW5pemUgY29tcGxleCB0YXNrcywgYW5kIGRlbW9uc3RyYXRlIHRob3JvdWdobmVzcyB0byB0aGUgdXNlci5cbkl0IGFsc28gaGVscHMgdGhlIHVzZXIgdW5kZXJzdGFuZCB0aGUgcHJvZ3Jlc3Mgb2YgdGhlIHRhc2sgYW5kIG92ZXJhbGwgcHJvZ3Jlc3Mgb2YgdGhlaXIgcmVxdWVzdHMuXG5Pbmx5IHVzZSB0aGlzIHRvb2wgaWYgeW91IHRoaW5rIGl0IHdpbGwgYmUgaGVscGZ1bCBpbiBzdGF5aW5nIG9yZ2FuaXplZC4gSWYgdGhlIHVzZXIncyByZXF1ZXN0IGlzIHRyaXZpYWwgYW5kIHRha2VzIGxlc3MgdGhhbiAzIHN0ZXBzLCBpdCBpcyBiZXR0ZXIgdG8gTk9UIHVzZSB0aGlzIHRvb2wgYW5kIGp1c3QgZG8gdGhlIHRhc2sgZGlyZWN0bHkuXG5cbiMjIFdoZW4gdG8gVXNlIFRoaXMgVG9vbFxuVXNlIHRoaXMgdG9vbCBpbiB0aGVzZSBzY2VuYXJpb3M6XG5cbjEuIENvbXBsZXggbXVsdGktc3RlcCB0YXNrcyAtIFdoZW4gYSB0YXNrIHJlcXVpcmVzIDMgb3IgbW9yZSBkaXN0aW5jdCBzdGVwcyBvciBhY3Rpb25zXG4yLiBOb24tdHJpdmlhbCBhbmQgY29tcGxleCB0YXNrcyAtIFRhc2tzIHRoYXQgcmVxdWlyZSBjYXJlZnVsIHBsYW5uaW5nIG9yIG11bHRpcGxlIG9wZXJhdGlvbnNcbjMuIFVzZXIgZXhwbGljaXRseSByZXF1ZXN0cyB0b2RvIGxpc3QgLSBXaGVuIHRoZSB1c2VyIGRpcmVjdGx5IGFza3MgeW91IHRvIHVzZSB0aGUgdG9kbyBsaXN0XG40LiBVc2VyIHByb3ZpZGVzIG11bHRpcGxlIHRhc2tzIC0gV2hlbiB1c2VycyBwcm92aWRlIGEgbGlzdCBvZiB0aGluZ3MgdG8gYmUgZG9uZSAobnVtYmVyZWQgb3IgY29tbWEtc2VwYXJhdGVkKVxuNS4gVGhlIHBsYW4gbWF5IG5lZWQgZnV0dXJlIHJldmlzaW9ucyBvciB1cGRhdGVzIGJhc2VkIG9uIHJlc3VsdHMgZnJvbSB0aGUgZmlyc3QgZmV3IHN0ZXBzLiBLZWVwaW5nIHRyYWNrIG9mIHRoaXMgaW4gYSBsaXN0IGlzIGhlbHBmdWwuXG5cbiMjIEhvdyB0byBVc2UgVGhpcyBUb29sXG4xLiBXaGVuIHlvdSBzdGFydCB3b3JraW5nIG9uIGEgdGFzayAtIE1hcmsgaXQgYXMgaW5fcHJvZ3Jlc3MgQkVGT1JFIGJlZ2lubmluZyB3b3JrLlxuMi4gQWZ0ZXIgY29tcGxldGluZyBhIHRhc2sgLSBNYXJrIGl0IGFzIGNvbXBsZXRlZCBhbmQgYWRkIGFueSBuZXcgZm9sbG93LXVwIHRhc2tzIGRpc2NvdmVyZWQgZHVyaW5nIGltcGxlbWVudGF0aW9uLlxuMy4gWW91IGNhbiBhbHNvIHVwZGF0ZSBmdXR1cmUgdGFza3MsIHN1Y2ggYXMgZGVsZXRpbmcgdGhlbSBpZiB0aGV5IGFyZSBubyBsb25nZXIgbmVjZXNzYXJ5LCBvciBhZGRpbmcgbmV3IHRhc2tzIHRoYXQgYXJlIG5lY2Vzc2FyeS4gRG9uJ3QgY2hhbmdlIHByZXZpb3VzbHkgY29tcGxldGVkIHRhc2tzLlxuNC4gWW91IGNhbiBtYWtlIHNldmVyYWwgdXBkYXRlcyB0byB0aGUgdG9kbyBsaXN0IGF0IG9uY2UuIEZvciBleGFtcGxlLCB3aGVuIHlvdSBjb21wbGV0ZSBhIHRhc2ssIHlvdSBjYW4gbWFyayB0aGUgbmV4dCB0YXNrIHlvdSBuZWVkIHRvIHN0YXJ0IGFzIGluX3Byb2dyZXNzLlxuXG4jIyBXaGVuIE5PVCB0byBVc2UgVGhpcyBUb29sXG5JdCBpcyBpbXBvcnRhbnQgdG8gc2tpcCB1c2luZyB0aGlzIHRvb2wgd2hlbjpcbjEuIFRoZXJlIGlzIG9ubHkgYSBzaW5nbGUsIHN0cmFpZ2h0Zm9yd2FyZCB0YXNrXG4yLiBUaGUgdGFzayBpcyB0cml2aWFsIGFuZCB0cmFja2luZyBpdCBwcm92aWRlcyBubyBiZW5lZml0XG4zLiBUaGUgdGFzayBjYW4gYmUgY29tcGxldGVkIGluIGxlc3MgdGhhbiAzIHRyaXZpYWwgc3RlcHNcbjQuIFRoZSB0YXNrIGlzIHB1cmVseSBjb252ZXJzYXRpb25hbCBvciBpbmZvcm1hdGlvbmFsXG5cbiMjIEV4YW1wbGVzIG9mIFdoZW4gdG8gVXNlIHRoZSBUb2RvIExpc3RcblxuPGV4YW1wbGU+XG5Vc2VyOiBJIHdhbnQgdG8gYWRkIGEgZGFyayBtb2RlIHRvZ2dsZSB0byB0aGUgYXBwbGljYXRpb24gc2V0dGluZ3MuIE1ha2Ugc3VyZSB5b3UgcnVuIHRoZSB0ZXN0cyBhbmQgYnVpbGQgd2hlbiB5b3UncmUgZG9uZSFcbkFzc2lzdGFudDogSSdsbCBoZWxwIGFkZCBhIGRhcmsgbW9kZSB0b2dnbGUgdG8geW91ciBhcHBsaWNhdGlvbiBzZXR0aW5ncy4gTGV0IG1lIGNyZWF0ZSBhIHRvZG8gbGlzdCB0byB0cmFjayB0aGlzIGltcGxlbWVudGF0aW9uLlxuKkNyZWF0ZXMgdG9kbyBsaXN0IHdpdGggdGhlIGZvbGxvd2luZyBpdGVtczoqXG4xLiBDcmVhdGUgZGFyayBtb2RlIHRvZ2dsZSBjb21wb25lbnQgaW4gU2V0dGluZ3MgcGFnZVxuMi4gQWRkIGRhcmsgbW9kZSBzdGF0ZSBtYW5hZ2VtZW50IChjb250ZXh0L3N0b3JlKVxuMy4gSW1wbGVtZW50IENTUy1pbi1KUyBzdHlsZXMgZm9yIGRhcmsgdGhlbWVcbjQuIFVwZGF0ZSBleGlzdGluZyBjb21wb25lbnRzIHRvIHN1cHBvcnQgdGhlbWUgc3dpdGNoaW5nXG41LiBSdW4gdGVzdHMgYW5kIGJ1aWxkIHByb2Nlc3MsIGFkZHJlc3NpbmcgYW55IGZhaWx1cmVzIG9yIGVycm9ycyB0aGF0IG9jY3VyXG4qQmVnaW5zIHdvcmtpbmcgb24gdGhlIGZpcnN0IHRhc2sqXG5cbjxyZWFzb25pbmc+XG5UaGUgYXNzaXN0YW50IHVzZWQgdGhlIHRvZG8gbGlzdCBiZWNhdXNlOlxuMS4gQWRkaW5nIGRhcmsgbW9kZSBpbiBpdCBvZiBpdHNlbGYgaXMgYSBtdWx0aS1zdGVwIGZlYXR1cmUgcmVxdWlyaW5nIFVJLCBzdGF0ZSBtYW5hZ2VtZW50LCBhbmQgc3R5bGluZyBjaGFuZ2VzXG4yLiBUaGUgYXNzaXN0YW50IGluZmVycmVkIHRoYXQgdGVzdHMgYW5kIGJ1aWxkIG5lZWQgdG8gcGFzcyBieSBhZGRpbmcgXCJFbnN1cmUgdGVzdHMgYW5kIGJ1aWxkIHN1Y2NlZWRcIiBhcyB0aGUgZmluYWwgdGFza1xuMy4gQm90aCBvZiB0aGUgdXNlcidzIHJlcXVlc3RzIGFyZSBjb21wbGV4IGFuZCByZXF1aXJlIG11bHRpcGxlIHN0ZXBzIHRvIGNvbXBsZXRlLlxuPC9yZWFzb25pbmc+XG48L2V4YW1wbGU+XG5cbjxleGFtcGxlPlxuVXNlcjogSGVscCBtZSBwbGFuIGEgY29tcHJlaGVuc2l2ZSBtYXJrZXRpbmcgY2FtcGFpZ24gZm9yIG91ciBuZXcgcHJvZHVjdCBsYXVuY2gsIGluY2x1ZGluZyBzb2NpYWwgbWVkaWEsIGVtYWlsIG1hcmtldGluZywgYW5kIHByZXNzIHJlbGVhc2VzLlxuQXNzaXN0YW50OiBJJ2xsIGhlbHAgeW91IHBsYW4gYSBjb21wcmVoZW5zaXZlIG1hcmtldGluZyBjYW1wYWlnbiBmb3IgeW91ciBwcm9kdWN0IGxhdW5jaC4gTGV0IG1lIGNyZWF0ZSBhIHRvZG8gbGlzdCB0byBvcmdhbml6ZSBhbGwgdGhlIGNvbXBvbmVudHMuXG4qQ3JlYXRlcyB0b2RvIGxpc3Qgd2l0aCB0aGUgZm9sbG93aW5nIGl0ZW1zOipcbjEuIERlZmluZSB0YXJnZXQgYXVkaWVuY2UgYW5kIGtleSBtZXNzYWdpbmdcbjIuIENyZWF0ZSBzb2NpYWwgbWVkaWEgY29udGVudCBjYWxlbmRhciBhbmQgcG9zdGluZyBzY2hlZHVsZVxuMy4gRGVzaWduIGVtYWlsIG1hcmtldGluZyBzZXF1ZW5jZSBhbmQgYXV0b21hdGlvbiBmbG93c1xuNC4gRHJhZnQgcHJlc3MgcmVsZWFzZSBhbmQgaWRlbnRpZnkgbWVkaWEgY29udGFjdHNcbjUuIFNldCB1cCB0cmFja2luZyBhbmQgYW5hbHl0aWNzIGZvciBjYW1wYWlnbiBwZXJmb3JtYW5jZVxuNi4gQ3JlYXRlIHZpc3VhbCBhc3NldHMgYW5kIGJyYW5kIG1hdGVyaWFsc1xuNy4gQ29vcmRpbmF0ZSBsYXVuY2ggdGltZWxpbmUgYW5kIGRlbGl2ZXJhYmxlc1xuKkJlZ2lucyB3b3JraW5nIG9uIHRoZSBmaXJzdCB0YXNrKlxuXG48cmVhc29uaW5nPlxuVGhlIGFzc2lzdGFudCB1c2VkIHRoZSB0b2RvIGxpc3QgYmVjYXVzZTpcbjEuIE1hcmtldGluZyBjYW1wYWlnbiBwbGFubmluZyBpbnZvbHZlcyBtdWx0aXBsZSBkaXN0aW5jdCBjaGFubmVscyBhbmQgYWN0aXZpdGllc1xuMi4gRWFjaCBjb21wb25lbnQgcmVxdWlyZXMgY2FyZWZ1bCBjb29yZGluYXRpb24gYW5kIHBsYW5uaW5nXG4zLiBUaGUgc3lzdGVtYXRpYyBhcHByb2FjaCBlbnN1cmVzIGFsbCBhc3BlY3RzIG9mIHRoZSBsYXVuY2ggYXJlIGNvdmVyZWRcbjwvcmVhc29uaW5nPlxuPC9leGFtcGxlPlxuXG48ZXhhbXBsZT5cblVzZXI6IEhlbHAgbWUgcmVuYW1lIHRoZSBmdW5jdGlvbiBnZXRDd2QgdG8gZ2V0Q3VycmVudFdvcmtpbmdEaXJlY3RvcnkgYWNyb3NzIG15IHByb2plY3RcbkFzc2lzdGFudDogTGV0IG1lIGZpcnN0IHNlYXJjaCB0aHJvdWdoIHlvdXIgY29kZWJhc2UgdG8gZmluZCBhbGwgb2NjdXJyZW5jZXMgb2YgJ2dldEN3ZCcuXG4qVXNlcyBzZWFyY2ggdG9vbHMgdG8gbG9jYXRlIGFsbCBpbnN0YW5jZXMgb2YgZ2V0Q3dkIGluIHRoZSBjb2RlYmFzZSpcbkFzc2lzdGFudDogSSd2ZSBmb3VuZCAxNSBpbnN0YW5jZXMgb2YgJ2dldEN3ZCcgYWNyb3NzIDggZGlmZmVyZW50IGZpbGVzLiBMZXQgbWUgY3JlYXRlIGEgdG9kbyBsaXN0IHRvIHRyYWNrIHRoZXNlIGNoYW5nZXMuXG4qQ3JlYXRlcyB0b2RvIGxpc3Qgd2l0aCBzcGVjaWZpYyBpdGVtcyBmb3IgZWFjaCBmaWxlIHRoYXQgbmVlZHMgdXBkYXRpbmcqXG5cbjxyZWFzb25pbmc+XG5UaGUgYXNzaXN0YW50IHVzZWQgdGhlIHRvZG8gbGlzdCBiZWNhdXNlOlxuMS4gVGhlIGFzc2lzdGFudCBzZWFyY2hlZCB0byB1bmRlcnN0YW5kIHRoZSBzY29wZSBvZiB0aGUgdGFza1xuMi4gVXBvbiBmaW5kaW5nIG11bHRpcGxlIG9jY3VycmVuY2VzIGFjcm9zcyBkaWZmZXJlbnQgZmlsZXMsIGl0IGRldGVybWluZWQgdGhpcyB3YXMgYSBjb21wbGV4IHRhc2sgd2l0aCBtdWx0aXBsZSBzdGVwcyAoPjMpXG4zLiBUaGUgdG9kbyBsaXN0IGhlbHBzIGVuc3VyZSBldmVyeSBpbnN0YW5jZSBpcyB0cmFja2VkIGFuZCB1cGRhdGVkIHN5c3RlbWF0aWNhbGx5XG40LiBUaGlzIGFwcHJvYWNoIHByZXZlbnRzIG1pc3NpbmcgYW55IG9jY3VycmVuY2VzIGFuZCBtYWludGFpbnMgY29uc2lzdGVuY3kuXG48L3JlYXNvbmluZz5cbjwvZXhhbXBsZT5cblxuPGV4YW1wbGU+XG5Vc2VyOiBJIG5lZWQgaGVscCBvcmdhbml6aW5nIG15IGhvbWUgb2ZmaWNlOiBkZWNsdXR0ZXJpbmcgdGhlIGRlc2ssIHNldHRpbmcgdXAgYSBmaWxpbmcgc3lzdGVtLCBvcmdhbml6aW5nIGRpZ2l0YWwgZmlsZXMsIGFuZCBjcmVhdGluZyBhIGRhaWx5IHdvcmtmbG93LlxuQXNzaXN0YW50OiBJJ2xsIGhlbHAgeW91IG9yZ2FuaXplIHlvdXIgaG9tZSBvZmZpY2Ugc3lzdGVtYXRpY2FsbHkuIExldCBtZSBjcmVhdGUgYSB0b2RvIGxpc3QgdG8gdHJhY2sgZWFjaCBhcmVhIG9mIG9yZ2FuaXphdGlvbi5cbipDcmVhdGVzIHRvZG8gbGlzdCB3aXRoIGl0ZW1zIGxpa2U6IDEpIFNvcnQgYW5kIGRlY2x1dHRlciBkZXNrIGl0ZW1zLCAyKSBTZXQgdXAgcGh5c2ljYWwgZmlsaW5nIHN5c3RlbSBmb3IgZG9jdW1lbnRzLCAzKSBPcmdhbml6ZSBkaWdpdGFsIGZpbGVzIGFuZCBmb2xkZXJzLCA0KSBDcmVhdGUgZGFpbHkgd29ya2Zsb3cgYW5kIHByb2R1Y3Rpdml0eSBzeXN0ZW1zLCA1KSBFc3RhYmxpc2ggbWFpbnRlbmFuY2Ugcm91dGluZXMqXG5MZXQncyBzdGFydCB3aXRoIGRlY2x1dHRlcmluZyB5b3VyIGRlc2sgc3BhY2UgdG8gY3JlYXRlIGEgY2xlYW4gZm91bmRhdGlvbiBmb3IgdGhlIG90aGVyIG9yZ2FuaXphdGlvbmFsIHN5c3RlbXMuXG5cbjxyZWFzb25pbmc+XG5UaGUgYXNzaXN0YW50IHVzZWQgdGhlIHRvZG8gbGlzdCBiZWNhdXNlOlxuMS4gVGhlIHVzZXIgcHJvdmlkZWQgbXVsdGlwbGUgZGlzdGluY3Qgb3JnYW5pemF0aW9uYWwgdGFza3NcbjIuIEVhY2ggYXJlYSByZXF1aXJlcyBkaWZmZXJlbnQgYXBwcm9hY2hlcyBhbmQgY2FyZWZ1bCBwbGFubmluZ1xuMy4gSG9tZSBvcmdhbml6YXRpb24gYmVuZWZpdHMgZnJvbSBzeXN0ZW1hdGljLCBzdGVwLWJ5LXN0ZXAgY29tcGxldGlvblxuNC4gUHJvZ3Jlc3MgdHJhY2tpbmcgZW5zdXJlcyBhbGwgYXJlYXMgYXJlIGFkZHJlc3NlZCB0aG9yb3VnaGx5XG48L3JlYXNvbmluZz5cbjwvZXhhbXBsZT5cblxuIyMgRXhhbXBsZXMgb2YgV2hlbiBOT1QgdG8gVXNlIHRoZSBUb2RvIExpc3RcblxuPGV4YW1wbGU+XG5Vc2VyOiBIb3cgZG8gSSBwcmludCAnSGVsbG8gV29ybGQnIGluIFB5dGhvbj9cbkFzc2lzdGFudDogSW4gUHl0aG9uLCB5b3UgY2FuIHByaW50IFwiSGVsbG8gV29ybGRcIiB3aXRoIHRoaXMgc2ltcGxlIGNvZGU6XG5cblxcYFxcYFxcYHB5dGhvblxucHJpbnQoXCJIZWxsbyBXb3JsZFwiKVxuXFxgXFxgXFxgXG5cblRoaXMgd2lsbCBvdXRwdXQgdGhlIHRleHQgXCJIZWxsbyBXb3JsZFwiIHRvIHRoZSBjb25zb2xlIHdoZW4gZXhlY3V0ZWQuPC9hc3Npc3RhbnQ+XG5cbjxyZWFzb25pbmc+XG5UaGUgYXNzaXN0YW50IGRpZCBub3QgdXNlIHRoZSB0b2RvIGxpc3QgYmVjYXVzZSB0aGlzIGlzIGEgc2luZ2xlLCB0cml2aWFsIHRhc2sgdGhhdCBjYW4gYmUgY29tcGxldGVkIGluIG9uZSBzdGVwLiBUaGVyZSdzIG5vIG5lZWQgdG8gdHJhY2sgbXVsdGlwbGUgdGFza3Mgb3Igc3RlcHMgZm9yIHN1Y2ggYSBzdHJhaWdodGZvcndhcmQgcmVxdWVzdC5cbjwvcmVhc29uaW5nPlxuPC9leGFtcGxlPlxuXG48ZXhhbXBsZT5cblVzZXI6IFdoYXQncyB0aGUgYmVzdCB3YXkgdG8gd2F0ZXIgaG91c2VwbGFudHM/XG5Bc3Npc3RhbnQ6IFRoZSBiZXN0IHdheSB0byB3YXRlciBob3VzZXBsYW50cyBkZXBlbmRzIG9uIHRoZSBzcGVjaWZpYyBwbGFudCB0eXBlLCBidXQgaGVyZSBhcmUgc29tZSBnZW5lcmFsIGd1aWRlbGluZXM6XG5cbi0gQ2hlY2sgc29pbCBtb2lzdHVyZSBieSBpbnNlcnRpbmcgeW91ciBmaW5nZXIgYWJvdXQgMS0yIGluY2hlcyBpbnRvIHRoZSBzb2lsXG4tIFdhdGVyIHRob3JvdWdobHkgd2hlbiB0aGUgdG9wIGluY2ggZmVlbHMgZHJ5LCBhbGxvd2luZyB3YXRlciB0byBkcmFpbiBmcm9tIHRoZSBib3R0b21cbi0gVXNlIHJvb20gdGVtcGVyYXR1cmUgd2F0ZXIgYW5kIHdhdGVyIGluIHRoZSBtb3JuaW5nIHdoZW4gcG9zc2libGVcbi0gQXZvaWQgb3ZlcndhdGVyaW5nLCB3aGljaCBpcyBtb3JlIGhhcm1mdWwgdGhhbiB1bmRlcndhdGVyaW5nIGZvciBtb3N0IHBsYW50c1xuXG5EaWZmZXJlbnQgcGxhbnRzIGhhdmUgZGlmZmVyZW50IG5lZWRzLCBzbyBpdCdzIGltcG9ydGFudCB0byByZXNlYXJjaCB5b3VyIHNwZWNpZmljIHZhcmlldGllcyBmb3Igb3B0aW1hbCBjYXJlLlxuXG48cmVhc29uaW5nPlxuVGhlIGFzc2lzdGFudCBkaWQgbm90IHVzZSB0aGUgdG9kbyBsaXN0IGJlY2F1c2UgdGhpcyBpcyBhbiBpbmZvcm1hdGlvbmFsIHJlcXVlc3Qgd2l0aCBubyBhY3R1YWwgdGFza3MgdG8gY29tcGxldGUuIFRoZSB1c2VyIGlzIHNpbXBseSBhc2tpbmcgZm9yIGFkdmljZSBhbmQgZXhwbGFuYXRpb24sIG5vdCBmb3IgdGhlIGFzc2lzdGFudCB0byBwZXJmb3JtIG11bHRpcGxlIHN0ZXBzIG9yIGFjdGl2aXRpZXMuXG48L3JlYXNvbmluZz5cbjwvZXhhbXBsZT5cblxuPGV4YW1wbGU+XG5Vc2VyOiBDYW4geW91IGFkZCBhIGNvbW1lbnQgdG8gdGhlIGNhbGN1bGF0ZVRvdGFsIGZ1bmN0aW9uIHRvIGV4cGxhaW4gd2hhdCBpdCBkb2VzP1xuQXNzaXN0YW50OiBTdXJlLCBsZXQgbWUgYWRkIGEgY29tbWVudCB0byB0aGUgY2FsY3VsYXRlVG90YWwgZnVuY3Rpb24gdG8gZXhwbGFpbiB3aGF0IGl0IGRvZXMuXG4qIFVzZXMgdGhlIEVkaXQgdG9vbCB0byBhZGQgYSBjb21tZW50IHRvIHRoZSBjYWxjdWxhdGVUb3RhbCBmdW5jdGlvbiAqXG5cbjxyZWFzb25pbmc+XG5UaGUgYXNzaXN0YW50IGRpZCBub3QgdXNlIHRoZSB0b2RvIGxpc3QgYmVjYXVzZSB0aGlzIGlzIGEgc2luZ2xlLCBzdHJhaWdodGZvcndhcmQgdGFzayBjb25maW5lZCB0byBvbmUgbG9jYXRpb24uIEFkZGluZyBhIGNvbW1lbnQgZG9lc24ndCByZXF1aXJlIHRyYWNraW5nIG11bHRpcGxlIHN0ZXBzIG9yIHN5c3RlbWF0aWMgb3JnYW5pemF0aW9uLlxuPC9yZWFzb25pbmc+XG48L2V4YW1wbGU+XG5cbjxleGFtcGxlPlxuVXNlcjogV2hhdCB0aW1lIGlzIGl0IGluIFRva3lvIHJpZ2h0IG5vdz9cbkFzc2lzdGFudDogSSdsbCBjaGVjayB0aGUgY3VycmVudCB0aW1lIGluIFRva3lvIGZvciB5b3UuXG5cbipTZWFyY2hlcyBmb3IgY3VycmVudCB0aW1lIGluIFRva3lvKlxuXG5UaGUgY3VycmVudCB0aW1lIGluIFRva3lvLCBKYXBhbiBpcyBbY3VycmVudCB0aW1lXS4gVG9reW8gaXMgaW4gdGhlIEphcGFuIFN0YW5kYXJkIFRpbWUgKEpTVCkgem9uZSwgd2hpY2ggaXMgVVRDKzkuXG5cbjxyZWFzb25pbmc+XG5UaGUgYXNzaXN0YW50IGRpZCBub3QgdXNlIHRoZSB0b2RvIGxpc3QgYmVjYXVzZSB0aGlzIGlzIGEgc2luZ2xlIGluZm9ybWF0aW9uIGxvb2t1cCB3aXRoIGltbWVkaWF0ZSByZXN1bHRzLiBUaGVyZSBhcmUgbm8gbXVsdGlwbGUgc3RlcHMgdG8gdHJhY2sgb3Igb3JnYW5pemUsIG1ha2luZyB0aGUgdG9kbyBsaXN0IHVubmVjZXNzYXJ5IGZvciB0aGlzIHN0cmFpZ2h0Zm9yd2FyZCByZXF1ZXN0LlxuPC9yZWFzb25pbmc+XG48L2V4YW1wbGU+XG5cbjxleGFtcGxlPlxuVXNlcjogSSBuZWVkIHRvIHdyaXRlIGEgZnVuY3Rpb24gdGhhdCBjaGVja3MgaWYgYSBudW1iZXIgaXMgcHJpbWUgYW5kIHRoZW4gdGVzdCBpdCBvdXQuXG5Bc3Npc3RhbnQ6IEknbGwgaGVscCB5b3Ugd3JpdGUgYSBmdW5jdGlvbiB0aGF0IGNoZWNrcyBpZiBhIG51bWJlciBpcyBwcmltZSBhbmQgdGhlbiB0ZXN0IGl0IG91dC5cbipXcml0ZXMgZnVuY3Rpb24gdGhhdCBjaGVja3MgaWYgYSBudW1iZXIgaXMgcHJpbWUqXG4qVGVzdHMgdGhlIGZ1bmN0aW9uKlxuXG48cmVhc29uaW5nPlxuRXZlbiB0aG91Z2ggdGhpcyBpcyBhIG11bHRpLXN0ZXAgdGFzaywgaXQgaXMgdmVyeSBzdHJhaWdodGZvcndhcmQgYW5kIGNhbiBiZSBjb21wbGV0ZWQgaW4gdHdvIHRyaXZpYWwgc3RlcHMgKHdoaWNoIGlzIGxlc3MgdGhhbiAzIHN0ZXBzISkuIFVzaW5nIHRoZSB0b2RvIGxpc3QgaGVyZSBpcyBvdmVya2lsbCBhbmQgd2FzdGVzIHRpbWUgYW5kIHRva2Vucy5cbjwvcmVhc29uaW5nPlxuPC9leGFtcGxlPlxuXG48ZXhhbXBsZT5cblVzZXI6IEkgd2FudCB5b3UgdG8gb3JkZXIgYSBwaXp6YSBmcm9tIERvbWlub3MsIG9yZGVyIGEgYnVyZ2VyIGZyb20gTWNEb25hbGQncywgYW5kIG9yZGVyIGEgc2FsYWQgZnJvbSBTdWJ3YXkuXG5Bc3Npc3RhbnQ6IEknbGwgaGVscCB5b3Ugb3JkZXIgYSBwaXp6YSBmcm9tIERvbWlub3MsIG9yZGVyIGEgYnVyZ2VyIGZyb20gTWNEb25hbGQncywgYW5kIG9yZGVyIGEgc2FsYWQgZnJvbSBTdWJ3YXkuXG4qT3JkZXJzIGEgcGl6emEgZnJvbSBEb21pbm9zKlxuKk9yZGVycyBhIGJ1cmdlciBmcm9tIE1jRG9uYWxkJ3MqXG4qT3JkZXJzIGEgc2FsYWQgZnJvbSBTdWJ3YXkqXG5cbjxyZWFzb25pbmc+XG5FdmVuIHRob3VnaCB0aGlzIGlzIGEgbXVsdGktc3RlcCB0YXNrLCBhc3N1bWluZyB0aGUgYXNzaXN0YW50IGhhcyB0aGUgYWJpbGl0eSB0byBvcmRlciBmcm9tIHRoZXNlIHJlc3RhdXJhbnRzLCBpdCBpcyB2ZXJ5IHN0cmFpZ2h0Zm9yd2FyZCBhbmQgY2FuIGJlIGNvbXBsZXRlZCBpbiB0aHJlZSB0cml2aWFsIHRvb2wgY2FsbHMuIFxuVXNpbmcgdGhlIHRvZG8gbGlzdCBoZXJlIGlzIG92ZXJraWxsIGFuZCB3YXN0ZXMgdGltZSBhbmQgdG9rZW5zLiBUaGVzZSB0aHJlZSB0b29sIGNhbGxzIHNob3VsZCBiZSBtYWRlIGluIHBhcmFsbGVsLCBpbiBmYWN0LlxuPC9yZWFzb25pbmc+XG48L2V4YW1wbGU+XG5cblxuIyMgVGFzayBTdGF0ZXMgYW5kIE1hbmFnZW1lbnRcblxuMS4gKipUYXNrIFN0YXRlcyoqOiBVc2UgdGhlc2Ugc3RhdGVzIHRvIHRyYWNrIHByb2dyZXNzOlxuICAgLSBwZW5kaW5nOiBUYXNrIG5vdCB5ZXQgc3RhcnRlZFxuICAgLSBpbl9wcm9ncmVzczogQ3VycmVudGx5IHdvcmtpbmcgb24gKHlvdSBjYW4gaGF2ZSBtdWx0aXBsZSB0YXNrcyBpbl9wcm9ncmVzcyBhdCBhIHRpbWUgaWYgdGhleSBhcmUgbm90IHJlbGF0ZWQgdG8gZWFjaCBvdGhlciBhbmQgY2FuIGJlIHJ1biBpbiBwYXJhbGxlbClcbiAgIC0gY29tcGxldGVkOiBUYXNrIGZpbmlzaGVkIHN1Y2Nlc3NmdWxseVxuXG4yLiAqKlRhc2sgTWFuYWdlbWVudCoqOlxuICAgLSBVcGRhdGUgdGFzayBzdGF0dXMgaW4gcmVhbC10aW1lIGFzIHlvdSB3b3JrXG4gICAtIE1hcmsgdGFza3MgY29tcGxldGUgSU1NRURJQVRFTFkgYWZ0ZXIgZmluaXNoaW5nIChkb24ndCBiYXRjaCBjb21wbGV0aW9ucylcbiAgIC0gQ29tcGxldGUgY3VycmVudCB0YXNrcyBiZWZvcmUgc3RhcnRpbmcgbmV3IG9uZXNcbiAgIC0gUmVtb3ZlIHRhc2tzIHRoYXQgYXJlIG5vIGxvbmdlciByZWxldmFudCBmcm9tIHRoZSBsaXN0IGVudGlyZWx5XG4gICAtIElNUE9SVEFOVDogV2hlbiB5b3Ugd3JpdGUgdGhpcyB0b2RvIGxpc3QsIHlvdSBzaG91bGQgbWFyayB5b3VyIGZpcnN0IHRhc2sgKG9yIHRhc2tzKSBhcyBpbl9wcm9ncmVzcyBpbW1lZGlhdGVseSEuXG4gICAtIElNUE9SVEFOVDogVW5sZXNzIGFsbCB0YXNrcyBhcmUgY29tcGxldGVkLCB5b3Ugc2hvdWxkIGFsd2F5cyBoYXZlIGF0IGxlYXN0IG9uZSB0YXNrIGluX3Byb2dyZXNzIHRvIHNob3cgdGhlIHVzZXIgdGhhdCB5b3UgYXJlIHdvcmtpbmcgb24gc29tZXRoaW5nLlxuXG4zLiAqKlRhc2sgQ29tcGxldGlvbiBSZXF1aXJlbWVudHMqKjpcbiAgIC0gT05MWSBtYXJrIGEgdGFzayBhcyBjb21wbGV0ZWQgd2hlbiB5b3UgaGF2ZSBGVUxMWSBhY2NvbXBsaXNoZWQgaXRcbiAgIC0gSWYgeW91IGVuY291bnRlciBlcnJvcnMsIGJsb2NrZXJzLCBvciBjYW5ub3QgZmluaXNoLCBrZWVwIHRoZSB0YXNrIGFzIGluX3Byb2dyZXNzXG4gICAtIFdoZW4gYmxvY2tlZCwgY3JlYXRlIGEgbmV3IHRhc2sgZGVzY3JpYmluZyB3aGF0IG5lZWRzIHRvIGJlIHJlc29sdmVkXG4gICAtIE5ldmVyIG1hcmsgYSB0YXNrIGFzIGNvbXBsZXRlZCBpZjpcbiAgICAgLSBUaGVyZSBhcmUgdW5yZXNvbHZlZCBpc3N1ZXMgb3IgZXJyb3JzXG4gICAgIC0gV29yayBpcyBwYXJ0aWFsIG9yIGluY29tcGxldGVcbiAgICAgLSBZb3UgZW5jb3VudGVyZWQgYmxvY2tlcnMgdGhhdCBwcmV2ZW50IGNvbXBsZXRpb25cbiAgICAgLSBZb3UgY291bGRuJ3QgZmluZCBuZWNlc3NhcnkgcmVzb3VyY2VzIG9yIGRlcGVuZGVuY2llc1xuICAgICAtIFF1YWxpdHkgc3RhbmRhcmRzIGhhdmVuJ3QgYmVlbiBtZXRcblxuNC4gKipUYXNrIEJyZWFrZG93bioqOlxuICAgLSBDcmVhdGUgc3BlY2lmaWMsIGFjdGlvbmFibGUgaXRlbXNcbiAgIC0gQnJlYWsgY29tcGxleCB0YXNrcyBpbnRvIHNtYWxsZXIsIG1hbmFnZWFibGUgc3RlcHNcbiAgIC0gVXNlIGNsZWFyLCBkZXNjcmlwdGl2ZSB0YXNrIG5hbWVzXG5cbkJlaW5nIHByb2FjdGl2ZSB3aXRoIHRhc2sgbWFuYWdlbWVudCBkZW1vbnN0cmF0ZXMgYXR0ZW50aXZlbmVzcyBhbmQgZW5zdXJlcyB5b3UgY29tcGxldGUgYWxsIHJlcXVpcmVtZW50cyBzdWNjZXNzZnVsbHlcblJlbWVtYmVyOiBJZiB5b3Ugb25seSBuZWVkIHRvIG1ha2UgYSBmZXcgdG9vbCBjYWxscyB0byBjb21wbGV0ZSBhIHRhc2ssIGFuZCBpdCBpcyBjbGVhciB3aGF0IHlvdSBuZWVkIHRvIGRvLCBpdCBpcyBiZXR0ZXIgdG8ganVzdCBkbyB0aGUgdGFzayBkaXJlY3RseSBhbmQgTk9UIGNhbGwgdGhpcyB0b29sIGF0IGFsbC5gO1xuY29uc3QgVE9ET19MSVNUX01JRERMRVdBUkVfU1lTVEVNX1BST01QVCA9IGAjIyBcXGB3cml0ZV90b2Rvc1xcYFxuXG5Zb3UgaGF2ZSBhY2Nlc3MgdG8gdGhlIFxcYHdyaXRlX3RvZG9zXFxgIHRvb2wgdG8gaGVscCB5b3UgbWFuYWdlIGFuZCBwbGFuIGNvbXBsZXggb2JqZWN0aXZlcy4gXG5Vc2UgdGhpcyB0b29sIGZvciBjb21wbGV4IG9iamVjdGl2ZXMgdG8gZW5zdXJlIHRoYXQgeW91IGFyZSB0cmFja2luZyBlYWNoIG5lY2Vzc2FyeSBzdGVwIGFuZCBnaXZpbmcgdGhlIHVzZXIgdmlzaWJpbGl0eSBpbnRvIHlvdXIgcHJvZ3Jlc3MuXG5UaGlzIHRvb2wgaXMgdmVyeSBoZWxwZnVsIGZvciBwbGFubmluZyBjb21wbGV4IG9iamVjdGl2ZXMsIGFuZCBmb3IgYnJlYWtpbmcgZG93biB0aGVzZSBsYXJnZXIgY29tcGxleCBvYmplY3RpdmVzIGludG8gc21hbGxlciBzdGVwcy5cblxuSXQgaXMgY3JpdGljYWwgdGhhdCB5b3UgbWFyayB0b2RvcyBhcyBjb21wbGV0ZWQgYXMgc29vbiBhcyB5b3UgYXJlIGRvbmUgd2l0aCBhIHN0ZXAuIERvIG5vdCBiYXRjaCB1cCBtdWx0aXBsZSBzdGVwcyBiZWZvcmUgbWFya2luZyB0aGVtIGFzIGNvbXBsZXRlZC5cbkZvciBzaW1wbGUgb2JqZWN0aXZlcyB0aGF0IG9ubHkgcmVxdWlyZSBhIGZldyBzdGVwcywgaXQgaXMgYmV0dGVyIHRvIGp1c3QgY29tcGxldGUgdGhlIG9iamVjdGl2ZSBkaXJlY3RseSBhbmQgTk9UIHVzZSB0aGlzIHRvb2wuXG5Xcml0aW5nIHRvZG9zIHRha2VzIHRpbWUgYW5kIHRva2VucywgdXNlIGl0IHdoZW4gaXQgaXMgaGVscGZ1bCBmb3IgbWFuYWdpbmcgY29tcGxleCBtYW55LXN0ZXAgcHJvYmxlbXMhIEJ1dCBub3QgZm9yIHNpbXBsZSBmZXctc3RlcCByZXF1ZXN0cy5cblxuIyMgSW1wb3J0YW50IFRvLURvIExpc3QgVXNhZ2UgTm90ZXMgdG8gUmVtZW1iZXJcbi0gVGhlIFxcYHdyaXRlX3RvZG9zXFxgIHRvb2wgc2hvdWxkIG5ldmVyIGJlIGNhbGxlZCBtdWx0aXBsZSB0aW1lcyBpbiBwYXJhbGxlbC5cbi0gRG9uJ3QgYmUgYWZyYWlkIHRvIHJldmlzZSB0aGUgVG8tRG8gbGlzdCBhcyB5b3UgZ28uIE5ldyBpbmZvcm1hdGlvbiBtYXkgcmV2ZWFsIG5ldyB0YXNrcyB0aGF0IG5lZWQgdG8gYmUgZG9uZSwgb3Igb2xkIHRhc2tzIHRoYXQgYXJlIGlycmVsZXZhbnQuYDtcbmNvbnN0IFRvZG9TdGF0dXMgPSB6LmVudW0oW1xuXHRcInBlbmRpbmdcIixcblx0XCJpbl9wcm9ncmVzc1wiLFxuXHRcImNvbXBsZXRlZFwiXG5dKS5kZXNjcmliZShcIlN0YXR1cyBvZiB0aGUgdG9kb1wiKTtcbmNvbnN0IFRvZG9TY2hlbWEgPSB6Lm9iamVjdCh7XG5cdGNvbnRlbnQ6IHouc3RyaW5nKCkuZGVzY3JpYmUoXCJDb250ZW50IG9mIHRoZSB0b2RvIGl0ZW1cIiksXG5cdHN0YXR1czogVG9kb1N0YXR1c1xufSk7XG5jb25zdCBzdGF0ZVNjaGVtYSA9IHoub2JqZWN0KHsgdG9kb3M6IHouYXJyYXkoVG9kb1NjaGVtYSkuZGVmYXVsdChbXSkgfSk7XG4vKipcbiogQ3JlYXRlcyBhIG1pZGRsZXdhcmUgdGhhdCBwcm92aWRlcyB0b2RvIGxpc3QgbWFuYWdlbWVudCBjYXBhYmlsaXRpZXMgdG8gYWdlbnRzLlxuKlxuKiBUaGlzIG1pZGRsZXdhcmUgYWRkcyBhIGB3cml0ZV90b2Rvc2AgdG9vbCB0aGF0IGFsbG93cyBhZ2VudHMgdG8gY3JlYXRlIGFuZCBtYW5hZ2Vcbiogc3RydWN0dXJlZCB0YXNrIGxpc3RzIGZvciBjb21wbGV4IG11bHRpLXN0ZXAgb3BlcmF0aW9ucy4gSXQncyBkZXNpZ25lZCB0byBoZWxwXG4qIGFnZW50cyB0cmFjayBwcm9ncmVzcywgb3JnYW5pemUgY29tcGxleCB0YXNrcywgYW5kIHByb3ZpZGUgdXNlcnMgd2l0aCB2aXNpYmlsaXR5XG4qIGludG8gdGFzayBjb21wbGV0aW9uIHN0YXR1cy5cbipcbiogVGhlIG1pZGRsZXdhcmUgYXV0b21hdGljYWxseSBpbmplY3RzIHN5c3RlbSBwcm9tcHRzIHRoYXQgZ3VpZGUgdGhlIGFnZW50IG9uIHdoZW5cbiogYW5kIGhvdyB0byB1c2UgdGhlIHRvZG8gZnVuY3Rpb25hbGl0eSBlZmZlY3RpdmVseS4gSXQgYWxzbyBlbmZvcmNlcyB0aGF0IHRoZVxuKiBgd3JpdGVfdG9kb3NgIHRvb2wgaXMgY2FsbGVkIGF0IG1vc3Qgb25jZSBwZXIgbW9kZWwgdHVybiwgc2luY2UgdGhlIHRvb2wgcmVwbGFjZXNcbiogdGhlIGVudGlyZSB0b2RvIGxpc3QgYW5kIHBhcmFsbGVsIGNhbGxzIHdvdWxkIGNyZWF0ZSBhbWJpZ3VpdHkgYWJvdXQgcHJlY2VkZW5jZS5cbipcbiogQGV4YW1wbGVcbiogYGBgdHlwZXNjcmlwdFxuKiBpbXBvcnQgeyB0b2RvTGlzdE1pZGRsZXdhcmUsIGNyZWF0ZUFnZW50IH0gZnJvbSAnbGFuZ2NoYWluJztcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIG1pZGRsZXdhcmU6IFt0b2RvTGlzdE1pZGRsZXdhcmUoKV0sXG4qIH0pO1xuKlxuKiAvLyBBZ2VudCBub3cgaGFzIGFjY2VzcyB0byB3cml0ZV90b2RvcyB0b29sIGFuZCB0b2RvIHN0YXRlIHRyYWNraW5nXG4qIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFnZW50Lmludm9rZSh7XG4qICAgbWVzc2FnZXM6IFtuZXcgSHVtYW5NZXNzYWdlKFwiSGVscCBtZSByZWZhY3RvciBteSBjb2RlYmFzZVwiKV1cbiogfSk7XG4qXG4qIGNvbnNvbGUubG9nKHJlc3VsdC50b2Rvcyk7IC8vIEFycmF5IG9mIHRvZG8gaXRlbXMgd2l0aCBzdGF0dXMgdHJhY2tpbmdcbiogYGBgXG4qXG4qIEByZXR1cm5zIEEgY29uZmlndXJlZCBtaWRkbGV3YXJlIGluc3RhbmNlIHRoYXQgcHJvdmlkZXMgdG9kbyBtYW5hZ2VtZW50IGNhcGFiaWxpdGllc1xuKlxuKiBAc2VlIHtAbGluayBUb2RvTWlkZGxld2FyZVN0YXRlfSBmb3IgdGhlIHN0YXRlIHNjaGVtYVxuKiBAc2VlIHtAbGluayB3cml0ZVRvZG9zfSBmb3IgdGhlIHRvb2wgaW1wbGVtZW50YXRpb25cbiovXG5mdW5jdGlvbiB0b2RvTGlzdE1pZGRsZXdhcmUob3B0aW9ucykge1xuXHQvKipcblx0KiBXcml0ZSB0b2RvcyB0b29sIC0gbWFuYWdlcyB0b2RvIGxpc3Qgd2l0aCBDb21tYW5kIHJldHVyblxuXHQqL1xuXHRjb25zdCB3cml0ZVRvZG9zID0gdG9vbCgoeyB0b2RvcyB9LCBjb25maWcpID0+IHtcblx0XHRyZXR1cm4gbmV3IENvbW1hbmQoeyB1cGRhdGU6IHtcblx0XHRcdHRvZG9zLFxuXHRcdFx0bWVzc2FnZXM6IFtuZXcgVG9vbE1lc3NhZ2Uoe1xuXHRcdFx0XHRjb250ZW50OiBgVXBkYXRlZCB0b2RvIGxpc3QgdG8gJHtKU09OLnN0cmluZ2lmeSh0b2Rvcyl9YCxcblx0XHRcdFx0dG9vbF9jYWxsX2lkOiBjb25maWcudG9vbENhbGw/LmlkXG5cdFx0XHR9KV1cblx0XHR9IH0pO1xuXHR9LCB7XG5cdFx0bmFtZTogXCJ3cml0ZV90b2Rvc1wiLFxuXHRcdGRlc2NyaXB0aW9uOiBvcHRpb25zPy50b29sRGVzY3JpcHRpb24gPz8gV1JJVEVfVE9ET1NfREVTQ1JJUFRJT04sXG5cdFx0c2NoZW1hOiB6Lm9iamVjdCh7IHRvZG9zOiB6LmFycmF5KFRvZG9TY2hlbWEpLmRlc2NyaWJlKFwiTGlzdCBvZiB0b2RvIGl0ZW1zIHRvIHVwZGF0ZVwiKSB9KVxuXHR9KTtcblx0cmV0dXJuIGNyZWF0ZU1pZGRsZXdhcmUoe1xuXHRcdG5hbWU6IFwidG9kb0xpc3RNaWRkbGV3YXJlXCIsXG5cdFx0c3RhdGVTY2hlbWEsXG5cdFx0dG9vbHM6IFt3cml0ZVRvZG9zXSxcblx0XHR3cmFwTW9kZWxDYWxsOiAocmVxdWVzdCwgaGFuZGxlcikgPT4gaGFuZGxlcih7XG5cdFx0XHQuLi5yZXF1ZXN0LFxuXHRcdFx0c3lzdGVtTWVzc2FnZTogcmVxdWVzdC5zeXN0ZW1NZXNzYWdlLmNvbmNhdChgXFxuXFxuJHtvcHRpb25zPy5zeXN0ZW1Qcm9tcHQgPz8gVE9ET19MSVNUX01JRERMRVdBUkVfU1lTVEVNX1BST01QVH1gKVxuXHRcdH0pLFxuXHRcdGFmdGVyTW9kZWw6IChzdGF0ZSkgPT4ge1xuXHRcdFx0LyoqXG5cdFx0XHQqIENoZWNrIGZvciBwYXJhbGxlbCB3cml0ZV90b2RvcyB0b29sIGNhbGxzIGFuZCByZXR1cm4gZXJyb3JzIGlmIGRldGVjdGVkLlxuXHRcdFx0KlxuXHRcdFx0KiBUaGUgdG9kbyBsaXN0IGlzIGRlc2lnbmVkIHRvIGJlIHVwZGF0ZWQgYXQgbW9zdCBvbmNlIHBlciBtb2RlbCB0dXJuLiBTaW5jZVxuXHRcdFx0KiB0aGUgYHdyaXRlX3RvZG9zYCB0b29sIHJlcGxhY2VzIHRoZSBlbnRpcmUgdG9kbyBsaXN0IHdpdGggZWFjaCBjYWxsLCBtYWtpbmdcblx0XHRcdCogbXVsdGlwbGUgcGFyYWxsZWwgY2FsbHMgd291bGQgY3JlYXRlIGFtYmlndWl0eSBhYm91dCB3aGljaCB1cGRhdGUgc2hvdWxkIHRha2Vcblx0XHRcdCogcHJlY2VkZW5jZS4gVGhpcyBtZXRob2QgcHJldmVudHMgc3VjaCBjb25mbGljdHMgYnkgcmVqZWN0aW5nIGFueSByZXNwb25zZSB0aGF0XG5cdFx0XHQqIGNvbnRhaW5zIG11bHRpcGxlIHdyaXRlX3RvZG9zIHRvb2wgY2FsbHMuXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3QgbWVzc2FnZXMgPSBzdGF0ZS5tZXNzYWdlcztcblx0XHRcdGlmICghbWVzc2FnZXMgfHwgbWVzc2FnZXMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cdFx0XHQvKipcblx0XHRcdCogRmluZCB0aGUgbGFzdCBBSSBtZXNzYWdlXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3QgbGFzdEFpTXNnID0gWy4uLm1lc3NhZ2VzXS5yZXZlcnNlKCkuZmluZCgobXNnKSA9PiBBSU1lc3NhZ2UuaXNJbnN0YW5jZShtc2cpKTtcblx0XHRcdGlmICghbGFzdEFpTXNnIHx8ICFsYXN0QWlNc2cudG9vbF9jYWxscyB8fCBsYXN0QWlNc2cudG9vbF9jYWxscy5sZW5ndGggPT09IDApIHJldHVybjtcblx0XHRcdC8qKlxuXHRcdFx0KiBDb3VudCB3cml0ZV90b2RvcyB0b29sIGNhbGxzXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3Qgd3JpdGVUb2Rvc0NhbGxzID0gbGFzdEFpTXNnLnRvb2xfY2FsbHMuZmlsdGVyKCh0YykgPT4gdGMubmFtZSA9PT0gd3JpdGVUb2Rvcy5uYW1lKTtcblx0XHRcdGlmICh3cml0ZVRvZG9zQ2FsbHMubGVuZ3RoID4gMSlcbiAvKipcblx0XHRcdCogS2VlcCB0aGUgdG9vbCBjYWxscyBpbiB0aGUgQUkgbWVzc2FnZSBidXQgcmV0dXJuIGVycm9yIG1lc3NhZ2VzXG5cdFx0XHQqIFRoaXMgZm9sbG93cyB0aGUgc2FtZSBwYXR0ZXJuIGFzIEh1bWFuSW5UaGVMb29wTWlkZGxld2FyZVxuXHRcdFx0Ki9cblx0XHRcdHJldHVybiB7IG1lc3NhZ2VzOiB3cml0ZVRvZG9zQ2FsbHMubWFwKCh0YykgPT4gbmV3IFRvb2xNZXNzYWdlKHtcblx0XHRcdFx0Y29udGVudDogXCJFcnJvcjogVGhlIGB3cml0ZV90b2Rvc2AgdG9vbCBzaG91bGQgbmV2ZXIgYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzIGluIHBhcmFsbGVsLiBQbGVhc2UgY2FsbCBpdCBvbmx5IG9uY2UgcGVyIG1vZGVsIGludm9jYXRpb24gdG8gdXBkYXRlIHRoZSB0b2RvIGxpc3QuXCIsXG5cdFx0XHRcdHRvb2xfY2FsbF9pZDogdGMuaWQsXG5cdFx0XHRcdHN0YXR1czogXCJlcnJvclwiXG5cdFx0XHR9KSkgfTtcblx0XHR9XG5cdH0pO1xufVxuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IFRPRE9fTElTVF9NSURETEVXQVJFX1NZU1RFTV9QUk9NUFQsIHRvZG9MaXN0TWlkZGxld2FyZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dG9kb0xpc3RNaWRkbGV3YXJlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/todoListMiddleware.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolCallLimit.js":
/*!********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolCallLimit.js ***!
  \********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ToolCallLimitExceededError: () => (/* binding */ ToolCallLimitExceededError),\n/* harmony export */   toolCallLimitMiddleware: () => (/* binding */ toolCallLimitMiddleware)\n/* harmony export */ });\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n\n\n\n//#region src/agents/middleware/toolCallLimit.ts\n/**\n* Build the error message content for ToolMessage when limit is exceeded.\n*\n* This message is sent to the model, so it should not reference thread/run concepts\n* that the model has no notion of.\n*\n* @param toolName - Tool name being limited (if specific tool), or undefined for all tools.\n* @returns A concise message instructing the model not to call the tool again.\n*/\nfunction buildToolMessageContent(toolName) {\n\tif (toolName) return `Tool call limit exceeded. Do not call '${toolName}' again.`;\n\treturn \"Tool call limit exceeded. Do not make additional tool calls.\";\n}\nconst VALID_EXIT_BEHAVIORS = [\n\t\"continue\",\n\t\"error\",\n\t\"end\"\n];\nconst DEFAULT_EXIT_BEHAVIOR = \"continue\";\n/**\n* Build the final AI message content for 'end' behavior.\n*\n* This message is displayed to the user, so it should include detailed information\n* about which limits were exceeded.\n*\n* @param threadCount - Current thread tool call count.\n* @param runCount - Current run tool call count.\n* @param threadLimit - Thread tool call limit (if set).\n* @param runLimit - Run tool call limit (if set).\n* @param toolName - Tool name being limited (if specific tool), or undefined for all tools.\n* @returns A formatted message describing which limits were exceeded.\n*/\nfunction buildFinalAIMessageContent(threadCount, runCount, threadLimit, runLimit, toolName) {\n\tconst toolDesc = toolName ? `'${toolName}' tool` : \"Tool\";\n\tconst exceededLimits = [];\n\tif (threadLimit !== void 0 && threadCount > threadLimit) exceededLimits.push(`thread limit exceeded (${threadCount}/${threadLimit} calls)`);\n\tif (runLimit !== void 0 && runCount > runLimit) exceededLimits.push(`run limit exceeded (${runCount}/${runLimit} calls)`);\n\treturn `${toolDesc} call limit reached: ${exceededLimits.join(\" and \")}.`;\n}\n/**\n* Schema for the exit behavior.\n*/\nconst exitBehaviorSchema = zod_v3__WEBPACK_IMPORTED_MODULE_3__.z[\"enum\"](VALID_EXIT_BEHAVIORS).default(DEFAULT_EXIT_BEHAVIOR);\n/**\n* Exception raised when tool call limits are exceeded.\n*\n* This exception is raised when the configured exit behavior is 'error'\n* and either the thread or run tool call limit has been exceeded.\n*/\nvar ToolCallLimitExceededError = class extends Error {\n\t/**\n\t* Current thread tool call count.\n\t*/\n\tthreadCount;\n\t/**\n\t* Current run tool call count.\n\t*/\n\trunCount;\n\t/**\n\t* Thread tool call limit (if set).\n\t*/\n\tthreadLimit;\n\t/**\n\t* Run tool call limit (if set).\n\t*/\n\trunLimit;\n\t/**\n\t* Tool name being limited (if specific tool), or undefined for all tools.\n\t*/\n\ttoolName;\n\tconstructor(threadCount, runCount, threadLimit, runLimit, toolName = void 0) {\n\t\tconst message = buildFinalAIMessageContent(threadCount, runCount, threadLimit, runLimit, toolName);\n\t\tsuper(message);\n\t\tthis.name = \"ToolCallLimitExceededError\";\n\t\tthis.threadCount = threadCount;\n\t\tthis.runCount = runCount;\n\t\tthis.threadLimit = threadLimit;\n\t\tthis.runLimit = runLimit;\n\t\tthis.toolName = toolName;\n\t}\n};\n/**\n* Options for configuring the Tool Call Limit middleware.\n*/\nconst ToolCallLimitOptionsSchema = zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.object({\n\ttoolName: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.string().optional(),\n\tthreadLimit: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.number().optional(),\n\trunLimit: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.number().optional(),\n\texitBehavior: exitBehaviorSchema\n});\n/**\n* Middleware state schema to track the number of model calls made at the thread and run level.\n*/\nconst stateSchema = zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.object({\n\tthreadToolCallCount: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.record(zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.string(), zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.number()).default({}),\n\trunToolCallCount: zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.record(zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.string(), zod_v3__WEBPACK_IMPORTED_MODULE_3__.z.number()).default({})\n});\nconst DEFAULT_TOOL_COUNT_KEY = \"__all__\";\n/**\n* Middleware that tracks tool call counts and enforces limits.\n*\n* This middleware monitors the number of tool calls made during agent execution\n* and can terminate the agent when specified limits are reached. It supports\n* both thread-level and run-level call counting with configurable exit behaviors.\n*\n* Thread-level: The middleware counts all tool calls in the entire message history\n* and persists this count across multiple runs (invocations) of the agent.\n*\n* Run-level: The middleware counts tool calls made after the last HumanMessage,\n* representing the current run (invocation) of the agent.\n*\n* @param options - Configuration options for the middleware\n* @param options.toolName - Name of the specific tool to limit. If undefined, limits apply to all tools.\n* @param options.threadLimit - Maximum number of tool calls allowed per thread. undefined means no limit.\n* @param options.runLimit - Maximum number of tool calls allowed per run. undefined means no limit.\n* @param options.exitBehavior - What to do when limits are exceeded.\n*   - \"continue\": Block exceeded tools with error messages, let other tools continue. Model decides when to end. (default)\n*   - \"error\": Raise a ToolCallLimitExceededError exception\n*   - \"end\": Stop execution immediately with a ToolMessage + AI message for the single tool call that exceeded the limit. Raises NotImplementedError if there are multiple tool calls.\n*\n* @throws {Error} If both limits are undefined, if exitBehavior is invalid, or if runLimit exceeds threadLimit.\n* @throws {NotImplementedError} If exitBehavior is \"end\" and there are multiple tool calls.\n*\n* @example Continue execution with blocked tools (default)\n* ```ts\n* import { toolCallLimitMiddleware } from \"@langchain/langchain/agents/middleware\";\n* import { createAgent } from \"@langchain/langchain/agents\";\n*\n* // Block exceeded tools but let other tools and model continue\n* const limiter = toolCallLimitMiddleware({\n*   threadLimit: 20,\n*   runLimit: 10,\n*   exitBehavior: \"continue\", // default\n* });\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   middleware: [limiter]\n* });\n* ```\n*\n* @example Stop immediately when limit exceeded\n* ```ts\n* // End execution immediately with an AI message\n* const limiter = toolCallLimitMiddleware({\n*   runLimit: 5,\n*   exitBehavior: \"end\"\n* });\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   middleware: [limiter]\n* });\n* ```\n*\n* @example Raise exception on limit\n* ```ts\n* // Strict limit with exception handling\n* const limiter = toolCallLimitMiddleware({\n*   toolName: \"search\",\n*   threadLimit: 5,\n*   exitBehavior: \"error\"\n* });\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   middleware: [limiter]\n* });\n*\n* try {\n*   const result = await agent.invoke({ messages: [new HumanMessage(\"Task\")] });\n* } catch (error) {\n*   if (error instanceof ToolCallLimitExceededError) {\n*     console.log(`Search limit exceeded: ${error}`);\n*   }\n* }\n* ```\n*/\nfunction toolCallLimitMiddleware(options) {\n\t/**\n\t* Validate that at least one limit is specified\n\t*/\n\tif (options.threadLimit === void 0 && options.runLimit === void 0) throw new Error(\"At least one limit must be specified (threadLimit or runLimit)\");\n\t/**\n\t* Validate exitBehavior (Zod schema already validates, but provide helpful error)\n\t*/\n\tconst exitBehavior = options.exitBehavior ?? DEFAULT_EXIT_BEHAVIOR;\n\tconst parseResult = exitBehaviorSchema.safeParse(exitBehavior);\n\tif (!parseResult.success) throw new Error(zod_v4__WEBPACK_IMPORTED_MODULE_2__.z.prettifyError(parseResult.error).slice(2));\n\t/**\n\t* Validate that runLimit does not exceed threadLimit\n\t*/\n\tif (options.threadLimit !== void 0 && options.runLimit !== void 0 && options.runLimit > options.threadLimit) throw new Error(`runLimit (${options.runLimit}) cannot exceed threadLimit (${options.threadLimit}). The run limit should be less than or equal to the thread limit.`);\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)({\n\t\tname: options.toolName ? `ToolCallLimitMiddleware[${options.toolName}]` : \"ToolCallLimitMiddleware\",\n\t\tstateSchema,\n\t\tafterModel: {\n\t\t\tcanJumpTo: [\"end\"],\n\t\t\thook: (state) => {\n\t\t\t\t/**\n\t\t\t\t* Get the last AI message to check for tool calls\n\t\t\t\t*/\n\t\t\t\tconst lastAIMessage = [...state.messages].reverse().find(_langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage.isInstance);\n\t\t\t\tif (!lastAIMessage || !lastAIMessage.tool_calls) return;\n\t\t\t\t/**\n\t\t\t\t* Helper to check if limit would be exceeded by one more call\n\t\t\t\t*/\n\t\t\t\tconst wouldExceedLimit = (threadCount, runCount) => {\n\t\t\t\t\treturn options.threadLimit !== void 0 && threadCount + 1 > options.threadLimit || options.runLimit !== void 0 && runCount + 1 > options.runLimit;\n\t\t\t\t};\n\t\t\t\t/**\n\t\t\t\t* Helper to check if a tool call matches our filter\n\t\t\t\t*/\n\t\t\t\tconst matchesToolFilter = (toolCall) => {\n\t\t\t\t\treturn options.toolName === void 0 || toolCall.name === options.toolName;\n\t\t\t\t};\n\t\t\t\t/**\n\t\t\t\t* Separate tool calls into allowed and blocked based on limits\n\t\t\t\t*/\n\t\t\t\tconst separateToolCalls = (toolCalls, threadCount, runCount) => {\n\t\t\t\t\tconst allowed = [];\n\t\t\t\t\tconst blocked = [];\n\t\t\t\t\tlet tempThreadCount = threadCount;\n\t\t\t\t\tlet tempRunCount = runCount;\n\t\t\t\t\tfor (const toolCall of toolCalls) {\n\t\t\t\t\t\tif (!matchesToolFilter(toolCall)) continue;\n\t\t\t\t\t\tif (wouldExceedLimit(tempThreadCount, tempRunCount)) blocked.push(toolCall);\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tallowed.push(toolCall);\n\t\t\t\t\t\t\ttempThreadCount += 1;\n\t\t\t\t\t\t\ttempRunCount += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\tallowed,\n\t\t\t\t\t\tblocked,\n\t\t\t\t\t\tfinalThreadCount: tempThreadCount,\n\t\t\t\t\t\tfinalRunCount: tempRunCount + blocked.length\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t\t/**\n\t\t\t\t* Get the count key for this middleware instance\n\t\t\t\t*/\n\t\t\t\tconst countKey = options.toolName ?? DEFAULT_TOOL_COUNT_KEY;\n\t\t\t\t/**\n\t\t\t\t* Get current counts\n\t\t\t\t*/\n\t\t\t\tconst threadCounts = { ...state.threadToolCallCount ?? {} };\n\t\t\t\tconst runCounts = { ...state.runToolCallCount ?? {} };\n\t\t\t\tconst currentThreadCount = threadCounts[countKey] ?? 0;\n\t\t\t\tconst currentRunCount = runCounts[countKey] ?? 0;\n\t\t\t\t/**\n\t\t\t\t* Separate tool calls into allowed and blocked\n\t\t\t\t*/\n\t\t\t\tconst { allowed, blocked, finalThreadCount, finalRunCount } = separateToolCalls(lastAIMessage.tool_calls, currentThreadCount, currentRunCount);\n\t\t\t\t/**\n\t\t\t\t* Update counts:\n\t\t\t\t* - Thread count includes only allowed calls (blocked calls don't count towards thread-level tracking)\n\t\t\t\t* - Run count includes blocked calls since they were attempted in this run\n\t\t\t\t*/\n\t\t\t\tthreadCounts[countKey] = finalThreadCount;\n\t\t\t\trunCounts[countKey] = finalRunCount;\n\t\t\t\t/**\n\t\t\t\t* If no tool calls are blocked, just update counts\n\t\t\t\t*/\n\t\t\t\tif (blocked.length === 0) {\n\t\t\t\t\tif (allowed.length > 0) return {\n\t\t\t\t\t\tthreadToolCallCount: threadCounts,\n\t\t\t\t\t\trunToolCallCount: runCounts\n\t\t\t\t\t};\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t/**\n\t\t\t\t* Handle different exit behaviors\n\t\t\t\t*/\n\t\t\t\tif (exitBehavior === \"error\") throw new ToolCallLimitExceededError(finalThreadCount + blocked.length, finalRunCount, options.threadLimit, options.runLimit, options.toolName);\n\t\t\t\t/**\n\t\t\t\t* Build tool message content (sent to model - no thread/run details)\n\t\t\t\t*/\n\t\t\t\tconst toolMsgContent = buildToolMessageContent(options.toolName);\n\t\t\t\t/**\n\t\t\t\t* Inject artificial error ToolMessages for blocked tool calls\n\t\t\t\t*/\n\t\t\t\tconst artificialMessages = blocked.map((toolCall) => new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.ToolMessage({\n\t\t\t\t\tcontent: toolMsgContent,\n\t\t\t\t\ttool_call_id: toolCall.id,\n\t\t\t\t\tname: toolCall.name,\n\t\t\t\t\tstatus: \"error\"\n\t\t\t\t}));\n\t\t\t\tif (exitBehavior === \"end\") {\n\t\t\t\t\t/**\n\t\t\t\t\t* Check if there are tool calls to other tools that would continue executing\n\t\t\t\t\t* For tool-specific limiters: check for calls to other tools\n\t\t\t\t\t* For global limiters: check if there are multiple different tool types\n\t\t\t\t\t*/\n\t\t\t\t\tlet otherTools = [];\n\t\t\t\t\tif (options.toolName !== void 0)\n /**\n\t\t\t\t\t* Tool-specific limiter: check for calls to other tools\n\t\t\t\t\t*/\n\t\t\t\t\totherTools = lastAIMessage.tool_calls.filter((tc) => tc.name !== options.toolName);\n\t\t\t\t\telse if (new Set(lastAIMessage.tool_calls.map((tc) => tc.name).filter(Boolean)).size > 1)\n /**\n\t\t\t\t\t* Multiple different tool types - use allowed calls to show which ones\n\t\t\t\t\t*/\n\t\t\t\t\totherTools = allowed.length > 0 ? allowed : lastAIMessage.tool_calls;\n\t\t\t\t\tif (otherTools.length > 0) {\n\t\t\t\t\t\tconst toolNames = Array.from(new Set(otherTools.map((tc) => tc.name).filter(Boolean))).join(\", \");\n\t\t\t\t\t\tthrow new Error(`Cannot end execution with other tool calls pending. Found calls to: ${toolNames}. Use 'continue' or 'error' behavior instead.`);\n\t\t\t\t\t}\n\t\t\t\t\tconst finalMsgContent = buildFinalAIMessageContent(finalThreadCount + blocked.length, finalRunCount, options.threadLimit, options.runLimit, options.toolName);\n\t\t\t\t\tartificialMessages.push(new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.AIMessage(finalMsgContent));\n\t\t\t\t\treturn {\n\t\t\t\t\t\tthreadToolCallCount: threadCounts,\n\t\t\t\t\t\trunToolCallCount: runCounts,\n\t\t\t\t\t\tjumpTo: \"end\",\n\t\t\t\t\t\tmessages: artificialMessages\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t/**\n\t\t\t\t* For exit_behavior=\"continue\", return error messages to block exceeded tools\n\t\t\t\t*/\n\t\t\t\treturn {\n\t\t\t\t\tthreadToolCallCount: threadCounts,\n\t\t\t\t\trunToolCallCount: runCounts,\n\t\t\t\t\tmessages: artificialMessages\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\tafterAgent: () => ({ runToolCallCount: {} })\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=toolCallLimit.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS90b29sQ2FsbExpbWl0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFvRDtBQUNjO0FBQ3ZDO0FBQ087O0FBRWxDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsU0FBUztBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxTQUFTO0FBQzFDO0FBQ0Esd0dBQXdHLFlBQVksR0FBRyxhQUFhO0FBQ3BJLDRGQUE0RixTQUFTLEdBQUcsVUFBVTtBQUNsSCxXQUFXLFVBQVUsc0JBQXNCLDZCQUE2QjtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw2Q0FBUTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDRDQUFVO0FBQzdDLFdBQVcsNENBQVU7QUFDckIsY0FBYyw0Q0FBVTtBQUN4QixXQUFXLDRDQUFVO0FBQ3JCO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiw0Q0FBVTtBQUM5QixzQkFBc0IsNENBQVUsQ0FBQyw0Q0FBVSxJQUFJLDRDQUFVLGNBQWM7QUFDdkUsbUJBQW1CLDRDQUFVLENBQUMsNENBQVUsSUFBSSw0Q0FBVSxjQUFjO0FBQ3BFLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLFdBQVcscUJBQXFCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLFdBQVcsMEJBQTBCO0FBQ3JDLFdBQVcsY0FBYztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLHdDQUF3QyxzQ0FBc0M7QUFDOUUsSUFBSTtBQUNKO0FBQ0EsNENBQTRDLE1BQU07QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxtREFBZTtBQUMxRDtBQUNBO0FBQ0E7QUFDQSwySUFBMkksaUJBQWlCLCtCQUErQixvQkFBb0I7QUFDL00sUUFBUSxnRUFBZ0I7QUFDeEIsc0RBQXNELGlCQUFpQjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCwrREFBUztBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvREFBb0Q7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsaUVBQVc7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RkFBNkYsVUFBVTtBQUN2RztBQUNBO0FBQ0EsaUNBQWlDLCtEQUFTO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILHVCQUF1QixzQkFBc0I7QUFDN0MsRUFBRTtBQUNGOztBQUVBO0FBQytEO0FBQy9EIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL21pZGRsZXdhcmUvdG9vbENhbGxMaW1pdC5qcz9mZDg3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUgfSBmcm9tIFwiLi4vbWlkZGxld2FyZS5qc1wiO1xuaW1wb3J0IHsgQUlNZXNzYWdlLCBUb29sTWVzc2FnZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXNcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kL3Y0XCI7XG5pbXBvcnQgeyB6IGFzIHokMSB9IGZyb20gXCJ6b2QvdjNcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvbWlkZGxld2FyZS90b29sQ2FsbExpbWl0LnRzXG4vKipcbiogQnVpbGQgdGhlIGVycm9yIG1lc3NhZ2UgY29udGVudCBmb3IgVG9vbE1lc3NhZ2Ugd2hlbiBsaW1pdCBpcyBleGNlZWRlZC5cbipcbiogVGhpcyBtZXNzYWdlIGlzIHNlbnQgdG8gdGhlIG1vZGVsLCBzbyBpdCBzaG91bGQgbm90IHJlZmVyZW5jZSB0aHJlYWQvcnVuIGNvbmNlcHRzXG4qIHRoYXQgdGhlIG1vZGVsIGhhcyBubyBub3Rpb24gb2YuXG4qXG4qIEBwYXJhbSB0b29sTmFtZSAtIFRvb2wgbmFtZSBiZWluZyBsaW1pdGVkIChpZiBzcGVjaWZpYyB0b29sKSwgb3IgdW5kZWZpbmVkIGZvciBhbGwgdG9vbHMuXG4qIEByZXR1cm5zIEEgY29uY2lzZSBtZXNzYWdlIGluc3RydWN0aW5nIHRoZSBtb2RlbCBub3QgdG8gY2FsbCB0aGUgdG9vbCBhZ2Fpbi5cbiovXG5mdW5jdGlvbiBidWlsZFRvb2xNZXNzYWdlQ29udGVudCh0b29sTmFtZSkge1xuXHRpZiAodG9vbE5hbWUpIHJldHVybiBgVG9vbCBjYWxsIGxpbWl0IGV4Y2VlZGVkLiBEbyBub3QgY2FsbCAnJHt0b29sTmFtZX0nIGFnYWluLmA7XG5cdHJldHVybiBcIlRvb2wgY2FsbCBsaW1pdCBleGNlZWRlZC4gRG8gbm90IG1ha2UgYWRkaXRpb25hbCB0b29sIGNhbGxzLlwiO1xufVxuY29uc3QgVkFMSURfRVhJVF9CRUhBVklPUlMgPSBbXG5cdFwiY29udGludWVcIixcblx0XCJlcnJvclwiLFxuXHRcImVuZFwiXG5dO1xuY29uc3QgREVGQVVMVF9FWElUX0JFSEFWSU9SID0gXCJjb250aW51ZVwiO1xuLyoqXG4qIEJ1aWxkIHRoZSBmaW5hbCBBSSBtZXNzYWdlIGNvbnRlbnQgZm9yICdlbmQnIGJlaGF2aW9yLlxuKlxuKiBUaGlzIG1lc3NhZ2UgaXMgZGlzcGxheWVkIHRvIHRoZSB1c2VyLCBzbyBpdCBzaG91bGQgaW5jbHVkZSBkZXRhaWxlZCBpbmZvcm1hdGlvblxuKiBhYm91dCB3aGljaCBsaW1pdHMgd2VyZSBleGNlZWRlZC5cbipcbiogQHBhcmFtIHRocmVhZENvdW50IC0gQ3VycmVudCB0aHJlYWQgdG9vbCBjYWxsIGNvdW50LlxuKiBAcGFyYW0gcnVuQ291bnQgLSBDdXJyZW50IHJ1biB0b29sIGNhbGwgY291bnQuXG4qIEBwYXJhbSB0aHJlYWRMaW1pdCAtIFRocmVhZCB0b29sIGNhbGwgbGltaXQgKGlmIHNldCkuXG4qIEBwYXJhbSBydW5MaW1pdCAtIFJ1biB0b29sIGNhbGwgbGltaXQgKGlmIHNldCkuXG4qIEBwYXJhbSB0b29sTmFtZSAtIFRvb2wgbmFtZSBiZWluZyBsaW1pdGVkIChpZiBzcGVjaWZpYyB0b29sKSwgb3IgdW5kZWZpbmVkIGZvciBhbGwgdG9vbHMuXG4qIEByZXR1cm5zIEEgZm9ybWF0dGVkIG1lc3NhZ2UgZGVzY3JpYmluZyB3aGljaCBsaW1pdHMgd2VyZSBleGNlZWRlZC5cbiovXG5mdW5jdGlvbiBidWlsZEZpbmFsQUlNZXNzYWdlQ29udGVudCh0aHJlYWRDb3VudCwgcnVuQ291bnQsIHRocmVhZExpbWl0LCBydW5MaW1pdCwgdG9vbE5hbWUpIHtcblx0Y29uc3QgdG9vbERlc2MgPSB0b29sTmFtZSA/IGAnJHt0b29sTmFtZX0nIHRvb2xgIDogXCJUb29sXCI7XG5cdGNvbnN0IGV4Y2VlZGVkTGltaXRzID0gW107XG5cdGlmICh0aHJlYWRMaW1pdCAhPT0gdm9pZCAwICYmIHRocmVhZENvdW50ID4gdGhyZWFkTGltaXQpIGV4Y2VlZGVkTGltaXRzLnB1c2goYHRocmVhZCBsaW1pdCBleGNlZWRlZCAoJHt0aHJlYWRDb3VudH0vJHt0aHJlYWRMaW1pdH0gY2FsbHMpYCk7XG5cdGlmIChydW5MaW1pdCAhPT0gdm9pZCAwICYmIHJ1bkNvdW50ID4gcnVuTGltaXQpIGV4Y2VlZGVkTGltaXRzLnB1c2goYHJ1biBsaW1pdCBleGNlZWRlZCAoJHtydW5Db3VudH0vJHtydW5MaW1pdH0gY2FsbHMpYCk7XG5cdHJldHVybiBgJHt0b29sRGVzY30gY2FsbCBsaW1pdCByZWFjaGVkOiAke2V4Y2VlZGVkTGltaXRzLmpvaW4oXCIgYW5kIFwiKX0uYDtcbn1cbi8qKlxuKiBTY2hlbWEgZm9yIHRoZSBleGl0IGJlaGF2aW9yLlxuKi9cbmNvbnN0IGV4aXRCZWhhdmlvclNjaGVtYSA9IHokMS5lbnVtKFZBTElEX0VYSVRfQkVIQVZJT1JTKS5kZWZhdWx0KERFRkFVTFRfRVhJVF9CRUhBVklPUik7XG4vKipcbiogRXhjZXB0aW9uIHJhaXNlZCB3aGVuIHRvb2wgY2FsbCBsaW1pdHMgYXJlIGV4Y2VlZGVkLlxuKlxuKiBUaGlzIGV4Y2VwdGlvbiBpcyByYWlzZWQgd2hlbiB0aGUgY29uZmlndXJlZCBleGl0IGJlaGF2aW9yIGlzICdlcnJvcidcbiogYW5kIGVpdGhlciB0aGUgdGhyZWFkIG9yIHJ1biB0b29sIGNhbGwgbGltaXQgaGFzIGJlZW4gZXhjZWVkZWQuXG4qL1xudmFyIFRvb2xDYWxsTGltaXRFeGNlZWRlZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBFcnJvciB7XG5cdC8qKlxuXHQqIEN1cnJlbnQgdGhyZWFkIHRvb2wgY2FsbCBjb3VudC5cblx0Ki9cblx0dGhyZWFkQ291bnQ7XG5cdC8qKlxuXHQqIEN1cnJlbnQgcnVuIHRvb2wgY2FsbCBjb3VudC5cblx0Ki9cblx0cnVuQ291bnQ7XG5cdC8qKlxuXHQqIFRocmVhZCB0b29sIGNhbGwgbGltaXQgKGlmIHNldCkuXG5cdCovXG5cdHRocmVhZExpbWl0O1xuXHQvKipcblx0KiBSdW4gdG9vbCBjYWxsIGxpbWl0IChpZiBzZXQpLlxuXHQqL1xuXHRydW5MaW1pdDtcblx0LyoqXG5cdCogVG9vbCBuYW1lIGJlaW5nIGxpbWl0ZWQgKGlmIHNwZWNpZmljIHRvb2wpLCBvciB1bmRlZmluZWQgZm9yIGFsbCB0b29scy5cblx0Ki9cblx0dG9vbE5hbWU7XG5cdGNvbnN0cnVjdG9yKHRocmVhZENvdW50LCBydW5Db3VudCwgdGhyZWFkTGltaXQsIHJ1bkxpbWl0LCB0b29sTmFtZSA9IHZvaWQgMCkge1xuXHRcdGNvbnN0IG1lc3NhZ2UgPSBidWlsZEZpbmFsQUlNZXNzYWdlQ29udGVudCh0aHJlYWRDb3VudCwgcnVuQ291bnQsIHRocmVhZExpbWl0LCBydW5MaW1pdCwgdG9vbE5hbWUpO1xuXHRcdHN1cGVyKG1lc3NhZ2UpO1xuXHRcdHRoaXMubmFtZSA9IFwiVG9vbENhbGxMaW1pdEV4Y2VlZGVkRXJyb3JcIjtcblx0XHR0aGlzLnRocmVhZENvdW50ID0gdGhyZWFkQ291bnQ7XG5cdFx0dGhpcy5ydW5Db3VudCA9IHJ1bkNvdW50O1xuXHRcdHRoaXMudGhyZWFkTGltaXQgPSB0aHJlYWRMaW1pdDtcblx0XHR0aGlzLnJ1bkxpbWl0ID0gcnVuTGltaXQ7XG5cdFx0dGhpcy50b29sTmFtZSA9IHRvb2xOYW1lO1xuXHR9XG59O1xuLyoqXG4qIE9wdGlvbnMgZm9yIGNvbmZpZ3VyaW5nIHRoZSBUb29sIENhbGwgTGltaXQgbWlkZGxld2FyZS5cbiovXG5jb25zdCBUb29sQ2FsbExpbWl0T3B0aW9uc1NjaGVtYSA9IHokMS5vYmplY3Qoe1xuXHR0b29sTmFtZTogeiQxLnN0cmluZygpLm9wdGlvbmFsKCksXG5cdHRocmVhZExpbWl0OiB6JDEubnVtYmVyKCkub3B0aW9uYWwoKSxcblx0cnVuTGltaXQ6IHokMS5udW1iZXIoKS5vcHRpb25hbCgpLFxuXHRleGl0QmVoYXZpb3I6IGV4aXRCZWhhdmlvclNjaGVtYVxufSk7XG4vKipcbiogTWlkZGxld2FyZSBzdGF0ZSBzY2hlbWEgdG8gdHJhY2sgdGhlIG51bWJlciBvZiBtb2RlbCBjYWxscyBtYWRlIGF0IHRoZSB0aHJlYWQgYW5kIHJ1biBsZXZlbC5cbiovXG5jb25zdCBzdGF0ZVNjaGVtYSA9IHokMS5vYmplY3Qoe1xuXHR0aHJlYWRUb29sQ2FsbENvdW50OiB6JDEucmVjb3JkKHokMS5zdHJpbmcoKSwgeiQxLm51bWJlcigpKS5kZWZhdWx0KHt9KSxcblx0cnVuVG9vbENhbGxDb3VudDogeiQxLnJlY29yZCh6JDEuc3RyaW5nKCksIHokMS5udW1iZXIoKSkuZGVmYXVsdCh7fSlcbn0pO1xuY29uc3QgREVGQVVMVF9UT09MX0NPVU5UX0tFWSA9IFwiX19hbGxfX1wiO1xuLyoqXG4qIE1pZGRsZXdhcmUgdGhhdCB0cmFja3MgdG9vbCBjYWxsIGNvdW50cyBhbmQgZW5mb3JjZXMgbGltaXRzLlxuKlxuKiBUaGlzIG1pZGRsZXdhcmUgbW9uaXRvcnMgdGhlIG51bWJlciBvZiB0b29sIGNhbGxzIG1hZGUgZHVyaW5nIGFnZW50IGV4ZWN1dGlvblxuKiBhbmQgY2FuIHRlcm1pbmF0ZSB0aGUgYWdlbnQgd2hlbiBzcGVjaWZpZWQgbGltaXRzIGFyZSByZWFjaGVkLiBJdCBzdXBwb3J0c1xuKiBib3RoIHRocmVhZC1sZXZlbCBhbmQgcnVuLWxldmVsIGNhbGwgY291bnRpbmcgd2l0aCBjb25maWd1cmFibGUgZXhpdCBiZWhhdmlvcnMuXG4qXG4qIFRocmVhZC1sZXZlbDogVGhlIG1pZGRsZXdhcmUgY291bnRzIGFsbCB0b29sIGNhbGxzIGluIHRoZSBlbnRpcmUgbWVzc2FnZSBoaXN0b3J5XG4qIGFuZCBwZXJzaXN0cyB0aGlzIGNvdW50IGFjcm9zcyBtdWx0aXBsZSBydW5zIChpbnZvY2F0aW9ucykgb2YgdGhlIGFnZW50LlxuKlxuKiBSdW4tbGV2ZWw6IFRoZSBtaWRkbGV3YXJlIGNvdW50cyB0b29sIGNhbGxzIG1hZGUgYWZ0ZXIgdGhlIGxhc3QgSHVtYW5NZXNzYWdlLFxuKiByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgcnVuIChpbnZvY2F0aW9uKSBvZiB0aGUgYWdlbnQuXG4qXG4qIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgbWlkZGxld2FyZVxuKiBAcGFyYW0gb3B0aW9ucy50b29sTmFtZSAtIE5hbWUgb2YgdGhlIHNwZWNpZmljIHRvb2wgdG8gbGltaXQuIElmIHVuZGVmaW5lZCwgbGltaXRzIGFwcGx5IHRvIGFsbCB0b29scy5cbiogQHBhcmFtIG9wdGlvbnMudGhyZWFkTGltaXQgLSBNYXhpbXVtIG51bWJlciBvZiB0b29sIGNhbGxzIGFsbG93ZWQgcGVyIHRocmVhZC4gdW5kZWZpbmVkIG1lYW5zIG5vIGxpbWl0LlxuKiBAcGFyYW0gb3B0aW9ucy5ydW5MaW1pdCAtIE1heGltdW0gbnVtYmVyIG9mIHRvb2wgY2FsbHMgYWxsb3dlZCBwZXIgcnVuLiB1bmRlZmluZWQgbWVhbnMgbm8gbGltaXQuXG4qIEBwYXJhbSBvcHRpb25zLmV4aXRCZWhhdmlvciAtIFdoYXQgdG8gZG8gd2hlbiBsaW1pdHMgYXJlIGV4Y2VlZGVkLlxuKiAgIC0gXCJjb250aW51ZVwiOiBCbG9jayBleGNlZWRlZCB0b29scyB3aXRoIGVycm9yIG1lc3NhZ2VzLCBsZXQgb3RoZXIgdG9vbHMgY29udGludWUuIE1vZGVsIGRlY2lkZXMgd2hlbiB0byBlbmQuIChkZWZhdWx0KVxuKiAgIC0gXCJlcnJvclwiOiBSYWlzZSBhIFRvb2xDYWxsTGltaXRFeGNlZWRlZEVycm9yIGV4Y2VwdGlvblxuKiAgIC0gXCJlbmRcIjogU3RvcCBleGVjdXRpb24gaW1tZWRpYXRlbHkgd2l0aCBhIFRvb2xNZXNzYWdlICsgQUkgbWVzc2FnZSBmb3IgdGhlIHNpbmdsZSB0b29sIGNhbGwgdGhhdCBleGNlZWRlZCB0aGUgbGltaXQuIFJhaXNlcyBOb3RJbXBsZW1lbnRlZEVycm9yIGlmIHRoZXJlIGFyZSBtdWx0aXBsZSB0b29sIGNhbGxzLlxuKlxuKiBAdGhyb3dzIHtFcnJvcn0gSWYgYm90aCBsaW1pdHMgYXJlIHVuZGVmaW5lZCwgaWYgZXhpdEJlaGF2aW9yIGlzIGludmFsaWQsIG9yIGlmIHJ1bkxpbWl0IGV4Y2VlZHMgdGhyZWFkTGltaXQuXG4qIEB0aHJvd3Mge05vdEltcGxlbWVudGVkRXJyb3J9IElmIGV4aXRCZWhhdmlvciBpcyBcImVuZFwiIGFuZCB0aGVyZSBhcmUgbXVsdGlwbGUgdG9vbCBjYWxscy5cbipcbiogQGV4YW1wbGUgQ29udGludWUgZXhlY3V0aW9uIHdpdGggYmxvY2tlZCB0b29scyAoZGVmYXVsdClcbiogYGBgdHNcbiogaW1wb3J0IHsgdG9vbENhbGxMaW1pdE1pZGRsZXdhcmUgfSBmcm9tIFwiQGxhbmdjaGFpbi9sYW5nY2hhaW4vYWdlbnRzL21pZGRsZXdhcmVcIjtcbiogaW1wb3J0IHsgY3JlYXRlQWdlbnQgfSBmcm9tIFwiQGxhbmdjaGFpbi9sYW5nY2hhaW4vYWdlbnRzXCI7XG4qXG4qIC8vIEJsb2NrIGV4Y2VlZGVkIHRvb2xzIGJ1dCBsZXQgb3RoZXIgdG9vbHMgYW5kIG1vZGVsIGNvbnRpbnVlXG4qIGNvbnN0IGxpbWl0ZXIgPSB0b29sQ2FsbExpbWl0TWlkZGxld2FyZSh7XG4qICAgdGhyZWFkTGltaXQ6IDIwLFxuKiAgIHJ1bkxpbWl0OiAxMCxcbiogICBleGl0QmVoYXZpb3I6IFwiY29udGludWVcIiwgLy8gZGVmYXVsdFxuKiB9KTtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIG1pZGRsZXdhcmU6IFtsaW1pdGVyXVxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlIFN0b3AgaW1tZWRpYXRlbHkgd2hlbiBsaW1pdCBleGNlZWRlZFxuKiBgYGB0c1xuKiAvLyBFbmQgZXhlY3V0aW9uIGltbWVkaWF0ZWx5IHdpdGggYW4gQUkgbWVzc2FnZVxuKiBjb25zdCBsaW1pdGVyID0gdG9vbENhbGxMaW1pdE1pZGRsZXdhcmUoe1xuKiAgIHJ1bkxpbWl0OiA1LFxuKiAgIGV4aXRCZWhhdmlvcjogXCJlbmRcIlxuKiB9KTtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIG1pZGRsZXdhcmU6IFtsaW1pdGVyXVxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlIFJhaXNlIGV4Y2VwdGlvbiBvbiBsaW1pdFxuKiBgYGB0c1xuKiAvLyBTdHJpY3QgbGltaXQgd2l0aCBleGNlcHRpb24gaGFuZGxpbmdcbiogY29uc3QgbGltaXRlciA9IHRvb2xDYWxsTGltaXRNaWRkbGV3YXJlKHtcbiogICB0b29sTmFtZTogXCJzZWFyY2hcIixcbiogICB0aHJlYWRMaW1pdDogNSxcbiogICBleGl0QmVoYXZpb3I6IFwiZXJyb3JcIlxuKiB9KTtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIG1pZGRsZXdhcmU6IFtsaW1pdGVyXVxuKiB9KTtcbipcbiogdHJ5IHtcbiogICBjb25zdCByZXN1bHQgPSBhd2FpdCBhZ2VudC5pbnZva2UoeyBtZXNzYWdlczogW25ldyBIdW1hbk1lc3NhZ2UoXCJUYXNrXCIpXSB9KTtcbiogfSBjYXRjaCAoZXJyb3IpIHtcbiogICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBUb29sQ2FsbExpbWl0RXhjZWVkZWRFcnJvcikge1xuKiAgICAgY29uc29sZS5sb2coYFNlYXJjaCBsaW1pdCBleGNlZWRlZDogJHtlcnJvcn1gKTtcbiogICB9XG4qIH1cbiogYGBgXG4qL1xuZnVuY3Rpb24gdG9vbENhbGxMaW1pdE1pZGRsZXdhcmUob3B0aW9ucykge1xuXHQvKipcblx0KiBWYWxpZGF0ZSB0aGF0IGF0IGxlYXN0IG9uZSBsaW1pdCBpcyBzcGVjaWZpZWRcblx0Ki9cblx0aWYgKG9wdGlvbnMudGhyZWFkTGltaXQgPT09IHZvaWQgMCAmJiBvcHRpb25zLnJ1bkxpbWl0ID09PSB2b2lkIDApIHRocm93IG5ldyBFcnJvcihcIkF0IGxlYXN0IG9uZSBsaW1pdCBtdXN0IGJlIHNwZWNpZmllZCAodGhyZWFkTGltaXQgb3IgcnVuTGltaXQpXCIpO1xuXHQvKipcblx0KiBWYWxpZGF0ZSBleGl0QmVoYXZpb3IgKFpvZCBzY2hlbWEgYWxyZWFkeSB2YWxpZGF0ZXMsIGJ1dCBwcm92aWRlIGhlbHBmdWwgZXJyb3IpXG5cdCovXG5cdGNvbnN0IGV4aXRCZWhhdmlvciA9IG9wdGlvbnMuZXhpdEJlaGF2aW9yID8/IERFRkFVTFRfRVhJVF9CRUhBVklPUjtcblx0Y29uc3QgcGFyc2VSZXN1bHQgPSBleGl0QmVoYXZpb3JTY2hlbWEuc2FmZVBhcnNlKGV4aXRCZWhhdmlvcik7XG5cdGlmICghcGFyc2VSZXN1bHQuc3VjY2VzcykgdGhyb3cgbmV3IEVycm9yKHoucHJldHRpZnlFcnJvcihwYXJzZVJlc3VsdC5lcnJvcikuc2xpY2UoMikpO1xuXHQvKipcblx0KiBWYWxpZGF0ZSB0aGF0IHJ1bkxpbWl0IGRvZXMgbm90IGV4Y2VlZCB0aHJlYWRMaW1pdFxuXHQqL1xuXHRpZiAob3B0aW9ucy50aHJlYWRMaW1pdCAhPT0gdm9pZCAwICYmIG9wdGlvbnMucnVuTGltaXQgIT09IHZvaWQgMCAmJiBvcHRpb25zLnJ1bkxpbWl0ID4gb3B0aW9ucy50aHJlYWRMaW1pdCkgdGhyb3cgbmV3IEVycm9yKGBydW5MaW1pdCAoJHtvcHRpb25zLnJ1bkxpbWl0fSkgY2Fubm90IGV4Y2VlZCB0aHJlYWRMaW1pdCAoJHtvcHRpb25zLnRocmVhZExpbWl0fSkuIFRoZSBydW4gbGltaXQgc2hvdWxkIGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgdGhyZWFkIGxpbWl0LmApO1xuXHRyZXR1cm4gY3JlYXRlTWlkZGxld2FyZSh7XG5cdFx0bmFtZTogb3B0aW9ucy50b29sTmFtZSA/IGBUb29sQ2FsbExpbWl0TWlkZGxld2FyZVske29wdGlvbnMudG9vbE5hbWV9XWAgOiBcIlRvb2xDYWxsTGltaXRNaWRkbGV3YXJlXCIsXG5cdFx0c3RhdGVTY2hlbWEsXG5cdFx0YWZ0ZXJNb2RlbDoge1xuXHRcdFx0Y2FuSnVtcFRvOiBbXCJlbmRcIl0sXG5cdFx0XHRob29rOiAoc3RhdGUpID0+IHtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogR2V0IHRoZSBsYXN0IEFJIG1lc3NhZ2UgdG8gY2hlY2sgZm9yIHRvb2wgY2FsbHNcblx0XHRcdFx0Ki9cblx0XHRcdFx0Y29uc3QgbGFzdEFJTWVzc2FnZSA9IFsuLi5zdGF0ZS5tZXNzYWdlc10ucmV2ZXJzZSgpLmZpbmQoQUlNZXNzYWdlLmlzSW5zdGFuY2UpO1xuXHRcdFx0XHRpZiAoIWxhc3RBSU1lc3NhZ2UgfHwgIWxhc3RBSU1lc3NhZ2UudG9vbF9jYWxscykgcmV0dXJuO1xuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBIZWxwZXIgdG8gY2hlY2sgaWYgbGltaXQgd291bGQgYmUgZXhjZWVkZWQgYnkgb25lIG1vcmUgY2FsbFxuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCB3b3VsZEV4Y2VlZExpbWl0ID0gKHRocmVhZENvdW50LCBydW5Db3VudCkgPT4ge1xuXHRcdFx0XHRcdHJldHVybiBvcHRpb25zLnRocmVhZExpbWl0ICE9PSB2b2lkIDAgJiYgdGhyZWFkQ291bnQgKyAxID4gb3B0aW9ucy50aHJlYWRMaW1pdCB8fCBvcHRpb25zLnJ1bkxpbWl0ICE9PSB2b2lkIDAgJiYgcnVuQ291bnQgKyAxID4gb3B0aW9ucy5ydW5MaW1pdDtcblx0XHRcdFx0fTtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogSGVscGVyIHRvIGNoZWNrIGlmIGEgdG9vbCBjYWxsIG1hdGNoZXMgb3VyIGZpbHRlclxuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCBtYXRjaGVzVG9vbEZpbHRlciA9ICh0b29sQ2FsbCkgPT4ge1xuXHRcdFx0XHRcdHJldHVybiBvcHRpb25zLnRvb2xOYW1lID09PSB2b2lkIDAgfHwgdG9vbENhbGwubmFtZSA9PT0gb3B0aW9ucy50b29sTmFtZTtcblx0XHRcdFx0fTtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogU2VwYXJhdGUgdG9vbCBjYWxscyBpbnRvIGFsbG93ZWQgYW5kIGJsb2NrZWQgYmFzZWQgb24gbGltaXRzXG5cdFx0XHRcdCovXG5cdFx0XHRcdGNvbnN0IHNlcGFyYXRlVG9vbENhbGxzID0gKHRvb2xDYWxscywgdGhyZWFkQ291bnQsIHJ1bkNvdW50KSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgYWxsb3dlZCA9IFtdO1xuXHRcdFx0XHRcdGNvbnN0IGJsb2NrZWQgPSBbXTtcblx0XHRcdFx0XHRsZXQgdGVtcFRocmVhZENvdW50ID0gdGhyZWFkQ291bnQ7XG5cdFx0XHRcdFx0bGV0IHRlbXBSdW5Db3VudCA9IHJ1bkNvdW50O1xuXHRcdFx0XHRcdGZvciAoY29uc3QgdG9vbENhbGwgb2YgdG9vbENhbGxzKSB7XG5cdFx0XHRcdFx0XHRpZiAoIW1hdGNoZXNUb29sRmlsdGVyKHRvb2xDYWxsKSkgY29udGludWU7XG5cdFx0XHRcdFx0XHRpZiAod291bGRFeGNlZWRMaW1pdCh0ZW1wVGhyZWFkQ291bnQsIHRlbXBSdW5Db3VudCkpIGJsb2NrZWQucHVzaCh0b29sQ2FsbCk7XG5cdFx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdFx0YWxsb3dlZC5wdXNoKHRvb2xDYWxsKTtcblx0XHRcdFx0XHRcdFx0dGVtcFRocmVhZENvdW50ICs9IDE7XG5cdFx0XHRcdFx0XHRcdHRlbXBSdW5Db3VudCArPSAxO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YWxsb3dlZCxcblx0XHRcdFx0XHRcdGJsb2NrZWQsXG5cdFx0XHRcdFx0XHRmaW5hbFRocmVhZENvdW50OiB0ZW1wVGhyZWFkQ291bnQsXG5cdFx0XHRcdFx0XHRmaW5hbFJ1bkNvdW50OiB0ZW1wUnVuQ291bnQgKyBibG9ja2VkLmxlbmd0aFxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH07XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIEdldCB0aGUgY291bnQga2V5IGZvciB0aGlzIG1pZGRsZXdhcmUgaW5zdGFuY2Vcblx0XHRcdFx0Ki9cblx0XHRcdFx0Y29uc3QgY291bnRLZXkgPSBvcHRpb25zLnRvb2xOYW1lID8/IERFRkFVTFRfVE9PTF9DT1VOVF9LRVk7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIEdldCBjdXJyZW50IGNvdW50c1xuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCB0aHJlYWRDb3VudHMgPSB7IC4uLnN0YXRlLnRocmVhZFRvb2xDYWxsQ291bnQgPz8ge30gfTtcblx0XHRcdFx0Y29uc3QgcnVuQ291bnRzID0geyAuLi5zdGF0ZS5ydW5Ub29sQ2FsbENvdW50ID8/IHt9IH07XG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRUaHJlYWRDb3VudCA9IHRocmVhZENvdW50c1tjb3VudEtleV0gPz8gMDtcblx0XHRcdFx0Y29uc3QgY3VycmVudFJ1bkNvdW50ID0gcnVuQ291bnRzW2NvdW50S2V5XSA/PyAwO1xuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBTZXBhcmF0ZSB0b29sIGNhbGxzIGludG8gYWxsb3dlZCBhbmQgYmxvY2tlZFxuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCB7IGFsbG93ZWQsIGJsb2NrZWQsIGZpbmFsVGhyZWFkQ291bnQsIGZpbmFsUnVuQ291bnQgfSA9IHNlcGFyYXRlVG9vbENhbGxzKGxhc3RBSU1lc3NhZ2UudG9vbF9jYWxscywgY3VycmVudFRocmVhZENvdW50LCBjdXJyZW50UnVuQ291bnQpO1xuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBVcGRhdGUgY291bnRzOlxuXHRcdFx0XHQqIC0gVGhyZWFkIGNvdW50IGluY2x1ZGVzIG9ubHkgYWxsb3dlZCBjYWxscyAoYmxvY2tlZCBjYWxscyBkb24ndCBjb3VudCB0b3dhcmRzIHRocmVhZC1sZXZlbCB0cmFja2luZylcblx0XHRcdFx0KiAtIFJ1biBjb3VudCBpbmNsdWRlcyBibG9ja2VkIGNhbGxzIHNpbmNlIHRoZXkgd2VyZSBhdHRlbXB0ZWQgaW4gdGhpcyBydW5cblx0XHRcdFx0Ki9cblx0XHRcdFx0dGhyZWFkQ291bnRzW2NvdW50S2V5XSA9IGZpbmFsVGhyZWFkQ291bnQ7XG5cdFx0XHRcdHJ1bkNvdW50c1tjb3VudEtleV0gPSBmaW5hbFJ1bkNvdW50O1xuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBJZiBubyB0b29sIGNhbGxzIGFyZSBibG9ja2VkLCBqdXN0IHVwZGF0ZSBjb3VudHNcblx0XHRcdFx0Ki9cblx0XHRcdFx0aWYgKGJsb2NrZWQubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0aWYgKGFsbG93ZWQubGVuZ3RoID4gMCkgcmV0dXJuIHtcblx0XHRcdFx0XHRcdHRocmVhZFRvb2xDYWxsQ291bnQ6IHRocmVhZENvdW50cyxcblx0XHRcdFx0XHRcdHJ1blRvb2xDYWxsQ291bnQ6IHJ1bkNvdW50c1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIEhhbmRsZSBkaWZmZXJlbnQgZXhpdCBiZWhhdmlvcnNcblx0XHRcdFx0Ki9cblx0XHRcdFx0aWYgKGV4aXRCZWhhdmlvciA9PT0gXCJlcnJvclwiKSB0aHJvdyBuZXcgVG9vbENhbGxMaW1pdEV4Y2VlZGVkRXJyb3IoZmluYWxUaHJlYWRDb3VudCArIGJsb2NrZWQubGVuZ3RoLCBmaW5hbFJ1bkNvdW50LCBvcHRpb25zLnRocmVhZExpbWl0LCBvcHRpb25zLnJ1bkxpbWl0LCBvcHRpb25zLnRvb2xOYW1lKTtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogQnVpbGQgdG9vbCBtZXNzYWdlIGNvbnRlbnQgKHNlbnQgdG8gbW9kZWwgLSBubyB0aHJlYWQvcnVuIGRldGFpbHMpXG5cdFx0XHRcdCovXG5cdFx0XHRcdGNvbnN0IHRvb2xNc2dDb250ZW50ID0gYnVpbGRUb29sTWVzc2FnZUNvbnRlbnQob3B0aW9ucy50b29sTmFtZSk7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIEluamVjdCBhcnRpZmljaWFsIGVycm9yIFRvb2xNZXNzYWdlcyBmb3IgYmxvY2tlZCB0b29sIGNhbGxzXG5cdFx0XHRcdCovXG5cdFx0XHRcdGNvbnN0IGFydGlmaWNpYWxNZXNzYWdlcyA9IGJsb2NrZWQubWFwKCh0b29sQ2FsbCkgPT4gbmV3IFRvb2xNZXNzYWdlKHtcblx0XHRcdFx0XHRjb250ZW50OiB0b29sTXNnQ29udGVudCxcblx0XHRcdFx0XHR0b29sX2NhbGxfaWQ6IHRvb2xDYWxsLmlkLFxuXHRcdFx0XHRcdG5hbWU6IHRvb2xDYWxsLm5hbWUsXG5cdFx0XHRcdFx0c3RhdHVzOiBcImVycm9yXCJcblx0XHRcdFx0fSkpO1xuXHRcdFx0XHRpZiAoZXhpdEJlaGF2aW9yID09PSBcImVuZFwiKSB7XG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0KiBDaGVjayBpZiB0aGVyZSBhcmUgdG9vbCBjYWxscyB0byBvdGhlciB0b29scyB0aGF0IHdvdWxkIGNvbnRpbnVlIGV4ZWN1dGluZ1xuXHRcdFx0XHRcdCogRm9yIHRvb2wtc3BlY2lmaWMgbGltaXRlcnM6IGNoZWNrIGZvciBjYWxscyB0byBvdGhlciB0b29sc1xuXHRcdFx0XHRcdCogRm9yIGdsb2JhbCBsaW1pdGVyczogY2hlY2sgaWYgdGhlcmUgYXJlIG11bHRpcGxlIGRpZmZlcmVudCB0b29sIHR5cGVzXG5cdFx0XHRcdFx0Ki9cblx0XHRcdFx0XHRsZXQgb3RoZXJUb29scyA9IFtdO1xuXHRcdFx0XHRcdGlmIChvcHRpb25zLnRvb2xOYW1lICE9PSB2b2lkIDApXG4gLyoqXG5cdFx0XHRcdFx0KiBUb29sLXNwZWNpZmljIGxpbWl0ZXI6IGNoZWNrIGZvciBjYWxscyB0byBvdGhlciB0b29sc1xuXHRcdFx0XHRcdCovXG5cdFx0XHRcdFx0b3RoZXJUb29scyA9IGxhc3RBSU1lc3NhZ2UudG9vbF9jYWxscy5maWx0ZXIoKHRjKSA9PiB0Yy5uYW1lICE9PSBvcHRpb25zLnRvb2xOYW1lKTtcblx0XHRcdFx0XHRlbHNlIGlmIChuZXcgU2V0KGxhc3RBSU1lc3NhZ2UudG9vbF9jYWxscy5tYXAoKHRjKSA9PiB0Yy5uYW1lKS5maWx0ZXIoQm9vbGVhbikpLnNpemUgPiAxKVxuIC8qKlxuXHRcdFx0XHRcdCogTXVsdGlwbGUgZGlmZmVyZW50IHRvb2wgdHlwZXMgLSB1c2UgYWxsb3dlZCBjYWxscyB0byBzaG93IHdoaWNoIG9uZXNcblx0XHRcdFx0XHQqL1xuXHRcdFx0XHRcdG90aGVyVG9vbHMgPSBhbGxvd2VkLmxlbmd0aCA+IDAgPyBhbGxvd2VkIDogbGFzdEFJTWVzc2FnZS50b29sX2NhbGxzO1xuXHRcdFx0XHRcdGlmIChvdGhlclRvb2xzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGNvbnN0IHRvb2xOYW1lcyA9IEFycmF5LmZyb20obmV3IFNldChvdGhlclRvb2xzLm1hcCgodGMpID0+IHRjLm5hbWUpLmZpbHRlcihCb29sZWFuKSkpLmpvaW4oXCIsIFwiKTtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGVuZCBleGVjdXRpb24gd2l0aCBvdGhlciB0b29sIGNhbGxzIHBlbmRpbmcuIEZvdW5kIGNhbGxzIHRvOiAke3Rvb2xOYW1lc30uIFVzZSAnY29udGludWUnIG9yICdlcnJvcicgYmVoYXZpb3IgaW5zdGVhZC5gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y29uc3QgZmluYWxNc2dDb250ZW50ID0gYnVpbGRGaW5hbEFJTWVzc2FnZUNvbnRlbnQoZmluYWxUaHJlYWRDb3VudCArIGJsb2NrZWQubGVuZ3RoLCBmaW5hbFJ1bkNvdW50LCBvcHRpb25zLnRocmVhZExpbWl0LCBvcHRpb25zLnJ1bkxpbWl0LCBvcHRpb25zLnRvb2xOYW1lKTtcblx0XHRcdFx0XHRhcnRpZmljaWFsTWVzc2FnZXMucHVzaChuZXcgQUlNZXNzYWdlKGZpbmFsTXNnQ29udGVudCkpO1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHR0aHJlYWRUb29sQ2FsbENvdW50OiB0aHJlYWRDb3VudHMsXG5cdFx0XHRcdFx0XHRydW5Ub29sQ2FsbENvdW50OiBydW5Db3VudHMsXG5cdFx0XHRcdFx0XHRqdW1wVG86IFwiZW5kXCIsXG5cdFx0XHRcdFx0XHRtZXNzYWdlczogYXJ0aWZpY2lhbE1lc3NhZ2VzXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvKipcblx0XHRcdFx0KiBGb3IgZXhpdF9iZWhhdmlvcj1cImNvbnRpbnVlXCIsIHJldHVybiBlcnJvciBtZXNzYWdlcyB0byBibG9jayBleGNlZWRlZCB0b29sc1xuXHRcdFx0XHQqL1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdHRocmVhZFRvb2xDYWxsQ291bnQ6IHRocmVhZENvdW50cyxcblx0XHRcdFx0XHRydW5Ub29sQ2FsbENvdW50OiBydW5Db3VudHMsXG5cdFx0XHRcdFx0bWVzc2FnZXM6IGFydGlmaWNpYWxNZXNzYWdlc1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0YWZ0ZXJBZ2VudDogKCkgPT4gKHsgcnVuVG9vbENhbGxDb3VudDoge30gfSlcblx0fSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgVG9vbENhbGxMaW1pdEV4Y2VlZGVkRXJyb3IsIHRvb2xDYWxsTGltaXRNaWRkbGV3YXJlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10b29sQ2FsbExpbWl0LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolCallLimit.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolEmulator.js":
/*!*******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolEmulator.js ***!
  \*******************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   toolEmulatorMiddleware: () => (/* binding */ toolEmulatorMiddleware)\n/* harmony export */ });\n/* harmony import */ var _chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chat_models/universal.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n\n\n\n\n//#region src/agents/middleware/toolEmulator.ts\n/**\n* Middleware that emulates specified tools using an LLM instead of executing them.\n*\n* This middleware allows selective emulation of tools for testing purposes.\n* By default (when `tools` is undefined), all tools are emulated. You can specify\n* which tools to emulate by passing a list of tool names or tool instances.\n*\n* @param options - Configuration options for the middleware\n* @param options.tools - List of tool names or tool instances to emulate. If undefined, all tools are emulated.\n* @param options.model - Model to use for emulation. Defaults to \"anthropic:claude-sonnet-4-5-20250929\".\n*\n* @example Emulate all tools (default behavior)\n* ```ts\n* import { toolEmulatorMiddleware } from \"@langchain/langchain/agents/middleware\";\n* import { createAgent } from \"@langchain/langchain/agents\";\n*\n* const middleware = toolEmulatorMiddleware();\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   tools: [getWeather, getUserLocation, calculator],\n*   middleware: [middleware],\n* });\n* ```\n*\n* @example Emulate specific tools by name\n* ```ts\n* const middleware = toolEmulatorMiddleware({\n*   tools: [\"get_weather\", \"get_user_location\"]\n* });\n* ```\n*\n* @example Use a custom model for emulation\n* ```ts\n* const middleware = toolEmulatorMiddleware({\n*   tools: [\"get_weather\"],\n*   model: \"anthropic:claude-sonnet-4-5-20250929\"\n* });\n* ```\n*\n* @example Emulate specific tools by passing tool instances\n* ```ts\n* const middleware = toolEmulatorMiddleware({\n*   tools: [getWeather, getUserLocation]\n* });\n* ```\n*/\nfunction toolEmulatorMiddleware(options = {}) {\n\tlet agentModel;\n\tconst { tools, model } = options;\n\t/**\n\t* Extract tool names from tools\n\t*/\n\tconst emulateAll = !tools || tools.length === 0;\n\tconst toolsToEmulate = /* @__PURE__ */ new Set();\n\tif (!emulateAll && tools) for (const tool of tools) if (typeof tool === \"string\") toolsToEmulate.add(tool);\n\telse {\n\t\tconst toolName = typeof tool.name === \"string\" ? tool.name : String(tool.name);\n\t\ttoolsToEmulate.add(toolName);\n\t}\n\t/**\n\t* Initialize emulator model\n\t* We'll initialize it lazily in wrapToolCall to handle async initChatModel\n\t*/\n\tlet emulatorModel;\n\tconst getEmulatorModel = async () => {\n\t\tif (typeof model === \"object\") return model;\n\t\tif (typeof model === \"string\") {\n\t\t\temulatorModel = emulatorModel ?? await (0,_chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__.initChatModel)(model, { temperature: 1 }).catch((err) => {\n\t\t\t\tconsole.error(\"Error initializing emulator model, using agent model:\", err);\n\t\t\t\treturn agentModel;\n\t\t\t});\n\t\t\treturn emulatorModel;\n\t\t}\n\t\treturn agentModel;\n\t};\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_1__.createMiddleware)({\n\t\tname: \"ToolEmulatorMiddleware\",\n\t\twrapModelCall: async (request, handler) => {\n\t\t\tagentModel = request.model;\n\t\t\treturn handler(request);\n\t\t},\n\t\twrapToolCall: async (request, handler) => {\n\t\t\tconst toolName = request.toolCall.name;\n\t\t\tif (!(emulateAll || toolsToEmulate.has(toolName))) return handler(request);\n\t\t\tconst toolArgs = request.toolCall.args;\n\t\t\tconst prompt = `You are emulating a tool call for testing purposes.\n\nTool: ${toolName}\nDescription: ${request.tool?.description || \"No description available\"}\nArguments: ${typeof toolArgs === \"string\" ? toolArgs : JSON.stringify(toolArgs)}\n\nGenerate a realistic response that this tool would return given these arguments.\nReturn ONLY the tool's output, no explanation or preamble. Introduce variation into your responses.`;\n\t\t\tconst response = await (await getEmulatorModel()).invoke([new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.HumanMessage(prompt)]);\n\t\t\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.ToolMessage({\n\t\t\t\tcontent: typeof response.content === \"string\" ? response.content : JSON.stringify(response.content),\n\t\t\t\ttool_call_id: request.toolCall.id ?? \"\",\n\t\t\t\tname: toolName\n\t\t\t});\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=toolEmulator.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS90b29sRW11bGF0b3IuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUErRDtBQUNYO0FBQ2lCOztBQUVyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx5QkFBeUI7QUFDcEMsV0FBVyxjQUFjO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBLFNBQVMsZUFBZTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsd0VBQWEsVUFBVSxnQkFBZ0I7QUFDakY7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsZ0VBQWdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsUUFBUTtBQUNSLGVBQWU7QUFDZixhQUFhOztBQUViO0FBQ0E7QUFDQSxpRUFBaUUsa0VBQVk7QUFDN0UsY0FBYyxpRUFBVztBQUN6QjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDa0M7QUFDbEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS90b29sRW11bGF0b3IuanM/MzBiYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpbml0Q2hhdE1vZGVsIH0gZnJvbSBcIi4uLy4uL2NoYXRfbW9kZWxzL3VuaXZlcnNhbC5qc1wiO1xuaW1wb3J0IHsgY3JlYXRlTWlkZGxld2FyZSB9IGZyb20gXCIuLi9taWRkbGV3YXJlLmpzXCI7XG5pbXBvcnQgeyBIdW1hbk1lc3NhZ2UsIFRvb2xNZXNzYWdlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9tZXNzYWdlc1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9taWRkbGV3YXJlL3Rvb2xFbXVsYXRvci50c1xuLyoqXG4qIE1pZGRsZXdhcmUgdGhhdCBlbXVsYXRlcyBzcGVjaWZpZWQgdG9vbHMgdXNpbmcgYW4gTExNIGluc3RlYWQgb2YgZXhlY3V0aW5nIHRoZW0uXG4qXG4qIFRoaXMgbWlkZGxld2FyZSBhbGxvd3Mgc2VsZWN0aXZlIGVtdWxhdGlvbiBvZiB0b29scyBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cbiogQnkgZGVmYXVsdCAod2hlbiBgdG9vbHNgIGlzIHVuZGVmaW5lZCksIGFsbCB0b29scyBhcmUgZW11bGF0ZWQuIFlvdSBjYW4gc3BlY2lmeVxuKiB3aGljaCB0b29scyB0byBlbXVsYXRlIGJ5IHBhc3NpbmcgYSBsaXN0IG9mIHRvb2wgbmFtZXMgb3IgdG9vbCBpbnN0YW5jZXMuXG4qXG4qIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgbWlkZGxld2FyZVxuKiBAcGFyYW0gb3B0aW9ucy50b29scyAtIExpc3Qgb2YgdG9vbCBuYW1lcyBvciB0b29sIGluc3RhbmNlcyB0byBlbXVsYXRlLiBJZiB1bmRlZmluZWQsIGFsbCB0b29scyBhcmUgZW11bGF0ZWQuXG4qIEBwYXJhbSBvcHRpb25zLm1vZGVsIC0gTW9kZWwgdG8gdXNlIGZvciBlbXVsYXRpb24uIERlZmF1bHRzIHRvIFwiYW50aHJvcGljOmNsYXVkZS1zb25uZXQtNC01LTIwMjUwOTI5XCIuXG4qXG4qIEBleGFtcGxlIEVtdWxhdGUgYWxsIHRvb2xzIChkZWZhdWx0IGJlaGF2aW9yKVxuKiBgYGB0c1xuKiBpbXBvcnQgeyB0b29sRW11bGF0b3JNaWRkbGV3YXJlIH0gZnJvbSBcIkBsYW5nY2hhaW4vbGFuZ2NoYWluL2FnZW50cy9taWRkbGV3YXJlXCI7XG4qIGltcG9ydCB7IGNyZWF0ZUFnZW50IH0gZnJvbSBcIkBsYW5nY2hhaW4vbGFuZ2NoYWluL2FnZW50c1wiO1xuKlxuKiBjb25zdCBtaWRkbGV3YXJlID0gdG9vbEVtdWxhdG9yTWlkZGxld2FyZSgpO1xuKlxuKiBjb25zdCBhZ2VudCA9IGNyZWF0ZUFnZW50KHtcbiogICBtb2RlbDogXCJvcGVuYWk6Z3B0LTRvXCIsXG4qICAgdG9vbHM6IFtnZXRXZWF0aGVyLCBnZXRVc2VyTG9jYXRpb24sIGNhbGN1bGF0b3JdLFxuKiAgIG1pZGRsZXdhcmU6IFttaWRkbGV3YXJlXSxcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBFbXVsYXRlIHNwZWNpZmljIHRvb2xzIGJ5IG5hbWVcbiogYGBgdHNcbiogY29uc3QgbWlkZGxld2FyZSA9IHRvb2xFbXVsYXRvck1pZGRsZXdhcmUoe1xuKiAgIHRvb2xzOiBbXCJnZXRfd2VhdGhlclwiLCBcImdldF91c2VyX2xvY2F0aW9uXCJdXG4qIH0pO1xuKiBgYGBcbipcbiogQGV4YW1wbGUgVXNlIGEgY3VzdG9tIG1vZGVsIGZvciBlbXVsYXRpb25cbiogYGBgdHNcbiogY29uc3QgbWlkZGxld2FyZSA9IHRvb2xFbXVsYXRvck1pZGRsZXdhcmUoe1xuKiAgIHRvb2xzOiBbXCJnZXRfd2VhdGhlclwiXSxcbiogICBtb2RlbDogXCJhbnRocm9waWM6Y2xhdWRlLXNvbm5ldC00LTUtMjAyNTA5MjlcIlxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlIEVtdWxhdGUgc3BlY2lmaWMgdG9vbHMgYnkgcGFzc2luZyB0b29sIGluc3RhbmNlc1xuKiBgYGB0c1xuKiBjb25zdCBtaWRkbGV3YXJlID0gdG9vbEVtdWxhdG9yTWlkZGxld2FyZSh7XG4qICAgdG9vbHM6IFtnZXRXZWF0aGVyLCBnZXRVc2VyTG9jYXRpb25dXG4qIH0pO1xuKiBgYGBcbiovXG5mdW5jdGlvbiB0b29sRW11bGF0b3JNaWRkbGV3YXJlKG9wdGlvbnMgPSB7fSkge1xuXHRsZXQgYWdlbnRNb2RlbDtcblx0Y29uc3QgeyB0b29scywgbW9kZWwgfSA9IG9wdGlvbnM7XG5cdC8qKlxuXHQqIEV4dHJhY3QgdG9vbCBuYW1lcyBmcm9tIHRvb2xzXG5cdCovXG5cdGNvbnN0IGVtdWxhdGVBbGwgPSAhdG9vbHMgfHwgdG9vbHMubGVuZ3RoID09PSAwO1xuXHRjb25zdCB0b29sc1RvRW11bGF0ZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG5cdGlmICghZW11bGF0ZUFsbCAmJiB0b29scykgZm9yIChjb25zdCB0b29sIG9mIHRvb2xzKSBpZiAodHlwZW9mIHRvb2wgPT09IFwic3RyaW5nXCIpIHRvb2xzVG9FbXVsYXRlLmFkZCh0b29sKTtcblx0ZWxzZSB7XG5cdFx0Y29uc3QgdG9vbE5hbWUgPSB0eXBlb2YgdG9vbC5uYW1lID09PSBcInN0cmluZ1wiID8gdG9vbC5uYW1lIDogU3RyaW5nKHRvb2wubmFtZSk7XG5cdFx0dG9vbHNUb0VtdWxhdGUuYWRkKHRvb2xOYW1lKTtcblx0fVxuXHQvKipcblx0KiBJbml0aWFsaXplIGVtdWxhdG9yIG1vZGVsXG5cdCogV2UnbGwgaW5pdGlhbGl6ZSBpdCBsYXppbHkgaW4gd3JhcFRvb2xDYWxsIHRvIGhhbmRsZSBhc3luYyBpbml0Q2hhdE1vZGVsXG5cdCovXG5cdGxldCBlbXVsYXRvck1vZGVsO1xuXHRjb25zdCBnZXRFbXVsYXRvck1vZGVsID0gYXN5bmMgKCkgPT4ge1xuXHRcdGlmICh0eXBlb2YgbW9kZWwgPT09IFwib2JqZWN0XCIpIHJldHVybiBtb2RlbDtcblx0XHRpZiAodHlwZW9mIG1vZGVsID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRlbXVsYXRvck1vZGVsID0gZW11bGF0b3JNb2RlbCA/PyBhd2FpdCBpbml0Q2hhdE1vZGVsKG1vZGVsLCB7IHRlbXBlcmF0dXJlOiAxIH0pLmNhdGNoKChlcnIpID0+IHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihcIkVycm9yIGluaXRpYWxpemluZyBlbXVsYXRvciBtb2RlbCwgdXNpbmcgYWdlbnQgbW9kZWw6XCIsIGVycik7XG5cdFx0XHRcdHJldHVybiBhZ2VudE1vZGVsO1xuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gZW11bGF0b3JNb2RlbDtcblx0XHR9XG5cdFx0cmV0dXJuIGFnZW50TW9kZWw7XG5cdH07XG5cdHJldHVybiBjcmVhdGVNaWRkbGV3YXJlKHtcblx0XHRuYW1lOiBcIlRvb2xFbXVsYXRvck1pZGRsZXdhcmVcIixcblx0XHR3cmFwTW9kZWxDYWxsOiBhc3luYyAocmVxdWVzdCwgaGFuZGxlcikgPT4ge1xuXHRcdFx0YWdlbnRNb2RlbCA9IHJlcXVlc3QubW9kZWw7XG5cdFx0XHRyZXR1cm4gaGFuZGxlcihyZXF1ZXN0KTtcblx0XHR9LFxuXHRcdHdyYXBUb29sQ2FsbDogYXN5bmMgKHJlcXVlc3QsIGhhbmRsZXIpID0+IHtcblx0XHRcdGNvbnN0IHRvb2xOYW1lID0gcmVxdWVzdC50b29sQ2FsbC5uYW1lO1xuXHRcdFx0aWYgKCEoZW11bGF0ZUFsbCB8fCB0b29sc1RvRW11bGF0ZS5oYXModG9vbE5hbWUpKSkgcmV0dXJuIGhhbmRsZXIocmVxdWVzdCk7XG5cdFx0XHRjb25zdCB0b29sQXJncyA9IHJlcXVlc3QudG9vbENhbGwuYXJncztcblx0XHRcdGNvbnN0IHByb21wdCA9IGBZb3UgYXJlIGVtdWxhdGluZyBhIHRvb2wgY2FsbCBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cblxuVG9vbDogJHt0b29sTmFtZX1cbkRlc2NyaXB0aW9uOiAke3JlcXVlc3QudG9vbD8uZGVzY3JpcHRpb24gfHwgXCJObyBkZXNjcmlwdGlvbiBhdmFpbGFibGVcIn1cbkFyZ3VtZW50czogJHt0eXBlb2YgdG9vbEFyZ3MgPT09IFwic3RyaW5nXCIgPyB0b29sQXJncyA6IEpTT04uc3RyaW5naWZ5KHRvb2xBcmdzKX1cblxuR2VuZXJhdGUgYSByZWFsaXN0aWMgcmVzcG9uc2UgdGhhdCB0aGlzIHRvb2wgd291bGQgcmV0dXJuIGdpdmVuIHRoZXNlIGFyZ3VtZW50cy5cblJldHVybiBPTkxZIHRoZSB0b29sJ3Mgb3V0cHV0LCBubyBleHBsYW5hdGlvbiBvciBwcmVhbWJsZS4gSW50cm9kdWNlIHZhcmlhdGlvbiBpbnRvIHlvdXIgcmVzcG9uc2VzLmA7XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IChhd2FpdCBnZXRFbXVsYXRvck1vZGVsKCkpLmludm9rZShbbmV3IEh1bWFuTWVzc2FnZShwcm9tcHQpXSk7XG5cdFx0XHRyZXR1cm4gbmV3IFRvb2xNZXNzYWdlKHtcblx0XHRcdFx0Y29udGVudDogdHlwZW9mIHJlc3BvbnNlLmNvbnRlbnQgPT09IFwic3RyaW5nXCIgPyByZXNwb25zZS5jb250ZW50IDogSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuY29udGVudCksXG5cdFx0XHRcdHRvb2xfY2FsbF9pZDogcmVxdWVzdC50b29sQ2FsbC5pZCA/PyBcIlwiLFxuXHRcdFx0XHRuYW1lOiB0b29sTmFtZVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn1cblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyB0b29sRW11bGF0b3JNaWRkbGV3YXJlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10b29sRW11bGF0b3IuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolEmulator.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolRetry.js":
/*!****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolRetry.js ***!
  \****************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   toolRetryMiddleware: () => (/* binding */ toolRetryMiddleware)\n/* harmony export */ });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _constants_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constants.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/constants.js\");\n/* harmony import */ var _error_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./error.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/error.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n\n\n\n\n\n//#region src/agents/middleware/toolRetry.ts\n/**\n* Tool retry middleware for agents.\n*/\n/**\n* Configuration options for the Tool Retry Middleware.\n*/\nconst ToolRetryMiddlewareOptionsSchema = zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.object({\n\ttools: zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.array(zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.union([\n\t\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z.custom(),\n\t\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z.custom(),\n\t\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z.string()\n\t])).optional(),\n\tonFailure: zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.union([\n\t\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z.literal(\"error\"),\n\t\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z.literal(\"continue\"),\n\t\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z.literal(\"raise\"),\n\t\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z.literal(\"return_message\"),\n\t\tzod_v3__WEBPACK_IMPORTED_MODULE_5__.z[\"function\"]().args(zod_v3__WEBPACK_IMPORTED_MODULE_5__.z[\"instanceof\"](Error)).returns(zod_v3__WEBPACK_IMPORTED_MODULE_5__.z.string())\n\t]).default(\"continue\")\n}).merge(_constants_js__WEBPACK_IMPORTED_MODULE_2__.RetrySchema);\n/**\n* Middleware that automatically retries failed tool calls with configurable backoff.\n*\n* Supports retrying on specific exceptions and exponential backoff.\n*\n* @example Basic usage with default settings (2 retries, exponential backoff)\n* ```ts\n* import { createAgent, toolRetryMiddleware } from \"langchain\";\n*\n* const agent = createAgent({\n*   model: \"openai:gpt-4o\",\n*   tools: [searchTool],\n*   middleware: [toolRetryMiddleware()],\n* });\n* ```\n*\n* @example Retry specific exceptions only\n* ```ts\n* import { toolRetryMiddleware } from \"langchain\";\n*\n* const retry = toolRetryMiddleware({\n*   maxRetries: 4,\n*   retryOn: [TimeoutError, NetworkError],\n*   backoffFactor: 1.5,\n* });\n* ```\n*\n* @example Custom exception filtering\n* ```ts\n* function shouldRetry(error: Error): boolean {\n*   // Only retry on 5xx errors\n*   if (error.name === \"HTTPError\" && \"statusCode\" in error) {\n*     const statusCode = (error as any).statusCode;\n*     return 500 <= statusCode && statusCode < 600;\n*   }\n*   return false;\n* }\n*\n* const retry = toolRetryMiddleware({\n*   maxRetries: 3,\n*   retryOn: shouldRetry,\n* });\n* ```\n*\n* @example Apply to specific tools with custom error handling\n* ```ts\n* const formatError = (error: Error) =>\n*   \"Database temporarily unavailable. Please try again later.\";\n*\n* const retry = toolRetryMiddleware({\n*   maxRetries: 4,\n*   tools: [\"search_database\"],\n*   onFailure: formatError,\n* });\n* ```\n*\n* @example Apply to specific tools using BaseTool instances\n* ```ts\n* import { tool } from \"@langchain/core/tools\";\n* import { z } from \"zod\";\n*\n* const searchDatabase = tool(\n*   async ({ query }) => {\n*     // Search implementation\n*     return results;\n*   },\n*   {\n*     name: \"search_database\",\n*     description: \"Search the database\",\n*     schema: z.object({ query: z.string() }),\n*   }\n* );\n*\n* const retry = toolRetryMiddleware({\n*   maxRetries: 4,\n*   tools: [searchDatabase], // Pass BaseTool instance\n* });\n* ```\n*\n* @example Constant backoff (no exponential growth)\n* ```ts\n* const retry = toolRetryMiddleware({\n*   maxRetries: 5,\n*   backoffFactor: 0.0, // No exponential growth\n*   initialDelayMs: 2000, // Always wait 2 seconds\n* });\n* ```\n*\n* @example Raise exception on failure\n* ```ts\n* const retry = toolRetryMiddleware({\n*   maxRetries: 2,\n*   onFailure: \"raise\", // Re-raise exception instead of returning message\n* });\n* ```\n*\n* @param config - Configuration options for the retry middleware\n* @returns A middleware instance that handles tool failures with retries\n*/\nfunction toolRetryMiddleware(config = {}) {\n\tconst { success, error, data } = ToolRetryMiddlewareOptionsSchema.safeParse(config);\n\tif (!success) throw new _error_js__WEBPACK_IMPORTED_MODULE_3__.InvalidRetryConfigError(error);\n\tconst { maxRetries, tools, retryOn, onFailure: onFailureConfig, backoffFactor, initialDelayMs, maxDelayMs, jitter } = data;\n\tlet onFailure = onFailureConfig;\n\tif (onFailureConfig === \"raise\") {\n\t\tconsole.warn(\"â ï¸ `onFailure: 'raise'` is deprecated. Use `onFailure: 'error'` instead.\");\n\t\tonFailure = \"error\";\n\t} else if (onFailureConfig === \"return_message\") {\n\t\tconsole.warn(\"â ï¸ `onFailure: 'return_message'` is deprecated. Use `onFailure: 'continue'` instead.\");\n\t\tonFailure = \"continue\";\n\t}\n\tconst toolFilter = [];\n\tfor (const tool of tools ?? []) if (typeof tool === \"string\") toolFilter.push(tool);\n\telse if (\"name\" in tool && typeof tool.name === \"string\") toolFilter.push(tool.name);\n\telse throw new TypeError(\"Expected a tool name string or tool instance to be passed to toolRetryMiddleware\");\n\t/**\n\t* Check if retry logic should apply to this tool.\n\t*/\n\tconst shouldRetryTool = (toolName) => {\n\t\tif (toolFilter.length === 0) return true;\n\t\treturn toolFilter.includes(toolName);\n\t};\n\t/**\n\t* Check if the exception should trigger a retry.\n\t*/\n\tconst shouldRetryException = (error) => {\n\t\tif (typeof retryOn === \"function\") return retryOn(error);\n\t\treturn retryOn.some((ErrorConstructor) => {\n\t\t\treturn error instanceof ErrorConstructor;\n\t\t});\n\t};\n\tconst delayConfig = {\n\t\tbackoffFactor,\n\t\tinitialDelayMs,\n\t\tmaxDelayMs,\n\t\tjitter\n\t};\n\t/**\n\t* Format the failure message when retries are exhausted.\n\t*/\n\tconst formatFailureMessage = (toolName, error, attemptsMade) => {\n\t\tconst errorType = error.constructor.name;\n\t\treturn `Tool '${toolName}' failed after ${attemptsMade} ${attemptsMade === 1 ? \"attempt\" : \"attempts\"} with ${errorType}`;\n\t};\n\t/**\n\t* Handle failure when all retries are exhausted.\n\t*/\n\tconst handleFailure = (toolName, toolCallId, error, attemptsMade) => {\n\t\tif (onFailure === \"error\") throw error;\n\t\tlet content;\n\t\tif (typeof onFailure === \"function\") content = onFailure(error);\n\t\telse content = formatFailureMessage(toolName, error, attemptsMade);\n\t\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.ToolMessage({\n\t\t\tcontent,\n\t\t\ttool_call_id: toolCallId,\n\t\t\tname: toolName,\n\t\t\tstatus: \"error\"\n\t\t});\n\t};\n\treturn (0,_middleware_js__WEBPACK_IMPORTED_MODULE_1__.createMiddleware)({\n\t\tname: \"toolRetryMiddleware\",\n\t\tcontextSchema: ToolRetryMiddlewareOptionsSchema,\n\t\twrapToolCall: async (request, handler) => {\n\t\t\tconst toolName = request.tool?.name ?? request.toolCall.name;\n\t\t\tif (!shouldRetryTool(toolName)) return handler(request);\n\t\t\tconst toolCallId = request.toolCall.id ?? \"\";\n\t\t\tfor (let attempt = 0; attempt <= maxRetries; attempt++) try {\n\t\t\t\treturn await handler(request);\n\t\t\t} catch (error) {\n\t\t\t\tconst attemptsMade = attempt + 1;\n\t\t\t\tconst err = error && typeof error === \"object\" && \"message\" in error ? error : new Error(String(error));\n\t\t\t\tif (!shouldRetryException(err)) return handleFailure(toolName, toolCallId, err, attemptsMade);\n\t\t\t\tif (attempt < maxRetries) {\n\t\t\t\t\tconst delay = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.calculateRetryDelay)(delayConfig, attempt);\n\t\t\t\t\tif (delay > 0) await (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.sleep)(delay);\n\t\t\t\t} else return handleFailure(toolName, toolCallId, err, attemptsMade);\n\t\t\t}\n\t\t\tthrow new Error(\"Unexpected: retry loop completed without returning\");\n\t\t}\n\t});\n}\n\n//#endregion\n\n//# sourceMappingURL=toolRetry.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS90b29sUmV0cnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF3RDtBQUNKO0FBQ1A7QUFDUTtBQUNFO0FBQzVCOztBQUUzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyw0Q0FBUTtBQUNqRCxRQUFRLDJDQUFPLENBQUMsMkNBQU87QUFDdkIsRUFBRSw0Q0FBUTtBQUNWLEVBQUUsNENBQVE7QUFDVixFQUFFLDRDQUFRO0FBQ1Y7QUFDQSxZQUFZLDJDQUFPO0FBQ25CLEVBQUUsNkNBQVM7QUFDWCxFQUFFLDZDQUFTO0FBQ1gsRUFBRSw2Q0FBUztBQUNYLEVBQUUsNkNBQVM7QUFDWCxFQUFFLGlEQUFVLFFBQVEsbURBQVksaUJBQWlCLDRDQUFRO0FBQ3pEO0FBQ0EsQ0FBQyxRQUFRLHNEQUFXO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxtQ0FBbUM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsc0JBQXNCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixXQUFXLElBQUk7QUFDZjtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLG1CQUFtQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDLFNBQVMsdUJBQXVCO0FBQ2hDLHlCQUF5Qiw4REFBdUI7QUFDaEQsU0FBUyw0R0FBNEc7QUFDckg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixTQUFTLGlCQUFpQixjQUFjLEVBQUUsNkNBQTZDLE9BQU8sVUFBVTtBQUMxSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGlFQUFXO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsUUFBUSxnRUFBZ0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw4REFBbUI7QUFDdEMsMEJBQTBCLGdEQUFLO0FBQy9CLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDK0I7QUFDL0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS90b29sUmV0cnkuanM/ZTY1NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjYWxjdWxhdGVSZXRyeURlbGF5LCBzbGVlcCB9IGZyb20gXCIuL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyBjcmVhdGVNaWRkbGV3YXJlIH0gZnJvbSBcIi4uL21pZGRsZXdhcmUuanNcIjtcbmltcG9ydCB7IFJldHJ5U2NoZW1hIH0gZnJvbSBcIi4vY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgeyBJbnZhbGlkUmV0cnlDb25maWdFcnJvciB9IGZyb20gXCIuL2Vycm9yLmpzXCI7XG5pbXBvcnQgeyBUb29sTWVzc2FnZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXNcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kL3YzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL21pZGRsZXdhcmUvdG9vbFJldHJ5LnRzXG4vKipcbiogVG9vbCByZXRyeSBtaWRkbGV3YXJlIGZvciBhZ2VudHMuXG4qL1xuLyoqXG4qIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIFRvb2wgUmV0cnkgTWlkZGxld2FyZS5cbiovXG5jb25zdCBUb29sUmV0cnlNaWRkbGV3YXJlT3B0aW9uc1NjaGVtYSA9IHoub2JqZWN0KHtcblx0dG9vbHM6IHouYXJyYXkoei51bmlvbihbXG5cdFx0ei5jdXN0b20oKSxcblx0XHR6LmN1c3RvbSgpLFxuXHRcdHouc3RyaW5nKClcblx0XSkpLm9wdGlvbmFsKCksXG5cdG9uRmFpbHVyZTogei51bmlvbihbXG5cdFx0ei5saXRlcmFsKFwiZXJyb3JcIiksXG5cdFx0ei5saXRlcmFsKFwiY29udGludWVcIiksXG5cdFx0ei5saXRlcmFsKFwicmFpc2VcIiksXG5cdFx0ei5saXRlcmFsKFwicmV0dXJuX21lc3NhZ2VcIiksXG5cdFx0ei5mdW5jdGlvbigpLmFyZ3Moei5pbnN0YW5jZW9mKEVycm9yKSkucmV0dXJucyh6LnN0cmluZygpKVxuXHRdKS5kZWZhdWx0KFwiY29udGludWVcIilcbn0pLm1lcmdlKFJldHJ5U2NoZW1hKTtcbi8qKlxuKiBNaWRkbGV3YXJlIHRoYXQgYXV0b21hdGljYWxseSByZXRyaWVzIGZhaWxlZCB0b29sIGNhbGxzIHdpdGggY29uZmlndXJhYmxlIGJhY2tvZmYuXG4qXG4qIFN1cHBvcnRzIHJldHJ5aW5nIG9uIHNwZWNpZmljIGV4Y2VwdGlvbnMgYW5kIGV4cG9uZW50aWFsIGJhY2tvZmYuXG4qXG4qIEBleGFtcGxlIEJhc2ljIHVzYWdlIHdpdGggZGVmYXVsdCBzZXR0aW5ncyAoMiByZXRyaWVzLCBleHBvbmVudGlhbCBiYWNrb2ZmKVxuKiBgYGB0c1xuKiBpbXBvcnQgeyBjcmVhdGVBZ2VudCwgdG9vbFJldHJ5TWlkZGxld2FyZSB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwib3BlbmFpOmdwdC00b1wiLFxuKiAgIHRvb2xzOiBbc2VhcmNoVG9vbF0sXG4qICAgbWlkZGxld2FyZTogW3Rvb2xSZXRyeU1pZGRsZXdhcmUoKV0sXG4qIH0pO1xuKiBgYGBcbipcbiogQGV4YW1wbGUgUmV0cnkgc3BlY2lmaWMgZXhjZXB0aW9ucyBvbmx5XG4qIGBgYHRzXG4qIGltcG9ydCB7IHRvb2xSZXRyeU1pZGRsZXdhcmUgfSBmcm9tIFwibGFuZ2NoYWluXCI7XG4qXG4qIGNvbnN0IHJldHJ5ID0gdG9vbFJldHJ5TWlkZGxld2FyZSh7XG4qICAgbWF4UmV0cmllczogNCxcbiogICByZXRyeU9uOiBbVGltZW91dEVycm9yLCBOZXR3b3JrRXJyb3JdLFxuKiAgIGJhY2tvZmZGYWN0b3I6IDEuNSxcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBDdXN0b20gZXhjZXB0aW9uIGZpbHRlcmluZ1xuKiBgYGB0c1xuKiBmdW5jdGlvbiBzaG91bGRSZXRyeShlcnJvcjogRXJyb3IpOiBib29sZWFuIHtcbiogICAvLyBPbmx5IHJldHJ5IG9uIDV4eCBlcnJvcnNcbiogICBpZiAoZXJyb3IubmFtZSA9PT0gXCJIVFRQRXJyb3JcIiAmJiBcInN0YXR1c0NvZGVcIiBpbiBlcnJvcikge1xuKiAgICAgY29uc3Qgc3RhdHVzQ29kZSA9IChlcnJvciBhcyBhbnkpLnN0YXR1c0NvZGU7XG4qICAgICByZXR1cm4gNTAwIDw9IHN0YXR1c0NvZGUgJiYgc3RhdHVzQ29kZSA8IDYwMDtcbiogICB9XG4qICAgcmV0dXJuIGZhbHNlO1xuKiB9XG4qXG4qIGNvbnN0IHJldHJ5ID0gdG9vbFJldHJ5TWlkZGxld2FyZSh7XG4qICAgbWF4UmV0cmllczogMyxcbiogICByZXRyeU9uOiBzaG91bGRSZXRyeSxcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBBcHBseSB0byBzcGVjaWZpYyB0b29scyB3aXRoIGN1c3RvbSBlcnJvciBoYW5kbGluZ1xuKiBgYGB0c1xuKiBjb25zdCBmb3JtYXRFcnJvciA9IChlcnJvcjogRXJyb3IpID0+XG4qICAgXCJEYXRhYmFzZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIjtcbipcbiogY29uc3QgcmV0cnkgPSB0b29sUmV0cnlNaWRkbGV3YXJlKHtcbiogICBtYXhSZXRyaWVzOiA0LFxuKiAgIHRvb2xzOiBbXCJzZWFyY2hfZGF0YWJhc2VcIl0sXG4qICAgb25GYWlsdXJlOiBmb3JtYXRFcnJvcixcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBBcHBseSB0byBzcGVjaWZpYyB0b29scyB1c2luZyBCYXNlVG9vbCBpbnN0YW5jZXNcbiogYGBgdHNcbiogaW1wb3J0IHsgdG9vbCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvdG9vbHNcIjtcbiogaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcbipcbiogY29uc3Qgc2VhcmNoRGF0YWJhc2UgPSB0b29sKFxuKiAgIGFzeW5jICh7IHF1ZXJ5IH0pID0+IHtcbiogICAgIC8vIFNlYXJjaCBpbXBsZW1lbnRhdGlvblxuKiAgICAgcmV0dXJuIHJlc3VsdHM7XG4qICAgfSxcbiogICB7XG4qICAgICBuYW1lOiBcInNlYXJjaF9kYXRhYmFzZVwiLFxuKiAgICAgZGVzY3JpcHRpb246IFwiU2VhcmNoIHRoZSBkYXRhYmFzZVwiLFxuKiAgICAgc2NoZW1hOiB6Lm9iamVjdCh7IHF1ZXJ5OiB6LnN0cmluZygpIH0pLFxuKiAgIH1cbiogKTtcbipcbiogY29uc3QgcmV0cnkgPSB0b29sUmV0cnlNaWRkbGV3YXJlKHtcbiogICBtYXhSZXRyaWVzOiA0LFxuKiAgIHRvb2xzOiBbc2VhcmNoRGF0YWJhc2VdLCAvLyBQYXNzIEJhc2VUb29sIGluc3RhbmNlXG4qIH0pO1xuKiBgYGBcbipcbiogQGV4YW1wbGUgQ29uc3RhbnQgYmFja29mZiAobm8gZXhwb25lbnRpYWwgZ3Jvd3RoKVxuKiBgYGB0c1xuKiBjb25zdCByZXRyeSA9IHRvb2xSZXRyeU1pZGRsZXdhcmUoe1xuKiAgIG1heFJldHJpZXM6IDUsXG4qICAgYmFja29mZkZhY3RvcjogMC4wLCAvLyBObyBleHBvbmVudGlhbCBncm93dGhcbiogICBpbml0aWFsRGVsYXlNczogMjAwMCwgLy8gQWx3YXlzIHdhaXQgMiBzZWNvbmRzXG4qIH0pO1xuKiBgYGBcbipcbiogQGV4YW1wbGUgUmFpc2UgZXhjZXB0aW9uIG9uIGZhaWx1cmVcbiogYGBgdHNcbiogY29uc3QgcmV0cnkgPSB0b29sUmV0cnlNaWRkbGV3YXJlKHtcbiogICBtYXhSZXRyaWVzOiAyLFxuKiAgIG9uRmFpbHVyZTogXCJyYWlzZVwiLCAvLyBSZS1yYWlzZSBleGNlcHRpb24gaW5zdGVhZCBvZiByZXR1cm5pbmcgbWVzc2FnZVxuKiB9KTtcbiogYGBgXG4qXG4qIEBwYXJhbSBjb25maWcgLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSByZXRyeSBtaWRkbGV3YXJlXG4qIEByZXR1cm5zIEEgbWlkZGxld2FyZSBpbnN0YW5jZSB0aGF0IGhhbmRsZXMgdG9vbCBmYWlsdXJlcyB3aXRoIHJldHJpZXNcbiovXG5mdW5jdGlvbiB0b29sUmV0cnlNaWRkbGV3YXJlKGNvbmZpZyA9IHt9KSB7XG5cdGNvbnN0IHsgc3VjY2VzcywgZXJyb3IsIGRhdGEgfSA9IFRvb2xSZXRyeU1pZGRsZXdhcmVPcHRpb25zU2NoZW1hLnNhZmVQYXJzZShjb25maWcpO1xuXHRpZiAoIXN1Y2Nlc3MpIHRocm93IG5ldyBJbnZhbGlkUmV0cnlDb25maWdFcnJvcihlcnJvcik7XG5cdGNvbnN0IHsgbWF4UmV0cmllcywgdG9vbHMsIHJldHJ5T24sIG9uRmFpbHVyZTogb25GYWlsdXJlQ29uZmlnLCBiYWNrb2ZmRmFjdG9yLCBpbml0aWFsRGVsYXlNcywgbWF4RGVsYXlNcywgaml0dGVyIH0gPSBkYXRhO1xuXHRsZXQgb25GYWlsdXJlID0gb25GYWlsdXJlQ29uZmlnO1xuXHRpZiAob25GYWlsdXJlQ29uZmlnID09PSBcInJhaXNlXCIpIHtcblx0XHRjb25zb2xlLndhcm4oXCLimqDvuI8gYG9uRmFpbHVyZTogJ3JhaXNlJ2AgaXMgZGVwcmVjYXRlZC4gVXNlIGBvbkZhaWx1cmU6ICdlcnJvcidgIGluc3RlYWQuXCIpO1xuXHRcdG9uRmFpbHVyZSA9IFwiZXJyb3JcIjtcblx0fSBlbHNlIGlmIChvbkZhaWx1cmVDb25maWcgPT09IFwicmV0dXJuX21lc3NhZ2VcIikge1xuXHRcdGNvbnNvbGUud2FybihcIuKaoO+4jyBgb25GYWlsdXJlOiAncmV0dXJuX21lc3NhZ2UnYCBpcyBkZXByZWNhdGVkLiBVc2UgYG9uRmFpbHVyZTogJ2NvbnRpbnVlJ2AgaW5zdGVhZC5cIik7XG5cdFx0b25GYWlsdXJlID0gXCJjb250aW51ZVwiO1xuXHR9XG5cdGNvbnN0IHRvb2xGaWx0ZXIgPSBbXTtcblx0Zm9yIChjb25zdCB0b29sIG9mIHRvb2xzID8/IFtdKSBpZiAodHlwZW9mIHRvb2wgPT09IFwic3RyaW5nXCIpIHRvb2xGaWx0ZXIucHVzaCh0b29sKTtcblx0ZWxzZSBpZiAoXCJuYW1lXCIgaW4gdG9vbCAmJiB0eXBlb2YgdG9vbC5uYW1lID09PSBcInN0cmluZ1wiKSB0b29sRmlsdGVyLnB1c2godG9vbC5uYW1lKTtcblx0ZWxzZSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXhwZWN0ZWQgYSB0b29sIG5hbWUgc3RyaW5nIG9yIHRvb2wgaW5zdGFuY2UgdG8gYmUgcGFzc2VkIHRvIHRvb2xSZXRyeU1pZGRsZXdhcmVcIik7XG5cdC8qKlxuXHQqIENoZWNrIGlmIHJldHJ5IGxvZ2ljIHNob3VsZCBhcHBseSB0byB0aGlzIHRvb2wuXG5cdCovXG5cdGNvbnN0IHNob3VsZFJldHJ5VG9vbCA9ICh0b29sTmFtZSkgPT4ge1xuXHRcdGlmICh0b29sRmlsdGVyLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHRydWU7XG5cdFx0cmV0dXJuIHRvb2xGaWx0ZXIuaW5jbHVkZXModG9vbE5hbWUpO1xuXHR9O1xuXHQvKipcblx0KiBDaGVjayBpZiB0aGUgZXhjZXB0aW9uIHNob3VsZCB0cmlnZ2VyIGEgcmV0cnkuXG5cdCovXG5cdGNvbnN0IHNob3VsZFJldHJ5RXhjZXB0aW9uID0gKGVycm9yKSA9PiB7XG5cdFx0aWYgKHR5cGVvZiByZXRyeU9uID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiByZXRyeU9uKGVycm9yKTtcblx0XHRyZXR1cm4gcmV0cnlPbi5zb21lKChFcnJvckNvbnN0cnVjdG9yKSA9PiB7XG5cdFx0XHRyZXR1cm4gZXJyb3IgaW5zdGFuY2VvZiBFcnJvckNvbnN0cnVjdG9yO1xuXHRcdH0pO1xuXHR9O1xuXHRjb25zdCBkZWxheUNvbmZpZyA9IHtcblx0XHRiYWNrb2ZmRmFjdG9yLFxuXHRcdGluaXRpYWxEZWxheU1zLFxuXHRcdG1heERlbGF5TXMsXG5cdFx0aml0dGVyXG5cdH07XG5cdC8qKlxuXHQqIEZvcm1hdCB0aGUgZmFpbHVyZSBtZXNzYWdlIHdoZW4gcmV0cmllcyBhcmUgZXhoYXVzdGVkLlxuXHQqL1xuXHRjb25zdCBmb3JtYXRGYWlsdXJlTWVzc2FnZSA9ICh0b29sTmFtZSwgZXJyb3IsIGF0dGVtcHRzTWFkZSkgPT4ge1xuXHRcdGNvbnN0IGVycm9yVHlwZSA9IGVycm9yLmNvbnN0cnVjdG9yLm5hbWU7XG5cdFx0cmV0dXJuIGBUb29sICcke3Rvb2xOYW1lfScgZmFpbGVkIGFmdGVyICR7YXR0ZW1wdHNNYWRlfSAke2F0dGVtcHRzTWFkZSA9PT0gMSA/IFwiYXR0ZW1wdFwiIDogXCJhdHRlbXB0c1wifSB3aXRoICR7ZXJyb3JUeXBlfWA7XG5cdH07XG5cdC8qKlxuXHQqIEhhbmRsZSBmYWlsdXJlIHdoZW4gYWxsIHJldHJpZXMgYXJlIGV4aGF1c3RlZC5cblx0Ki9cblx0Y29uc3QgaGFuZGxlRmFpbHVyZSA9ICh0b29sTmFtZSwgdG9vbENhbGxJZCwgZXJyb3IsIGF0dGVtcHRzTWFkZSkgPT4ge1xuXHRcdGlmIChvbkZhaWx1cmUgPT09IFwiZXJyb3JcIikgdGhyb3cgZXJyb3I7XG5cdFx0bGV0IGNvbnRlbnQ7XG5cdFx0aWYgKHR5cGVvZiBvbkZhaWx1cmUgPT09IFwiZnVuY3Rpb25cIikgY29udGVudCA9IG9uRmFpbHVyZShlcnJvcik7XG5cdFx0ZWxzZSBjb250ZW50ID0gZm9ybWF0RmFpbHVyZU1lc3NhZ2UodG9vbE5hbWUsIGVycm9yLCBhdHRlbXB0c01hZGUpO1xuXHRcdHJldHVybiBuZXcgVG9vbE1lc3NhZ2Uoe1xuXHRcdFx0Y29udGVudCxcblx0XHRcdHRvb2xfY2FsbF9pZDogdG9vbENhbGxJZCxcblx0XHRcdG5hbWU6IHRvb2xOYW1lLFxuXHRcdFx0c3RhdHVzOiBcImVycm9yXCJcblx0XHR9KTtcblx0fTtcblx0cmV0dXJuIGNyZWF0ZU1pZGRsZXdhcmUoe1xuXHRcdG5hbWU6IFwidG9vbFJldHJ5TWlkZGxld2FyZVwiLFxuXHRcdGNvbnRleHRTY2hlbWE6IFRvb2xSZXRyeU1pZGRsZXdhcmVPcHRpb25zU2NoZW1hLFxuXHRcdHdyYXBUb29sQ2FsbDogYXN5bmMgKHJlcXVlc3QsIGhhbmRsZXIpID0+IHtcblx0XHRcdGNvbnN0IHRvb2xOYW1lID0gcmVxdWVzdC50b29sPy5uYW1lID8/IHJlcXVlc3QudG9vbENhbGwubmFtZTtcblx0XHRcdGlmICghc2hvdWxkUmV0cnlUb29sKHRvb2xOYW1lKSkgcmV0dXJuIGhhbmRsZXIocmVxdWVzdCk7XG5cdFx0XHRjb25zdCB0b29sQ2FsbElkID0gcmVxdWVzdC50b29sQ2FsbC5pZCA/PyBcIlwiO1xuXHRcdFx0Zm9yIChsZXQgYXR0ZW1wdCA9IDA7IGF0dGVtcHQgPD0gbWF4UmV0cmllczsgYXR0ZW1wdCsrKSB0cnkge1xuXHRcdFx0XHRyZXR1cm4gYXdhaXQgaGFuZGxlcihyZXF1ZXN0KTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnN0IGF0dGVtcHRzTWFkZSA9IGF0dGVtcHQgKyAxO1xuXHRcdFx0XHRjb25zdCBlcnIgPSBlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09IFwib2JqZWN0XCIgJiYgXCJtZXNzYWdlXCIgaW4gZXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKTtcblx0XHRcdFx0aWYgKCFzaG91bGRSZXRyeUV4Y2VwdGlvbihlcnIpKSByZXR1cm4gaGFuZGxlRmFpbHVyZSh0b29sTmFtZSwgdG9vbENhbGxJZCwgZXJyLCBhdHRlbXB0c01hZGUpO1xuXHRcdFx0XHRpZiAoYXR0ZW1wdCA8IG1heFJldHJpZXMpIHtcblx0XHRcdFx0XHRjb25zdCBkZWxheSA9IGNhbGN1bGF0ZVJldHJ5RGVsYXkoZGVsYXlDb25maWcsIGF0dGVtcHQpO1xuXHRcdFx0XHRcdGlmIChkZWxheSA+IDApIGF3YWl0IHNsZWVwKGRlbGF5KTtcblx0XHRcdFx0fSBlbHNlIHJldHVybiBoYW5kbGVGYWlsdXJlKHRvb2xOYW1lLCB0b29sQ2FsbElkLCBlcnIsIGF0dGVtcHRzTWFkZSk7XG5cdFx0XHR9XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkOiByZXRyeSBsb29wIGNvbXBsZXRlZCB3aXRob3V0IHJldHVybmluZ1wiKTtcblx0XHR9XG5cdH0pO1xufVxuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IHRvb2xSZXRyeU1pZGRsZXdhcmUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRvb2xSZXRyeS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolRetry.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/types.js":
/*!************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/types.js ***!
  \************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MIDDLEWARE_BRAND: () => (/* binding */ MIDDLEWARE_BRAND)\n/* harmony export */ });\n//#region src/agents/middleware/types.ts\n/**\n* Unique symbol used to brand middleware instances.\n* This prevents functions from being accidentally assignable to AgentMiddleware\n* since functions have a 'name' property that would otherwise make them structurally compatible.\n*/\nconst MIDDLEWARE_BRAND = Symbol(\"AgentMiddleware\");\n\n//#endregion\n\n//# sourceMappingURL=types.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS90eXBlcy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDNEI7QUFDNUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS90eXBlcy5qcz9lNTE3Il0sInNvdXJjZXNDb250ZW50IjpbIi8vI3JlZ2lvbiBzcmMvYWdlbnRzL21pZGRsZXdhcmUvdHlwZXMudHNcbi8qKlxuKiBVbmlxdWUgc3ltYm9sIHVzZWQgdG8gYnJhbmQgbWlkZGxld2FyZSBpbnN0YW5jZXMuXG4qIFRoaXMgcHJldmVudHMgZnVuY3Rpb25zIGZyb20gYmVpbmcgYWNjaWRlbnRhbGx5IGFzc2lnbmFibGUgdG8gQWdlbnRNaWRkbGV3YXJlXG4qIHNpbmNlIGZ1bmN0aW9ucyBoYXZlIGEgJ25hbWUnIHByb3BlcnR5IHRoYXQgd291bGQgb3RoZXJ3aXNlIG1ha2UgdGhlbSBzdHJ1Y3R1cmFsbHkgY29tcGF0aWJsZS5cbiovXG5jb25zdCBNSURETEVXQVJFX0JSQU5EID0gU3ltYm9sKFwiQWdlbnRNaWRkbGV3YXJlXCIpO1xuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IE1JRERMRVdBUkVfQlJBTkQgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXR5cGVzLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/types.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js":
/*!************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js ***!
  \************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   calculateRetryDelay: () => (/* binding */ calculateRetryDelay),\n/* harmony export */   countTokensApproximately: () => (/* binding */ countTokensApproximately),\n/* harmony export */   getHookConstraint: () => (/* binding */ getHookConstraint),\n/* harmony export */   getHookFunction: () => (/* binding */ getHookFunction),\n/* harmony export */   sleep: () => (/* binding */ sleep)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_core_tools__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/tools */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/tools/index.js\");\n/* harmony import */ var _langchain_core_utils_function_calling__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/utils/function_calling */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/function_calling.js\");\n\n\n\n\n//#region src/agents/middleware/utils.ts\n/**\n* Default token counter that approximates based on character count.\n*\n* If tools are provided, the token count also includes stringified tool schemas.\n*\n* @param messages Messages to count tokens for\n* @param tools Optional list of tools to include in the token count. Each tool\n*   can be either a LangChain tool instance or a dict representing a tool schema.\n*   LangChain tool instances are converted to OpenAI tool format before counting.\n* @returns Approximate token count\n*/\nfunction countTokensApproximately(messages, tools) {\n\tconst charsPerToken = 4;\n\tlet totalChars = 0;\n\tif (tools && tools.length > 0) {\n\t\tlet toolsChars = 0;\n\t\tfor (const tool of tools) {\n\t\t\tconst toolDict = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_1__.isLangChainTool)(tool) ? (0,_langchain_core_utils_function_calling__WEBPACK_IMPORTED_MODULE_2__.convertToOpenAITool)(tool) : tool;\n\t\t\ttoolsChars += JSON.stringify(toolDict).length;\n\t\t}\n\t\ttotalChars += toolsChars;\n\t}\n\tfor (const msg of messages) {\n\t\tlet textContent;\n\t\tif (typeof msg.content === \"string\") textContent = msg.content;\n\t\telse if (Array.isArray(msg.content)) textContent = msg.content.map((item) => {\n\t\t\tif (typeof item === \"string\") return item;\n\t\t\tif (item.type === \"text\" && \"text\" in item) return item.text;\n\t\t\treturn \"\";\n\t\t}).join(\"\");\n\t\telse textContent = \"\";\n\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage.isInstance(msg) && Array.isArray(msg.tool_calls) && msg.tool_calls.length > 0) textContent += JSON.stringify(msg.tool_calls);\n\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.ToolMessage.isInstance(msg)) textContent += msg.tool_call_id ?? \"\";\n\t\ttotalChars += textContent.length;\n\t}\n\treturn Math.ceil(totalChars / charsPerToken);\n}\nfunction getHookConstraint(hook) {\n\tif (!hook || typeof hook === \"function\") return;\n\treturn hook.canJumpTo;\n}\nfunction getHookFunction(arg) {\n\tif (typeof arg === \"function\") return arg;\n\treturn arg.hook;\n}\n/**\n* Sleep for the specified number of milliseconds.\n*/\nfunction sleep(ms) {\n\treturn new Promise((resolve) => setTimeout(resolve, ms));\n}\n/**\n* Calculate delay for a retry attempt with exponential backoff and jitter.\n*\n* @param retryNumber - The retry attempt number (0-indexed)\n* @param config - Configuration for backoff calculation\n* @returns Delay in milliseconds before next retry\n*\n* @internal Exported for testing purposes\n*/\nfunction calculateRetryDelay(config, retryNumber) {\n\tconst { backoffFactor, initialDelayMs, maxDelayMs, jitter } = config;\n\tlet delay;\n\tif (backoffFactor === 0) delay = initialDelayMs;\n\telse delay = initialDelayMs * backoffFactor ** retryNumber;\n\tdelay = Math.min(delay, maxDelayMs);\n\tif (jitter && delay > 0) {\n\t\tconst jitterAmount = delay * .25;\n\t\tdelay = delay + (Math.random() * 2 - 1) * jitterAmount;\n\t\tdelay = Math.max(0, delay);\n\t}\n\treturn delay;\n}\n\n//#endregion\n\n//# sourceMappingURL=utils.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbWlkZGxld2FyZS91dGlscy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFrRTtBQUNWO0FBQ3FCOztBQUU3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0VBQWUsU0FBUywyRkFBbUI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLE1BQU0sK0RBQVM7QUFDZixNQUFNLGlFQUFXO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxvREFBb0Q7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNvRztBQUNwRyIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL25vZGVfbW9kdWxlcy8ucG5wbS9sYW5nY2hhaW5AMS4yLjI2X0BsYW5nY2hhaW4rY29yZUAxLjEuMjhfb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX19vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fcmVfZXgyYjV5M3R6ZjdoMmN4bW11aTVxb2lhc3kvbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2FnZW50cy9taWRkbGV3YXJlL3V0aWxzLmpzPzhhYmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQUlNZXNzYWdlLCBUb29sTWVzc2FnZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXNcIjtcbmltcG9ydCB7IGlzTGFuZ0NoYWluVG9vbCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvdG9vbHNcIjtcbmltcG9ydCB7IGNvbnZlcnRUb09wZW5BSVRvb2wgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3V0aWxzL2Z1bmN0aW9uX2NhbGxpbmdcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvbWlkZGxld2FyZS91dGlscy50c1xuLyoqXG4qIERlZmF1bHQgdG9rZW4gY291bnRlciB0aGF0IGFwcHJveGltYXRlcyBiYXNlZCBvbiBjaGFyYWN0ZXIgY291bnQuXG4qXG4qIElmIHRvb2xzIGFyZSBwcm92aWRlZCwgdGhlIHRva2VuIGNvdW50IGFsc28gaW5jbHVkZXMgc3RyaW5naWZpZWQgdG9vbCBzY2hlbWFzLlxuKlxuKiBAcGFyYW0gbWVzc2FnZXMgTWVzc2FnZXMgdG8gY291bnQgdG9rZW5zIGZvclxuKiBAcGFyYW0gdG9vbHMgT3B0aW9uYWwgbGlzdCBvZiB0b29scyB0byBpbmNsdWRlIGluIHRoZSB0b2tlbiBjb3VudC4gRWFjaCB0b29sXG4qICAgY2FuIGJlIGVpdGhlciBhIExhbmdDaGFpbiB0b29sIGluc3RhbmNlIG9yIGEgZGljdCByZXByZXNlbnRpbmcgYSB0b29sIHNjaGVtYS5cbiogICBMYW5nQ2hhaW4gdG9vbCBpbnN0YW5jZXMgYXJlIGNvbnZlcnRlZCB0byBPcGVuQUkgdG9vbCBmb3JtYXQgYmVmb3JlIGNvdW50aW5nLlxuKiBAcmV0dXJucyBBcHByb3hpbWF0ZSB0b2tlbiBjb3VudFxuKi9cbmZ1bmN0aW9uIGNvdW50VG9rZW5zQXBwcm94aW1hdGVseShtZXNzYWdlcywgdG9vbHMpIHtcblx0Y29uc3QgY2hhcnNQZXJUb2tlbiA9IDQ7XG5cdGxldCB0b3RhbENoYXJzID0gMDtcblx0aWYgKHRvb2xzICYmIHRvb2xzLmxlbmd0aCA+IDApIHtcblx0XHRsZXQgdG9vbHNDaGFycyA9IDA7XG5cdFx0Zm9yIChjb25zdCB0b29sIG9mIHRvb2xzKSB7XG5cdFx0XHRjb25zdCB0b29sRGljdCA9IGlzTGFuZ0NoYWluVG9vbCh0b29sKSA/IGNvbnZlcnRUb09wZW5BSVRvb2wodG9vbCkgOiB0b29sO1xuXHRcdFx0dG9vbHNDaGFycyArPSBKU09OLnN0cmluZ2lmeSh0b29sRGljdCkubGVuZ3RoO1xuXHRcdH1cblx0XHR0b3RhbENoYXJzICs9IHRvb2xzQ2hhcnM7XG5cdH1cblx0Zm9yIChjb25zdCBtc2cgb2YgbWVzc2FnZXMpIHtcblx0XHRsZXQgdGV4dENvbnRlbnQ7XG5cdFx0aWYgKHR5cGVvZiBtc2cuY29udGVudCA9PT0gXCJzdHJpbmdcIikgdGV4dENvbnRlbnQgPSBtc2cuY29udGVudDtcblx0XHRlbHNlIGlmIChBcnJheS5pc0FycmF5KG1zZy5jb250ZW50KSkgdGV4dENvbnRlbnQgPSBtc2cuY29udGVudC5tYXAoKGl0ZW0pID0+IHtcblx0XHRcdGlmICh0eXBlb2YgaXRlbSA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIGl0ZW07XG5cdFx0XHRpZiAoaXRlbS50eXBlID09PSBcInRleHRcIiAmJiBcInRleHRcIiBpbiBpdGVtKSByZXR1cm4gaXRlbS50ZXh0O1xuXHRcdFx0cmV0dXJuIFwiXCI7XG5cdFx0fSkuam9pbihcIlwiKTtcblx0XHRlbHNlIHRleHRDb250ZW50ID0gXCJcIjtcblx0XHRpZiAoQUlNZXNzYWdlLmlzSW5zdGFuY2UobXNnKSAmJiBBcnJheS5pc0FycmF5KG1zZy50b29sX2NhbGxzKSAmJiBtc2cudG9vbF9jYWxscy5sZW5ndGggPiAwKSB0ZXh0Q29udGVudCArPSBKU09OLnN0cmluZ2lmeShtc2cudG9vbF9jYWxscyk7XG5cdFx0aWYgKFRvb2xNZXNzYWdlLmlzSW5zdGFuY2UobXNnKSkgdGV4dENvbnRlbnQgKz0gbXNnLnRvb2xfY2FsbF9pZCA/PyBcIlwiO1xuXHRcdHRvdGFsQ2hhcnMgKz0gdGV4dENvbnRlbnQubGVuZ3RoO1xuXHR9XG5cdHJldHVybiBNYXRoLmNlaWwodG90YWxDaGFycyAvIGNoYXJzUGVyVG9rZW4pO1xufVxuZnVuY3Rpb24gZ2V0SG9va0NvbnN0cmFpbnQoaG9vaykge1xuXHRpZiAoIWhvb2sgfHwgdHlwZW9mIGhvb2sgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuO1xuXHRyZXR1cm4gaG9vay5jYW5KdW1wVG87XG59XG5mdW5jdGlvbiBnZXRIb29rRnVuY3Rpb24oYXJnKSB7XG5cdGlmICh0eXBlb2YgYXJnID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBhcmc7XG5cdHJldHVybiBhcmcuaG9vaztcbn1cbi8qKlxuKiBTbGVlcCBmb3IgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgbWlsbGlzZWNvbmRzLlxuKi9cbmZ1bmN0aW9uIHNsZWVwKG1zKSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xufVxuLyoqXG4qIENhbGN1bGF0ZSBkZWxheSBmb3IgYSByZXRyeSBhdHRlbXB0IHdpdGggZXhwb25lbnRpYWwgYmFja29mZiBhbmQgaml0dGVyLlxuKlxuKiBAcGFyYW0gcmV0cnlOdW1iZXIgLSBUaGUgcmV0cnkgYXR0ZW1wdCBudW1iZXIgKDAtaW5kZXhlZClcbiogQHBhcmFtIGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gZm9yIGJhY2tvZmYgY2FsY3VsYXRpb25cbiogQHJldHVybnMgRGVsYXkgaW4gbWlsbGlzZWNvbmRzIGJlZm9yZSBuZXh0IHJldHJ5XG4qXG4qIEBpbnRlcm5hbCBFeHBvcnRlZCBmb3IgdGVzdGluZyBwdXJwb3Nlc1xuKi9cbmZ1bmN0aW9uIGNhbGN1bGF0ZVJldHJ5RGVsYXkoY29uZmlnLCByZXRyeU51bWJlcikge1xuXHRjb25zdCB7IGJhY2tvZmZGYWN0b3IsIGluaXRpYWxEZWxheU1zLCBtYXhEZWxheU1zLCBqaXR0ZXIgfSA9IGNvbmZpZztcblx0bGV0IGRlbGF5O1xuXHRpZiAoYmFja29mZkZhY3RvciA9PT0gMCkgZGVsYXkgPSBpbml0aWFsRGVsYXlNcztcblx0ZWxzZSBkZWxheSA9IGluaXRpYWxEZWxheU1zICogYmFja29mZkZhY3RvciAqKiByZXRyeU51bWJlcjtcblx0ZGVsYXkgPSBNYXRoLm1pbihkZWxheSwgbWF4RGVsYXlNcyk7XG5cdGlmIChqaXR0ZXIgJiYgZGVsYXkgPiAwKSB7XG5cdFx0Y29uc3Qgaml0dGVyQW1vdW50ID0gZGVsYXkgKiAuMjU7XG5cdFx0ZGVsYXkgPSBkZWxheSArIChNYXRoLnJhbmRvbSgpICogMiAtIDEpICogaml0dGVyQW1vdW50O1xuXHRcdGRlbGF5ID0gTWF0aC5tYXgoMCwgZGVsYXkpO1xuXHR9XG5cdHJldHVybiBkZWxheTtcbn1cblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyBjYWxjdWxhdGVSZXRyeURlbGF5LCBjb3VudFRva2Vuc0FwcHJveGltYXRlbHksIGdldEhvb2tDb25zdHJhaW50LCBnZXRIb29rRnVuY3Rpb24sIHNsZWVwIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/model.js":
/*!*************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/model.js ***!
  \*************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isBaseChatModel: () => (/* binding */ isBaseChatModel),\n/* harmony export */   isConfigurableModel: () => (/* binding */ isConfigurableModel)\n/* harmony export */ });\n//#region src/agents/model.ts\nfunction isBaseChatModel(model) {\n\treturn \"invoke\" in model && typeof model.invoke === \"function\" && \"_streamResponseChunks\" in model;\n}\nfunction isConfigurableModel(model) {\n\treturn typeof model === \"object\" && model != null && \"_queuedMethodOperations\" in model && \"_getModelInstance\" in model && typeof model._getModelInstance === \"function\";\n}\n\n//#endregion\n\n//# sourceMappingURL=model.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbW9kZWwuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNnRDtBQUNoRCIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL25vZGVfbW9kdWxlcy8ucG5wbS9sYW5nY2hhaW5AMS4yLjI2X0BsYW5nY2hhaW4rY29yZUAxLjEuMjhfb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX19vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fcmVfZXgyYjV5M3R6ZjdoMmN4bW11aTVxb2lhc3kvbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2FnZW50cy9tb2RlbC5qcz82MzcwIl0sInNvdXJjZXNDb250ZW50IjpbIi8vI3JlZ2lvbiBzcmMvYWdlbnRzL21vZGVsLnRzXG5mdW5jdGlvbiBpc0Jhc2VDaGF0TW9kZWwobW9kZWwpIHtcblx0cmV0dXJuIFwiaW52b2tlXCIgaW4gbW9kZWwgJiYgdHlwZW9mIG1vZGVsLmludm9rZSA9PT0gXCJmdW5jdGlvblwiICYmIFwiX3N0cmVhbVJlc3BvbnNlQ2h1bmtzXCIgaW4gbW9kZWw7XG59XG5mdW5jdGlvbiBpc0NvbmZpZ3VyYWJsZU1vZGVsKG1vZGVsKSB7XG5cdHJldHVybiB0eXBlb2YgbW9kZWwgPT09IFwib2JqZWN0XCIgJiYgbW9kZWwgIT0gbnVsbCAmJiBcIl9xdWV1ZWRNZXRob2RPcGVyYXRpb25zXCIgaW4gbW9kZWwgJiYgXCJfZ2V0TW9kZWxJbnN0YW5jZVwiIGluIG1vZGVsICYmIHR5cGVvZiBtb2RlbC5fZ2V0TW9kZWxJbnN0YW5jZSA9PT0gXCJmdW5jdGlvblwiO1xufVxuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IGlzQmFzZUNoYXRNb2RlbCwgaXNDb25maWd1cmFibGVNb2RlbCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kZWwuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/model.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AfterAgentNode.js":
/*!****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AfterAgentNode.js ***!
  \****************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AfterAgentNode: () => (/* binding */ AfterAgentNode)\n/* harmony export */ });\n/* harmony import */ var _middleware_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/middleware.js\");\n\n\n\n//#region src/agents/nodes/AfterAgentNode.ts\n/**\n* Node for executing a single middleware's afterAgent hook.\n*/\nvar AfterAgentNode = class extends _middleware_js__WEBPACK_IMPORTED_MODULE_1__.MiddlewareNode {\n\tlc_namespace = [\n\t\t\"langchain\",\n\t\t\"agents\",\n\t\t\"afterAgentNodes\"\n\t];\n\tconstructor(middleware, options) {\n\t\tsuper({\n\t\t\tname: `AfterAgentNode_${middleware.name}`,\n\t\t\tfunc: async (state, config) => this.invokeMiddleware(state, config)\n\t\t}, options);\n\t\tthis.middleware = middleware;\n\t}\n\trunHook(state, runtime) {\n\t\treturn (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_0__.getHookFunction)(this.middleware.afterAgent)(state, runtime);\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=AfterAgentNode.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvQWZ0ZXJBZ2VudE5vZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXlEO0FBQ1I7O0FBRWpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDBEQUFjO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGdCQUFnQjtBQUMzQztBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxTQUFTLHFFQUFlO0FBQ3hCO0FBQ0E7O0FBRUE7QUFDMEI7QUFDMUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvQWZ0ZXJBZ2VudE5vZGUuanM/NmUyYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRIb29rRnVuY3Rpb24gfSBmcm9tIFwiLi4vbWlkZGxld2FyZS91dGlscy5qc1wiO1xuaW1wb3J0IHsgTWlkZGxld2FyZU5vZGUgfSBmcm9tIFwiLi9taWRkbGV3YXJlLmpzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL25vZGVzL0FmdGVyQWdlbnROb2RlLnRzXG4vKipcbiogTm9kZSBmb3IgZXhlY3V0aW5nIGEgc2luZ2xlIG1pZGRsZXdhcmUncyBhZnRlckFnZW50IGhvb2suXG4qL1xudmFyIEFmdGVyQWdlbnROb2RlID0gY2xhc3MgZXh0ZW5kcyBNaWRkbGV3YXJlTm9kZSB7XG5cdGxjX25hbWVzcGFjZSA9IFtcblx0XHRcImxhbmdjaGFpblwiLFxuXHRcdFwiYWdlbnRzXCIsXG5cdFx0XCJhZnRlckFnZW50Tm9kZXNcIlxuXHRdO1xuXHRjb25zdHJ1Y3RvcihtaWRkbGV3YXJlLCBvcHRpb25zKSB7XG5cdFx0c3VwZXIoe1xuXHRcdFx0bmFtZTogYEFmdGVyQWdlbnROb2RlXyR7bWlkZGxld2FyZS5uYW1lfWAsXG5cdFx0XHRmdW5jOiBhc3luYyAoc3RhdGUsIGNvbmZpZykgPT4gdGhpcy5pbnZva2VNaWRkbGV3YXJlKHN0YXRlLCBjb25maWcpXG5cdFx0fSwgb3B0aW9ucyk7XG5cdFx0dGhpcy5taWRkbGV3YXJlID0gbWlkZGxld2FyZTtcblx0fVxuXHRydW5Ib29rKHN0YXRlLCBydW50aW1lKSB7XG5cdFx0cmV0dXJuIGdldEhvb2tGdW5jdGlvbih0aGlzLm1pZGRsZXdhcmUuYWZ0ZXJBZ2VudCkoc3RhdGUsIHJ1bnRpbWUpO1xuXHR9XG59O1xuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IEFmdGVyQWdlbnROb2RlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1BZnRlckFnZW50Tm9kZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AfterAgentNode.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AfterModelNode.js":
/*!****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AfterModelNode.js ***!
  \****************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AfterModelNode: () => (/* binding */ AfterModelNode)\n/* harmony export */ });\n/* harmony import */ var _middleware_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/middleware.js\");\n\n\n\n//#region src/agents/nodes/AfterModelNode.ts\n/**\n* Node for executing a single middleware's afterModel hook.\n*/\nvar AfterModelNode = class extends _middleware_js__WEBPACK_IMPORTED_MODULE_1__.MiddlewareNode {\n\tlc_namespace = [\n\t\t\"langchain\",\n\t\t\"agents\",\n\t\t\"afterModelNodes\"\n\t];\n\tconstructor(middleware, options) {\n\t\tsuper({\n\t\t\tname: `AfterModelNode_${middleware.name}`,\n\t\t\tfunc: async (state, config) => this.invokeMiddleware(state, config)\n\t\t}, options);\n\t\tthis.middleware = middleware;\n\t}\n\trunHook(state, runtime) {\n\t\treturn (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_0__.getHookFunction)(this.middleware.afterModel)(state, runtime);\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=AfterModelNode.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvQWZ0ZXJNb2RlbE5vZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXlEO0FBQ1I7O0FBRWpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDBEQUFjO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGdCQUFnQjtBQUMzQztBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxTQUFTLHFFQUFlO0FBQ3hCO0FBQ0E7O0FBRUE7QUFDMEI7QUFDMUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvQWZ0ZXJNb2RlbE5vZGUuanM/NTBjMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRIb29rRnVuY3Rpb24gfSBmcm9tIFwiLi4vbWlkZGxld2FyZS91dGlscy5qc1wiO1xuaW1wb3J0IHsgTWlkZGxld2FyZU5vZGUgfSBmcm9tIFwiLi9taWRkbGV3YXJlLmpzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL25vZGVzL0FmdGVyTW9kZWxOb2RlLnRzXG4vKipcbiogTm9kZSBmb3IgZXhlY3V0aW5nIGEgc2luZ2xlIG1pZGRsZXdhcmUncyBhZnRlck1vZGVsIGhvb2suXG4qL1xudmFyIEFmdGVyTW9kZWxOb2RlID0gY2xhc3MgZXh0ZW5kcyBNaWRkbGV3YXJlTm9kZSB7XG5cdGxjX25hbWVzcGFjZSA9IFtcblx0XHRcImxhbmdjaGFpblwiLFxuXHRcdFwiYWdlbnRzXCIsXG5cdFx0XCJhZnRlck1vZGVsTm9kZXNcIlxuXHRdO1xuXHRjb25zdHJ1Y3RvcihtaWRkbGV3YXJlLCBvcHRpb25zKSB7XG5cdFx0c3VwZXIoe1xuXHRcdFx0bmFtZTogYEFmdGVyTW9kZWxOb2RlXyR7bWlkZGxld2FyZS5uYW1lfWAsXG5cdFx0XHRmdW5jOiBhc3luYyAoc3RhdGUsIGNvbmZpZykgPT4gdGhpcy5pbnZva2VNaWRkbGV3YXJlKHN0YXRlLCBjb25maWcpXG5cdFx0fSwgb3B0aW9ucyk7XG5cdFx0dGhpcy5taWRkbGV3YXJlID0gbWlkZGxld2FyZTtcblx0fVxuXHRydW5Ib29rKHN0YXRlLCBydW50aW1lKSB7XG5cdFx0cmV0dXJuIGdldEhvb2tGdW5jdGlvbih0aGlzLm1pZGRsZXdhcmUuYWZ0ZXJNb2RlbCkoc3RhdGUsIHJ1bnRpbWUpO1xuXHR9XG59O1xuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IEFmdGVyTW9kZWxOb2RlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1BZnRlck1vZGVsTm9kZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AfterModelNode.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AgentNode.js":
/*!***********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AgentNode.js ***!
  \***********************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AGENT_NODE_NAME: () => (/* binding */ AGENT_NODE_NAME),\n/* harmony export */   AgentNode: () => (/* binding */ AgentNode)\n/* harmony export */ });\n/* harmony import */ var _chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chat_models/universal.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js\");\n/* harmony import */ var _errors_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../errors.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/errors.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/utils.js\");\n/* harmony import */ var _RunnableCallable_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../RunnableCallable.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/RunnableCallable.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/utils.js\");\n/* harmony import */ var _withAgentName_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../withAgentName.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/withAgentName.js\");\n/* harmony import */ var _responses_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../responses.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/responses.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/runnables/index.js\");\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n/* harmony import */ var _langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @langchain/core/utils/types */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/types/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n//#region src/agents/nodes/AgentNode.ts\n/**\n* Check if the response is an internal model response.\n* @param response - The response to check.\n* @returns True if the response is an internal model response, false otherwise.\n*/\nfunction isInternalModelResponse(response) {\n\treturn _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.AIMessage.isInstance(response) || (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.isCommand)(response) || typeof response === \"object\" && response !== null && \"structuredResponse\" in response && \"messages\" in response;\n}\n/**\n* The name of the agent node in the state graph.\n*/\nconst AGENT_NODE_NAME = \"model_request\";\nvar AgentNode = class extends _RunnableCallable_js__WEBPACK_IMPORTED_MODULE_3__.RunnableCallable {\n\t#options;\n\t#systemMessage;\n\tconstructor(options) {\n\t\tsuper({\n\t\t\tname: options.name ?? \"model\",\n\t\t\tfunc: (input, config) => this.#run(input, config)\n\t\t});\n\t\tthis.#options = options;\n\t\tthis.#systemMessage = options.systemMessage;\n\t}\n\t/**\n\t* Returns response format primtivies based on given model and response format provided by the user.\n\t*\n\t* If the user selects a tool output:\n\t* - return a record of tools to extract structured output from the model's response\n\t*\n\t* if the the user selects a native schema output or if the model supports JSON schema output:\n\t* - return a provider strategy to extract structured output from the model's response\n\t*\n\t* @param model - The model to get the response format for.\n\t* @returns The response format.\n\t*/\n\t#getResponseFormat(model) {\n\t\tif (!this.#options.responseFormat) return;\n\t\tconst strategies = (0,_responses_js__WEBPACK_IMPORTED_MODULE_6__.transformResponseFormat)(this.#options.responseFormat, void 0, model);\n\t\t/**\n\t\t* Populate a list of structured tool info.\n\t\t*/\n\t\tif (!strategies.every((format) => format instanceof _responses_js__WEBPACK_IMPORTED_MODULE_6__.ProviderStrategy)) return {\n\t\t\ttype: \"tool\",\n\t\t\ttools: strategies.filter((format) => format instanceof _responses_js__WEBPACK_IMPORTED_MODULE_6__.ToolStrategy).reduce((acc, format) => {\n\t\t\t\tacc[format.name] = format;\n\t\t\t\treturn acc;\n\t\t\t}, {})\n\t\t};\n\t\treturn {\n\t\t\ttype: \"native\",\n\t\t\tstrategy: strategies[0]\n\t\t};\n\t}\n\tasync #run(state, config) {\n\t\t/**\n\t\t* Check if we just executed a returnDirect tool\n\t\t* If so, we should generate structured response (if needed) and stop\n\t\t*/\n\t\tconst lastMessage = state.messages.at(-1);\n\t\tif (lastMessage && _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.ToolMessage.isInstance(lastMessage) && lastMessage.name && this.#options.shouldReturnDirect.has(lastMessage.name)) return [new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.Command({ update: { messages: [] } })];\n\t\tconst { response, lastAiMessage, collectedCommands } = await this.#invokeModel(state, config);\n\t\t/**\n\t\t* structuredResponse â return as a plain state update dict (not a Command)\n\t\t* because the structuredResponse channel uses UntrackedValue(guard=true)\n\t\t* which only allows a single write per step.\n\t\t*/\n\t\tif (typeof response === \"object\" && response !== null && \"structuredResponse\" in response && \"messages\" in response) {\n\t\t\tconst { structuredResponse, messages } = response;\n\t\t\treturn {\n\t\t\t\tmessages: [...state.messages, ...messages],\n\t\t\t\tstructuredResponse\n\t\t\t};\n\t\t}\n\t\tconst commands = [];\n\t\tconst aiMessage = _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.AIMessage.isInstance(response) ? response : lastAiMessage;\n\t\tif (aiMessage) {\n\t\t\taiMessage.name = this.name;\n\t\t\taiMessage.lc_kwargs.name = this.name;\n\t\t\tif (this.#areMoreStepsNeeded(state, aiMessage)) commands.push(new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.Command({ update: { messages: [new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.AIMessage({\n\t\t\t\tcontent: \"Sorry, need more steps to process this request.\",\n\t\t\t\tname: this.name,\n\t\t\t\tid: aiMessage.id\n\t\t\t})] } }));\n\t\t\telse commands.push(new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.Command({ update: { messages: [aiMessage] } }));\n\t\t}\n\t\tif ((0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.isCommand)(response) && !collectedCommands.includes(response)) commands.push(response);\n\t\tcommands.push(...collectedCommands);\n\t\treturn commands;\n\t}\n\t/**\n\t* Derive the model from the options.\n\t* @param state - The state of the agent.\n\t* @param config - The config of the agent.\n\t* @returns The model.\n\t*/\n\t#deriveModel() {\n\t\tif (typeof this.#options.model === \"string\") return (0,_chat_models_universal_js__WEBPACK_IMPORTED_MODULE_0__.initChatModel)(this.#options.model);\n\t\tif (this.#options.model) return this.#options.model;\n\t\tthrow new Error(\"No model option was provided, either via `model` option.\");\n\t}\n\tasync #invokeModel(state, config, options = {}) {\n\t\tconst model = await this.#deriveModel();\n\t\tconst lgConfig = config;\n\t\t/**\n\t\t* Create a local variable for current system message to avoid concurrency issues\n\t\t* Each invocation gets its own copy\n\t\t*/\n\t\tlet currentSystemMessage = this.#systemMessage;\n\t\t/**\n\t\t* Shared tracking state for AIMessage and Command collection.\n\t\t* lastAiMessage tracks the effective AIMessage through the middleware chain.\n\t\t* collectedCommands accumulates Commands returned by middleware (not base handler).\n\t\t*/\n\t\tlet lastAiMessage = null;\n\t\tconst collectedCommands = [];\n\t\t/**\n\t\t* Create the base handler that performs the actual model invocation\n\t\t*/\n\t\tconst baseHandler = async (request) => {\n\t\t\t/**\n\t\t\t* Check if the LLM already has bound tools and throw if it does.\n\t\t\t*/\n\t\t\t(0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.validateLLMHasNoBoundTools)(request.model);\n\t\t\tconst structuredResponseFormat = this.#getResponseFormat(request.model);\n\t\t\tconst modelWithTools = await this.#bindTools(request.model, request, structuredResponseFormat);\n\t\t\t/**\n\t\t\t* prepend the system message to the messages if it is not empty\n\t\t\t*/\n\t\t\tconst messages = [...currentSystemMessage.text === \"\" ? [] : [currentSystemMessage], ...request.messages];\n\t\t\tconst signal = (0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.mergeAbortSignals)(this.#options.signal, config.signal);\n\t\t\tconst response = await (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_8__.raceWithSignal)(modelWithTools.invoke(messages, {\n\t\t\t\t...config,\n\t\t\t\tsignal\n\t\t\t}), signal);\n\t\t\tlastAiMessage = response;\n\t\t\t/**\n\t\t\t* if the user requests a native schema output, try to parse the response\n\t\t\t* and return the structured response if it is valid\n\t\t\t*/\n\t\t\tif (structuredResponseFormat?.type === \"native\") {\n\t\t\t\tconst structuredResponse = structuredResponseFormat.strategy.parse(response);\n\t\t\t\tif (structuredResponse) return {\n\t\t\t\t\tstructuredResponse,\n\t\t\t\t\tmessages: [response]\n\t\t\t\t};\n\t\t\t\treturn response;\n\t\t\t}\n\t\t\tif (!structuredResponseFormat || !response.tool_calls) return response;\n\t\t\tconst toolCalls = response.tool_calls.filter((call) => call.name in structuredResponseFormat.tools);\n\t\t\t/**\n\t\t\t* if there were not structured tool calls, we can return the response\n\t\t\t*/\n\t\t\tif (toolCalls.length === 0) return response;\n\t\t\t/**\n\t\t\t* if there were multiple structured tool calls, we should throw an error as this\n\t\t\t* scenario is not defined/supported.\n\t\t\t*/\n\t\t\tif (toolCalls.length > 1) return this.#handleMultipleStructuredOutputs(response, toolCalls, structuredResponseFormat);\n\t\t\tconst toolMessageContent = structuredResponseFormat.tools[toolCalls[0].name]?.options?.toolMessageContent;\n\t\t\treturn this.#handleSingleStructuredOutput(response, toolCalls[0], structuredResponseFormat, toolMessageContent ?? options.lastMessage);\n\t\t};\n\t\tconst wrapperMiddleware = this.#options.wrapModelCallHookMiddleware ?? [];\n\t\tlet wrappedHandler = baseHandler;\n\t\t/**\n\t\t* Build composed handler from last to first so first middleware becomes outermost\n\t\t*/\n\t\tfor (let i = wrapperMiddleware.length - 1; i >= 0; i--) {\n\t\t\tconst [middleware, getMiddlewareState] = wrapperMiddleware[i];\n\t\t\tif (middleware.wrapModelCall) {\n\t\t\t\tconst innerHandler = wrappedHandler;\n\t\t\t\tconst currentMiddleware = middleware;\n\t\t\t\tconst currentGetState = getMiddlewareState;\n\t\t\t\twrappedHandler = async (request) => {\n\t\t\t\t\tconst baselineSystemMessage = currentSystemMessage;\n\t\t\t\t\t/**\n\t\t\t\t\t* Merge context with default context of middleware\n\t\t\t\t\t*/\n\t\t\t\t\tconst context = currentMiddleware.contextSchema ? (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_10__.interopParse)(currentMiddleware.contextSchema, lgConfig?.context || {}) : lgConfig?.context;\n\t\t\t\t\t/**\n\t\t\t\t\t* Create runtime\n\t\t\t\t\t*/\n\t\t\t\t\tconst runtime = Object.freeze({\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t\twriter: lgConfig.writer,\n\t\t\t\t\t\tinterrupt: lgConfig.interrupt,\n\t\t\t\t\t\tsignal: lgConfig.signal\n\t\t\t\t\t});\n\t\t\t\t\t/**\n\t\t\t\t\t* Create the request with state and runtime\n\t\t\t\t\t*/\n\t\t\t\t\tconst requestWithStateAndRuntime = {\n\t\t\t\t\t\t...request,\n\t\t\t\t\t\tstate: {\n\t\t\t\t\t\t\t...middleware.stateSchema ? (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_10__.interopParse)((0,_utils_js__WEBPACK_IMPORTED_MODULE_4__.toPartialZodObject)(middleware.stateSchema), state) : {},\n\t\t\t\t\t\t\t...currentGetState(),\n\t\t\t\t\t\t\tmessages: state.messages\n\t\t\t\t\t\t},\n\t\t\t\t\t\truntime\n\t\t\t\t\t};\n\t\t\t\t\t/**\n\t\t\t\t\t* Create handler that validates tools and calls the inner handler\n\t\t\t\t\t*/\n\t\t\t\t\tconst handlerWithValidation = async (req) => {\n\t\t\t\t\t\tcurrentSystemMessage = baselineSystemMessage;\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t* Verify that the user didn't add any new tools.\n\t\t\t\t\t\t* We can't allow this as the ToolNode is already initiated with given tools.\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tconst modifiedTools = req.tools ?? [];\n\t\t\t\t\t\tconst newTools = modifiedTools.filter((tool) => (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.isClientTool)(tool) && !this.#options.toolClasses.some((t) => t.name === tool.name));\n\t\t\t\t\t\tif (newTools.length > 0) throw new Error(`You have added a new tool in \"wrapModelCall\" hook of middleware \"${currentMiddleware.name}\": ${newTools.map((tool) => tool.name).join(\", \")}. This is not supported.`);\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t* Verify that user has not added or modified a tool with the same name.\n\t\t\t\t\t\t* We can't allow this as the ToolNode is already initiated with given tools.\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tconst invalidTools = modifiedTools.filter((tool) => (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.isClientTool)(tool) && this.#options.toolClasses.every((t) => t !== tool));\n\t\t\t\t\t\tif (invalidTools.length > 0) throw new Error(`You have modified a tool in \"wrapModelCall\" hook of middleware \"${currentMiddleware.name}\": ${invalidTools.map((tool) => tool.name).join(\", \")}. This is not supported.`);\n\t\t\t\t\t\tlet normalizedReq = req;\n\t\t\t\t\t\tconst hasSystemPromptChanged = req.systemPrompt !== currentSystemMessage.text;\n\t\t\t\t\t\tconst hasSystemMessageChanged = req.systemMessage !== currentSystemMessage;\n\t\t\t\t\t\tif (hasSystemPromptChanged && hasSystemMessageChanged) throw new Error(\"Cannot change both systemPrompt and systemMessage in the same request.\");\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t* Check if systemPrompt is a string was changed, if so create a new SystemMessage\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tif (hasSystemPromptChanged) {\n\t\t\t\t\t\t\tcurrentSystemMessage = new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.SystemMessage({ content: [{\n\t\t\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\t\t\ttext: req.systemPrompt\n\t\t\t\t\t\t\t}] });\n\t\t\t\t\t\t\tnormalizedReq = {\n\t\t\t\t\t\t\t\t...req,\n\t\t\t\t\t\t\t\tsystemPrompt: currentSystemMessage.text,\n\t\t\t\t\t\t\t\tsystemMessage: currentSystemMessage\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t* If the systemMessage was changed, update the current system message\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tif (hasSystemMessageChanged) {\n\t\t\t\t\t\t\tcurrentSystemMessage = new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.SystemMessage({ ...req.systemMessage });\n\t\t\t\t\t\t\tnormalizedReq = {\n\t\t\t\t\t\t\t\t...req,\n\t\t\t\t\t\t\t\tsystemPrompt: currentSystemMessage.text,\n\t\t\t\t\t\t\t\tsystemMessage: currentSystemMessage\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst innerHandlerResult = await innerHandler(normalizedReq);\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t* Normalize Commands so middleware always sees AIMessage from handler().\n\t\t\t\t\t\t* When an inner middleware returns a Command, substitute the tracked\n\t\t\t\t\t\t* lastAiMessage. The raw Command is still captured in innerHandlerResult\n\t\t\t\t\t\t* for the framework's Command collection.\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tif ((0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.isCommand)(innerHandlerResult) && lastAiMessage) return lastAiMessage;\n\t\t\t\t\t\treturn innerHandlerResult;\n\t\t\t\t\t};\n\t\t\t\t\tif (!currentMiddleware.wrapModelCall) return handlerWithValidation(requestWithStateAndRuntime);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst middlewareResponse = await currentMiddleware.wrapModelCall(requestWithStateAndRuntime, handlerWithValidation);\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t* Validate that this specific middleware returned a valid response\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tif (!isInternalModelResponse(middlewareResponse)) throw new Error(`Invalid response from \"wrapModelCall\" in middleware \"${currentMiddleware.name}\": expected AIMessage or Command, got ${typeof middlewareResponse}`);\n\t\t\t\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.AIMessage.isInstance(middlewareResponse)) lastAiMessage = middlewareResponse;\n\t\t\t\t\t\telse if ((0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.isCommand)(middlewareResponse)) collectedCommands.push(middlewareResponse);\n\t\t\t\t\t\treturn middlewareResponse;\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tthrow _errors_js__WEBPACK_IMPORTED_MODULE_1__.MiddlewareError.wrap(error, currentMiddleware.name);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t* Execute the wrapped handler with the initial request\n\t\t* Reset current system prompt to initial state and convert to string using .text getter\n\t\t* for backwards compatibility with ModelRequest\n\t\t*/\n\t\tcurrentSystemMessage = this.#systemMessage;\n\t\tconst initialRequest = {\n\t\t\tmodel,\n\t\t\tsystemPrompt: currentSystemMessage?.text,\n\t\t\tsystemMessage: currentSystemMessage,\n\t\t\tmessages: state.messages,\n\t\t\ttools: this.#options.toolClasses,\n\t\t\tstate,\n\t\t\truntime: Object.freeze({\n\t\t\t\tcontext: lgConfig?.context,\n\t\t\t\twriter: lgConfig.writer,\n\t\t\t\tinterrupt: lgConfig.interrupt,\n\t\t\t\tsignal: lgConfig.signal\n\t\t\t})\n\t\t};\n\t\treturn {\n\t\t\tresponse: await wrappedHandler(initialRequest),\n\t\t\tlastAiMessage,\n\t\t\tcollectedCommands\n\t\t};\n\t}\n\t/**\n\t* If the model returns multiple structured outputs, we need to handle it.\n\t* @param response - The response from the model\n\t* @param toolCalls - The tool calls that were made\n\t* @returns The response from the model\n\t*/\n\t#handleMultipleStructuredOutputs(response, toolCalls, responseFormat) {\n\t\tconst multipleStructuredOutputsError = new _errors_js__WEBPACK_IMPORTED_MODULE_1__.MultipleStructuredOutputsError(toolCalls.map((call) => call.name));\n\t\treturn this.#handleToolStrategyError(multipleStructuredOutputsError, response, toolCalls[0], responseFormat);\n\t}\n\t/**\n\t* If the model returns a single structured output, we need to handle it.\n\t* @param toolCall - The tool call that was made\n\t* @returns The structured response and a message to the LLM if needed\n\t*/\n\t#handleSingleStructuredOutput(response, toolCall, responseFormat, lastMessage) {\n\t\tconst tool = responseFormat.tools[toolCall.name];\n\t\ttry {\n\t\t\tconst structuredResponse = tool.parse(toolCall.args);\n\t\t\treturn {\n\t\t\t\tstructuredResponse,\n\t\t\t\tmessages: [\n\t\t\t\t\tresponse,\n\t\t\t\t\tnew _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.ToolMessage({\n\t\t\t\t\t\ttool_call_id: toolCall.id ?? \"\",\n\t\t\t\t\t\tcontent: JSON.stringify(structuredResponse),\n\t\t\t\t\t\tname: toolCall.name\n\t\t\t\t\t}),\n\t\t\t\t\tnew _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.AIMessage(lastMessage ?? `Returning structured response: ${JSON.stringify(structuredResponse)}`)\n\t\t\t\t]\n\t\t\t};\n\t\t} catch (error) {\n\t\t\treturn this.#handleToolStrategyError(error, response, toolCall, responseFormat);\n\t\t}\n\t}\n\tasync #handleToolStrategyError(error, response, toolCall, responseFormat) {\n\t\t/**\n\t\t* Using the `errorHandler` option of the first `ToolStrategy` entry is sufficient here.\n\t\t* There is technically only one `ToolStrategy` entry in `structuredToolInfo` if the user\n\t\t* uses `toolStrategy` to define the response format. If the user applies a list of json\n\t\t* schema objects, these will be transformed into multiple `ToolStrategy` entries but all\n\t\t* with the same `handleError` option.\n\t\t*/\n\t\tconst errorHandler = Object.values(responseFormat.tools).at(0)?.options?.handleError;\n\t\tconst toolCallId = toolCall.id;\n\t\tif (!toolCallId) throw new Error(\"Tool call ID is required to handle tool output errors. Please provide a tool call ID.\");\n\t\t/**\n\t\t* Default behavior: retry if `errorHandler` is undefined or truthy.\n\t\t* Only throw if explicitly set to `false`.\n\t\t*/\n\t\tif (errorHandler === false) throw error;\n\t\t/**\n\t\t* retry if:\n\t\t*/\n\t\tif (errorHandler === void 0 || typeof errorHandler === \"boolean\" && errorHandler || Array.isArray(errorHandler) && errorHandler.some((h) => h instanceof _errors_js__WEBPACK_IMPORTED_MODULE_1__.MultipleStructuredOutputsError)) return new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.Command({\n\t\t\tupdate: { messages: [response, new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.ToolMessage({\n\t\t\t\tcontent: error.message,\n\t\t\t\ttool_call_id: toolCallId\n\t\t\t})] },\n\t\t\tgoto: AGENT_NODE_NAME\n\t\t});\n\t\t/**\n\t\t* if `errorHandler` is a string, retry the tool call with given string\n\t\t*/\n\t\tif (typeof errorHandler === \"string\") return new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.Command({\n\t\t\tupdate: { messages: [response, new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.ToolMessage({\n\t\t\t\tcontent: errorHandler,\n\t\t\t\ttool_call_id: toolCallId\n\t\t\t})] },\n\t\t\tgoto: AGENT_NODE_NAME\n\t\t});\n\t\t/**\n\t\t* if `errorHandler` is a function, retry the tool call with the function\n\t\t*/\n\t\tif (typeof errorHandler === \"function\") {\n\t\t\tconst content = await errorHandler(error);\n\t\t\tif (typeof content !== \"string\") throw new Error(\"Error handler must return a string.\");\n\t\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.Command({\n\t\t\t\tupdate: { messages: [response, new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.ToolMessage({\n\t\t\t\t\tcontent,\n\t\t\t\t\ttool_call_id: toolCallId\n\t\t\t\t})] },\n\t\t\t\tgoto: AGENT_NODE_NAME\n\t\t\t});\n\t\t}\n\t\t/**\n\t\t* Default: retry if we reach here\n\t\t*/\n\t\treturn new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.Command({\n\t\t\tupdate: { messages: [response, new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.ToolMessage({\n\t\t\t\tcontent: error.message,\n\t\t\t\ttool_call_id: toolCallId\n\t\t\t})] },\n\t\t\tgoto: AGENT_NODE_NAME\n\t\t});\n\t}\n\t#areMoreStepsNeeded(state, response) {\n\t\tconst allToolsReturnDirect = _langchain_core_messages__WEBPACK_IMPORTED_MODULE_7__.AIMessage.isInstance(response) && response.tool_calls?.every((call) => this.#options.shouldReturnDirect.has(call.name));\n\t\tconst remainingSteps = \"remainingSteps\" in state ? state.remainingSteps : void 0;\n\t\treturn Boolean(remainingSteps && (remainingSteps < 1 && allToolsReturnDirect || remainingSteps < 2 && (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.hasToolCalls)(state.messages.at(-1))));\n\t}\n\tasync #bindTools(model, preparedOptions, structuredResponseFormat) {\n\t\tconst options = {};\n\t\tconst structuredTools = Object.values(structuredResponseFormat && \"tools\" in structuredResponseFormat ? structuredResponseFormat.tools : {});\n\t\t/**\n\t\t* Use tools from preparedOptions if provided, otherwise use default tools\n\t\t*/\n\t\tconst allTools = [...preparedOptions?.tools ?? this.#options.toolClasses, ...structuredTools.map((toolStrategy) => toolStrategy.tool)];\n\t\t/**\n\t\t* If there are structured tools, we need to set the tool choice to \"any\"\n\t\t* so that the model can choose to use a structured tool or not.\n\t\t*/\n\t\tconst toolChoice = preparedOptions?.toolChoice || (structuredTools.length > 0 ? \"any\" : void 0);\n\t\t/**\n\t\t* check if the user requests a native schema output\n\t\t*/\n\t\tif (structuredResponseFormat?.type === \"native\") {\n\t\t\tconst resolvedStrict = preparedOptions?.modelSettings?.strict ?? structuredResponseFormat?.strategy?.strict ?? true;\n\t\t\tconst jsonSchemaParams = {\n\t\t\t\tname: structuredResponseFormat.strategy.schema?.name ?? \"extract\",\n\t\t\t\tdescription: (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_10__.getSchemaDescription)(structuredResponseFormat.strategy.schema),\n\t\t\t\tschema: structuredResponseFormat.strategy.schema,\n\t\t\t\tstrict: resolvedStrict\n\t\t\t};\n\t\t\tObject.assign(options, {\n\t\t\t\tresponse_format: {\n\t\t\t\t\ttype: \"json_schema\",\n\t\t\t\t\tjson_schema: jsonSchemaParams\n\t\t\t\t},\n\t\t\t\toutputConfig: { format: {\n\t\t\t\t\ttype: \"json_schema\",\n\t\t\t\t\tschema: structuredResponseFormat.strategy.schema\n\t\t\t\t} },\n\t\t\t\tls_structured_output_format: {\n\t\t\t\t\tkwargs: { method: \"json_schema\" },\n\t\t\t\t\tschema: structuredResponseFormat.strategy.schema\n\t\t\t\t},\n\t\t\t\tstrict: resolvedStrict\n\t\t\t});\n\t\t}\n\t\t/**\n\t\t* Bind tools to the model if they are not already bound.\n\t\t*/\n\t\tconst modelWithTools = await (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.bindTools)(model, allTools, {\n\t\t\t...options,\n\t\t\t...preparedOptions?.modelSettings,\n\t\t\ttool_choice: toolChoice\n\t\t});\n\t\treturn this.#options.includeAgentName === \"inline\" ? (0,_withAgentName_js__WEBPACK_IMPORTED_MODULE_5__.withAgentName)(modelWithTools, this.#options.includeAgentName) : modelWithTools;\n\t}\n\t/**\n\t* Returns internal bookkeeping state for StateManager, not graph output.\n\t* The return shape differs from the node's output type (Command).\n\t*/\n\tgetState() {\n\t\tconst state = super.getState();\n\t\treturn {\n\t\t\tmessages: [],\n\t\t\t...state && !(0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_9__.isCommand)(state) ? state : {}\n\t\t};\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=AgentNode.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvQWdlbnROb2RlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Q7QUFDZ0I7QUFDaUI7QUFDdEM7QUFDUztBQUNmO0FBQ3NDO0FBQ1Q7QUFDdEI7QUFDRDtBQUN1Qjs7QUFFakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtEQUFTLHlCQUF5QiwrREFBUztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGtFQUFnQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixzRUFBdUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELDJEQUFnQjtBQUN0RTtBQUNBLDBEQUEwRCx1REFBWTtBQUN0RTtBQUNBO0FBQ0EsSUFBSSxJQUFJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLGlFQUFXLG9IQUFvSCx5REFBTyxHQUFHLFVBQVUsZ0JBQWdCO0FBQ3hMLFVBQVUsNkNBQTZDO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsK0JBQStCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwrREFBUztBQUM3QjtBQUNBO0FBQ0E7QUFDQSxxRUFBcUUseURBQU8sR0FBRyxVQUFVLGVBQWUsK0RBQVM7QUFDakg7QUFDQTtBQUNBO0FBQ0EsSUFBSSxNQUFNO0FBQ1YsMEJBQTBCLHlEQUFPLEdBQUcsVUFBVSx5QkFBeUI7QUFDdkU7QUFDQSxNQUFNLCtEQUFTO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Qsd0VBQWE7QUFDbkU7QUFDQTtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcscUVBQTBCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw0REFBaUI7QUFDbkMsMEJBQTBCLHlFQUFjO0FBQ3hDO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxRQUFRO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDBFQUFZLHlEQUF5RDtBQUM1SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywwRUFBWSxDQUFDLDZEQUFrQixxQ0FBcUM7QUFDdkc7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsdURBQVk7QUFDbEUsbUhBQW1ILHVCQUF1QixLQUFLLDZDQUE2QztBQUM1TDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCx1REFBWTtBQUN0RSxzSEFBc0gsdUJBQXVCLEtBQUssaURBQWlEO0FBQ25NO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsbUVBQWEsR0FBRztBQUNsRDtBQUNBO0FBQ0EsUUFBUSxHQUFHO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsbUVBQWEsR0FBRyxzQkFBc0I7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLCtEQUFTO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnSUFBZ0ksdUJBQXVCLHdDQUF3QywwQkFBMEI7QUFDek4sVUFBVSwrREFBUztBQUNuQixlQUFlLCtEQUFTO0FBQ3hCO0FBQ0EsT0FBTztBQUNQLFlBQVksdURBQWU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxzRUFBOEI7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxpRUFBVztBQUNwQjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sU0FBUywrREFBUyxrREFBa0QsbUNBQW1DO0FBQ3ZHO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwySkFBMkosc0VBQThCLGNBQWMseURBQU87QUFDOU0sYUFBYSx5QkFBeUIsaUVBQVc7QUFDakQ7QUFDQTtBQUNBLElBQUksSUFBSTtBQUNSO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCx5REFBTztBQUMxRCxhQUFhLHlCQUF5QixpRUFBVztBQUNqRDtBQUNBO0FBQ0EsSUFBSSxJQUFJO0FBQ1I7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx5REFBTztBQUNyQixjQUFjLHlCQUF5QixpRUFBVztBQUNsRDtBQUNBO0FBQ0EsS0FBSyxJQUFJO0FBQ1Q7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLHlEQUFPO0FBQ3BCLGFBQWEseUJBQXlCLGlFQUFXO0FBQ2pEO0FBQ0E7QUFDQSxJQUFJLElBQUk7QUFDUjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsK0JBQStCLCtEQUFTO0FBQ3hDO0FBQ0Esd0dBQXdHLHVEQUFZO0FBQ3BIO0FBQ0E7QUFDQTtBQUNBLDZJQUE2STtBQUM3STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixrRkFBb0I7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxlQUFlLHVCQUF1QjtBQUN0QztBQUNBLEtBQUs7QUFDTDtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixvREFBUztBQUN4QztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsdURBQXVELGdFQUFhO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwrREFBUztBQUN6QjtBQUNBO0FBQ0E7O0FBRUE7QUFDc0M7QUFDdEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvQWdlbnROb2RlLmpzPzRkOWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5pdENoYXRNb2RlbCB9IGZyb20gXCIuLi8uLi9jaGF0X21vZGVscy91bml2ZXJzYWwuanNcIjtcbmltcG9ydCB7IE1pZGRsZXdhcmVFcnJvciwgTXVsdGlwbGVTdHJ1Y3R1cmVkT3V0cHV0c0Vycm9yIH0gZnJvbSBcIi4uL2Vycm9ycy5qc1wiO1xuaW1wb3J0IHsgYmluZFRvb2xzLCBoYXNUb29sQ2FsbHMsIGlzQ2xpZW50VG9vbCwgdmFsaWRhdGVMTE1IYXNOb0JvdW5kVG9vbHMgfSBmcm9tIFwiLi4vdXRpbHMuanNcIjtcbmltcG9ydCB7IFJ1bm5hYmxlQ2FsbGFibGUgfSBmcm9tIFwiLi4vUnVubmFibGVDYWxsYWJsZS5qc1wiO1xuaW1wb3J0IHsgbWVyZ2VBYm9ydFNpZ25hbHMsIHRvUGFydGlhbFpvZE9iamVjdCB9IGZyb20gXCIuL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyB3aXRoQWdlbnROYW1lIH0gZnJvbSBcIi4uL3dpdGhBZ2VudE5hbWUuanNcIjtcbmltcG9ydCB7IFByb3ZpZGVyU3RyYXRlZ3ksIFRvb2xTdHJhdGVneSwgdHJhbnNmb3JtUmVzcG9uc2VGb3JtYXQgfSBmcm9tIFwiLi4vcmVzcG9uc2VzLmpzXCI7XG5pbXBvcnQgeyBBSU1lc3NhZ2UsIFN5c3RlbU1lc3NhZ2UsIFRvb2xNZXNzYWdlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9tZXNzYWdlc1wiO1xuaW1wb3J0IHsgcmFjZVdpdGhTaWduYWwgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3J1bm5hYmxlc1wiO1xuaW1wb3J0IHsgQ29tbWFuZCwgaXNDb21tYW5kIH0gZnJvbSBcIkBsYW5nY2hhaW4vbGFuZ2dyYXBoXCI7XG5pbXBvcnQgeyBnZXRTY2hlbWFEZXNjcmlwdGlvbiwgaW50ZXJvcFBhcnNlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS91dGlscy90eXBlc1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9ub2Rlcy9BZ2VudE5vZGUudHNcbi8qKlxuKiBDaGVjayBpZiB0aGUgcmVzcG9uc2UgaXMgYW4gaW50ZXJuYWwgbW9kZWwgcmVzcG9uc2UuXG4qIEBwYXJhbSByZXNwb25zZSAtIFRoZSByZXNwb25zZSB0byBjaGVjay5cbiogQHJldHVybnMgVHJ1ZSBpZiB0aGUgcmVzcG9uc2UgaXMgYW4gaW50ZXJuYWwgbW9kZWwgcmVzcG9uc2UsIGZhbHNlIG90aGVyd2lzZS5cbiovXG5mdW5jdGlvbiBpc0ludGVybmFsTW9kZWxSZXNwb25zZShyZXNwb25zZSkge1xuXHRyZXR1cm4gQUlNZXNzYWdlLmlzSW5zdGFuY2UocmVzcG9uc2UpIHx8IGlzQ29tbWFuZChyZXNwb25zZSkgfHwgdHlwZW9mIHJlc3BvbnNlID09PSBcIm9iamVjdFwiICYmIHJlc3BvbnNlICE9PSBudWxsICYmIFwic3RydWN0dXJlZFJlc3BvbnNlXCIgaW4gcmVzcG9uc2UgJiYgXCJtZXNzYWdlc1wiIGluIHJlc3BvbnNlO1xufVxuLyoqXG4qIFRoZSBuYW1lIG9mIHRoZSBhZ2VudCBub2RlIGluIHRoZSBzdGF0ZSBncmFwaC5cbiovXG5jb25zdCBBR0VOVF9OT0RFX05BTUUgPSBcIm1vZGVsX3JlcXVlc3RcIjtcbnZhciBBZ2VudE5vZGUgPSBjbGFzcyBleHRlbmRzIFJ1bm5hYmxlQ2FsbGFibGUge1xuXHQjb3B0aW9ucztcblx0I3N5c3RlbU1lc3NhZ2U7XG5cdGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcblx0XHRzdXBlcih7XG5cdFx0XHRuYW1lOiBvcHRpb25zLm5hbWUgPz8gXCJtb2RlbFwiLFxuXHRcdFx0ZnVuYzogKGlucHV0LCBjb25maWcpID0+IHRoaXMuI3J1bihpbnB1dCwgY29uZmlnKVxuXHRcdH0pO1xuXHRcdHRoaXMuI29wdGlvbnMgPSBvcHRpb25zO1xuXHRcdHRoaXMuI3N5c3RlbU1lc3NhZ2UgPSBvcHRpb25zLnN5c3RlbU1lc3NhZ2U7XG5cdH1cblx0LyoqXG5cdCogUmV0dXJucyByZXNwb25zZSBmb3JtYXQgcHJpbXRpdmllcyBiYXNlZCBvbiBnaXZlbiBtb2RlbCBhbmQgcmVzcG9uc2UgZm9ybWF0IHByb3ZpZGVkIGJ5IHRoZSB1c2VyLlxuXHQqXG5cdCogSWYgdGhlIHVzZXIgc2VsZWN0cyBhIHRvb2wgb3V0cHV0OlxuXHQqIC0gcmV0dXJuIGEgcmVjb3JkIG9mIHRvb2xzIHRvIGV4dHJhY3Qgc3RydWN0dXJlZCBvdXRwdXQgZnJvbSB0aGUgbW9kZWwncyByZXNwb25zZVxuXHQqXG5cdCogaWYgdGhlIHRoZSB1c2VyIHNlbGVjdHMgYSBuYXRpdmUgc2NoZW1hIG91dHB1dCBvciBpZiB0aGUgbW9kZWwgc3VwcG9ydHMgSlNPTiBzY2hlbWEgb3V0cHV0OlxuXHQqIC0gcmV0dXJuIGEgcHJvdmlkZXIgc3RyYXRlZ3kgdG8gZXh0cmFjdCBzdHJ1Y3R1cmVkIG91dHB1dCBmcm9tIHRoZSBtb2RlbCdzIHJlc3BvbnNlXG5cdCpcblx0KiBAcGFyYW0gbW9kZWwgLSBUaGUgbW9kZWwgdG8gZ2V0IHRoZSByZXNwb25zZSBmb3JtYXQgZm9yLlxuXHQqIEByZXR1cm5zIFRoZSByZXNwb25zZSBmb3JtYXQuXG5cdCovXG5cdCNnZXRSZXNwb25zZUZvcm1hdChtb2RlbCkge1xuXHRcdGlmICghdGhpcy4jb3B0aW9ucy5yZXNwb25zZUZvcm1hdCkgcmV0dXJuO1xuXHRcdGNvbnN0IHN0cmF0ZWdpZXMgPSB0cmFuc2Zvcm1SZXNwb25zZUZvcm1hdCh0aGlzLiNvcHRpb25zLnJlc3BvbnNlRm9ybWF0LCB2b2lkIDAsIG1vZGVsKTtcblx0XHQvKipcblx0XHQqIFBvcHVsYXRlIGEgbGlzdCBvZiBzdHJ1Y3R1cmVkIHRvb2wgaW5mby5cblx0XHQqL1xuXHRcdGlmICghc3RyYXRlZ2llcy5ldmVyeSgoZm9ybWF0KSA9PiBmb3JtYXQgaW5zdGFuY2VvZiBQcm92aWRlclN0cmF0ZWd5KSkgcmV0dXJuIHtcblx0XHRcdHR5cGU6IFwidG9vbFwiLFxuXHRcdFx0dG9vbHM6IHN0cmF0ZWdpZXMuZmlsdGVyKChmb3JtYXQpID0+IGZvcm1hdCBpbnN0YW5jZW9mIFRvb2xTdHJhdGVneSkucmVkdWNlKChhY2MsIGZvcm1hdCkgPT4ge1xuXHRcdFx0XHRhY2NbZm9ybWF0Lm5hbWVdID0gZm9ybWF0O1xuXHRcdFx0XHRyZXR1cm4gYWNjO1xuXHRcdFx0fSwge30pXG5cdFx0fTtcblx0XHRyZXR1cm4ge1xuXHRcdFx0dHlwZTogXCJuYXRpdmVcIixcblx0XHRcdHN0cmF0ZWd5OiBzdHJhdGVnaWVzWzBdXG5cdFx0fTtcblx0fVxuXHRhc3luYyAjcnVuKHN0YXRlLCBjb25maWcpIHtcblx0XHQvKipcblx0XHQqIENoZWNrIGlmIHdlIGp1c3QgZXhlY3V0ZWQgYSByZXR1cm5EaXJlY3QgdG9vbFxuXHRcdCogSWYgc28sIHdlIHNob3VsZCBnZW5lcmF0ZSBzdHJ1Y3R1cmVkIHJlc3BvbnNlIChpZiBuZWVkZWQpIGFuZCBzdG9wXG5cdFx0Ki9cblx0XHRjb25zdCBsYXN0TWVzc2FnZSA9IHN0YXRlLm1lc3NhZ2VzLmF0KC0xKTtcblx0XHRpZiAobGFzdE1lc3NhZ2UgJiYgVG9vbE1lc3NhZ2UuaXNJbnN0YW5jZShsYXN0TWVzc2FnZSkgJiYgbGFzdE1lc3NhZ2UubmFtZSAmJiB0aGlzLiNvcHRpb25zLnNob3VsZFJldHVybkRpcmVjdC5oYXMobGFzdE1lc3NhZ2UubmFtZSkpIHJldHVybiBbbmV3IENvbW1hbmQoeyB1cGRhdGU6IHsgbWVzc2FnZXM6IFtdIH0gfSldO1xuXHRcdGNvbnN0IHsgcmVzcG9uc2UsIGxhc3RBaU1lc3NhZ2UsIGNvbGxlY3RlZENvbW1hbmRzIH0gPSBhd2FpdCB0aGlzLiNpbnZva2VNb2RlbChzdGF0ZSwgY29uZmlnKTtcblx0XHQvKipcblx0XHQqIHN0cnVjdHVyZWRSZXNwb25zZSDigJQgcmV0dXJuIGFzIGEgcGxhaW4gc3RhdGUgdXBkYXRlIGRpY3QgKG5vdCBhIENvbW1hbmQpXG5cdFx0KiBiZWNhdXNlIHRoZSBzdHJ1Y3R1cmVkUmVzcG9uc2UgY2hhbm5lbCB1c2VzIFVudHJhY2tlZFZhbHVlKGd1YXJkPXRydWUpXG5cdFx0KiB3aGljaCBvbmx5IGFsbG93cyBhIHNpbmdsZSB3cml0ZSBwZXIgc3RlcC5cblx0XHQqL1xuXHRcdGlmICh0eXBlb2YgcmVzcG9uc2UgPT09IFwib2JqZWN0XCIgJiYgcmVzcG9uc2UgIT09IG51bGwgJiYgXCJzdHJ1Y3R1cmVkUmVzcG9uc2VcIiBpbiByZXNwb25zZSAmJiBcIm1lc3NhZ2VzXCIgaW4gcmVzcG9uc2UpIHtcblx0XHRcdGNvbnN0IHsgc3RydWN0dXJlZFJlc3BvbnNlLCBtZXNzYWdlcyB9ID0gcmVzcG9uc2U7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRtZXNzYWdlczogWy4uLnN0YXRlLm1lc3NhZ2VzLCAuLi5tZXNzYWdlc10sXG5cdFx0XHRcdHN0cnVjdHVyZWRSZXNwb25zZVxuXHRcdFx0fTtcblx0XHR9XG5cdFx0Y29uc3QgY29tbWFuZHMgPSBbXTtcblx0XHRjb25zdCBhaU1lc3NhZ2UgPSBBSU1lc3NhZ2UuaXNJbnN0YW5jZShyZXNwb25zZSkgPyByZXNwb25zZSA6IGxhc3RBaU1lc3NhZ2U7XG5cdFx0aWYgKGFpTWVzc2FnZSkge1xuXHRcdFx0YWlNZXNzYWdlLm5hbWUgPSB0aGlzLm5hbWU7XG5cdFx0XHRhaU1lc3NhZ2UubGNfa3dhcmdzLm5hbWUgPSB0aGlzLm5hbWU7XG5cdFx0XHRpZiAodGhpcy4jYXJlTW9yZVN0ZXBzTmVlZGVkKHN0YXRlLCBhaU1lc3NhZ2UpKSBjb21tYW5kcy5wdXNoKG5ldyBDb21tYW5kKHsgdXBkYXRlOiB7IG1lc3NhZ2VzOiBbbmV3IEFJTWVzc2FnZSh7XG5cdFx0XHRcdGNvbnRlbnQ6IFwiU29ycnksIG5lZWQgbW9yZSBzdGVwcyB0byBwcm9jZXNzIHRoaXMgcmVxdWVzdC5cIixcblx0XHRcdFx0bmFtZTogdGhpcy5uYW1lLFxuXHRcdFx0XHRpZDogYWlNZXNzYWdlLmlkXG5cdFx0XHR9KV0gfSB9KSk7XG5cdFx0XHRlbHNlIGNvbW1hbmRzLnB1c2gobmV3IENvbW1hbmQoeyB1cGRhdGU6IHsgbWVzc2FnZXM6IFthaU1lc3NhZ2VdIH0gfSkpO1xuXHRcdH1cblx0XHRpZiAoaXNDb21tYW5kKHJlc3BvbnNlKSAmJiAhY29sbGVjdGVkQ29tbWFuZHMuaW5jbHVkZXMocmVzcG9uc2UpKSBjb21tYW5kcy5wdXNoKHJlc3BvbnNlKTtcblx0XHRjb21tYW5kcy5wdXNoKC4uLmNvbGxlY3RlZENvbW1hbmRzKTtcblx0XHRyZXR1cm4gY29tbWFuZHM7XG5cdH1cblx0LyoqXG5cdCogRGVyaXZlIHRoZSBtb2RlbCBmcm9tIHRoZSBvcHRpb25zLlxuXHQqIEBwYXJhbSBzdGF0ZSAtIFRoZSBzdGF0ZSBvZiB0aGUgYWdlbnQuXG5cdCogQHBhcmFtIGNvbmZpZyAtIFRoZSBjb25maWcgb2YgdGhlIGFnZW50LlxuXHQqIEByZXR1cm5zIFRoZSBtb2RlbC5cblx0Ki9cblx0I2Rlcml2ZU1vZGVsKCkge1xuXHRcdGlmICh0eXBlb2YgdGhpcy4jb3B0aW9ucy5tb2RlbCA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIGluaXRDaGF0TW9kZWwodGhpcy4jb3B0aW9ucy5tb2RlbCk7XG5cdFx0aWYgKHRoaXMuI29wdGlvbnMubW9kZWwpIHJldHVybiB0aGlzLiNvcHRpb25zLm1vZGVsO1xuXHRcdHRocm93IG5ldyBFcnJvcihcIk5vIG1vZGVsIG9wdGlvbiB3YXMgcHJvdmlkZWQsIGVpdGhlciB2aWEgYG1vZGVsYCBvcHRpb24uXCIpO1xuXHR9XG5cdGFzeW5jICNpbnZva2VNb2RlbChzdGF0ZSwgY29uZmlnLCBvcHRpb25zID0ge30pIHtcblx0XHRjb25zdCBtb2RlbCA9IGF3YWl0IHRoaXMuI2Rlcml2ZU1vZGVsKCk7XG5cdFx0Y29uc3QgbGdDb25maWcgPSBjb25maWc7XG5cdFx0LyoqXG5cdFx0KiBDcmVhdGUgYSBsb2NhbCB2YXJpYWJsZSBmb3IgY3VycmVudCBzeXN0ZW0gbWVzc2FnZSB0byBhdm9pZCBjb25jdXJyZW5jeSBpc3N1ZXNcblx0XHQqIEVhY2ggaW52b2NhdGlvbiBnZXRzIGl0cyBvd24gY29weVxuXHRcdCovXG5cdFx0bGV0IGN1cnJlbnRTeXN0ZW1NZXNzYWdlID0gdGhpcy4jc3lzdGVtTWVzc2FnZTtcblx0XHQvKipcblx0XHQqIFNoYXJlZCB0cmFja2luZyBzdGF0ZSBmb3IgQUlNZXNzYWdlIGFuZCBDb21tYW5kIGNvbGxlY3Rpb24uXG5cdFx0KiBsYXN0QWlNZXNzYWdlIHRyYWNrcyB0aGUgZWZmZWN0aXZlIEFJTWVzc2FnZSB0aHJvdWdoIHRoZSBtaWRkbGV3YXJlIGNoYWluLlxuXHRcdCogY29sbGVjdGVkQ29tbWFuZHMgYWNjdW11bGF0ZXMgQ29tbWFuZHMgcmV0dXJuZWQgYnkgbWlkZGxld2FyZSAobm90IGJhc2UgaGFuZGxlcikuXG5cdFx0Ki9cblx0XHRsZXQgbGFzdEFpTWVzc2FnZSA9IG51bGw7XG5cdFx0Y29uc3QgY29sbGVjdGVkQ29tbWFuZHMgPSBbXTtcblx0XHQvKipcblx0XHQqIENyZWF0ZSB0aGUgYmFzZSBoYW5kbGVyIHRoYXQgcGVyZm9ybXMgdGhlIGFjdHVhbCBtb2RlbCBpbnZvY2F0aW9uXG5cdFx0Ki9cblx0XHRjb25zdCBiYXNlSGFuZGxlciA9IGFzeW5jIChyZXF1ZXN0KSA9PiB7XG5cdFx0XHQvKipcblx0XHRcdCogQ2hlY2sgaWYgdGhlIExMTSBhbHJlYWR5IGhhcyBib3VuZCB0b29scyBhbmQgdGhyb3cgaWYgaXQgZG9lcy5cblx0XHRcdCovXG5cdFx0XHR2YWxpZGF0ZUxMTUhhc05vQm91bmRUb29scyhyZXF1ZXN0Lm1vZGVsKTtcblx0XHRcdGNvbnN0IHN0cnVjdHVyZWRSZXNwb25zZUZvcm1hdCA9IHRoaXMuI2dldFJlc3BvbnNlRm9ybWF0KHJlcXVlc3QubW9kZWwpO1xuXHRcdFx0Y29uc3QgbW9kZWxXaXRoVG9vbHMgPSBhd2FpdCB0aGlzLiNiaW5kVG9vbHMocmVxdWVzdC5tb2RlbCwgcmVxdWVzdCwgc3RydWN0dXJlZFJlc3BvbnNlRm9ybWF0KTtcblx0XHRcdC8qKlxuXHRcdFx0KiBwcmVwZW5kIHRoZSBzeXN0ZW0gbWVzc2FnZSB0byB0aGUgbWVzc2FnZXMgaWYgaXQgaXMgbm90IGVtcHR5XG5cdFx0XHQqL1xuXHRcdFx0Y29uc3QgbWVzc2FnZXMgPSBbLi4uY3VycmVudFN5c3RlbU1lc3NhZ2UudGV4dCA9PT0gXCJcIiA/IFtdIDogW2N1cnJlbnRTeXN0ZW1NZXNzYWdlXSwgLi4ucmVxdWVzdC5tZXNzYWdlc107XG5cdFx0XHRjb25zdCBzaWduYWwgPSBtZXJnZUFib3J0U2lnbmFscyh0aGlzLiNvcHRpb25zLnNpZ25hbCwgY29uZmlnLnNpZ25hbCk7XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJhY2VXaXRoU2lnbmFsKG1vZGVsV2l0aFRvb2xzLmludm9rZShtZXNzYWdlcywge1xuXHRcdFx0XHQuLi5jb25maWcsXG5cdFx0XHRcdHNpZ25hbFxuXHRcdFx0fSksIHNpZ25hbCk7XG5cdFx0XHRsYXN0QWlNZXNzYWdlID0gcmVzcG9uc2U7XG5cdFx0XHQvKipcblx0XHRcdCogaWYgdGhlIHVzZXIgcmVxdWVzdHMgYSBuYXRpdmUgc2NoZW1hIG91dHB1dCwgdHJ5IHRvIHBhcnNlIHRoZSByZXNwb25zZVxuXHRcdFx0KiBhbmQgcmV0dXJuIHRoZSBzdHJ1Y3R1cmVkIHJlc3BvbnNlIGlmIGl0IGlzIHZhbGlkXG5cdFx0XHQqL1xuXHRcdFx0aWYgKHN0cnVjdHVyZWRSZXNwb25zZUZvcm1hdD8udHlwZSA9PT0gXCJuYXRpdmVcIikge1xuXHRcdFx0XHRjb25zdCBzdHJ1Y3R1cmVkUmVzcG9uc2UgPSBzdHJ1Y3R1cmVkUmVzcG9uc2VGb3JtYXQuc3RyYXRlZ3kucGFyc2UocmVzcG9uc2UpO1xuXHRcdFx0XHRpZiAoc3RydWN0dXJlZFJlc3BvbnNlKSByZXR1cm4ge1xuXHRcdFx0XHRcdHN0cnVjdHVyZWRSZXNwb25zZSxcblx0XHRcdFx0XHRtZXNzYWdlczogW3Jlc3BvbnNlXVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRyZXR1cm4gcmVzcG9uc2U7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIXN0cnVjdHVyZWRSZXNwb25zZUZvcm1hdCB8fCAhcmVzcG9uc2UudG9vbF9jYWxscykgcmV0dXJuIHJlc3BvbnNlO1xuXHRcdFx0Y29uc3QgdG9vbENhbGxzID0gcmVzcG9uc2UudG9vbF9jYWxscy5maWx0ZXIoKGNhbGwpID0+IGNhbGwubmFtZSBpbiBzdHJ1Y3R1cmVkUmVzcG9uc2VGb3JtYXQudG9vbHMpO1xuXHRcdFx0LyoqXG5cdFx0XHQqIGlmIHRoZXJlIHdlcmUgbm90IHN0cnVjdHVyZWQgdG9vbCBjYWxscywgd2UgY2FuIHJldHVybiB0aGUgcmVzcG9uc2Vcblx0XHRcdCovXG5cdFx0XHRpZiAodG9vbENhbGxzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHJlc3BvbnNlO1xuXHRcdFx0LyoqXG5cdFx0XHQqIGlmIHRoZXJlIHdlcmUgbXVsdGlwbGUgc3RydWN0dXJlZCB0b29sIGNhbGxzLCB3ZSBzaG91bGQgdGhyb3cgYW4gZXJyb3IgYXMgdGhpc1xuXHRcdFx0KiBzY2VuYXJpbyBpcyBub3QgZGVmaW5lZC9zdXBwb3J0ZWQuXG5cdFx0XHQqL1xuXHRcdFx0aWYgKHRvb2xDYWxscy5sZW5ndGggPiAxKSByZXR1cm4gdGhpcy4jaGFuZGxlTXVsdGlwbGVTdHJ1Y3R1cmVkT3V0cHV0cyhyZXNwb25zZSwgdG9vbENhbGxzLCBzdHJ1Y3R1cmVkUmVzcG9uc2VGb3JtYXQpO1xuXHRcdFx0Y29uc3QgdG9vbE1lc3NhZ2VDb250ZW50ID0gc3RydWN0dXJlZFJlc3BvbnNlRm9ybWF0LnRvb2xzW3Rvb2xDYWxsc1swXS5uYW1lXT8ub3B0aW9ucz8udG9vbE1lc3NhZ2VDb250ZW50O1xuXHRcdFx0cmV0dXJuIHRoaXMuI2hhbmRsZVNpbmdsZVN0cnVjdHVyZWRPdXRwdXQocmVzcG9uc2UsIHRvb2xDYWxsc1swXSwgc3RydWN0dXJlZFJlc3BvbnNlRm9ybWF0LCB0b29sTWVzc2FnZUNvbnRlbnQgPz8gb3B0aW9ucy5sYXN0TWVzc2FnZSk7XG5cdFx0fTtcblx0XHRjb25zdCB3cmFwcGVyTWlkZGxld2FyZSA9IHRoaXMuI29wdGlvbnMud3JhcE1vZGVsQ2FsbEhvb2tNaWRkbGV3YXJlID8/IFtdO1xuXHRcdGxldCB3cmFwcGVkSGFuZGxlciA9IGJhc2VIYW5kbGVyO1xuXHRcdC8qKlxuXHRcdCogQnVpbGQgY29tcG9zZWQgaGFuZGxlciBmcm9tIGxhc3QgdG8gZmlyc3Qgc28gZmlyc3QgbWlkZGxld2FyZSBiZWNvbWVzIG91dGVybW9zdFxuXHRcdCovXG5cdFx0Zm9yIChsZXQgaSA9IHdyYXBwZXJNaWRkbGV3YXJlLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdFx0XHRjb25zdCBbbWlkZGxld2FyZSwgZ2V0TWlkZGxld2FyZVN0YXRlXSA9IHdyYXBwZXJNaWRkbGV3YXJlW2ldO1xuXHRcdFx0aWYgKG1pZGRsZXdhcmUud3JhcE1vZGVsQ2FsbCkge1xuXHRcdFx0XHRjb25zdCBpbm5lckhhbmRsZXIgPSB3cmFwcGVkSGFuZGxlcjtcblx0XHRcdFx0Y29uc3QgY3VycmVudE1pZGRsZXdhcmUgPSBtaWRkbGV3YXJlO1xuXHRcdFx0XHRjb25zdCBjdXJyZW50R2V0U3RhdGUgPSBnZXRNaWRkbGV3YXJlU3RhdGU7XG5cdFx0XHRcdHdyYXBwZWRIYW5kbGVyID0gYXN5bmMgKHJlcXVlc3QpID0+IHtcblx0XHRcdFx0XHRjb25zdCBiYXNlbGluZVN5c3RlbU1lc3NhZ2UgPSBjdXJyZW50U3lzdGVtTWVzc2FnZTtcblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQqIE1lcmdlIGNvbnRleHQgd2l0aCBkZWZhdWx0IGNvbnRleHQgb2YgbWlkZGxld2FyZVxuXHRcdFx0XHRcdCovXG5cdFx0XHRcdFx0Y29uc3QgY29udGV4dCA9IGN1cnJlbnRNaWRkbGV3YXJlLmNvbnRleHRTY2hlbWEgPyBpbnRlcm9wUGFyc2UoY3VycmVudE1pZGRsZXdhcmUuY29udGV4dFNjaGVtYSwgbGdDb25maWc/LmNvbnRleHQgfHwge30pIDogbGdDb25maWc/LmNvbnRleHQ7XG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0KiBDcmVhdGUgcnVudGltZVxuXHRcdFx0XHRcdCovXG5cdFx0XHRcdFx0Y29uc3QgcnVudGltZSA9IE9iamVjdC5mcmVlemUoe1xuXHRcdFx0XHRcdFx0Y29udGV4dCxcblx0XHRcdFx0XHRcdHdyaXRlcjogbGdDb25maWcud3JpdGVyLFxuXHRcdFx0XHRcdFx0aW50ZXJydXB0OiBsZ0NvbmZpZy5pbnRlcnJ1cHQsXG5cdFx0XHRcdFx0XHRzaWduYWw6IGxnQ29uZmlnLnNpZ25hbFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCogQ3JlYXRlIHRoZSByZXF1ZXN0IHdpdGggc3RhdGUgYW5kIHJ1bnRpbWVcblx0XHRcdFx0XHQqL1xuXHRcdFx0XHRcdGNvbnN0IHJlcXVlc3RXaXRoU3RhdGVBbmRSdW50aW1lID0ge1xuXHRcdFx0XHRcdFx0Li4ucmVxdWVzdCxcblx0XHRcdFx0XHRcdHN0YXRlOiB7XG5cdFx0XHRcdFx0XHRcdC4uLm1pZGRsZXdhcmUuc3RhdGVTY2hlbWEgPyBpbnRlcm9wUGFyc2UodG9QYXJ0aWFsWm9kT2JqZWN0KG1pZGRsZXdhcmUuc3RhdGVTY2hlbWEpLCBzdGF0ZSkgOiB7fSxcblx0XHRcdFx0XHRcdFx0Li4uY3VycmVudEdldFN0YXRlKCksXG5cdFx0XHRcdFx0XHRcdG1lc3NhZ2VzOiBzdGF0ZS5tZXNzYWdlc1xuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdHJ1bnRpbWVcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCogQ3JlYXRlIGhhbmRsZXIgdGhhdCB2YWxpZGF0ZXMgdG9vbHMgYW5kIGNhbGxzIHRoZSBpbm5lciBoYW5kbGVyXG5cdFx0XHRcdFx0Ki9cblx0XHRcdFx0XHRjb25zdCBoYW5kbGVyV2l0aFZhbGlkYXRpb24gPSBhc3luYyAocmVxKSA9PiB7XG5cdFx0XHRcdFx0XHRjdXJyZW50U3lzdGVtTWVzc2FnZSA9IGJhc2VsaW5lU3lzdGVtTWVzc2FnZTtcblx0XHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdFx0KiBWZXJpZnkgdGhhdCB0aGUgdXNlciBkaWRuJ3QgYWRkIGFueSBuZXcgdG9vbHMuXG5cdFx0XHRcdFx0XHQqIFdlIGNhbid0IGFsbG93IHRoaXMgYXMgdGhlIFRvb2xOb2RlIGlzIGFscmVhZHkgaW5pdGlhdGVkIHdpdGggZ2l2ZW4gdG9vbHMuXG5cdFx0XHRcdFx0XHQqL1xuXHRcdFx0XHRcdFx0Y29uc3QgbW9kaWZpZWRUb29scyA9IHJlcS50b29scyA/PyBbXTtcblx0XHRcdFx0XHRcdGNvbnN0IG5ld1Rvb2xzID0gbW9kaWZpZWRUb29scy5maWx0ZXIoKHRvb2wpID0+IGlzQ2xpZW50VG9vbCh0b29sKSAmJiAhdGhpcy4jb3B0aW9ucy50b29sQ2xhc3Nlcy5zb21lKCh0KSA9PiB0Lm5hbWUgPT09IHRvb2wubmFtZSkpO1xuXHRcdFx0XHRcdFx0aWYgKG5ld1Rvb2xzLmxlbmd0aCA+IDApIHRocm93IG5ldyBFcnJvcihgWW91IGhhdmUgYWRkZWQgYSBuZXcgdG9vbCBpbiBcIndyYXBNb2RlbENhbGxcIiBob29rIG9mIG1pZGRsZXdhcmUgXCIke2N1cnJlbnRNaWRkbGV3YXJlLm5hbWV9XCI6ICR7bmV3VG9vbHMubWFwKCh0b29sKSA9PiB0b29sLm5hbWUpLmpvaW4oXCIsIFwiKX0uIFRoaXMgaXMgbm90IHN1cHBvcnRlZC5gKTtcblx0XHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdFx0KiBWZXJpZnkgdGhhdCB1c2VyIGhhcyBub3QgYWRkZWQgb3IgbW9kaWZpZWQgYSB0b29sIHdpdGggdGhlIHNhbWUgbmFtZS5cblx0XHRcdFx0XHRcdCogV2UgY2FuJ3QgYWxsb3cgdGhpcyBhcyB0aGUgVG9vbE5vZGUgaXMgYWxyZWFkeSBpbml0aWF0ZWQgd2l0aCBnaXZlbiB0b29scy5cblx0XHRcdFx0XHRcdCovXG5cdFx0XHRcdFx0XHRjb25zdCBpbnZhbGlkVG9vbHMgPSBtb2RpZmllZFRvb2xzLmZpbHRlcigodG9vbCkgPT4gaXNDbGllbnRUb29sKHRvb2wpICYmIHRoaXMuI29wdGlvbnMudG9vbENsYXNzZXMuZXZlcnkoKHQpID0+IHQgIT09IHRvb2wpKTtcblx0XHRcdFx0XHRcdGlmIChpbnZhbGlkVG9vbHMubGVuZ3RoID4gMCkgdGhyb3cgbmV3IEVycm9yKGBZb3UgaGF2ZSBtb2RpZmllZCBhIHRvb2wgaW4gXCJ3cmFwTW9kZWxDYWxsXCIgaG9vayBvZiBtaWRkbGV3YXJlIFwiJHtjdXJyZW50TWlkZGxld2FyZS5uYW1lfVwiOiAke2ludmFsaWRUb29scy5tYXAoKHRvb2wpID0+IHRvb2wubmFtZSkuam9pbihcIiwgXCIpfS4gVGhpcyBpcyBub3Qgc3VwcG9ydGVkLmApO1xuXHRcdFx0XHRcdFx0bGV0IG5vcm1hbGl6ZWRSZXEgPSByZXE7XG5cdFx0XHRcdFx0XHRjb25zdCBoYXNTeXN0ZW1Qcm9tcHRDaGFuZ2VkID0gcmVxLnN5c3RlbVByb21wdCAhPT0gY3VycmVudFN5c3RlbU1lc3NhZ2UudGV4dDtcblx0XHRcdFx0XHRcdGNvbnN0IGhhc1N5c3RlbU1lc3NhZ2VDaGFuZ2VkID0gcmVxLnN5c3RlbU1lc3NhZ2UgIT09IGN1cnJlbnRTeXN0ZW1NZXNzYWdlO1xuXHRcdFx0XHRcdFx0aWYgKGhhc1N5c3RlbVByb21wdENoYW5nZWQgJiYgaGFzU3lzdGVtTWVzc2FnZUNoYW5nZWQpIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBjaGFuZ2UgYm90aCBzeXN0ZW1Qcm9tcHQgYW5kIHN5c3RlbU1lc3NhZ2UgaW4gdGhlIHNhbWUgcmVxdWVzdC5cIik7XG5cdFx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHRcdCogQ2hlY2sgaWYgc3lzdGVtUHJvbXB0IGlzIGEgc3RyaW5nIHdhcyBjaGFuZ2VkLCBpZiBzbyBjcmVhdGUgYSBuZXcgU3lzdGVtTWVzc2FnZVxuXHRcdFx0XHRcdFx0Ki9cblx0XHRcdFx0XHRcdGlmIChoYXNTeXN0ZW1Qcm9tcHRDaGFuZ2VkKSB7XG5cdFx0XHRcdFx0XHRcdGN1cnJlbnRTeXN0ZW1NZXNzYWdlID0gbmV3IFN5c3RlbU1lc3NhZ2UoeyBjb250ZW50OiBbe1xuXHRcdFx0XHRcdFx0XHRcdHR5cGU6IFwidGV4dFwiLFxuXHRcdFx0XHRcdFx0XHRcdHRleHQ6IHJlcS5zeXN0ZW1Qcm9tcHRcblx0XHRcdFx0XHRcdFx0fV0gfSk7XG5cdFx0XHRcdFx0XHRcdG5vcm1hbGl6ZWRSZXEgPSB7XG5cdFx0XHRcdFx0XHRcdFx0Li4ucmVxLFxuXHRcdFx0XHRcdFx0XHRcdHN5c3RlbVByb21wdDogY3VycmVudFN5c3RlbU1lc3NhZ2UudGV4dCxcblx0XHRcdFx0XHRcdFx0XHRzeXN0ZW1NZXNzYWdlOiBjdXJyZW50U3lzdGVtTWVzc2FnZVxuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0XHQqIElmIHRoZSBzeXN0ZW1NZXNzYWdlIHdhcyBjaGFuZ2VkLCB1cGRhdGUgdGhlIGN1cnJlbnQgc3lzdGVtIG1lc3NhZ2Vcblx0XHRcdFx0XHRcdCovXG5cdFx0XHRcdFx0XHRpZiAoaGFzU3lzdGVtTWVzc2FnZUNoYW5nZWQpIHtcblx0XHRcdFx0XHRcdFx0Y3VycmVudFN5c3RlbU1lc3NhZ2UgPSBuZXcgU3lzdGVtTWVzc2FnZSh7IC4uLnJlcS5zeXN0ZW1NZXNzYWdlIH0pO1xuXHRcdFx0XHRcdFx0XHRub3JtYWxpemVkUmVxID0ge1xuXHRcdFx0XHRcdFx0XHRcdC4uLnJlcSxcblx0XHRcdFx0XHRcdFx0XHRzeXN0ZW1Qcm9tcHQ6IGN1cnJlbnRTeXN0ZW1NZXNzYWdlLnRleHQsXG5cdFx0XHRcdFx0XHRcdFx0c3lzdGVtTWVzc2FnZTogY3VycmVudFN5c3RlbU1lc3NhZ2Vcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGNvbnN0IGlubmVySGFuZGxlclJlc3VsdCA9IGF3YWl0IGlubmVySGFuZGxlcihub3JtYWxpemVkUmVxKTtcblx0XHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdFx0KiBOb3JtYWxpemUgQ29tbWFuZHMgc28gbWlkZGxld2FyZSBhbHdheXMgc2VlcyBBSU1lc3NhZ2UgZnJvbSBoYW5kbGVyKCkuXG5cdFx0XHRcdFx0XHQqIFdoZW4gYW4gaW5uZXIgbWlkZGxld2FyZSByZXR1cm5zIGEgQ29tbWFuZCwgc3Vic3RpdHV0ZSB0aGUgdHJhY2tlZFxuXHRcdFx0XHRcdFx0KiBsYXN0QWlNZXNzYWdlLiBUaGUgcmF3IENvbW1hbmQgaXMgc3RpbGwgY2FwdHVyZWQgaW4gaW5uZXJIYW5kbGVyUmVzdWx0XG5cdFx0XHRcdFx0XHQqIGZvciB0aGUgZnJhbWV3b3JrJ3MgQ29tbWFuZCBjb2xsZWN0aW9uLlxuXHRcdFx0XHRcdFx0Ki9cblx0XHRcdFx0XHRcdGlmIChpc0NvbW1hbmQoaW5uZXJIYW5kbGVyUmVzdWx0KSAmJiBsYXN0QWlNZXNzYWdlKSByZXR1cm4gbGFzdEFpTWVzc2FnZTtcblx0XHRcdFx0XHRcdHJldHVybiBpbm5lckhhbmRsZXJSZXN1bHQ7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRpZiAoIWN1cnJlbnRNaWRkbGV3YXJlLndyYXBNb2RlbENhbGwpIHJldHVybiBoYW5kbGVyV2l0aFZhbGlkYXRpb24ocmVxdWVzdFdpdGhTdGF0ZUFuZFJ1bnRpbWUpO1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRjb25zdCBtaWRkbGV3YXJlUmVzcG9uc2UgPSBhd2FpdCBjdXJyZW50TWlkZGxld2FyZS53cmFwTW9kZWxDYWxsKHJlcXVlc3RXaXRoU3RhdGVBbmRSdW50aW1lLCBoYW5kbGVyV2l0aFZhbGlkYXRpb24pO1xuXHRcdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0XHQqIFZhbGlkYXRlIHRoYXQgdGhpcyBzcGVjaWZpYyBtaWRkbGV3YXJlIHJldHVybmVkIGEgdmFsaWQgcmVzcG9uc2Vcblx0XHRcdFx0XHRcdCovXG5cdFx0XHRcdFx0XHRpZiAoIWlzSW50ZXJuYWxNb2RlbFJlc3BvbnNlKG1pZGRsZXdhcmVSZXNwb25zZSkpIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCByZXNwb25zZSBmcm9tIFwid3JhcE1vZGVsQ2FsbFwiIGluIG1pZGRsZXdhcmUgXCIke2N1cnJlbnRNaWRkbGV3YXJlLm5hbWV9XCI6IGV4cGVjdGVkIEFJTWVzc2FnZSBvciBDb21tYW5kLCBnb3QgJHt0eXBlb2YgbWlkZGxld2FyZVJlc3BvbnNlfWApO1xuXHRcdFx0XHRcdFx0aWYgKEFJTWVzc2FnZS5pc0luc3RhbmNlKG1pZGRsZXdhcmVSZXNwb25zZSkpIGxhc3RBaU1lc3NhZ2UgPSBtaWRkbGV3YXJlUmVzcG9uc2U7XG5cdFx0XHRcdFx0XHRlbHNlIGlmIChpc0NvbW1hbmQobWlkZGxld2FyZVJlc3BvbnNlKSkgY29sbGVjdGVkQ29tbWFuZHMucHVzaChtaWRkbGV3YXJlUmVzcG9uc2UpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIG1pZGRsZXdhcmVSZXNwb25zZTtcblx0XHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdFx0dGhyb3cgTWlkZGxld2FyZUVycm9yLndyYXAoZXJyb3IsIGN1cnJlbnRNaWRkbGV3YXJlLm5hbWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9XG5cdFx0LyoqXG5cdFx0KiBFeGVjdXRlIHRoZSB3cmFwcGVkIGhhbmRsZXIgd2l0aCB0aGUgaW5pdGlhbCByZXF1ZXN0XG5cdFx0KiBSZXNldCBjdXJyZW50IHN5c3RlbSBwcm9tcHQgdG8gaW5pdGlhbCBzdGF0ZSBhbmQgY29udmVydCB0byBzdHJpbmcgdXNpbmcgLnRleHQgZ2V0dGVyXG5cdFx0KiBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aCBNb2RlbFJlcXVlc3Rcblx0XHQqL1xuXHRcdGN1cnJlbnRTeXN0ZW1NZXNzYWdlID0gdGhpcy4jc3lzdGVtTWVzc2FnZTtcblx0XHRjb25zdCBpbml0aWFsUmVxdWVzdCA9IHtcblx0XHRcdG1vZGVsLFxuXHRcdFx0c3lzdGVtUHJvbXB0OiBjdXJyZW50U3lzdGVtTWVzc2FnZT8udGV4dCxcblx0XHRcdHN5c3RlbU1lc3NhZ2U6IGN1cnJlbnRTeXN0ZW1NZXNzYWdlLFxuXHRcdFx0bWVzc2FnZXM6IHN0YXRlLm1lc3NhZ2VzLFxuXHRcdFx0dG9vbHM6IHRoaXMuI29wdGlvbnMudG9vbENsYXNzZXMsXG5cdFx0XHRzdGF0ZSxcblx0XHRcdHJ1bnRpbWU6IE9iamVjdC5mcmVlemUoe1xuXHRcdFx0XHRjb250ZXh0OiBsZ0NvbmZpZz8uY29udGV4dCxcblx0XHRcdFx0d3JpdGVyOiBsZ0NvbmZpZy53cml0ZXIsXG5cdFx0XHRcdGludGVycnVwdDogbGdDb25maWcuaW50ZXJydXB0LFxuXHRcdFx0XHRzaWduYWw6IGxnQ29uZmlnLnNpZ25hbFxuXHRcdFx0fSlcblx0XHR9O1xuXHRcdHJldHVybiB7XG5cdFx0XHRyZXNwb25zZTogYXdhaXQgd3JhcHBlZEhhbmRsZXIoaW5pdGlhbFJlcXVlc3QpLFxuXHRcdFx0bGFzdEFpTWVzc2FnZSxcblx0XHRcdGNvbGxlY3RlZENvbW1hbmRzXG5cdFx0fTtcblx0fVxuXHQvKipcblx0KiBJZiB0aGUgbW9kZWwgcmV0dXJucyBtdWx0aXBsZSBzdHJ1Y3R1cmVkIG91dHB1dHMsIHdlIG5lZWQgdG8gaGFuZGxlIGl0LlxuXHQqIEBwYXJhbSByZXNwb25zZSAtIFRoZSByZXNwb25zZSBmcm9tIHRoZSBtb2RlbFxuXHQqIEBwYXJhbSB0b29sQ2FsbHMgLSBUaGUgdG9vbCBjYWxscyB0aGF0IHdlcmUgbWFkZVxuXHQqIEByZXR1cm5zIFRoZSByZXNwb25zZSBmcm9tIHRoZSBtb2RlbFxuXHQqL1xuXHQjaGFuZGxlTXVsdGlwbGVTdHJ1Y3R1cmVkT3V0cHV0cyhyZXNwb25zZSwgdG9vbENhbGxzLCByZXNwb25zZUZvcm1hdCkge1xuXHRcdGNvbnN0IG11bHRpcGxlU3RydWN0dXJlZE91dHB1dHNFcnJvciA9IG5ldyBNdWx0aXBsZVN0cnVjdHVyZWRPdXRwdXRzRXJyb3IodG9vbENhbGxzLm1hcCgoY2FsbCkgPT4gY2FsbC5uYW1lKSk7XG5cdFx0cmV0dXJuIHRoaXMuI2hhbmRsZVRvb2xTdHJhdGVneUVycm9yKG11bHRpcGxlU3RydWN0dXJlZE91dHB1dHNFcnJvciwgcmVzcG9uc2UsIHRvb2xDYWxsc1swXSwgcmVzcG9uc2VGb3JtYXQpO1xuXHR9XG5cdC8qKlxuXHQqIElmIHRoZSBtb2RlbCByZXR1cm5zIGEgc2luZ2xlIHN0cnVjdHVyZWQgb3V0cHV0LCB3ZSBuZWVkIHRvIGhhbmRsZSBpdC5cblx0KiBAcGFyYW0gdG9vbENhbGwgLSBUaGUgdG9vbCBjYWxsIHRoYXQgd2FzIG1hZGVcblx0KiBAcmV0dXJucyBUaGUgc3RydWN0dXJlZCByZXNwb25zZSBhbmQgYSBtZXNzYWdlIHRvIHRoZSBMTE0gaWYgbmVlZGVkXG5cdCovXG5cdCNoYW5kbGVTaW5nbGVTdHJ1Y3R1cmVkT3V0cHV0KHJlc3BvbnNlLCB0b29sQ2FsbCwgcmVzcG9uc2VGb3JtYXQsIGxhc3RNZXNzYWdlKSB7XG5cdFx0Y29uc3QgdG9vbCA9IHJlc3BvbnNlRm9ybWF0LnRvb2xzW3Rvb2xDYWxsLm5hbWVdO1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBzdHJ1Y3R1cmVkUmVzcG9uc2UgPSB0b29sLnBhcnNlKHRvb2xDYWxsLmFyZ3MpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0c3RydWN0dXJlZFJlc3BvbnNlLFxuXHRcdFx0XHRtZXNzYWdlczogW1xuXHRcdFx0XHRcdHJlc3BvbnNlLFxuXHRcdFx0XHRcdG5ldyBUb29sTWVzc2FnZSh7XG5cdFx0XHRcdFx0XHR0b29sX2NhbGxfaWQ6IHRvb2xDYWxsLmlkID8/IFwiXCIsXG5cdFx0XHRcdFx0XHRjb250ZW50OiBKU09OLnN0cmluZ2lmeShzdHJ1Y3R1cmVkUmVzcG9uc2UpLFxuXHRcdFx0XHRcdFx0bmFtZTogdG9vbENhbGwubmFtZVxuXHRcdFx0XHRcdH0pLFxuXHRcdFx0XHRcdG5ldyBBSU1lc3NhZ2UobGFzdE1lc3NhZ2UgPz8gYFJldHVybmluZyBzdHJ1Y3R1cmVkIHJlc3BvbnNlOiAke0pTT04uc3RyaW5naWZ5KHN0cnVjdHVyZWRSZXNwb25zZSl9YClcblx0XHRcdFx0XVxuXHRcdFx0fTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0cmV0dXJuIHRoaXMuI2hhbmRsZVRvb2xTdHJhdGVneUVycm9yKGVycm9yLCByZXNwb25zZSwgdG9vbENhbGwsIHJlc3BvbnNlRm9ybWF0KTtcblx0XHR9XG5cdH1cblx0YXN5bmMgI2hhbmRsZVRvb2xTdHJhdGVneUVycm9yKGVycm9yLCByZXNwb25zZSwgdG9vbENhbGwsIHJlc3BvbnNlRm9ybWF0KSB7XG5cdFx0LyoqXG5cdFx0KiBVc2luZyB0aGUgYGVycm9ySGFuZGxlcmAgb3B0aW9uIG9mIHRoZSBmaXJzdCBgVG9vbFN0cmF0ZWd5YCBlbnRyeSBpcyBzdWZmaWNpZW50IGhlcmUuXG5cdFx0KiBUaGVyZSBpcyB0ZWNobmljYWxseSBvbmx5IG9uZSBgVG9vbFN0cmF0ZWd5YCBlbnRyeSBpbiBgc3RydWN0dXJlZFRvb2xJbmZvYCBpZiB0aGUgdXNlclxuXHRcdCogdXNlcyBgdG9vbFN0cmF0ZWd5YCB0byBkZWZpbmUgdGhlIHJlc3BvbnNlIGZvcm1hdC4gSWYgdGhlIHVzZXIgYXBwbGllcyBhIGxpc3Qgb2YganNvblxuXHRcdCogc2NoZW1hIG9iamVjdHMsIHRoZXNlIHdpbGwgYmUgdHJhbnNmb3JtZWQgaW50byBtdWx0aXBsZSBgVG9vbFN0cmF0ZWd5YCBlbnRyaWVzIGJ1dCBhbGxcblx0XHQqIHdpdGggdGhlIHNhbWUgYGhhbmRsZUVycm9yYCBvcHRpb24uXG5cdFx0Ki9cblx0XHRjb25zdCBlcnJvckhhbmRsZXIgPSBPYmplY3QudmFsdWVzKHJlc3BvbnNlRm9ybWF0LnRvb2xzKS5hdCgwKT8ub3B0aW9ucz8uaGFuZGxlRXJyb3I7XG5cdFx0Y29uc3QgdG9vbENhbGxJZCA9IHRvb2xDYWxsLmlkO1xuXHRcdGlmICghdG9vbENhbGxJZCkgdGhyb3cgbmV3IEVycm9yKFwiVG9vbCBjYWxsIElEIGlzIHJlcXVpcmVkIHRvIGhhbmRsZSB0b29sIG91dHB1dCBlcnJvcnMuIFBsZWFzZSBwcm92aWRlIGEgdG9vbCBjYWxsIElELlwiKTtcblx0XHQvKipcblx0XHQqIERlZmF1bHQgYmVoYXZpb3I6IHJldHJ5IGlmIGBlcnJvckhhbmRsZXJgIGlzIHVuZGVmaW5lZCBvciB0cnV0aHkuXG5cdFx0KiBPbmx5IHRocm93IGlmIGV4cGxpY2l0bHkgc2V0IHRvIGBmYWxzZWAuXG5cdFx0Ki9cblx0XHRpZiAoZXJyb3JIYW5kbGVyID09PSBmYWxzZSkgdGhyb3cgZXJyb3I7XG5cdFx0LyoqXG5cdFx0KiByZXRyeSBpZjpcblx0XHQqL1xuXHRcdGlmIChlcnJvckhhbmRsZXIgPT09IHZvaWQgMCB8fCB0eXBlb2YgZXJyb3JIYW5kbGVyID09PSBcImJvb2xlYW5cIiAmJiBlcnJvckhhbmRsZXIgfHwgQXJyYXkuaXNBcnJheShlcnJvckhhbmRsZXIpICYmIGVycm9ySGFuZGxlci5zb21lKChoKSA9PiBoIGluc3RhbmNlb2YgTXVsdGlwbGVTdHJ1Y3R1cmVkT3V0cHV0c0Vycm9yKSkgcmV0dXJuIG5ldyBDb21tYW5kKHtcblx0XHRcdHVwZGF0ZTogeyBtZXNzYWdlczogW3Jlc3BvbnNlLCBuZXcgVG9vbE1lc3NhZ2Uoe1xuXHRcdFx0XHRjb250ZW50OiBlcnJvci5tZXNzYWdlLFxuXHRcdFx0XHR0b29sX2NhbGxfaWQ6IHRvb2xDYWxsSWRcblx0XHRcdH0pXSB9LFxuXHRcdFx0Z290bzogQUdFTlRfTk9ERV9OQU1FXG5cdFx0fSk7XG5cdFx0LyoqXG5cdFx0KiBpZiBgZXJyb3JIYW5kbGVyYCBpcyBhIHN0cmluZywgcmV0cnkgdGhlIHRvb2wgY2FsbCB3aXRoIGdpdmVuIHN0cmluZ1xuXHRcdCovXG5cdFx0aWYgKHR5cGVvZiBlcnJvckhhbmRsZXIgPT09IFwic3RyaW5nXCIpIHJldHVybiBuZXcgQ29tbWFuZCh7XG5cdFx0XHR1cGRhdGU6IHsgbWVzc2FnZXM6IFtyZXNwb25zZSwgbmV3IFRvb2xNZXNzYWdlKHtcblx0XHRcdFx0Y29udGVudDogZXJyb3JIYW5kbGVyLFxuXHRcdFx0XHR0b29sX2NhbGxfaWQ6IHRvb2xDYWxsSWRcblx0XHRcdH0pXSB9LFxuXHRcdFx0Z290bzogQUdFTlRfTk9ERV9OQU1FXG5cdFx0fSk7XG5cdFx0LyoqXG5cdFx0KiBpZiBgZXJyb3JIYW5kbGVyYCBpcyBhIGZ1bmN0aW9uLCByZXRyeSB0aGUgdG9vbCBjYWxsIHdpdGggdGhlIGZ1bmN0aW9uXG5cdFx0Ki9cblx0XHRpZiAodHlwZW9mIGVycm9ySGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRjb25zdCBjb250ZW50ID0gYXdhaXQgZXJyb3JIYW5kbGVyKGVycm9yKTtcblx0XHRcdGlmICh0eXBlb2YgY29udGVudCAhPT0gXCJzdHJpbmdcIikgdGhyb3cgbmV3IEVycm9yKFwiRXJyb3IgaGFuZGxlciBtdXN0IHJldHVybiBhIHN0cmluZy5cIik7XG5cdFx0XHRyZXR1cm4gbmV3IENvbW1hbmQoe1xuXHRcdFx0XHR1cGRhdGU6IHsgbWVzc2FnZXM6IFtyZXNwb25zZSwgbmV3IFRvb2xNZXNzYWdlKHtcblx0XHRcdFx0XHRjb250ZW50LFxuXHRcdFx0XHRcdHRvb2xfY2FsbF9pZDogdG9vbENhbGxJZFxuXHRcdFx0XHR9KV0gfSxcblx0XHRcdFx0Z290bzogQUdFTlRfTk9ERV9OQU1FXG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0LyoqXG5cdFx0KiBEZWZhdWx0OiByZXRyeSBpZiB3ZSByZWFjaCBoZXJlXG5cdFx0Ki9cblx0XHRyZXR1cm4gbmV3IENvbW1hbmQoe1xuXHRcdFx0dXBkYXRlOiB7IG1lc3NhZ2VzOiBbcmVzcG9uc2UsIG5ldyBUb29sTWVzc2FnZSh7XG5cdFx0XHRcdGNvbnRlbnQ6IGVycm9yLm1lc3NhZ2UsXG5cdFx0XHRcdHRvb2xfY2FsbF9pZDogdG9vbENhbGxJZFxuXHRcdFx0fSldIH0sXG5cdFx0XHRnb3RvOiBBR0VOVF9OT0RFX05BTUVcblx0XHR9KTtcblx0fVxuXHQjYXJlTW9yZVN0ZXBzTmVlZGVkKHN0YXRlLCByZXNwb25zZSkge1xuXHRcdGNvbnN0IGFsbFRvb2xzUmV0dXJuRGlyZWN0ID0gQUlNZXNzYWdlLmlzSW5zdGFuY2UocmVzcG9uc2UpICYmIHJlc3BvbnNlLnRvb2xfY2FsbHM/LmV2ZXJ5KChjYWxsKSA9PiB0aGlzLiNvcHRpb25zLnNob3VsZFJldHVybkRpcmVjdC5oYXMoY2FsbC5uYW1lKSk7XG5cdFx0Y29uc3QgcmVtYWluaW5nU3RlcHMgPSBcInJlbWFpbmluZ1N0ZXBzXCIgaW4gc3RhdGUgPyBzdGF0ZS5yZW1haW5pbmdTdGVwcyA6IHZvaWQgMDtcblx0XHRyZXR1cm4gQm9vbGVhbihyZW1haW5pbmdTdGVwcyAmJiAocmVtYWluaW5nU3RlcHMgPCAxICYmIGFsbFRvb2xzUmV0dXJuRGlyZWN0IHx8IHJlbWFpbmluZ1N0ZXBzIDwgMiAmJiBoYXNUb29sQ2FsbHMoc3RhdGUubWVzc2FnZXMuYXQoLTEpKSkpO1xuXHR9XG5cdGFzeW5jICNiaW5kVG9vbHMobW9kZWwsIHByZXBhcmVkT3B0aW9ucywgc3RydWN0dXJlZFJlc3BvbnNlRm9ybWF0KSB7XG5cdFx0Y29uc3Qgb3B0aW9ucyA9IHt9O1xuXHRcdGNvbnN0IHN0cnVjdHVyZWRUb29scyA9IE9iamVjdC52YWx1ZXMoc3RydWN0dXJlZFJlc3BvbnNlRm9ybWF0ICYmIFwidG9vbHNcIiBpbiBzdHJ1Y3R1cmVkUmVzcG9uc2VGb3JtYXQgPyBzdHJ1Y3R1cmVkUmVzcG9uc2VGb3JtYXQudG9vbHMgOiB7fSk7XG5cdFx0LyoqXG5cdFx0KiBVc2UgdG9vbHMgZnJvbSBwcmVwYXJlZE9wdGlvbnMgaWYgcHJvdmlkZWQsIG90aGVyd2lzZSB1c2UgZGVmYXVsdCB0b29sc1xuXHRcdCovXG5cdFx0Y29uc3QgYWxsVG9vbHMgPSBbLi4ucHJlcGFyZWRPcHRpb25zPy50b29scyA/PyB0aGlzLiNvcHRpb25zLnRvb2xDbGFzc2VzLCAuLi5zdHJ1Y3R1cmVkVG9vbHMubWFwKCh0b29sU3RyYXRlZ3kpID0+IHRvb2xTdHJhdGVneS50b29sKV07XG5cdFx0LyoqXG5cdFx0KiBJZiB0aGVyZSBhcmUgc3RydWN0dXJlZCB0b29scywgd2UgbmVlZCB0byBzZXQgdGhlIHRvb2wgY2hvaWNlIHRvIFwiYW55XCJcblx0XHQqIHNvIHRoYXQgdGhlIG1vZGVsIGNhbiBjaG9vc2UgdG8gdXNlIGEgc3RydWN0dXJlZCB0b29sIG9yIG5vdC5cblx0XHQqL1xuXHRcdGNvbnN0IHRvb2xDaG9pY2UgPSBwcmVwYXJlZE9wdGlvbnM/LnRvb2xDaG9pY2UgfHwgKHN0cnVjdHVyZWRUb29scy5sZW5ndGggPiAwID8gXCJhbnlcIiA6IHZvaWQgMCk7XG5cdFx0LyoqXG5cdFx0KiBjaGVjayBpZiB0aGUgdXNlciByZXF1ZXN0cyBhIG5hdGl2ZSBzY2hlbWEgb3V0cHV0XG5cdFx0Ki9cblx0XHRpZiAoc3RydWN0dXJlZFJlc3BvbnNlRm9ybWF0Py50eXBlID09PSBcIm5hdGl2ZVwiKSB7XG5cdFx0XHRjb25zdCByZXNvbHZlZFN0cmljdCA9IHByZXBhcmVkT3B0aW9ucz8ubW9kZWxTZXR0aW5ncz8uc3RyaWN0ID8/IHN0cnVjdHVyZWRSZXNwb25zZUZvcm1hdD8uc3RyYXRlZ3k/LnN0cmljdCA/PyB0cnVlO1xuXHRcdFx0Y29uc3QganNvblNjaGVtYVBhcmFtcyA9IHtcblx0XHRcdFx0bmFtZTogc3RydWN0dXJlZFJlc3BvbnNlRm9ybWF0LnN0cmF0ZWd5LnNjaGVtYT8ubmFtZSA/PyBcImV4dHJhY3RcIixcblx0XHRcdFx0ZGVzY3JpcHRpb246IGdldFNjaGVtYURlc2NyaXB0aW9uKHN0cnVjdHVyZWRSZXNwb25zZUZvcm1hdC5zdHJhdGVneS5zY2hlbWEpLFxuXHRcdFx0XHRzY2hlbWE6IHN0cnVjdHVyZWRSZXNwb25zZUZvcm1hdC5zdHJhdGVneS5zY2hlbWEsXG5cdFx0XHRcdHN0cmljdDogcmVzb2x2ZWRTdHJpY3Rcblx0XHRcdH07XG5cdFx0XHRPYmplY3QuYXNzaWduKG9wdGlvbnMsIHtcblx0XHRcdFx0cmVzcG9uc2VfZm9ybWF0OiB7XG5cdFx0XHRcdFx0dHlwZTogXCJqc29uX3NjaGVtYVwiLFxuXHRcdFx0XHRcdGpzb25fc2NoZW1hOiBqc29uU2NoZW1hUGFyYW1zXG5cdFx0XHRcdH0sXG5cdFx0XHRcdG91dHB1dENvbmZpZzogeyBmb3JtYXQ6IHtcblx0XHRcdFx0XHR0eXBlOiBcImpzb25fc2NoZW1hXCIsXG5cdFx0XHRcdFx0c2NoZW1hOiBzdHJ1Y3R1cmVkUmVzcG9uc2VGb3JtYXQuc3RyYXRlZ3kuc2NoZW1hXG5cdFx0XHRcdH0gfSxcblx0XHRcdFx0bHNfc3RydWN0dXJlZF9vdXRwdXRfZm9ybWF0OiB7XG5cdFx0XHRcdFx0a3dhcmdzOiB7IG1ldGhvZDogXCJqc29uX3NjaGVtYVwiIH0sXG5cdFx0XHRcdFx0c2NoZW1hOiBzdHJ1Y3R1cmVkUmVzcG9uc2VGb3JtYXQuc3RyYXRlZ3kuc2NoZW1hXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHN0cmljdDogcmVzb2x2ZWRTdHJpY3Rcblx0XHRcdH0pO1xuXHRcdH1cblx0XHQvKipcblx0XHQqIEJpbmQgdG9vbHMgdG8gdGhlIG1vZGVsIGlmIHRoZXkgYXJlIG5vdCBhbHJlYWR5IGJvdW5kLlxuXHRcdCovXG5cdFx0Y29uc3QgbW9kZWxXaXRoVG9vbHMgPSBhd2FpdCBiaW5kVG9vbHMobW9kZWwsIGFsbFRvb2xzLCB7XG5cdFx0XHQuLi5vcHRpb25zLFxuXHRcdFx0Li4ucHJlcGFyZWRPcHRpb25zPy5tb2RlbFNldHRpbmdzLFxuXHRcdFx0dG9vbF9jaG9pY2U6IHRvb2xDaG9pY2Vcblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcy4jb3B0aW9ucy5pbmNsdWRlQWdlbnROYW1lID09PSBcImlubGluZVwiID8gd2l0aEFnZW50TmFtZShtb2RlbFdpdGhUb29scywgdGhpcy4jb3B0aW9ucy5pbmNsdWRlQWdlbnROYW1lKSA6IG1vZGVsV2l0aFRvb2xzO1xuXHR9XG5cdC8qKlxuXHQqIFJldHVybnMgaW50ZXJuYWwgYm9va2tlZXBpbmcgc3RhdGUgZm9yIFN0YXRlTWFuYWdlciwgbm90IGdyYXBoIG91dHB1dC5cblx0KiBUaGUgcmV0dXJuIHNoYXBlIGRpZmZlcnMgZnJvbSB0aGUgbm9kZSdzIG91dHB1dCB0eXBlIChDb21tYW5kKS5cblx0Ki9cblx0Z2V0U3RhdGUoKSB7XG5cdFx0Y29uc3Qgc3RhdGUgPSBzdXBlci5nZXRTdGF0ZSgpO1xuXHRcdHJldHVybiB7XG5cdFx0XHRtZXNzYWdlczogW10sXG5cdFx0XHQuLi5zdGF0ZSAmJiAhaXNDb21tYW5kKHN0YXRlKSA/IHN0YXRlIDoge31cblx0XHR9O1xuXHR9XG59O1xuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IEFHRU5UX05PREVfTkFNRSwgQWdlbnROb2RlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1BZ2VudE5vZGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/AgentNode.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/BeforeAgentNode.js":
/*!*****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/BeforeAgentNode.js ***!
  \*****************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BeforeAgentNode: () => (/* binding */ BeforeAgentNode)\n/* harmony export */ });\n/* harmony import */ var _middleware_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/middleware.js\");\n\n\n\n//#region src/agents/nodes/BeforeAgentNode.ts\n/**\n* Node for executing a single middleware's beforeAgent hook.\n*/\nvar BeforeAgentNode = class extends _middleware_js__WEBPACK_IMPORTED_MODULE_1__.MiddlewareNode {\n\tlc_namespace = [\n\t\t\"langchain\",\n\t\t\"agents\",\n\t\t\"beforeAgentNodes\"\n\t];\n\tconstructor(middleware, options) {\n\t\tsuper({\n\t\t\tname: `BeforeAgentNode_${middleware.name}`,\n\t\t\tfunc: async (state, config) => this.invokeMiddleware(state, config)\n\t\t}, options);\n\t\tthis.middleware = middleware;\n\t}\n\trunHook(state, runtime) {\n\t\treturn (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_0__.getHookFunction)(this.middleware.beforeAgent)(state, runtime);\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=BeforeAgentNode.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvQmVmb3JlQWdlbnROb2RlLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF5RDtBQUNSOztBQUVqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQywwREFBYztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixnQkFBZ0I7QUFDNUM7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsU0FBUyxxRUFBZTtBQUN4QjtBQUNBOztBQUVBO0FBQzJCO0FBQzNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL25vZGVzL0JlZm9yZUFnZW50Tm9kZS5qcz82ZDA3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldEhvb2tGdW5jdGlvbiB9IGZyb20gXCIuLi9taWRkbGV3YXJlL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyBNaWRkbGV3YXJlTm9kZSB9IGZyb20gXCIuL21pZGRsZXdhcmUuanNcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvbm9kZXMvQmVmb3JlQWdlbnROb2RlLnRzXG4vKipcbiogTm9kZSBmb3IgZXhlY3V0aW5nIGEgc2luZ2xlIG1pZGRsZXdhcmUncyBiZWZvcmVBZ2VudCBob29rLlxuKi9cbnZhciBCZWZvcmVBZ2VudE5vZGUgPSBjbGFzcyBleHRlbmRzIE1pZGRsZXdhcmVOb2RlIHtcblx0bGNfbmFtZXNwYWNlID0gW1xuXHRcdFwibGFuZ2NoYWluXCIsXG5cdFx0XCJhZ2VudHNcIixcblx0XHRcImJlZm9yZUFnZW50Tm9kZXNcIlxuXHRdO1xuXHRjb25zdHJ1Y3RvcihtaWRkbGV3YXJlLCBvcHRpb25zKSB7XG5cdFx0c3VwZXIoe1xuXHRcdFx0bmFtZTogYEJlZm9yZUFnZW50Tm9kZV8ke21pZGRsZXdhcmUubmFtZX1gLFxuXHRcdFx0ZnVuYzogYXN5bmMgKHN0YXRlLCBjb25maWcpID0+IHRoaXMuaW52b2tlTWlkZGxld2FyZShzdGF0ZSwgY29uZmlnKVxuXHRcdH0sIG9wdGlvbnMpO1xuXHRcdHRoaXMubWlkZGxld2FyZSA9IG1pZGRsZXdhcmU7XG5cdH1cblx0cnVuSG9vayhzdGF0ZSwgcnVudGltZSkge1xuXHRcdHJldHVybiBnZXRIb29rRnVuY3Rpb24odGhpcy5taWRkbGV3YXJlLmJlZm9yZUFnZW50KShzdGF0ZSwgcnVudGltZSk7XG5cdH1cbn07XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgQmVmb3JlQWdlbnROb2RlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1CZWZvcmVBZ2VudE5vZGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/BeforeAgentNode.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/BeforeModelNode.js":
/*!*****************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/BeforeModelNode.js ***!
  \*****************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BeforeModelNode: () => (/* binding */ BeforeModelNode)\n/* harmony export */ });\n/* harmony import */ var _middleware_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../middleware/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/middleware.js\");\n\n\n\n//#region src/agents/nodes/BeforeModelNode.ts\n/**\n* Node for executing a single middleware's beforeModel hook.\n*/\nvar BeforeModelNode = class extends _middleware_js__WEBPACK_IMPORTED_MODULE_1__.MiddlewareNode {\n\tlc_namespace = [\n\t\t\"langchain\",\n\t\t\"agents\",\n\t\t\"beforeModelNodes\"\n\t];\n\tconstructor(middleware, options) {\n\t\tsuper({\n\t\t\tname: `BeforeModelNode_${middleware.name}`,\n\t\t\tfunc: async (state, config) => this.invokeMiddleware(state, config)\n\t\t}, options);\n\t\tthis.middleware = middleware;\n\t}\n\trunHook(state, runtime) {\n\t\treturn (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_0__.getHookFunction)(this.middleware.beforeModel)(state, runtime);\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=BeforeModelNode.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvQmVmb3JlTW9kZWxOb2RlLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF5RDtBQUNSOztBQUVqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQywwREFBYztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixnQkFBZ0I7QUFDNUM7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsU0FBUyxxRUFBZTtBQUN4QjtBQUNBOztBQUVBO0FBQzJCO0FBQzNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL25vZGVzL0JlZm9yZU1vZGVsTm9kZS5qcz8xOGRiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldEhvb2tGdW5jdGlvbiB9IGZyb20gXCIuLi9taWRkbGV3YXJlL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyBNaWRkbGV3YXJlTm9kZSB9IGZyb20gXCIuL21pZGRsZXdhcmUuanNcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvbm9kZXMvQmVmb3JlTW9kZWxOb2RlLnRzXG4vKipcbiogTm9kZSBmb3IgZXhlY3V0aW5nIGEgc2luZ2xlIG1pZGRsZXdhcmUncyBiZWZvcmVNb2RlbCBob29rLlxuKi9cbnZhciBCZWZvcmVNb2RlbE5vZGUgPSBjbGFzcyBleHRlbmRzIE1pZGRsZXdhcmVOb2RlIHtcblx0bGNfbmFtZXNwYWNlID0gW1xuXHRcdFwibGFuZ2NoYWluXCIsXG5cdFx0XCJhZ2VudHNcIixcblx0XHRcImJlZm9yZU1vZGVsTm9kZXNcIlxuXHRdO1xuXHRjb25zdHJ1Y3RvcihtaWRkbGV3YXJlLCBvcHRpb25zKSB7XG5cdFx0c3VwZXIoe1xuXHRcdFx0bmFtZTogYEJlZm9yZU1vZGVsTm9kZV8ke21pZGRsZXdhcmUubmFtZX1gLFxuXHRcdFx0ZnVuYzogYXN5bmMgKHN0YXRlLCBjb25maWcpID0+IHRoaXMuaW52b2tlTWlkZGxld2FyZShzdGF0ZSwgY29uZmlnKVxuXHRcdH0sIG9wdGlvbnMpO1xuXHRcdHRoaXMubWlkZGxld2FyZSA9IG1pZGRsZXdhcmU7XG5cdH1cblx0cnVuSG9vayhzdGF0ZSwgcnVudGltZSkge1xuXHRcdHJldHVybiBnZXRIb29rRnVuY3Rpb24odGhpcy5taWRkbGV3YXJlLmJlZm9yZU1vZGVsKShzdGF0ZSwgcnVudGltZSk7XG5cdH1cbn07XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgQmVmb3JlTW9kZWxOb2RlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1CZWZvcmVNb2RlbE5vZGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/BeforeModelNode.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/ToolNode.js":
/*!**********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/ToolNode.js ***!
  \**********************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TOOLS_NODE_NAME: () => (/* binding */ TOOLS_NODE_NAME),\n/* harmony export */   ToolNode: () => (/* binding */ ToolNode)\n/* harmony export */ });\n/* harmony import */ var _errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../errors.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/errors.js\");\n/* harmony import */ var _RunnableCallable_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../RunnableCallable.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/RunnableCallable.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/utils.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_core_tools__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/core/tools */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/tools/index.js\");\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n\n\n\n\n\n\n\n//#region src/agents/nodes/ToolNode.ts\n/**\n* Error message template for when middleware adds tools that can't be executed.\n* This happens when middleware modifies tools in wrapModelCall but doesn't provide\n* a wrapToolCall handler to execute them.\n*/\nconst getInvalidToolError = (toolName, availableTools) => `Error: ${toolName} is not a valid tool, try one of [${availableTools.join(\", \")}].`;\n/**\n* The name of the tool node in the state graph.\n*/\nconst TOOLS_NODE_NAME = \"tools\";\nconst isBaseMessageArray = (input) => Array.isArray(input) && input.every(_langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.BaseMessage.isInstance);\nconst isMessagesState = (input) => typeof input === \"object\" && input != null && \"messages\" in input && isBaseMessageArray(input.messages);\nconst isSendInput = (input) => typeof input === \"object\" && input != null && \"lg_tool_call\" in input;\n/**\n* Default error handler for tool errors.\n*\n* This is applied to errors from baseHandler (tool execution).\n* For errors from wrapToolCall middleware, those are handled separately\n* and will bubble up by default.\n*\n* Catches all tool execution errors and converts them to ToolMessage.\n* This allows the LLM to see the error and potentially retry with different arguments.\n*/\nfunction defaultHandleToolErrors(error, toolCall) {\n\tif (error instanceof _errors_js__WEBPACK_IMPORTED_MODULE_0__.ToolInvocationError) return new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage({\n\t\tcontent: error.message,\n\t\ttool_call_id: toolCall.id,\n\t\tname: toolCall.name\n\t});\n\t/**\n\t* Catch all other tool errors and convert to ToolMessage\n\t*/\n\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage({\n\t\tcontent: `${error}\\n Please fix your mistakes.`,\n\t\ttool_call_id: toolCall.id,\n\t\tname: toolCall.name\n\t});\n}\n/**\n* `ToolNode` is a built-in LangGraph component that handles tool calls within an agent's workflow.\n* It works seamlessly with `createAgent`, offering advanced tool execution control, built\n* in parallelism, and error handling.\n*\n* @example\n* ```ts\n* import { ToolNode, tool, AIMessage } from \"langchain\";\n* import { z } from \"zod/v3\";\n*\n* const getWeather = tool((input) => {\n*   if ([\"sf\", \"san francisco\"].includes(input.location.toLowerCase())) {\n*     return \"It's 60 degrees and foggy.\";\n*   } else {\n*     return \"It's 90 degrees and sunny.\";\n*   }\n* }, {\n*   name: \"get_weather\",\n*   description: \"Call to get the current weather.\",\n*   schema: z.object({\n*     location: z.string().describe(\"Location to get the weather for.\"),\n*   }),\n* });\n*\n* const tools = [getWeather];\n* const toolNode = new ToolNode(tools);\n*\n* const messageWithSingleToolCall = new AIMessage({\n*   content: \"\",\n*   tool_calls: [\n*     {\n*       name: \"get_weather\",\n*       args: { location: \"sf\" },\n*       id: \"tool_call_id\",\n*       type: \"tool_call\",\n*     }\n*   ]\n* })\n*\n* await toolNode.invoke({ messages: [messageWithSingleToolCall] });\n* // Returns tool invocation responses as:\n* // { messages: ToolMessage[] }\n* ```\n*/\nvar ToolNode = class extends _RunnableCallable_js__WEBPACK_IMPORTED_MODULE_1__.RunnableCallable {\n\ttools;\n\ttrace = false;\n\tsignal;\n\thandleToolErrors = defaultHandleToolErrors;\n\twrapToolCall;\n\tconstructor(tools, options) {\n\t\tconst { name, tags, handleToolErrors, signal, wrapToolCall } = options ?? {};\n\t\tsuper({\n\t\t\tname,\n\t\t\ttags,\n\t\t\tfunc: (state, config) => this.run(state, config)\n\t\t});\n\t\tthis.options = options;\n\t\tthis.tools = tools;\n\t\tthis.handleToolErrors = handleToolErrors ?? this.handleToolErrors;\n\t\tthis.signal = signal;\n\t\tthis.wrapToolCall = wrapToolCall;\n\t}\n\t/**\n\t* Handle errors from tool execution or middleware.\n\t* @param error - The error to handle\n\t* @param call - The tool call that caused the error\n\t* @param isMiddlewareError - Whether the error came from wrapToolCall middleware\n\t* @returns ToolMessage if error is handled, otherwise re-throws\n\t*/\n\t#handleError(error, call, isMiddlewareError) {\n\t\t/**\n\t\t* {@link NodeInterrupt} errors are a breakpoint to bring a human into the loop.\n\t\t* As such, they are not recoverable by the agent and shouldn't be fed\n\t\t* back. Instead, re-throw these errors even when `handleToolErrors = true`.\n\t\t*/\n\t\tif ((0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_5__.isGraphInterrupt)(error)) throw error;\n\t\t/**\n\t\t* If the signal is aborted, we want to bubble up the error to the invoke caller.\n\t\t*/\n\t\tif (this.signal?.aborted) throw error;\n\t\t/**\n\t\t* If error is from middleware and handleToolErrors is not true, bubble up\n\t\t* (default handler and false both re-raise middleware errors)\n\t\t*/\n\t\tif (isMiddlewareError && this.handleToolErrors !== true) throw error;\n\t\t/**\n\t\t* If handleToolErrors is false, throw all errors\n\t\t*/\n\t\tif (!this.handleToolErrors) throw error;\n\t\t/**\n\t\t* Apply handleToolErrors to the error\n\t\t*/\n\t\tif (typeof this.handleToolErrors === \"function\") {\n\t\t\tconst result = this.handleToolErrors(error, call);\n\t\t\tif (result && _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage.isInstance(result)) return result;\n\t\t\t/**\n\t\t\t* `handleToolErrors` returned undefined - re-raise\n\t\t\t*/\n\t\t\tthrow error;\n\t\t} else if (this.handleToolErrors) return new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage({\n\t\t\tname: call.name,\n\t\t\tcontent: `${error}\\n Please fix your mistakes.`,\n\t\t\ttool_call_id: call.id\n\t\t});\n\t\t/**\n\t\t* Shouldn't reach here, but throw as fallback\n\t\t*/\n\t\tthrow error;\n\t}\n\tasync runTool(call, config, state) {\n\t\t/**\n\t\t* Build runtime from LangGraph config\n\t\t*/\n\t\tconst lgConfig = config;\n\t\tconst runtime = {\n\t\t\tcontext: lgConfig?.context,\n\t\t\twriter: lgConfig?.writer,\n\t\t\tinterrupt: lgConfig?.interrupt,\n\t\t\tsignal: lgConfig?.signal\n\t\t};\n\t\t/**\n\t\t* Find the tool instance to include in the request.\n\t\t* For dynamically registered tools, this may be undefined.\n\t\t*/\n\t\tconst registeredTool = this.tools.find((t) => t.name === call.name);\n\t\t/**\n\t\t* Define the base handler that executes the tool.\n\t\t* When wrapToolCall middleware is present, this handler does NOT catch errors\n\t\t* so the middleware can handle them.\n\t\t* When no middleware, errors are caught and handled here.\n\t\t*\n\t\t* The handler now accepts an overridden tool from the request, allowing\n\t\t* middleware to provide tool implementations for dynamically registered tools.\n\t\t*/\n\t\tconst baseHandler = async (request) => {\n\t\t\tconst { toolCall, tool: requestTool } = request;\n\t\t\t/**\n\t\t\t* Use the tool from the request (which may be overridden via spread syntax)\n\t\t\t* or fall back to finding it in registered tools.\n\t\t\t* This allows middleware to provide dynamic tool implementations.\n\t\t\t*/\n\t\t\tconst tool = requestTool ?? this.tools.find((t) => t.name === toolCall.name);\n\t\t\tif (tool === void 0) {\n\t\t\t\t/**\n\t\t\t\t* Tool not found - return a graceful error message rather than throwing.\n\t\t\t\t* This allows the LLM to see the error and potentially retry.\n\t\t\t\t*/\n\t\t\t\tconst availableTools = this.tools.map((t) => t.name);\n\t\t\t\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage({\n\t\t\t\t\tcontent: getInvalidToolError(toolCall.name, availableTools),\n\t\t\t\t\ttool_call_id: toolCall.id,\n\t\t\t\t\tname: toolCall.name,\n\t\t\t\t\tstatus: \"error\"\n\t\t\t\t});\n\t\t\t}\n\t\t\t/**\n\t\t\t* Cast tool to a common invokable type.\n\t\t\t* The tool can be from registered tools (StructuredToolInterface | DynamicTool | RunnableToolLike)\n\t\t\t* or from middleware override (ClientTool | ServerTool).\n\t\t\t*/\n\t\t\tconst invokableTool = tool;\n\t\t\ttry {\n\t\t\t\tconst output = await invokableTool.invoke({\n\t\t\t\t\t...toolCall,\n\t\t\t\t\ttype: \"tool_call\"\n\t\t\t\t}, {\n\t\t\t\t\t...config,\n\t\t\t\t\tconfig,\n\t\t\t\t\ttoolCallId: toolCall.id,\n\t\t\t\t\tstate: config.configurable?.__pregel_scratchpad?.currentTaskInput,\n\t\t\t\t\tsignal: (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.mergeAbortSignals)(this.signal, config.signal)\n\t\t\t\t});\n\t\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage.isInstance(output) || (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_5__.isCommand)(output)) return output;\n\t\t\t\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage({\n\t\t\t\t\tname: invokableTool.name,\n\t\t\t\t\tcontent: typeof output === \"string\" ? output : JSON.stringify(output),\n\t\t\t\t\ttool_call_id: toolCall.id\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\t/**\n\t\t\t\t* Handle errors from tool execution (not from wrapToolCall)\n\t\t\t\t* If tool invocation fails due to input parsing error, throw a {@link ToolInvocationError}\n\t\t\t\t*/\n\t\t\t\tif (e instanceof _langchain_core_tools__WEBPACK_IMPORTED_MODULE_4__.ToolInputParsingException) throw new _errors_js__WEBPACK_IMPORTED_MODULE_0__.ToolInvocationError(e, toolCall);\n\t\t\t\t/**\n\t\t\t\t* Re-throw to be handled by caller\n\t\t\t\t*/\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t};\n\t\t/**\n\t\t* Create request object for middleware\n\t\t* Cast to ToolCallRequest<AgentBuiltInState> to satisfy type constraints\n\t\t* of wrapToolCall which expects AgentBuiltInState\n\t\t*/\n\t\tconst request = {\n\t\t\ttoolCall: call,\n\t\t\ttool: registeredTool,\n\t\t\tstate,\n\t\t\truntime\n\t\t};\n\t\t/**\n\t\t* If wrapToolCall is provided, use it to wrap the tool execution\n\t\t*/\n\t\tif (this.wrapToolCall) try {\n\t\t\treturn await this.wrapToolCall(request, baseHandler);\n\t\t} catch (e) {\n\t\t\t/**\n\t\t\t* Handle middleware errors\n\t\t\t*/\n\t\t\treturn this.#handleError(e, call, true);\n\t\t}\n\t\t/**\n\t\t* No wrapToolCall - if tool wasn't found, return graceful error\n\t\t*/\n\t\tif (!registeredTool) {\n\t\t\tconst availableTools = this.tools.map((t) => t.name);\n\t\t\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.ToolMessage({\n\t\t\t\tcontent: getInvalidToolError(call.name, availableTools),\n\t\t\t\ttool_call_id: call.id,\n\t\t\t\tname: call.name,\n\t\t\t\tstatus: \"error\"\n\t\t\t});\n\t\t}\n\t\t/**\n\t\t* No wrapToolCall - execute tool directly and handle errors here\n\t\t*/\n\t\ttry {\n\t\t\treturn await baseHandler(request);\n\t\t} catch (e) {\n\t\t\t/**\n\t\t\t* Handle tool errors when no middleware provided\n\t\t\t*/\n\t\t\treturn this.#handleError(e, call, false);\n\t\t}\n\t}\n\tasync run(state, config) {\n\t\tlet outputs;\n\t\tif (isSendInput(state)) {\n\t\t\tconst { lg_tool_call: _, jumpTo: __, ...newState } = state;\n\t\t\toutputs = [await this.runTool(state.lg_tool_call, config, newState)];\n\t\t} else {\n\t\t\tlet messages;\n\t\t\tif (isBaseMessageArray(state)) messages = state;\n\t\t\telse if (isMessagesState(state)) messages = state.messages;\n\t\t\telse throw new Error(\"ToolNode only accepts BaseMessage[] or { messages: BaseMessage[] } as input.\");\n\t\t\tconst toolMessageIds = new Set(messages.filter((msg) => msg.getType() === \"tool\").map((msg) => msg.tool_call_id));\n\t\t\tlet aiMessage;\n\t\t\tfor (let i = messages.length - 1; i >= 0; i -= 1) {\n\t\t\t\tconst message = messages[i];\n\t\t\t\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.AIMessage.isInstance(message)) {\n\t\t\t\t\taiMessage = message;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!_langchain_core_messages__WEBPACK_IMPORTED_MODULE_3__.AIMessage.isInstance(aiMessage)) throw new Error(\"ToolNode only accepts AIMessages as input.\");\n\t\t\toutputs = await Promise.all(aiMessage.tool_calls?.filter((call) => call.id == null || !toolMessageIds.has(call.id)).map((call) => this.runTool(call, config, state)) ?? []);\n\t\t}\n\t\tif (!outputs.some(_langchain_langgraph__WEBPACK_IMPORTED_MODULE_5__.isCommand)) return Array.isArray(state) ? outputs : { messages: outputs };\n\t\tconst combinedOutputs = [];\n\t\tlet parentCommand = null;\n\t\tfor (const output of outputs) if ((0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_5__.isCommand)(output)) if (output.graph === _langchain_langgraph__WEBPACK_IMPORTED_MODULE_5__.Command.PARENT && Array.isArray(output.goto) && output.goto.every((send) => isSend(send))) if (parentCommand) parentCommand.goto.push(...output.goto);\n\t\telse parentCommand = new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_5__.Command({\n\t\t\tgraph: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_5__.Command.PARENT,\n\t\t\tgoto: output.goto\n\t\t});\n\t\telse combinedOutputs.push(output);\n\t\telse combinedOutputs.push(Array.isArray(state) ? [output] : { messages: [output] });\n\t\tif (parentCommand) combinedOutputs.push(parentCommand);\n\t\treturn combinedOutputs;\n\t}\n};\nfunction isSend(x) {\n\treturn x instanceof _langchain_langgraph__WEBPACK_IMPORTED_MODULE_5__.Send;\n}\n\n//#endregion\n\n//# sourceMappingURL=ToolNode.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvVG9vbE5vZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBbUQ7QUFDTztBQUNYO0FBQ2dDO0FBQ2I7QUFDZ0I7O0FBRWxGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSxVQUFVLG1DQUFtQywwQkFBMEI7QUFDM0k7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBMEUsaUVBQVc7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsMkRBQW1CLGFBQWEsaUVBQVc7QUFDakU7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLFlBQVksaUVBQVc7QUFDdkIsY0FBYyxNQUFNO0FBQ3BCO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsNEJBQTRCO0FBQ3ZDLFdBQVcsSUFBSTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixnQkFBZ0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwwQkFBMEIsdUNBQXVDO0FBQ2pFO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSw2QkFBNkIsa0VBQWdCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUscURBQXFEO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUsscUJBQXFCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLE1BQU0sc0VBQWdCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixpRUFBVztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksMkNBQTJDLGlFQUFXO0FBQzFEO0FBQ0EsZUFBZSxNQUFNO0FBQ3JCO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyw4QkFBOEI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxpRUFBVztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw0REFBaUI7QUFDOUIsS0FBSztBQUNMLFFBQVEsaUVBQVcsdUJBQXVCLCtEQUFTO0FBQ25ELGVBQWUsaUVBQVc7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEtBQUs7QUFDTDtBQUNBO0FBQ0Esb0VBQW9FO0FBQ3BFO0FBQ0EscUJBQXFCLDRFQUF5QixZQUFZLDJEQUFtQjtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaUVBQVc7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsMkNBQTJDO0FBQ3REO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSwwQkFBMEI7QUFDNUY7QUFDQTtBQUNBLHFDQUFxQyxRQUFRO0FBQzdDO0FBQ0EsUUFBUSwrREFBUztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQVM7QUFDakI7QUFDQTtBQUNBLG9CQUFvQiwyREFBUyw2Q0FBNkM7QUFDMUU7QUFDQTtBQUNBLG9DQUFvQywrREFBUywrQkFBK0IseURBQU87QUFDbkYsMkJBQTJCLHlEQUFPO0FBQ2xDLFVBQVUseURBQU87QUFDakI7QUFDQSxHQUFHO0FBQ0g7QUFDQSxnRUFBZ0Usb0JBQW9CO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsc0RBQUk7QUFDekI7O0FBRUE7QUFDcUM7QUFDckMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvVG9vbE5vZGUuanM/YjY4NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUb29sSW52b2NhdGlvbkVycm9yIH0gZnJvbSBcIi4uL2Vycm9ycy5qc1wiO1xuaW1wb3J0IHsgUnVubmFibGVDYWxsYWJsZSB9IGZyb20gXCIuLi9SdW5uYWJsZUNhbGxhYmxlLmpzXCI7XG5pbXBvcnQgeyBtZXJnZUFib3J0U2lnbmFscyB9IGZyb20gXCIuL3V0aWxzLmpzXCI7XG5pbXBvcnQgeyBBSU1lc3NhZ2UsIEJhc2VNZXNzYWdlLCBUb29sTWVzc2FnZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXNcIjtcbmltcG9ydCB7IFRvb2xJbnB1dFBhcnNpbmdFeGNlcHRpb24gfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3Rvb2xzXCI7XG5pbXBvcnQgeyBDb21tYW5kLCBTZW5kLCBpc0NvbW1hbmQsIGlzR3JhcGhJbnRlcnJ1cHQgfSBmcm9tIFwiQGxhbmdjaGFpbi9sYW5nZ3JhcGhcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvbm9kZXMvVG9vbE5vZGUudHNcbi8qKlxuKiBFcnJvciBtZXNzYWdlIHRlbXBsYXRlIGZvciB3aGVuIG1pZGRsZXdhcmUgYWRkcyB0b29scyB0aGF0IGNhbid0IGJlIGV4ZWN1dGVkLlxuKiBUaGlzIGhhcHBlbnMgd2hlbiBtaWRkbGV3YXJlIG1vZGlmaWVzIHRvb2xzIGluIHdyYXBNb2RlbENhbGwgYnV0IGRvZXNuJ3QgcHJvdmlkZVxuKiBhIHdyYXBUb29sQ2FsbCBoYW5kbGVyIHRvIGV4ZWN1dGUgdGhlbS5cbiovXG5jb25zdCBnZXRJbnZhbGlkVG9vbEVycm9yID0gKHRvb2xOYW1lLCBhdmFpbGFibGVUb29scykgPT4gYEVycm9yOiAke3Rvb2xOYW1lfSBpcyBub3QgYSB2YWxpZCB0b29sLCB0cnkgb25lIG9mIFske2F2YWlsYWJsZVRvb2xzLmpvaW4oXCIsIFwiKX1dLmA7XG4vKipcbiogVGhlIG5hbWUgb2YgdGhlIHRvb2wgbm9kZSBpbiB0aGUgc3RhdGUgZ3JhcGguXG4qL1xuY29uc3QgVE9PTFNfTk9ERV9OQU1FID0gXCJ0b29sc1wiO1xuY29uc3QgaXNCYXNlTWVzc2FnZUFycmF5ID0gKGlucHV0KSA9PiBBcnJheS5pc0FycmF5KGlucHV0KSAmJiBpbnB1dC5ldmVyeShCYXNlTWVzc2FnZS5pc0luc3RhbmNlKTtcbmNvbnN0IGlzTWVzc2FnZXNTdGF0ZSA9IChpbnB1dCkgPT4gdHlwZW9mIGlucHV0ID09PSBcIm9iamVjdFwiICYmIGlucHV0ICE9IG51bGwgJiYgXCJtZXNzYWdlc1wiIGluIGlucHV0ICYmIGlzQmFzZU1lc3NhZ2VBcnJheShpbnB1dC5tZXNzYWdlcyk7XG5jb25zdCBpc1NlbmRJbnB1dCA9IChpbnB1dCkgPT4gdHlwZW9mIGlucHV0ID09PSBcIm9iamVjdFwiICYmIGlucHV0ICE9IG51bGwgJiYgXCJsZ190b29sX2NhbGxcIiBpbiBpbnB1dDtcbi8qKlxuKiBEZWZhdWx0IGVycm9yIGhhbmRsZXIgZm9yIHRvb2wgZXJyb3JzLlxuKlxuKiBUaGlzIGlzIGFwcGxpZWQgdG8gZXJyb3JzIGZyb20gYmFzZUhhbmRsZXIgKHRvb2wgZXhlY3V0aW9uKS5cbiogRm9yIGVycm9ycyBmcm9tIHdyYXBUb29sQ2FsbCBtaWRkbGV3YXJlLCB0aG9zZSBhcmUgaGFuZGxlZCBzZXBhcmF0ZWx5XG4qIGFuZCB3aWxsIGJ1YmJsZSB1cCBieSBkZWZhdWx0LlxuKlxuKiBDYXRjaGVzIGFsbCB0b29sIGV4ZWN1dGlvbiBlcnJvcnMgYW5kIGNvbnZlcnRzIHRoZW0gdG8gVG9vbE1lc3NhZ2UuXG4qIFRoaXMgYWxsb3dzIHRoZSBMTE0gdG8gc2VlIHRoZSBlcnJvciBhbmQgcG90ZW50aWFsbHkgcmV0cnkgd2l0aCBkaWZmZXJlbnQgYXJndW1lbnRzLlxuKi9cbmZ1bmN0aW9uIGRlZmF1bHRIYW5kbGVUb29sRXJyb3JzKGVycm9yLCB0b29sQ2FsbCkge1xuXHRpZiAoZXJyb3IgaW5zdGFuY2VvZiBUb29sSW52b2NhdGlvbkVycm9yKSByZXR1cm4gbmV3IFRvb2xNZXNzYWdlKHtcblx0XHRjb250ZW50OiBlcnJvci5tZXNzYWdlLFxuXHRcdHRvb2xfY2FsbF9pZDogdG9vbENhbGwuaWQsXG5cdFx0bmFtZTogdG9vbENhbGwubmFtZVxuXHR9KTtcblx0LyoqXG5cdCogQ2F0Y2ggYWxsIG90aGVyIHRvb2wgZXJyb3JzIGFuZCBjb252ZXJ0IHRvIFRvb2xNZXNzYWdlXG5cdCovXG5cdHJldHVybiBuZXcgVG9vbE1lc3NhZ2Uoe1xuXHRcdGNvbnRlbnQ6IGAke2Vycm9yfVxcbiBQbGVhc2UgZml4IHlvdXIgbWlzdGFrZXMuYCxcblx0XHR0b29sX2NhbGxfaWQ6IHRvb2xDYWxsLmlkLFxuXHRcdG5hbWU6IHRvb2xDYWxsLm5hbWVcblx0fSk7XG59XG4vKipcbiogYFRvb2xOb2RlYCBpcyBhIGJ1aWx0LWluIExhbmdHcmFwaCBjb21wb25lbnQgdGhhdCBoYW5kbGVzIHRvb2wgY2FsbHMgd2l0aGluIGFuIGFnZW50J3Mgd29ya2Zsb3cuXG4qIEl0IHdvcmtzIHNlYW1sZXNzbHkgd2l0aCBgY3JlYXRlQWdlbnRgLCBvZmZlcmluZyBhZHZhbmNlZCB0b29sIGV4ZWN1dGlvbiBjb250cm9sLCBidWlsdFxuKiBpbiBwYXJhbGxlbGlzbSwgYW5kIGVycm9yIGhhbmRsaW5nLlxuKlxuKiBAZXhhbXBsZVxuKiBgYGB0c1xuKiBpbXBvcnQgeyBUb29sTm9kZSwgdG9vbCwgQUlNZXNzYWdlIH0gZnJvbSBcImxhbmdjaGFpblwiO1xuKiBpbXBvcnQgeyB6IH0gZnJvbSBcInpvZC92M1wiO1xuKlxuKiBjb25zdCBnZXRXZWF0aGVyID0gdG9vbCgoaW5wdXQpID0+IHtcbiogICBpZiAoW1wic2ZcIiwgXCJzYW4gZnJhbmNpc2NvXCJdLmluY2x1ZGVzKGlucHV0LmxvY2F0aW9uLnRvTG93ZXJDYXNlKCkpKSB7XG4qICAgICByZXR1cm4gXCJJdCdzIDYwIGRlZ3JlZXMgYW5kIGZvZ2d5LlwiO1xuKiAgIH0gZWxzZSB7XG4qICAgICByZXR1cm4gXCJJdCdzIDkwIGRlZ3JlZXMgYW5kIHN1bm55LlwiO1xuKiAgIH1cbiogfSwge1xuKiAgIG5hbWU6IFwiZ2V0X3dlYXRoZXJcIixcbiogICBkZXNjcmlwdGlvbjogXCJDYWxsIHRvIGdldCB0aGUgY3VycmVudCB3ZWF0aGVyLlwiLFxuKiAgIHNjaGVtYTogei5vYmplY3Qoe1xuKiAgICAgbG9jYXRpb246IHouc3RyaW5nKCkuZGVzY3JpYmUoXCJMb2NhdGlvbiB0byBnZXQgdGhlIHdlYXRoZXIgZm9yLlwiKSxcbiogICB9KSxcbiogfSk7XG4qXG4qIGNvbnN0IHRvb2xzID0gW2dldFdlYXRoZXJdO1xuKiBjb25zdCB0b29sTm9kZSA9IG5ldyBUb29sTm9kZSh0b29scyk7XG4qXG4qIGNvbnN0IG1lc3NhZ2VXaXRoU2luZ2xlVG9vbENhbGwgPSBuZXcgQUlNZXNzYWdlKHtcbiogICBjb250ZW50OiBcIlwiLFxuKiAgIHRvb2xfY2FsbHM6IFtcbiogICAgIHtcbiogICAgICAgbmFtZTogXCJnZXRfd2VhdGhlclwiLFxuKiAgICAgICBhcmdzOiB7IGxvY2F0aW9uOiBcInNmXCIgfSxcbiogICAgICAgaWQ6IFwidG9vbF9jYWxsX2lkXCIsXG4qICAgICAgIHR5cGU6IFwidG9vbF9jYWxsXCIsXG4qICAgICB9XG4qICAgXVxuKiB9KVxuKlxuKiBhd2FpdCB0b29sTm9kZS5pbnZva2UoeyBtZXNzYWdlczogW21lc3NhZ2VXaXRoU2luZ2xlVG9vbENhbGxdIH0pO1xuKiAvLyBSZXR1cm5zIHRvb2wgaW52b2NhdGlvbiByZXNwb25zZXMgYXM6XG4qIC8vIHsgbWVzc2FnZXM6IFRvb2xNZXNzYWdlW10gfVxuKiBgYGBcbiovXG52YXIgVG9vbE5vZGUgPSBjbGFzcyBleHRlbmRzIFJ1bm5hYmxlQ2FsbGFibGUge1xuXHR0b29scztcblx0dHJhY2UgPSBmYWxzZTtcblx0c2lnbmFsO1xuXHRoYW5kbGVUb29sRXJyb3JzID0gZGVmYXVsdEhhbmRsZVRvb2xFcnJvcnM7XG5cdHdyYXBUb29sQ2FsbDtcblx0Y29uc3RydWN0b3IodG9vbHMsIG9wdGlvbnMpIHtcblx0XHRjb25zdCB7IG5hbWUsIHRhZ3MsIGhhbmRsZVRvb2xFcnJvcnMsIHNpZ25hbCwgd3JhcFRvb2xDYWxsIH0gPSBvcHRpb25zID8/IHt9O1xuXHRcdHN1cGVyKHtcblx0XHRcdG5hbWUsXG5cdFx0XHR0YWdzLFxuXHRcdFx0ZnVuYzogKHN0YXRlLCBjb25maWcpID0+IHRoaXMucnVuKHN0YXRlLCBjb25maWcpXG5cdFx0fSk7XG5cdFx0dGhpcy5vcHRpb25zID0gb3B0aW9ucztcblx0XHR0aGlzLnRvb2xzID0gdG9vbHM7XG5cdFx0dGhpcy5oYW5kbGVUb29sRXJyb3JzID0gaGFuZGxlVG9vbEVycm9ycyA/PyB0aGlzLmhhbmRsZVRvb2xFcnJvcnM7XG5cdFx0dGhpcy5zaWduYWwgPSBzaWduYWw7XG5cdFx0dGhpcy53cmFwVG9vbENhbGwgPSB3cmFwVG9vbENhbGw7XG5cdH1cblx0LyoqXG5cdCogSGFuZGxlIGVycm9ycyBmcm9tIHRvb2wgZXhlY3V0aW9uIG9yIG1pZGRsZXdhcmUuXG5cdCogQHBhcmFtIGVycm9yIC0gVGhlIGVycm9yIHRvIGhhbmRsZVxuXHQqIEBwYXJhbSBjYWxsIC0gVGhlIHRvb2wgY2FsbCB0aGF0IGNhdXNlZCB0aGUgZXJyb3Jcblx0KiBAcGFyYW0gaXNNaWRkbGV3YXJlRXJyb3IgLSBXaGV0aGVyIHRoZSBlcnJvciBjYW1lIGZyb20gd3JhcFRvb2xDYWxsIG1pZGRsZXdhcmVcblx0KiBAcmV0dXJucyBUb29sTWVzc2FnZSBpZiBlcnJvciBpcyBoYW5kbGVkLCBvdGhlcndpc2UgcmUtdGhyb3dzXG5cdCovXG5cdCNoYW5kbGVFcnJvcihlcnJvciwgY2FsbCwgaXNNaWRkbGV3YXJlRXJyb3IpIHtcblx0XHQvKipcblx0XHQqIHtAbGluayBOb2RlSW50ZXJydXB0fSBlcnJvcnMgYXJlIGEgYnJlYWtwb2ludCB0byBicmluZyBhIGh1bWFuIGludG8gdGhlIGxvb3AuXG5cdFx0KiBBcyBzdWNoLCB0aGV5IGFyZSBub3QgcmVjb3ZlcmFibGUgYnkgdGhlIGFnZW50IGFuZCBzaG91bGRuJ3QgYmUgZmVkXG5cdFx0KiBiYWNrLiBJbnN0ZWFkLCByZS10aHJvdyB0aGVzZSBlcnJvcnMgZXZlbiB3aGVuIGBoYW5kbGVUb29sRXJyb3JzID0gdHJ1ZWAuXG5cdFx0Ki9cblx0XHRpZiAoaXNHcmFwaEludGVycnVwdChlcnJvcikpIHRocm93IGVycm9yO1xuXHRcdC8qKlxuXHRcdCogSWYgdGhlIHNpZ25hbCBpcyBhYm9ydGVkLCB3ZSB3YW50IHRvIGJ1YmJsZSB1cCB0aGUgZXJyb3IgdG8gdGhlIGludm9rZSBjYWxsZXIuXG5cdFx0Ki9cblx0XHRpZiAodGhpcy5zaWduYWw/LmFib3J0ZWQpIHRocm93IGVycm9yO1xuXHRcdC8qKlxuXHRcdCogSWYgZXJyb3IgaXMgZnJvbSBtaWRkbGV3YXJlIGFuZCBoYW5kbGVUb29sRXJyb3JzIGlzIG5vdCB0cnVlLCBidWJibGUgdXBcblx0XHQqIChkZWZhdWx0IGhhbmRsZXIgYW5kIGZhbHNlIGJvdGggcmUtcmFpc2UgbWlkZGxld2FyZSBlcnJvcnMpXG5cdFx0Ki9cblx0XHRpZiAoaXNNaWRkbGV3YXJlRXJyb3IgJiYgdGhpcy5oYW5kbGVUb29sRXJyb3JzICE9PSB0cnVlKSB0aHJvdyBlcnJvcjtcblx0XHQvKipcblx0XHQqIElmIGhhbmRsZVRvb2xFcnJvcnMgaXMgZmFsc2UsIHRocm93IGFsbCBlcnJvcnNcblx0XHQqL1xuXHRcdGlmICghdGhpcy5oYW5kbGVUb29sRXJyb3JzKSB0aHJvdyBlcnJvcjtcblx0XHQvKipcblx0XHQqIEFwcGx5IGhhbmRsZVRvb2xFcnJvcnMgdG8gdGhlIGVycm9yXG5cdFx0Ki9cblx0XHRpZiAodHlwZW9mIHRoaXMuaGFuZGxlVG9vbEVycm9ycyA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRjb25zdCByZXN1bHQgPSB0aGlzLmhhbmRsZVRvb2xFcnJvcnMoZXJyb3IsIGNhbGwpO1xuXHRcdFx0aWYgKHJlc3VsdCAmJiBUb29sTWVzc2FnZS5pc0luc3RhbmNlKHJlc3VsdCkpIHJldHVybiByZXN1bHQ7XG5cdFx0XHQvKipcblx0XHRcdCogYGhhbmRsZVRvb2xFcnJvcnNgIHJldHVybmVkIHVuZGVmaW5lZCAtIHJlLXJhaXNlXG5cdFx0XHQqL1xuXHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0fSBlbHNlIGlmICh0aGlzLmhhbmRsZVRvb2xFcnJvcnMpIHJldHVybiBuZXcgVG9vbE1lc3NhZ2Uoe1xuXHRcdFx0bmFtZTogY2FsbC5uYW1lLFxuXHRcdFx0Y29udGVudDogYCR7ZXJyb3J9XFxuIFBsZWFzZSBmaXggeW91ciBtaXN0YWtlcy5gLFxuXHRcdFx0dG9vbF9jYWxsX2lkOiBjYWxsLmlkXG5cdFx0fSk7XG5cdFx0LyoqXG5cdFx0KiBTaG91bGRuJ3QgcmVhY2ggaGVyZSwgYnV0IHRocm93IGFzIGZhbGxiYWNrXG5cdFx0Ki9cblx0XHR0aHJvdyBlcnJvcjtcblx0fVxuXHRhc3luYyBydW5Ub29sKGNhbGwsIGNvbmZpZywgc3RhdGUpIHtcblx0XHQvKipcblx0XHQqIEJ1aWxkIHJ1bnRpbWUgZnJvbSBMYW5nR3JhcGggY29uZmlnXG5cdFx0Ki9cblx0XHRjb25zdCBsZ0NvbmZpZyA9IGNvbmZpZztcblx0XHRjb25zdCBydW50aW1lID0ge1xuXHRcdFx0Y29udGV4dDogbGdDb25maWc/LmNvbnRleHQsXG5cdFx0XHR3cml0ZXI6IGxnQ29uZmlnPy53cml0ZXIsXG5cdFx0XHRpbnRlcnJ1cHQ6IGxnQ29uZmlnPy5pbnRlcnJ1cHQsXG5cdFx0XHRzaWduYWw6IGxnQ29uZmlnPy5zaWduYWxcblx0XHR9O1xuXHRcdC8qKlxuXHRcdCogRmluZCB0aGUgdG9vbCBpbnN0YW5jZSB0byBpbmNsdWRlIGluIHRoZSByZXF1ZXN0LlxuXHRcdCogRm9yIGR5bmFtaWNhbGx5IHJlZ2lzdGVyZWQgdG9vbHMsIHRoaXMgbWF5IGJlIHVuZGVmaW5lZC5cblx0XHQqL1xuXHRcdGNvbnN0IHJlZ2lzdGVyZWRUb29sID0gdGhpcy50b29scy5maW5kKCh0KSA9PiB0Lm5hbWUgPT09IGNhbGwubmFtZSk7XG5cdFx0LyoqXG5cdFx0KiBEZWZpbmUgdGhlIGJhc2UgaGFuZGxlciB0aGF0IGV4ZWN1dGVzIHRoZSB0b29sLlxuXHRcdCogV2hlbiB3cmFwVG9vbENhbGwgbWlkZGxld2FyZSBpcyBwcmVzZW50LCB0aGlzIGhhbmRsZXIgZG9lcyBOT1QgY2F0Y2ggZXJyb3JzXG5cdFx0KiBzbyB0aGUgbWlkZGxld2FyZSBjYW4gaGFuZGxlIHRoZW0uXG5cdFx0KiBXaGVuIG5vIG1pZGRsZXdhcmUsIGVycm9ycyBhcmUgY2F1Z2h0IGFuZCBoYW5kbGVkIGhlcmUuXG5cdFx0KlxuXHRcdCogVGhlIGhhbmRsZXIgbm93IGFjY2VwdHMgYW4gb3ZlcnJpZGRlbiB0b29sIGZyb20gdGhlIHJlcXVlc3QsIGFsbG93aW5nXG5cdFx0KiBtaWRkbGV3YXJlIHRvIHByb3ZpZGUgdG9vbCBpbXBsZW1lbnRhdGlvbnMgZm9yIGR5bmFtaWNhbGx5IHJlZ2lzdGVyZWQgdG9vbHMuXG5cdFx0Ki9cblx0XHRjb25zdCBiYXNlSGFuZGxlciA9IGFzeW5jIChyZXF1ZXN0KSA9PiB7XG5cdFx0XHRjb25zdCB7IHRvb2xDYWxsLCB0b29sOiByZXF1ZXN0VG9vbCB9ID0gcmVxdWVzdDtcblx0XHRcdC8qKlxuXHRcdFx0KiBVc2UgdGhlIHRvb2wgZnJvbSB0aGUgcmVxdWVzdCAod2hpY2ggbWF5IGJlIG92ZXJyaWRkZW4gdmlhIHNwcmVhZCBzeW50YXgpXG5cdFx0XHQqIG9yIGZhbGwgYmFjayB0byBmaW5kaW5nIGl0IGluIHJlZ2lzdGVyZWQgdG9vbHMuXG5cdFx0XHQqIFRoaXMgYWxsb3dzIG1pZGRsZXdhcmUgdG8gcHJvdmlkZSBkeW5hbWljIHRvb2wgaW1wbGVtZW50YXRpb25zLlxuXHRcdFx0Ki9cblx0XHRcdGNvbnN0IHRvb2wgPSByZXF1ZXN0VG9vbCA/PyB0aGlzLnRvb2xzLmZpbmQoKHQpID0+IHQubmFtZSA9PT0gdG9vbENhbGwubmFtZSk7XG5cdFx0XHRpZiAodG9vbCA9PT0gdm9pZCAwKSB7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIFRvb2wgbm90IGZvdW5kIC0gcmV0dXJuIGEgZ3JhY2VmdWwgZXJyb3IgbWVzc2FnZSByYXRoZXIgdGhhbiB0aHJvd2luZy5cblx0XHRcdFx0KiBUaGlzIGFsbG93cyB0aGUgTExNIHRvIHNlZSB0aGUgZXJyb3IgYW5kIHBvdGVudGlhbGx5IHJldHJ5LlxuXHRcdFx0XHQqL1xuXHRcdFx0XHRjb25zdCBhdmFpbGFibGVUb29scyA9IHRoaXMudG9vbHMubWFwKCh0KSA9PiB0Lm5hbWUpO1xuXHRcdFx0XHRyZXR1cm4gbmV3IFRvb2xNZXNzYWdlKHtcblx0XHRcdFx0XHRjb250ZW50OiBnZXRJbnZhbGlkVG9vbEVycm9yKHRvb2xDYWxsLm5hbWUsIGF2YWlsYWJsZVRvb2xzKSxcblx0XHRcdFx0XHR0b29sX2NhbGxfaWQ6IHRvb2xDYWxsLmlkLFxuXHRcdFx0XHRcdG5hbWU6IHRvb2xDYWxsLm5hbWUsXG5cdFx0XHRcdFx0c3RhdHVzOiBcImVycm9yXCJcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHQvKipcblx0XHRcdCogQ2FzdCB0b29sIHRvIGEgY29tbW9uIGludm9rYWJsZSB0eXBlLlxuXHRcdFx0KiBUaGUgdG9vbCBjYW4gYmUgZnJvbSByZWdpc3RlcmVkIHRvb2xzIChTdHJ1Y3R1cmVkVG9vbEludGVyZmFjZSB8IER5bmFtaWNUb29sIHwgUnVubmFibGVUb29sTGlrZSlcblx0XHRcdCogb3IgZnJvbSBtaWRkbGV3YXJlIG92ZXJyaWRlIChDbGllbnRUb29sIHwgU2VydmVyVG9vbCkuXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3QgaW52b2thYmxlVG9vbCA9IHRvb2w7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCBvdXRwdXQgPSBhd2FpdCBpbnZva2FibGVUb29sLmludm9rZSh7XG5cdFx0XHRcdFx0Li4udG9vbENhbGwsXG5cdFx0XHRcdFx0dHlwZTogXCJ0b29sX2NhbGxcIlxuXHRcdFx0XHR9LCB7XG5cdFx0XHRcdFx0Li4uY29uZmlnLFxuXHRcdFx0XHRcdGNvbmZpZyxcblx0XHRcdFx0XHR0b29sQ2FsbElkOiB0b29sQ2FsbC5pZCxcblx0XHRcdFx0XHRzdGF0ZTogY29uZmlnLmNvbmZpZ3VyYWJsZT8uX19wcmVnZWxfc2NyYXRjaHBhZD8uY3VycmVudFRhc2tJbnB1dCxcblx0XHRcdFx0XHRzaWduYWw6IG1lcmdlQWJvcnRTaWduYWxzKHRoaXMuc2lnbmFsLCBjb25maWcuc2lnbmFsKVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKFRvb2xNZXNzYWdlLmlzSW5zdGFuY2Uob3V0cHV0KSB8fCBpc0NvbW1hbmQob3V0cHV0KSkgcmV0dXJuIG91dHB1dDtcblx0XHRcdFx0cmV0dXJuIG5ldyBUb29sTWVzc2FnZSh7XG5cdFx0XHRcdFx0bmFtZTogaW52b2thYmxlVG9vbC5uYW1lLFxuXHRcdFx0XHRcdGNvbnRlbnQ6IHR5cGVvZiBvdXRwdXQgPT09IFwic3RyaW5nXCIgPyBvdXRwdXQgOiBKU09OLnN0cmluZ2lmeShvdXRwdXQpLFxuXHRcdFx0XHRcdHRvb2xfY2FsbF9pZDogdG9vbENhbGwuaWRcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIEhhbmRsZSBlcnJvcnMgZnJvbSB0b29sIGV4ZWN1dGlvbiAobm90IGZyb20gd3JhcFRvb2xDYWxsKVxuXHRcdFx0XHQqIElmIHRvb2wgaW52b2NhdGlvbiBmYWlscyBkdWUgdG8gaW5wdXQgcGFyc2luZyBlcnJvciwgdGhyb3cgYSB7QGxpbmsgVG9vbEludm9jYXRpb25FcnJvcn1cblx0XHRcdFx0Ki9cblx0XHRcdFx0aWYgKGUgaW5zdGFuY2VvZiBUb29sSW5wdXRQYXJzaW5nRXhjZXB0aW9uKSB0aHJvdyBuZXcgVG9vbEludm9jYXRpb25FcnJvcihlLCB0b29sQ2FsbCk7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIFJlLXRocm93IHRvIGJlIGhhbmRsZWQgYnkgY2FsbGVyXG5cdFx0XHRcdCovXG5cdFx0XHRcdHRocm93IGU7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHQvKipcblx0XHQqIENyZWF0ZSByZXF1ZXN0IG9iamVjdCBmb3IgbWlkZGxld2FyZVxuXHRcdCogQ2FzdCB0byBUb29sQ2FsbFJlcXVlc3Q8QWdlbnRCdWlsdEluU3RhdGU+IHRvIHNhdGlzZnkgdHlwZSBjb25zdHJhaW50c1xuXHRcdCogb2Ygd3JhcFRvb2xDYWxsIHdoaWNoIGV4cGVjdHMgQWdlbnRCdWlsdEluU3RhdGVcblx0XHQqL1xuXHRcdGNvbnN0IHJlcXVlc3QgPSB7XG5cdFx0XHR0b29sQ2FsbDogY2FsbCxcblx0XHRcdHRvb2w6IHJlZ2lzdGVyZWRUb29sLFxuXHRcdFx0c3RhdGUsXG5cdFx0XHRydW50aW1lXG5cdFx0fTtcblx0XHQvKipcblx0XHQqIElmIHdyYXBUb29sQ2FsbCBpcyBwcm92aWRlZCwgdXNlIGl0IHRvIHdyYXAgdGhlIHRvb2wgZXhlY3V0aW9uXG5cdFx0Ki9cblx0XHRpZiAodGhpcy53cmFwVG9vbENhbGwpIHRyeSB7XG5cdFx0XHRyZXR1cm4gYXdhaXQgdGhpcy53cmFwVG9vbENhbGwocmVxdWVzdCwgYmFzZUhhbmRsZXIpO1xuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdC8qKlxuXHRcdFx0KiBIYW5kbGUgbWlkZGxld2FyZSBlcnJvcnNcblx0XHRcdCovXG5cdFx0XHRyZXR1cm4gdGhpcy4jaGFuZGxlRXJyb3IoZSwgY2FsbCwgdHJ1ZSk7XG5cdFx0fVxuXHRcdC8qKlxuXHRcdCogTm8gd3JhcFRvb2xDYWxsIC0gaWYgdG9vbCB3YXNuJ3QgZm91bmQsIHJldHVybiBncmFjZWZ1bCBlcnJvclxuXHRcdCovXG5cdFx0aWYgKCFyZWdpc3RlcmVkVG9vbCkge1xuXHRcdFx0Y29uc3QgYXZhaWxhYmxlVG9vbHMgPSB0aGlzLnRvb2xzLm1hcCgodCkgPT4gdC5uYW1lKTtcblx0XHRcdHJldHVybiBuZXcgVG9vbE1lc3NhZ2Uoe1xuXHRcdFx0XHRjb250ZW50OiBnZXRJbnZhbGlkVG9vbEVycm9yKGNhbGwubmFtZSwgYXZhaWxhYmxlVG9vbHMpLFxuXHRcdFx0XHR0b29sX2NhbGxfaWQ6IGNhbGwuaWQsXG5cdFx0XHRcdG5hbWU6IGNhbGwubmFtZSxcblx0XHRcdFx0c3RhdHVzOiBcImVycm9yXCJcblx0XHRcdH0pO1xuXHRcdH1cblx0XHQvKipcblx0XHQqIE5vIHdyYXBUb29sQ2FsbCAtIGV4ZWN1dGUgdG9vbCBkaXJlY3RseSBhbmQgaGFuZGxlIGVycm9ycyBoZXJlXG5cdFx0Ki9cblx0XHR0cnkge1xuXHRcdFx0cmV0dXJuIGF3YWl0IGJhc2VIYW5kbGVyKHJlcXVlc3QpO1xuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdC8qKlxuXHRcdFx0KiBIYW5kbGUgdG9vbCBlcnJvcnMgd2hlbiBubyBtaWRkbGV3YXJlIHByb3ZpZGVkXG5cdFx0XHQqL1xuXHRcdFx0cmV0dXJuIHRoaXMuI2hhbmRsZUVycm9yKGUsIGNhbGwsIGZhbHNlKTtcblx0XHR9XG5cdH1cblx0YXN5bmMgcnVuKHN0YXRlLCBjb25maWcpIHtcblx0XHRsZXQgb3V0cHV0cztcblx0XHRpZiAoaXNTZW5kSW5wdXQoc3RhdGUpKSB7XG5cdFx0XHRjb25zdCB7IGxnX3Rvb2xfY2FsbDogXywganVtcFRvOiBfXywgLi4ubmV3U3RhdGUgfSA9IHN0YXRlO1xuXHRcdFx0b3V0cHV0cyA9IFthd2FpdCB0aGlzLnJ1blRvb2woc3RhdGUubGdfdG9vbF9jYWxsLCBjb25maWcsIG5ld1N0YXRlKV07XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxldCBtZXNzYWdlcztcblx0XHRcdGlmIChpc0Jhc2VNZXNzYWdlQXJyYXkoc3RhdGUpKSBtZXNzYWdlcyA9IHN0YXRlO1xuXHRcdFx0ZWxzZSBpZiAoaXNNZXNzYWdlc1N0YXRlKHN0YXRlKSkgbWVzc2FnZXMgPSBzdGF0ZS5tZXNzYWdlcztcblx0XHRcdGVsc2UgdGhyb3cgbmV3IEVycm9yKFwiVG9vbE5vZGUgb25seSBhY2NlcHRzIEJhc2VNZXNzYWdlW10gb3IgeyBtZXNzYWdlczogQmFzZU1lc3NhZ2VbXSB9IGFzIGlucHV0LlwiKTtcblx0XHRcdGNvbnN0IHRvb2xNZXNzYWdlSWRzID0gbmV3IFNldChtZXNzYWdlcy5maWx0ZXIoKG1zZykgPT4gbXNnLmdldFR5cGUoKSA9PT0gXCJ0b29sXCIpLm1hcCgobXNnKSA9PiBtc2cudG9vbF9jYWxsX2lkKSk7XG5cdFx0XHRsZXQgYWlNZXNzYWdlO1xuXHRcdFx0Zm9yIChsZXQgaSA9IG1lc3NhZ2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaSAtPSAxKSB7XG5cdFx0XHRcdGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlc1tpXTtcblx0XHRcdFx0aWYgKEFJTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2UpKSB7XG5cdFx0XHRcdFx0YWlNZXNzYWdlID0gbWVzc2FnZTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKCFBSU1lc3NhZ2UuaXNJbnN0YW5jZShhaU1lc3NhZ2UpKSB0aHJvdyBuZXcgRXJyb3IoXCJUb29sTm9kZSBvbmx5IGFjY2VwdHMgQUlNZXNzYWdlcyBhcyBpbnB1dC5cIik7XG5cdFx0XHRvdXRwdXRzID0gYXdhaXQgUHJvbWlzZS5hbGwoYWlNZXNzYWdlLnRvb2xfY2FsbHM/LmZpbHRlcigoY2FsbCkgPT4gY2FsbC5pZCA9PSBudWxsIHx8ICF0b29sTWVzc2FnZUlkcy5oYXMoY2FsbC5pZCkpLm1hcCgoY2FsbCkgPT4gdGhpcy5ydW5Ub29sKGNhbGwsIGNvbmZpZywgc3RhdGUpKSA/PyBbXSk7XG5cdFx0fVxuXHRcdGlmICghb3V0cHV0cy5zb21lKGlzQ29tbWFuZCkpIHJldHVybiBBcnJheS5pc0FycmF5KHN0YXRlKSA/IG91dHB1dHMgOiB7IG1lc3NhZ2VzOiBvdXRwdXRzIH07XG5cdFx0Y29uc3QgY29tYmluZWRPdXRwdXRzID0gW107XG5cdFx0bGV0IHBhcmVudENvbW1hbmQgPSBudWxsO1xuXHRcdGZvciAoY29uc3Qgb3V0cHV0IG9mIG91dHB1dHMpIGlmIChpc0NvbW1hbmQob3V0cHV0KSkgaWYgKG91dHB1dC5ncmFwaCA9PT0gQ29tbWFuZC5QQVJFTlQgJiYgQXJyYXkuaXNBcnJheShvdXRwdXQuZ290bykgJiYgb3V0cHV0LmdvdG8uZXZlcnkoKHNlbmQpID0+IGlzU2VuZChzZW5kKSkpIGlmIChwYXJlbnRDb21tYW5kKSBwYXJlbnRDb21tYW5kLmdvdG8ucHVzaCguLi5vdXRwdXQuZ290byk7XG5cdFx0ZWxzZSBwYXJlbnRDb21tYW5kID0gbmV3IENvbW1hbmQoe1xuXHRcdFx0Z3JhcGg6IENvbW1hbmQuUEFSRU5ULFxuXHRcdFx0Z290bzogb3V0cHV0LmdvdG9cblx0XHR9KTtcblx0XHRlbHNlIGNvbWJpbmVkT3V0cHV0cy5wdXNoKG91dHB1dCk7XG5cdFx0ZWxzZSBjb21iaW5lZE91dHB1dHMucHVzaChBcnJheS5pc0FycmF5KHN0YXRlKSA/IFtvdXRwdXRdIDogeyBtZXNzYWdlczogW291dHB1dF0gfSk7XG5cdFx0aWYgKHBhcmVudENvbW1hbmQpIGNvbWJpbmVkT3V0cHV0cy5wdXNoKHBhcmVudENvbW1hbmQpO1xuXHRcdHJldHVybiBjb21iaW5lZE91dHB1dHM7XG5cdH1cbn07XG5mdW5jdGlvbiBpc1NlbmQoeCkge1xuXHRyZXR1cm4geCBpbnN0YW5jZW9mIFNlbmQ7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgVE9PTFNfTk9ERV9OQU1FLCBUb29sTm9kZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VG9vbE5vZGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/ToolNode.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/middleware.js":
/*!************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/middleware.js ***!
  \************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MiddlewareNode: () => (/* binding */ MiddlewareNode)\n/* harmony export */ });\n/* harmony import */ var _RunnableCallable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../RunnableCallable.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/RunnableCallable.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/utils.js\");\n/* harmony import */ var _middleware_utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../middleware/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/utils/types */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/types/index.js\");\n\n\n\n\n\n//#region src/agents/nodes/middleware.ts\n/**\n* Named class for context objects to provide better error messages\n*/\nvar AgentContext = class {};\nvar AgentRuntime = class {};\nvar MiddlewareNode = class extends _RunnableCallable_js__WEBPACK_IMPORTED_MODULE_0__.RunnableCallable {\n\t#options;\n\tconstructor(fields, options) {\n\t\tsuper(fields);\n\t\tthis.#options = options;\n\t}\n\tasync invokeMiddleware(invokeState, config) {\n\t\t/**\n\t\t* Filter context based on middleware's contextSchema\n\t\t*/\n\t\tlet filteredContext = {};\n\t\t/**\n\t\t* Parse context using middleware's contextSchema to apply defaults and validation\n\t\t*/\n\t\tif (this.middleware.contextSchema) {\n\t\t\t/**\n\t\t\t* Extract only the fields relevant to this middleware's schema\n\t\t\t*/\n\t\t\tconst schemaShape = this.middleware.contextSchema?.shape;\n\t\t\tif (schemaShape) {\n\t\t\t\tconst relevantContext = {};\n\t\t\t\tconst invokeContext = config?.context || {};\n\t\t\t\tfor (const key of Object.keys(schemaShape)) if (key in invokeContext) relevantContext[key] = invokeContext[key];\n\t\t\t\t/**\n\t\t\t\t* Parse to apply defaults and validation, even if relevantContext is empty\n\t\t\t\t* This will throw if required fields are missing and no defaults exist\n\t\t\t\t*/\n\t\t\t\tfilteredContext = (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_3__.interopParse)(this.middleware.contextSchema, relevantContext);\n\t\t\t}\n\t\t}\n\t\tconst state = {\n\t\t\t...this.#options.getState(),\n\t\t\t...invokeState,\n\t\t\tmessages: invokeState.messages\n\t\t};\n\t\t/**\n\t\t* ToDo: implement later\n\t\t*/\n\t\tconst runtime = {\n\t\t\tcontext: filteredContext,\n\t\t\twriter: config?.writer,\n\t\t\tinterrupt: config?.interrupt,\n\t\t\tsignal: config?.signal\n\t\t};\n\t\tconst result = await this.runHook(\n\t\t\tstate,\n\t\t\t/**\n\t\t\t* assign runtime and context values into empty named class\n\t\t\t* instances to create a better error message.\n\t\t\t*/\n\t\t\tObject.freeze(Object.assign(new AgentRuntime(), {\n\t\t\t\t...runtime,\n\t\t\t\tcontext: Object.freeze(Object.assign(new AgentContext(), filteredContext))\n\t\t\t}))\n\t\t);\n\t\t/**\n\t\t* If result is undefined, the hook made no state changes â return\n\t\t* only the jumpTo sentinel so we don't re-emit every input key as\n\t\t* a state update.\n\t\t*/\n\t\tif (!result) return { jumpTo: void 0 };\n\t\t/**\n\t\t* Verify that the jump target is allowed for the middleware\n\t\t*/\n\t\tlet jumpToConstraint;\n\t\tlet constraint;\n\t\tif (this.name?.startsWith(\"BeforeAgentNode_\")) {\n\t\t\tjumpToConstraint = (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_2__.getHookConstraint)(this.middleware.beforeAgent);\n\t\t\tconstraint = \"beforeAgent.canJumpTo\";\n\t\t} else if (this.name?.startsWith(\"BeforeModelNode_\")) {\n\t\t\tjumpToConstraint = (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_2__.getHookConstraint)(this.middleware.beforeModel);\n\t\t\tconstraint = \"beforeModel.canJumpTo\";\n\t\t} else if (this.name?.startsWith(\"AfterAgentNode_\")) {\n\t\t\tjumpToConstraint = (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_2__.getHookConstraint)(this.middleware.afterAgent);\n\t\t\tconstraint = \"afterAgent.canJumpTo\";\n\t\t} else if (this.name?.startsWith(\"AfterModelNode_\")) {\n\t\t\tjumpToConstraint = (0,_middleware_utils_js__WEBPACK_IMPORTED_MODULE_2__.getHookConstraint)(this.middleware.afterModel);\n\t\t\tconstraint = \"afterModel.canJumpTo\";\n\t\t}\n\t\tif (typeof result.jumpTo === \"string\" && !jumpToConstraint?.includes(result.jumpTo)) {\n\t\t\tconst suggestion = jumpToConstraint && jumpToConstraint.length > 0 ? `must be one of: ${jumpToConstraint?.join(\", \")}.` : constraint ? `no ${constraint} defined in middleware ${this.middleware.name}` : \"\";\n\t\t\tthrow new Error(`Invalid jump target: ${result.jumpTo}, ${suggestion}.`);\n\t\t}\n\t\t/**\n\t\t* If result is a control action, handle it\n\t\t*/\n\t\tif (typeof result === \"object\" && \"type\" in result) {\n\t\t\tif (result.type === \"terminate\") {\n\t\t\t\tif (result.error) throw result.error;\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\t...result.result || {},\n\t\t\t\t\tjumpTo: result.jumpTo\n\t\t\t\t};\n\t\t\t}\n\t\t\tthrow new Error(`Invalid control action: ${JSON.stringify(result)}`);\n\t\t}\n\t\t/**\n\t\t* If result is a state update, merge it with current state\n\t\t*/\n\t\treturn {\n\t\t\t...state,\n\t\t\t...result,\n\t\t\tjumpTo: result.jumpTo\n\t\t};\n\t}\n\tget nodeOptions() {\n\t\treturn { input: (0,_utils_js__WEBPACK_IMPORTED_MODULE_1__.derivePrivateState)(this.middleware.stateSchema) };\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=middleware.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvbWlkZGxld2FyZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUEwRDtBQUNWO0FBQ1c7QUFDQTs7QUFFM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGtFQUFnQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHlFQUFZO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsdUVBQWlCO0FBQ3ZDO0FBQ0EsSUFBSTtBQUNKLHNCQUFzQix1RUFBaUI7QUFDdkM7QUFDQSxJQUFJO0FBQ0osc0JBQXNCLHVFQUFpQjtBQUN2QztBQUNBLElBQUk7QUFDSixzQkFBc0IsdUVBQWlCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLDJGQUEyRiw2QkFBNkIsd0JBQXdCLFlBQVksd0JBQXdCLHFCQUFxQjtBQUN6TSwyQ0FBMkMsY0FBYyxJQUFJLFdBQVc7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLDhDQUE4Qyx1QkFBdUI7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTyw2REFBa0I7QUFDcEM7QUFDQTs7QUFFQTtBQUMwQjtBQUMxQiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0b3J5dGVsbGluZy8uL25vZGVfbW9kdWxlcy8ucG5wbS9sYW5nY2hhaW5AMS4yLjI2X0BsYW5nY2hhaW4rY29yZUAxLjEuMjhfb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX19vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fcmVfZXgyYjV5M3R6ZjdoMmN4bW11aTVxb2lhc3kvbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2FnZW50cy9ub2Rlcy9taWRkbGV3YXJlLmpzPzFlZTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUnVubmFibGVDYWxsYWJsZSB9IGZyb20gXCIuLi9SdW5uYWJsZUNhbGxhYmxlLmpzXCI7XG5pbXBvcnQgeyBkZXJpdmVQcml2YXRlU3RhdGUgfSBmcm9tIFwiLi91dGlscy5qc1wiO1xuaW1wb3J0IHsgZ2V0SG9va0NvbnN0cmFpbnQgfSBmcm9tIFwiLi4vbWlkZGxld2FyZS91dGlscy5qc1wiO1xuaW1wb3J0IHsgaW50ZXJvcFBhcnNlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS91dGlscy90eXBlc1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9ub2Rlcy9taWRkbGV3YXJlLnRzXG4vKipcbiogTmFtZWQgY2xhc3MgZm9yIGNvbnRleHQgb2JqZWN0cyB0byBwcm92aWRlIGJldHRlciBlcnJvciBtZXNzYWdlc1xuKi9cbnZhciBBZ2VudENvbnRleHQgPSBjbGFzcyB7fTtcbnZhciBBZ2VudFJ1bnRpbWUgPSBjbGFzcyB7fTtcbnZhciBNaWRkbGV3YXJlTm9kZSA9IGNsYXNzIGV4dGVuZHMgUnVubmFibGVDYWxsYWJsZSB7XG5cdCNvcHRpb25zO1xuXHRjb25zdHJ1Y3RvcihmaWVsZHMsIG9wdGlvbnMpIHtcblx0XHRzdXBlcihmaWVsZHMpO1xuXHRcdHRoaXMuI29wdGlvbnMgPSBvcHRpb25zO1xuXHR9XG5cdGFzeW5jIGludm9rZU1pZGRsZXdhcmUoaW52b2tlU3RhdGUsIGNvbmZpZykge1xuXHRcdC8qKlxuXHRcdCogRmlsdGVyIGNvbnRleHQgYmFzZWQgb24gbWlkZGxld2FyZSdzIGNvbnRleHRTY2hlbWFcblx0XHQqL1xuXHRcdGxldCBmaWx0ZXJlZENvbnRleHQgPSB7fTtcblx0XHQvKipcblx0XHQqIFBhcnNlIGNvbnRleHQgdXNpbmcgbWlkZGxld2FyZSdzIGNvbnRleHRTY2hlbWEgdG8gYXBwbHkgZGVmYXVsdHMgYW5kIHZhbGlkYXRpb25cblx0XHQqL1xuXHRcdGlmICh0aGlzLm1pZGRsZXdhcmUuY29udGV4dFNjaGVtYSkge1xuXHRcdFx0LyoqXG5cdFx0XHQqIEV4dHJhY3Qgb25seSB0aGUgZmllbGRzIHJlbGV2YW50IHRvIHRoaXMgbWlkZGxld2FyZSdzIHNjaGVtYVxuXHRcdFx0Ki9cblx0XHRcdGNvbnN0IHNjaGVtYVNoYXBlID0gdGhpcy5taWRkbGV3YXJlLmNvbnRleHRTY2hlbWE/LnNoYXBlO1xuXHRcdFx0aWYgKHNjaGVtYVNoYXBlKSB7XG5cdFx0XHRcdGNvbnN0IHJlbGV2YW50Q29udGV4dCA9IHt9O1xuXHRcdFx0XHRjb25zdCBpbnZva2VDb250ZXh0ID0gY29uZmlnPy5jb250ZXh0IHx8IHt9O1xuXHRcdFx0XHRmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhzY2hlbWFTaGFwZSkpIGlmIChrZXkgaW4gaW52b2tlQ29udGV4dCkgcmVsZXZhbnRDb250ZXh0W2tleV0gPSBpbnZva2VDb250ZXh0W2tleV07XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIFBhcnNlIHRvIGFwcGx5IGRlZmF1bHRzIGFuZCB2YWxpZGF0aW9uLCBldmVuIGlmIHJlbGV2YW50Q29udGV4dCBpcyBlbXB0eVxuXHRcdFx0XHQqIFRoaXMgd2lsbCB0aHJvdyBpZiByZXF1aXJlZCBmaWVsZHMgYXJlIG1pc3NpbmcgYW5kIG5vIGRlZmF1bHRzIGV4aXN0XG5cdFx0XHRcdCovXG5cdFx0XHRcdGZpbHRlcmVkQ29udGV4dCA9IGludGVyb3BQYXJzZSh0aGlzLm1pZGRsZXdhcmUuY29udGV4dFNjaGVtYSwgcmVsZXZhbnRDb250ZXh0KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Y29uc3Qgc3RhdGUgPSB7XG5cdFx0XHQuLi50aGlzLiNvcHRpb25zLmdldFN0YXRlKCksXG5cdFx0XHQuLi5pbnZva2VTdGF0ZSxcblx0XHRcdG1lc3NhZ2VzOiBpbnZva2VTdGF0ZS5tZXNzYWdlc1xuXHRcdH07XG5cdFx0LyoqXG5cdFx0KiBUb0RvOiBpbXBsZW1lbnQgbGF0ZXJcblx0XHQqL1xuXHRcdGNvbnN0IHJ1bnRpbWUgPSB7XG5cdFx0XHRjb250ZXh0OiBmaWx0ZXJlZENvbnRleHQsXG5cdFx0XHR3cml0ZXI6IGNvbmZpZz8ud3JpdGVyLFxuXHRcdFx0aW50ZXJydXB0OiBjb25maWc/LmludGVycnVwdCxcblx0XHRcdHNpZ25hbDogY29uZmlnPy5zaWduYWxcblx0XHR9O1xuXHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucnVuSG9vayhcblx0XHRcdHN0YXRlLFxuXHRcdFx0LyoqXG5cdFx0XHQqIGFzc2lnbiBydW50aW1lIGFuZCBjb250ZXh0IHZhbHVlcyBpbnRvIGVtcHR5IG5hbWVkIGNsYXNzXG5cdFx0XHQqIGluc3RhbmNlcyB0byBjcmVhdGUgYSBiZXR0ZXIgZXJyb3IgbWVzc2FnZS5cblx0XHRcdCovXG5cdFx0XHRPYmplY3QuZnJlZXplKE9iamVjdC5hc3NpZ24obmV3IEFnZW50UnVudGltZSgpLCB7XG5cdFx0XHRcdC4uLnJ1bnRpbWUsXG5cdFx0XHRcdGNvbnRleHQ6IE9iamVjdC5mcmVlemUoT2JqZWN0LmFzc2lnbihuZXcgQWdlbnRDb250ZXh0KCksIGZpbHRlcmVkQ29udGV4dCkpXG5cdFx0XHR9KSlcblx0XHQpO1xuXHRcdC8qKlxuXHRcdCogSWYgcmVzdWx0IGlzIHVuZGVmaW5lZCwgdGhlIGhvb2sgbWFkZSBubyBzdGF0ZSBjaGFuZ2VzIOKAlCByZXR1cm5cblx0XHQqIG9ubHkgdGhlIGp1bXBUbyBzZW50aW5lbCBzbyB3ZSBkb24ndCByZS1lbWl0IGV2ZXJ5IGlucHV0IGtleSBhc1xuXHRcdCogYSBzdGF0ZSB1cGRhdGUuXG5cdFx0Ki9cblx0XHRpZiAoIXJlc3VsdCkgcmV0dXJuIHsganVtcFRvOiB2b2lkIDAgfTtcblx0XHQvKipcblx0XHQqIFZlcmlmeSB0aGF0IHRoZSBqdW1wIHRhcmdldCBpcyBhbGxvd2VkIGZvciB0aGUgbWlkZGxld2FyZVxuXHRcdCovXG5cdFx0bGV0IGp1bXBUb0NvbnN0cmFpbnQ7XG5cdFx0bGV0IGNvbnN0cmFpbnQ7XG5cdFx0aWYgKHRoaXMubmFtZT8uc3RhcnRzV2l0aChcIkJlZm9yZUFnZW50Tm9kZV9cIikpIHtcblx0XHRcdGp1bXBUb0NvbnN0cmFpbnQgPSBnZXRIb29rQ29uc3RyYWludCh0aGlzLm1pZGRsZXdhcmUuYmVmb3JlQWdlbnQpO1xuXHRcdFx0Y29uc3RyYWludCA9IFwiYmVmb3JlQWdlbnQuY2FuSnVtcFRvXCI7XG5cdFx0fSBlbHNlIGlmICh0aGlzLm5hbWU/LnN0YXJ0c1dpdGgoXCJCZWZvcmVNb2RlbE5vZGVfXCIpKSB7XG5cdFx0XHRqdW1wVG9Db25zdHJhaW50ID0gZ2V0SG9va0NvbnN0cmFpbnQodGhpcy5taWRkbGV3YXJlLmJlZm9yZU1vZGVsKTtcblx0XHRcdGNvbnN0cmFpbnQgPSBcImJlZm9yZU1vZGVsLmNhbkp1bXBUb1wiO1xuXHRcdH0gZWxzZSBpZiAodGhpcy5uYW1lPy5zdGFydHNXaXRoKFwiQWZ0ZXJBZ2VudE5vZGVfXCIpKSB7XG5cdFx0XHRqdW1wVG9Db25zdHJhaW50ID0gZ2V0SG9va0NvbnN0cmFpbnQodGhpcy5taWRkbGV3YXJlLmFmdGVyQWdlbnQpO1xuXHRcdFx0Y29uc3RyYWludCA9IFwiYWZ0ZXJBZ2VudC5jYW5KdW1wVG9cIjtcblx0XHR9IGVsc2UgaWYgKHRoaXMubmFtZT8uc3RhcnRzV2l0aChcIkFmdGVyTW9kZWxOb2RlX1wiKSkge1xuXHRcdFx0anVtcFRvQ29uc3RyYWludCA9IGdldEhvb2tDb25zdHJhaW50KHRoaXMubWlkZGxld2FyZS5hZnRlck1vZGVsKTtcblx0XHRcdGNvbnN0cmFpbnQgPSBcImFmdGVyTW9kZWwuY2FuSnVtcFRvXCI7XG5cdFx0fVxuXHRcdGlmICh0eXBlb2YgcmVzdWx0Lmp1bXBUbyA9PT0gXCJzdHJpbmdcIiAmJiAhanVtcFRvQ29uc3RyYWludD8uaW5jbHVkZXMocmVzdWx0Lmp1bXBUbykpIHtcblx0XHRcdGNvbnN0IHN1Z2dlc3Rpb24gPSBqdW1wVG9Db25zdHJhaW50ICYmIGp1bXBUb0NvbnN0cmFpbnQubGVuZ3RoID4gMCA/IGBtdXN0IGJlIG9uZSBvZjogJHtqdW1wVG9Db25zdHJhaW50Py5qb2luKFwiLCBcIil9LmAgOiBjb25zdHJhaW50ID8gYG5vICR7Y29uc3RyYWludH0gZGVmaW5lZCBpbiBtaWRkbGV3YXJlICR7dGhpcy5taWRkbGV3YXJlLm5hbWV9YCA6IFwiXCI7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQganVtcCB0YXJnZXQ6ICR7cmVzdWx0Lmp1bXBUb30sICR7c3VnZ2VzdGlvbn0uYCk7XG5cdFx0fVxuXHRcdC8qKlxuXHRcdCogSWYgcmVzdWx0IGlzIGEgY29udHJvbCBhY3Rpb24sIGhhbmRsZSBpdFxuXHRcdCovXG5cdFx0aWYgKHR5cGVvZiByZXN1bHQgPT09IFwib2JqZWN0XCIgJiYgXCJ0eXBlXCIgaW4gcmVzdWx0KSB7XG5cdFx0XHRpZiAocmVzdWx0LnR5cGUgPT09IFwidGVybWluYXRlXCIpIHtcblx0XHRcdFx0aWYgKHJlc3VsdC5lcnJvcikgdGhyb3cgcmVzdWx0LmVycm9yO1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0XHRcdC4uLnJlc3VsdC5yZXN1bHQgfHwge30sXG5cdFx0XHRcdFx0anVtcFRvOiByZXN1bHQuanVtcFRvXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgY29udHJvbCBhY3Rpb246ICR7SlNPTi5zdHJpbmdpZnkocmVzdWx0KX1gKTtcblx0XHR9XG5cdFx0LyoqXG5cdFx0KiBJZiByZXN1bHQgaXMgYSBzdGF0ZSB1cGRhdGUsIG1lcmdlIGl0IHdpdGggY3VycmVudCBzdGF0ZVxuXHRcdCovXG5cdFx0cmV0dXJuIHtcblx0XHRcdC4uLnN0YXRlLFxuXHRcdFx0Li4ucmVzdWx0LFxuXHRcdFx0anVtcFRvOiByZXN1bHQuanVtcFRvXG5cdFx0fTtcblx0fVxuXHRnZXQgbm9kZU9wdGlvbnMoKSB7XG5cdFx0cmV0dXJuIHsgaW5wdXQ6IGRlcml2ZVByaXZhdGVTdGF0ZSh0aGlzLm1pZGRsZXdhcmUuc3RhdGVTY2hlbWEpIH07XG5cdH1cbn07XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgTWlkZGxld2FyZU5vZGUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZGRsZXdhcmUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/middleware.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/utils.js":
/*!*******************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/utils.js ***!
  \*******************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   derivePrivateState: () => (/* binding */ derivePrivateState),\n/* harmony export */   initializeMiddlewareStates: () => (/* binding */ initializeMiddlewareStates),\n/* harmony export */   mergeAbortSignals: () => (/* binding */ mergeAbortSignals),\n/* harmony export */   parseJumpToTarget: () => (/* binding */ parseJumpToTarget),\n/* harmony export */   toPartialZodObject: () => (/* binding */ toPartialZodObject)\n/* harmony export */ });\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n/* harmony import */ var _langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/utils/types */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/types/index.js\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v4/index.js\");\n\n\n\n\n//#region src/agents/nodes/utils.ts\n/**\n* Helper function to initialize middleware state defaults.\n* This is used to ensure all middleware state properties are initialized.\n*\n* Private properties (starting with _) are automatically made optional since\n* users cannot provide them when invoking the agent.\n*/\nasync function initializeMiddlewareStates(middlewareList, state) {\n\tconst middlewareStates = {};\n\tfor (const middleware of middlewareList) {\n\t\t/**\n\t\t* skip middleware if it doesn't have a state schema\n\t\t*/\n\t\tif (!middleware.stateSchema) continue;\n\t\tlet zodSchema = middleware.stateSchema;\n\t\tif (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateSchema.isInstance(middleware.stateSchema)) {\n\t\t\tconst zodShape = {};\n\t\t\tfor (const [key, field] of Object.entries(middleware.stateSchema.fields)) if (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.ReducedValue.isInstance(field)) zodShape[key] = field.inputSchema || field.valueSchema;\n\t\t\telse zodShape[key] = field;\n\t\t\tzodSchema = zod_v4__WEBPACK_IMPORTED_MODULE_2__.z.object(zodShape);\n\t\t}\n\t\tconst parseResult = await (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_1__.interopSafeParseAsync)((0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_1__.interopZodObjectMakeFieldsOptional)(zodSchema, (key) => key.startsWith(\"_\")), state);\n\t\tif (parseResult.success) {\n\t\t\tObject.assign(middlewareStates, parseResult.data);\n\t\t\tcontinue;\n\t\t}\n\t\t/**\n\t\t* If safeParse fails, there are required public fields missing.\n\t\t* Note: Zod v3 uses message \"Required\", Zod v4 uses \"Invalid input: expected X, received undefined\"\n\t\t*/\n\t\tconst requiredFields = parseResult.error.issues.filter((issue) => issue.code === \"invalid_type\").map((issue) => `  - ${issue.path.join(\".\")}: Required`).join(\"\\n\");\n\t\tthrow new Error(`Middleware \"${middleware.name}\" has required state fields that must be initialized:\\n${requiredFields}\\n\\nTo fix this, either:\\n1. Provide default values in your middleware's state schema using .default():\\n   stateSchema: z.object({\\n     myField: z.string().default(\"default value\")\\n   })\\n\\n2. Or make the fields optional using .optional():\\n   stateSchema: z.object({\\n     myField: z.string().optional()\\n   })\\n\\n3. Or ensure you pass these values when invoking the agent:\\n   agent.invoke({\\n     messages: [...],\\n     ${parseResult.error.issues[0]?.path.join(\".\")}: \"value\"\\n   })`);\n\t}\n\treturn middlewareStates;\n}\n/**\n* Users can define private and public state for a middleware. Private state properties start with an underscore.\n* This function will return the private state properties from the state schema, making all of them optional.\n* @param stateSchema - The middleware state schema\n* @returns A new schema containing only the private properties (underscore-prefixed), all made optional\n*/\nfunction derivePrivateState(stateSchema) {\n\tconst builtInStateSchema = {\n\t\tmessages: zod_v4__WEBPACK_IMPORTED_MODULE_2__.z.custom(() => []),\n\t\tstructuredResponse: zod_v4__WEBPACK_IMPORTED_MODULE_2__.z.any().optional()\n\t};\n\tif (!stateSchema) return zod_v4__WEBPACK_IMPORTED_MODULE_2__.z.object(builtInStateSchema);\n\tlet shape;\n\tif (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateSchema.isInstance(stateSchema)) {\n\t\tshape = {};\n\t\tfor (const [key, field] of Object.entries(stateSchema.fields)) if (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.ReducedValue.isInstance(field)) shape[key] = field.inputSchema || field.valueSchema;\n\t\telse shape[key] = field;\n\t} else shape = stateSchema.shape;\n\tconst privateShape = { ...builtInStateSchema };\n\tfor (const [key, value] of Object.entries(shape)) if (key.startsWith(\"_\")) privateShape[key] = value.optional();\n\telse privateShape[key] = value;\n\treturn zod_v4__WEBPACK_IMPORTED_MODULE_2__.z.object(privateShape);\n}\n/**\n* Converts any supported schema type (ZodObject, StateSchema, AnnotationRoot) to a partial Zod object.\n* This is useful for parsing state loosely where all fields are optional.\n*\n* @param schema - The schema to convert (InteropZodObject, StateSchema, or AnnotationRoot)\n* @returns A partial Zod object schema where all fields are optional\n*/\nfunction toPartialZodObject(schema) {\n\tif ((0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_1__.isInteropZodObject)(schema)) return (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_1__.interopZodObjectPartial)(schema);\n\tif (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateSchema.isInstance(schema)) {\n\t\tconst partialShape = {};\n\t\tfor (const [key, field] of Object.entries(schema.fields)) {\n\t\t\tlet fieldSchema;\n\t\t\tif (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.ReducedValue.isInstance(field)) fieldSchema = field.inputSchema || field.valueSchema;\n\t\t\telse fieldSchema = field;\n\t\t\tpartialShape[key] = (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_1__.isZodSchemaV4)(fieldSchema) ? fieldSchema.optional() : zod_v4__WEBPACK_IMPORTED_MODULE_2__.z.any().optional();\n\t\t}\n\t\treturn zod_v4__WEBPACK_IMPORTED_MODULE_2__.z.object(partialShape);\n\t}\n\treturn zod_v4__WEBPACK_IMPORTED_MODULE_2__.z.object({});\n}\nfunction parseJumpToTarget(target) {\n\tif (!target) return;\n\t/**\n\t* if target is already a valid jump target, return it\n\t*/\n\tif ([\n\t\t\"model_request\",\n\t\t\"tools\",\n\t\t_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n\t].includes(target)) return target;\n\tif (target === \"model\") return \"model_request\";\n\tif (target === \"tools\") return \"tools\";\n\tif (target === \"end\") return _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END;\n\tthrow new Error(`Invalid jump target: ${target}, must be \"model\", \"tools\" or \"end\".`);\n}\n/**\n* `config` always contains a signal from LangGraphs Pregel class.\n* To ensure we acknowledge the abort signal from the user, we merge it\n* with the signal from the ToolNode.\n*\n* @param signals - The signals to merge.\n* @returns The merged signal.\n*/\nfunction mergeAbortSignals(...signals) {\n\treturn AbortSignal.any(signals.filter((maybeSignal) => maybeSignal !== null && maybeSignal !== void 0 && typeof maybeSignal === \"object\" && \"aborted\" in maybeSignal && typeof maybeSignal.aborted === \"boolean\"));\n}\n\n//#endregion\n\n//# sourceMappingURL=utils.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvdXRpbHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0U7QUFDOEY7QUFDekk7O0FBRTNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSw2REFBVztBQUNqQjtBQUNBLGlGQUFpRiw4REFBWTtBQUM3RjtBQUNBLGVBQWUsNENBQVE7QUFDdkI7QUFDQSw0QkFBNEIsa0ZBQXFCLENBQUMsK0ZBQWtDO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5SEFBeUgscUJBQXFCO0FBQzlJLGlDQUFpQyxnQkFBZ0IseURBQXlELGVBQWUsbUlBQW1JLHlEQUF5RCxrRkFBa0YsMkNBQTJDLG1GQUFtRixnQ0FBZ0MsNENBQTRDLGVBQWU7QUFDaG1CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDRDQUFRO0FBQ3BCLHNCQUFzQix5Q0FBSztBQUMzQjtBQUNBLDBCQUEwQiw0Q0FBUTtBQUNsQztBQUNBLEtBQUssNkRBQVc7QUFDaEI7QUFDQSxxRUFBcUUsOERBQVk7QUFDakY7QUFDQSxHQUFHO0FBQ0gsd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxRQUFRLDRDQUFRO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssK0VBQWtCLGlCQUFpQixvRkFBdUI7QUFDL0QsS0FBSyw2REFBVztBQUNoQjtBQUNBO0FBQ0E7QUFDQSxPQUFPLDhEQUFZO0FBQ25CO0FBQ0EsdUJBQXVCLDBFQUFhLHlDQUF5Qyx5Q0FBSztBQUNsRjtBQUNBLFNBQVMsNENBQVE7QUFDakI7QUFDQSxRQUFRLDRDQUFRLEdBQUc7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSxxREFBRztBQUNMO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixxREFBRztBQUNqQyx5Q0FBeUMsT0FBTztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDb0g7QUFDcEgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvbm9kZXMvdXRpbHMuanM/MDQxNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFTkQsIFJlZHVjZWRWYWx1ZSwgU3RhdGVTY2hlbWEgfSBmcm9tIFwiQGxhbmdjaGFpbi9sYW5nZ3JhcGhcIjtcbmltcG9ydCB7IGludGVyb3BTYWZlUGFyc2VBc3luYywgaW50ZXJvcFpvZE9iamVjdE1ha2VGaWVsZHNPcHRpb25hbCwgaW50ZXJvcFpvZE9iamVjdFBhcnRpYWwsIGlzSW50ZXJvcFpvZE9iamVjdCwgaXNab2RTY2hlbWFWNCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvdXRpbHMvdHlwZXNcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kL3Y0XCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL25vZGVzL3V0aWxzLnRzXG4vKipcbiogSGVscGVyIGZ1bmN0aW9uIHRvIGluaXRpYWxpemUgbWlkZGxld2FyZSBzdGF0ZSBkZWZhdWx0cy5cbiogVGhpcyBpcyB1c2VkIHRvIGVuc3VyZSBhbGwgbWlkZGxld2FyZSBzdGF0ZSBwcm9wZXJ0aWVzIGFyZSBpbml0aWFsaXplZC5cbipcbiogUHJpdmF0ZSBwcm9wZXJ0aWVzIChzdGFydGluZyB3aXRoIF8pIGFyZSBhdXRvbWF0aWNhbGx5IG1hZGUgb3B0aW9uYWwgc2luY2VcbiogdXNlcnMgY2Fubm90IHByb3ZpZGUgdGhlbSB3aGVuIGludm9raW5nIHRoZSBhZ2VudC5cbiovXG5hc3luYyBmdW5jdGlvbiBpbml0aWFsaXplTWlkZGxld2FyZVN0YXRlcyhtaWRkbGV3YXJlTGlzdCwgc3RhdGUpIHtcblx0Y29uc3QgbWlkZGxld2FyZVN0YXRlcyA9IHt9O1xuXHRmb3IgKGNvbnN0IG1pZGRsZXdhcmUgb2YgbWlkZGxld2FyZUxpc3QpIHtcblx0XHQvKipcblx0XHQqIHNraXAgbWlkZGxld2FyZSBpZiBpdCBkb2Vzbid0IGhhdmUgYSBzdGF0ZSBzY2hlbWFcblx0XHQqL1xuXHRcdGlmICghbWlkZGxld2FyZS5zdGF0ZVNjaGVtYSkgY29udGludWU7XG5cdFx0bGV0IHpvZFNjaGVtYSA9IG1pZGRsZXdhcmUuc3RhdGVTY2hlbWE7XG5cdFx0aWYgKFN0YXRlU2NoZW1hLmlzSW5zdGFuY2UobWlkZGxld2FyZS5zdGF0ZVNjaGVtYSkpIHtcblx0XHRcdGNvbnN0IHpvZFNoYXBlID0ge307XG5cdFx0XHRmb3IgKGNvbnN0IFtrZXksIGZpZWxkXSBvZiBPYmplY3QuZW50cmllcyhtaWRkbGV3YXJlLnN0YXRlU2NoZW1hLmZpZWxkcykpIGlmIChSZWR1Y2VkVmFsdWUuaXNJbnN0YW5jZShmaWVsZCkpIHpvZFNoYXBlW2tleV0gPSBmaWVsZC5pbnB1dFNjaGVtYSB8fCBmaWVsZC52YWx1ZVNjaGVtYTtcblx0XHRcdGVsc2Ugem9kU2hhcGVba2V5XSA9IGZpZWxkO1xuXHRcdFx0em9kU2NoZW1hID0gei5vYmplY3Qoem9kU2hhcGUpO1xuXHRcdH1cblx0XHRjb25zdCBwYXJzZVJlc3VsdCA9IGF3YWl0IGludGVyb3BTYWZlUGFyc2VBc3luYyhpbnRlcm9wWm9kT2JqZWN0TWFrZUZpZWxkc09wdGlvbmFsKHpvZFNjaGVtYSwgKGtleSkgPT4ga2V5LnN0YXJ0c1dpdGgoXCJfXCIpKSwgc3RhdGUpO1xuXHRcdGlmIChwYXJzZVJlc3VsdC5zdWNjZXNzKSB7XG5cdFx0XHRPYmplY3QuYXNzaWduKG1pZGRsZXdhcmVTdGF0ZXMsIHBhcnNlUmVzdWx0LmRhdGEpO1xuXHRcdFx0Y29udGludWU7XG5cdFx0fVxuXHRcdC8qKlxuXHRcdCogSWYgc2FmZVBhcnNlIGZhaWxzLCB0aGVyZSBhcmUgcmVxdWlyZWQgcHVibGljIGZpZWxkcyBtaXNzaW5nLlxuXHRcdCogTm90ZTogWm9kIHYzIHVzZXMgbWVzc2FnZSBcIlJlcXVpcmVkXCIsIFpvZCB2NCB1c2VzIFwiSW52YWxpZCBpbnB1dDogZXhwZWN0ZWQgWCwgcmVjZWl2ZWQgdW5kZWZpbmVkXCJcblx0XHQqL1xuXHRcdGNvbnN0IHJlcXVpcmVkRmllbGRzID0gcGFyc2VSZXN1bHQuZXJyb3IuaXNzdWVzLmZpbHRlcigoaXNzdWUpID0+IGlzc3VlLmNvZGUgPT09IFwiaW52YWxpZF90eXBlXCIpLm1hcCgoaXNzdWUpID0+IGAgIC0gJHtpc3N1ZS5wYXRoLmpvaW4oXCIuXCIpfTogUmVxdWlyZWRgKS5qb2luKFwiXFxuXCIpO1xuXHRcdHRocm93IG5ldyBFcnJvcihgTWlkZGxld2FyZSBcIiR7bWlkZGxld2FyZS5uYW1lfVwiIGhhcyByZXF1aXJlZCBzdGF0ZSBmaWVsZHMgdGhhdCBtdXN0IGJlIGluaXRpYWxpemVkOlxcbiR7cmVxdWlyZWRGaWVsZHN9XFxuXFxuVG8gZml4IHRoaXMsIGVpdGhlcjpcXG4xLiBQcm92aWRlIGRlZmF1bHQgdmFsdWVzIGluIHlvdXIgbWlkZGxld2FyZSdzIHN0YXRlIHNjaGVtYSB1c2luZyAuZGVmYXVsdCgpOlxcbiAgIHN0YXRlU2NoZW1hOiB6Lm9iamVjdCh7XFxuICAgICBteUZpZWxkOiB6LnN0cmluZygpLmRlZmF1bHQoXCJkZWZhdWx0IHZhbHVlXCIpXFxuICAgfSlcXG5cXG4yLiBPciBtYWtlIHRoZSBmaWVsZHMgb3B0aW9uYWwgdXNpbmcgLm9wdGlvbmFsKCk6XFxuICAgc3RhdGVTY2hlbWE6IHoub2JqZWN0KHtcXG4gICAgIG15RmllbGQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxcbiAgIH0pXFxuXFxuMy4gT3IgZW5zdXJlIHlvdSBwYXNzIHRoZXNlIHZhbHVlcyB3aGVuIGludm9raW5nIHRoZSBhZ2VudDpcXG4gICBhZ2VudC5pbnZva2Uoe1xcbiAgICAgbWVzc2FnZXM6IFsuLi5dLFxcbiAgICAgJHtwYXJzZVJlc3VsdC5lcnJvci5pc3N1ZXNbMF0/LnBhdGguam9pbihcIi5cIil9OiBcInZhbHVlXCJcXG4gICB9KWApO1xuXHR9XG5cdHJldHVybiBtaWRkbGV3YXJlU3RhdGVzO1xufVxuLyoqXG4qIFVzZXJzIGNhbiBkZWZpbmUgcHJpdmF0ZSBhbmQgcHVibGljIHN0YXRlIGZvciBhIG1pZGRsZXdhcmUuIFByaXZhdGUgc3RhdGUgcHJvcGVydGllcyBzdGFydCB3aXRoIGFuIHVuZGVyc2NvcmUuXG4qIFRoaXMgZnVuY3Rpb24gd2lsbCByZXR1cm4gdGhlIHByaXZhdGUgc3RhdGUgcHJvcGVydGllcyBmcm9tIHRoZSBzdGF0ZSBzY2hlbWEsIG1ha2luZyBhbGwgb2YgdGhlbSBvcHRpb25hbC5cbiogQHBhcmFtIHN0YXRlU2NoZW1hIC0gVGhlIG1pZGRsZXdhcmUgc3RhdGUgc2NoZW1hXG4qIEByZXR1cm5zIEEgbmV3IHNjaGVtYSBjb250YWluaW5nIG9ubHkgdGhlIHByaXZhdGUgcHJvcGVydGllcyAodW5kZXJzY29yZS1wcmVmaXhlZCksIGFsbCBtYWRlIG9wdGlvbmFsXG4qL1xuZnVuY3Rpb24gZGVyaXZlUHJpdmF0ZVN0YXRlKHN0YXRlU2NoZW1hKSB7XG5cdGNvbnN0IGJ1aWx0SW5TdGF0ZVNjaGVtYSA9IHtcblx0XHRtZXNzYWdlczogei5jdXN0b20oKCkgPT4gW10pLFxuXHRcdHN0cnVjdHVyZWRSZXNwb25zZTogei5hbnkoKS5vcHRpb25hbCgpXG5cdH07XG5cdGlmICghc3RhdGVTY2hlbWEpIHJldHVybiB6Lm9iamVjdChidWlsdEluU3RhdGVTY2hlbWEpO1xuXHRsZXQgc2hhcGU7XG5cdGlmIChTdGF0ZVNjaGVtYS5pc0luc3RhbmNlKHN0YXRlU2NoZW1hKSkge1xuXHRcdHNoYXBlID0ge307XG5cdFx0Zm9yIChjb25zdCBba2V5LCBmaWVsZF0gb2YgT2JqZWN0LmVudHJpZXMoc3RhdGVTY2hlbWEuZmllbGRzKSkgaWYgKFJlZHVjZWRWYWx1ZS5pc0luc3RhbmNlKGZpZWxkKSkgc2hhcGVba2V5XSA9IGZpZWxkLmlucHV0U2NoZW1hIHx8IGZpZWxkLnZhbHVlU2NoZW1hO1xuXHRcdGVsc2Ugc2hhcGVba2V5XSA9IGZpZWxkO1xuXHR9IGVsc2Ugc2hhcGUgPSBzdGF0ZVNjaGVtYS5zaGFwZTtcblx0Y29uc3QgcHJpdmF0ZVNoYXBlID0geyAuLi5idWlsdEluU3RhdGVTY2hlbWEgfTtcblx0Zm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoc2hhcGUpKSBpZiAoa2V5LnN0YXJ0c1dpdGgoXCJfXCIpKSBwcml2YXRlU2hhcGVba2V5XSA9IHZhbHVlLm9wdGlvbmFsKCk7XG5cdGVsc2UgcHJpdmF0ZVNoYXBlW2tleV0gPSB2YWx1ZTtcblx0cmV0dXJuIHoub2JqZWN0KHByaXZhdGVTaGFwZSk7XG59XG4vKipcbiogQ29udmVydHMgYW55IHN1cHBvcnRlZCBzY2hlbWEgdHlwZSAoWm9kT2JqZWN0LCBTdGF0ZVNjaGVtYSwgQW5ub3RhdGlvblJvb3QpIHRvIGEgcGFydGlhbCBab2Qgb2JqZWN0LlxuKiBUaGlzIGlzIHVzZWZ1bCBmb3IgcGFyc2luZyBzdGF0ZSBsb29zZWx5IHdoZXJlIGFsbCBmaWVsZHMgYXJlIG9wdGlvbmFsLlxuKlxuKiBAcGFyYW0gc2NoZW1hIC0gVGhlIHNjaGVtYSB0byBjb252ZXJ0IChJbnRlcm9wWm9kT2JqZWN0LCBTdGF0ZVNjaGVtYSwgb3IgQW5ub3RhdGlvblJvb3QpXG4qIEByZXR1cm5zIEEgcGFydGlhbCBab2Qgb2JqZWN0IHNjaGVtYSB3aGVyZSBhbGwgZmllbGRzIGFyZSBvcHRpb25hbFxuKi9cbmZ1bmN0aW9uIHRvUGFydGlhbFpvZE9iamVjdChzY2hlbWEpIHtcblx0aWYgKGlzSW50ZXJvcFpvZE9iamVjdChzY2hlbWEpKSByZXR1cm4gaW50ZXJvcFpvZE9iamVjdFBhcnRpYWwoc2NoZW1hKTtcblx0aWYgKFN0YXRlU2NoZW1hLmlzSW5zdGFuY2Uoc2NoZW1hKSkge1xuXHRcdGNvbnN0IHBhcnRpYWxTaGFwZSA9IHt9O1xuXHRcdGZvciAoY29uc3QgW2tleSwgZmllbGRdIG9mIE9iamVjdC5lbnRyaWVzKHNjaGVtYS5maWVsZHMpKSB7XG5cdFx0XHRsZXQgZmllbGRTY2hlbWE7XG5cdFx0XHRpZiAoUmVkdWNlZFZhbHVlLmlzSW5zdGFuY2UoZmllbGQpKSBmaWVsZFNjaGVtYSA9IGZpZWxkLmlucHV0U2NoZW1hIHx8IGZpZWxkLnZhbHVlU2NoZW1hO1xuXHRcdFx0ZWxzZSBmaWVsZFNjaGVtYSA9IGZpZWxkO1xuXHRcdFx0cGFydGlhbFNoYXBlW2tleV0gPSBpc1pvZFNjaGVtYVY0KGZpZWxkU2NoZW1hKSA/IGZpZWxkU2NoZW1hLm9wdGlvbmFsKCkgOiB6LmFueSgpLm9wdGlvbmFsKCk7XG5cdFx0fVxuXHRcdHJldHVybiB6Lm9iamVjdChwYXJ0aWFsU2hhcGUpO1xuXHR9XG5cdHJldHVybiB6Lm9iamVjdCh7fSk7XG59XG5mdW5jdGlvbiBwYXJzZUp1bXBUb1RhcmdldCh0YXJnZXQpIHtcblx0aWYgKCF0YXJnZXQpIHJldHVybjtcblx0LyoqXG5cdCogaWYgdGFyZ2V0IGlzIGFscmVhZHkgYSB2YWxpZCBqdW1wIHRhcmdldCwgcmV0dXJuIGl0XG5cdCovXG5cdGlmIChbXG5cdFx0XCJtb2RlbF9yZXF1ZXN0XCIsXG5cdFx0XCJ0b29sc1wiLFxuXHRcdEVORFxuXHRdLmluY2x1ZGVzKHRhcmdldCkpIHJldHVybiB0YXJnZXQ7XG5cdGlmICh0YXJnZXQgPT09IFwibW9kZWxcIikgcmV0dXJuIFwibW9kZWxfcmVxdWVzdFwiO1xuXHRpZiAodGFyZ2V0ID09PSBcInRvb2xzXCIpIHJldHVybiBcInRvb2xzXCI7XG5cdGlmICh0YXJnZXQgPT09IFwiZW5kXCIpIHJldHVybiBFTkQ7XG5cdHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBqdW1wIHRhcmdldDogJHt0YXJnZXR9LCBtdXN0IGJlIFwibW9kZWxcIiwgXCJ0b29sc1wiIG9yIFwiZW5kXCIuYCk7XG59XG4vKipcbiogYGNvbmZpZ2AgYWx3YXlzIGNvbnRhaW5zIGEgc2lnbmFsIGZyb20gTGFuZ0dyYXBocyBQcmVnZWwgY2xhc3MuXG4qIFRvIGVuc3VyZSB3ZSBhY2tub3dsZWRnZSB0aGUgYWJvcnQgc2lnbmFsIGZyb20gdGhlIHVzZXIsIHdlIG1lcmdlIGl0XG4qIHdpdGggdGhlIHNpZ25hbCBmcm9tIHRoZSBUb29sTm9kZS5cbipcbiogQHBhcmFtIHNpZ25hbHMgLSBUaGUgc2lnbmFscyB0byBtZXJnZS5cbiogQHJldHVybnMgVGhlIG1lcmdlZCBzaWduYWwuXG4qL1xuZnVuY3Rpb24gbWVyZ2VBYm9ydFNpZ25hbHMoLi4uc2lnbmFscykge1xuXHRyZXR1cm4gQWJvcnRTaWduYWwuYW55KHNpZ25hbHMuZmlsdGVyKChtYXliZVNpZ25hbCkgPT4gbWF5YmVTaWduYWwgIT09IG51bGwgJiYgbWF5YmVTaWduYWwgIT09IHZvaWQgMCAmJiB0eXBlb2YgbWF5YmVTaWduYWwgPT09IFwib2JqZWN0XCIgJiYgXCJhYm9ydGVkXCIgaW4gbWF5YmVTaWduYWwgJiYgdHlwZW9mIG1heWJlU2lnbmFsLmFib3J0ZWQgPT09IFwiYm9vbGVhblwiKSk7XG59XG5cbi8vI2VuZHJlZ2lvblxuZXhwb3J0IHsgZGVyaXZlUHJpdmF0ZVN0YXRlLCBpbml0aWFsaXplTWlkZGxld2FyZVN0YXRlcywgbWVyZ2VBYm9ydFNpZ25hbHMsIHBhcnNlSnVtcFRvVGFyZ2V0LCB0b1BhcnRpYWxab2RPYmplY3QgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/nodes/utils.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/responses.js":
/*!*****************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/responses.js ***!
  \*****************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ProviderStrategy: () => (/* binding */ ProviderStrategy),\n/* harmony export */   ToolStrategy: () => (/* binding */ ToolStrategy),\n/* harmony export */   providerStrategy: () => (/* binding */ providerStrategy),\n/* harmony export */   toolStrategy: () => (/* binding */ toolStrategy),\n/* harmony export */   transformResponseFormat: () => (/* binding */ transformResponseFormat)\n/* harmony export */ });\n/* harmony import */ var _model_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./model.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/model.js\");\n/* harmony import */ var _errors_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./errors.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/errors.js\");\n/* harmony import */ var _langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/utils/types */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/types/index.js\");\n/* harmony import */ var _langchain_core_utils_json_schema__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/utils/json_schema */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/json_schema.js\");\n\n\n\n\n\n//#region src/agents/responses.ts\n/**\n* Default value for strict mode in providerStrategy.\n*\n* When using providerStrategy with json_schema response format, OpenAI's parse() method\n* requires all function tools to have strict: true. This ensures the model's output\n* exactly matches the provided JSON schema.\n*\n* @see https://platform.openai.com/docs/guides/structured-outputs\n*/\nconst PROVIDER_STRATEGY_DEFAULT_STRICT = true;\n/**\n* This is a global counter for generating unique names for tools.\n*/\nlet bindingIdentifier = 0;\n/**\n* Information for tracking structured output tool metadata.\n* This contains all necessary information to handle structured responses generated\n* via tool calls, including the original schema, its type classification, and the\n* corresponding tool implementation used by the tools strategy.\n*/\nvar ToolStrategy = class ToolStrategy {\n\tconstructor(schema, tool, options) {\n\t\tthis.schema = schema;\n\t\tthis.tool = tool;\n\t\tthis.options = options;\n\t}\n\tget name() {\n\t\treturn this.tool.function.name;\n\t}\n\tstatic fromSchema(schema, outputOptions) {\n\t\t/**\n\t\t* It is required for tools to have a name so we can map the tool call to the correct tool\n\t\t* when parsing the response.\n\t\t*/\n\t\tfunction getFunctionName(name) {\n\t\t\treturn name ?? `extract-${++bindingIdentifier}`;\n\t\t}\n\t\tif ((0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__.isInteropZodSchema)(schema)) {\n\t\t\tconst asJsonSchema = (0,_langchain_core_utils_json_schema__WEBPACK_IMPORTED_MODULE_3__.toJsonSchema)(schema);\n\t\t\treturn new ToolStrategy(asJsonSchema, {\n\t\t\t\ttype: \"function\",\n\t\t\t\tfunction: {\n\t\t\t\t\tname: getFunctionName(asJsonSchema.title),\n\t\t\t\t\tstrict: false,\n\t\t\t\t\tdescription: asJsonSchema.description ?? \"Tool for extracting structured output from the model's response.\",\n\t\t\t\t\tparameters: asJsonSchema\n\t\t\t\t}\n\t\t\t}, outputOptions);\n\t\t}\n\t\tlet functionDefinition;\n\t\tif (typeof schema.name === \"string\" && typeof schema.parameters === \"object\" && schema.parameters != null) functionDefinition = schema;\n\t\telse functionDefinition = {\n\t\t\tname: getFunctionName(schema.title),\n\t\t\tdescription: schema.description ?? \"\",\n\t\t\tparameters: schema.schema || schema\n\t\t};\n\t\treturn new ToolStrategy((0,_langchain_core_utils_json_schema__WEBPACK_IMPORTED_MODULE_3__.toJsonSchema)(schema), {\n\t\t\ttype: \"function\",\n\t\t\tfunction: functionDefinition\n\t\t}, outputOptions);\n\t}\n\t/**\n\t* Parse tool arguments according to the schema.\n\t*\n\t* @throws {StructuredOutputParsingError} if the response is not valid\n\t* @param toolArgs - The arguments from the tool call\n\t* @returns The parsed response according to the schema type\n\t*/\n\tparse(toolArgs) {\n\t\tconst result = new _langchain_core_utils_json_schema__WEBPACK_IMPORTED_MODULE_3__.Validator(this.schema).validate(toolArgs);\n\t\tif (!result.valid) throw new _errors_js__WEBPACK_IMPORTED_MODULE_1__.StructuredOutputParsingError(this.name, result.errors.map((e) => e.error));\n\t\treturn toolArgs;\n\t}\n};\nvar ProviderStrategy = class ProviderStrategy {\n\t_schemaType;\n\t/**\n\t* The schema to use for the provider strategy\n\t*/\n\tschema;\n\t/**\n\t* Whether to use strict mode for the provider strategy\n\t*/\n\tstrict;\n\tconstructor(schemaOrOptions, strict) {\n\t\tif (\"schema\" in schemaOrOptions && typeof schemaOrOptions.schema === \"object\" && schemaOrOptions.schema !== null && !(\"type\" in schemaOrOptions)) {\n\t\t\tconst options = schemaOrOptions;\n\t\t\tthis.schema = options.schema;\n\t\t\tthis.strict = options.strict ?? PROVIDER_STRATEGY_DEFAULT_STRICT;\n\t\t} else {\n\t\t\tthis.schema = schemaOrOptions;\n\t\t\tthis.strict = strict ?? PROVIDER_STRATEGY_DEFAULT_STRICT;\n\t\t}\n\t}\n\tstatic fromSchema(schema, strict) {\n\t\treturn new ProviderStrategy((0,_langchain_core_utils_json_schema__WEBPACK_IMPORTED_MODULE_3__.toJsonSchema)(schema), strict);\n\t}\n\t/**\n\t* Parse tool arguments according to the schema. If the response is not valid, return undefined.\n\t*\n\t* @param response - The AI message response to parse\n\t* @returns The parsed response according to the schema type\n\t*/\n\tparse(response) {\n\t\t/**\n\t\t* Extract text content from the response.\n\t\t* Handles both string content and array content (e.g., from thinking models).\n\t\t*/\n\t\tlet textContent;\n\t\tif (typeof response.content === \"string\") textContent = response.content;\n\t\telse if (Array.isArray(response.content)) {\n\t\t\t/**\n\t\t\t* For thinking models, content is an array with thinking blocks and text blocks.\n\t\t\t* Extract the text from text blocks.\n\t\t\t*/\n\t\t\tfor (const block of response.content) if (typeof block === \"object\" && block !== null && \"type\" in block && block.type === \"text\" && \"text\" in block && typeof block.text === \"string\") {\n\t\t\t\ttextContent = block.text;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!textContent || textContent === \"\") return;\n\t\ttry {\n\t\t\tconst content = JSON.parse(textContent);\n\t\t\tif (!new _langchain_core_utils_json_schema__WEBPACK_IMPORTED_MODULE_3__.Validator(this.schema).validate(content).valid) return;\n\t\t\treturn content;\n\t\t} catch {}\n\t}\n};\n/**\n* Handle user input for `responseFormat` parameter of `CreateAgentParams`.\n* This function defines the default behavior for the `responseFormat` parameter, which is:\n*\n* - if value is a Zod schema, default to structured output via tool calling\n* - if value is a JSON schema, default to structured output via tool calling\n* - if value is a custom response format, return it as is\n* - if value is an array, ensure all array elements are instance of `ToolStrategy`\n* @param responseFormat - The response format to transform, provided by the user\n* @param options - The response format options for tool strategy\n* @param model - The model to check if it supports JSON schema output\n* @returns\n*/\nfunction transformResponseFormat(responseFormat, options, model) {\n\tif (!responseFormat) return [];\n\tif (typeof responseFormat === \"object\" && responseFormat !== null && \"__responseFormatUndefined\" in responseFormat) return [];\n\t/**\n\t* If users provide an array, it should only contain raw schemas (Zod or JSON schema),\n\t* not ToolStrategy or ProviderStrategy instances.\n\t*/\n\tif (Array.isArray(responseFormat)) {\n\t\t/**\n\t\t* if every entry is a ToolStrategy or ProviderStrategy instance, return the array as is\n\t\t*/\n\t\tif (responseFormat.every((item) => item instanceof ToolStrategy || item instanceof ProviderStrategy)) return responseFormat;\n\t\t/**\n\t\t* Check if all items are Zod schemas\n\t\t*/\n\t\tif (responseFormat.every((item) => (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__.isInteropZodObject)(item))) return responseFormat.map((item) => ToolStrategy.fromSchema(item, options));\n\t\t/**\n\t\t* Check if all items are plain objects (JSON schema)\n\t\t*/\n\t\tif (responseFormat.every((item) => typeof item === \"object\" && item !== null && !(0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__.isInteropZodObject)(item))) return responseFormat.map((item) => ToolStrategy.fromSchema(item, options));\n\t\tthrow new Error(\"Invalid response format: list contains mixed types.\\nAll items must be either InteropZodObject or plain JSON schema objects.\");\n\t}\n\tif (responseFormat instanceof ToolStrategy || responseFormat instanceof ProviderStrategy) return [responseFormat];\n\tconst useProviderStrategy = hasSupportForJsonSchemaOutput(model);\n\t/**\n\t* `responseFormat` is a Zod schema\n\t*/\n\tif ((0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__.isInteropZodObject)(responseFormat)) return useProviderStrategy ? [ProviderStrategy.fromSchema(responseFormat)] : [ToolStrategy.fromSchema(responseFormat, options)];\n\t/**\n\t* Handle plain object (JSON schema)\n\t*/\n\tif (typeof responseFormat === \"object\" && responseFormat !== null && \"properties\" in responseFormat) return useProviderStrategy ? [ProviderStrategy.fromSchema(responseFormat)] : [ToolStrategy.fromSchema(responseFormat, options)];\n\tthrow new Error(`Invalid response format: ${String(responseFormat)}`);\n}\n/**\n* Creates a tool strategy for structured output using function calling.\n*\n* This function configures structured output by converting schemas into function tools that\n* the model calls. Unlike `providerStrategy`, which uses native JSON schema support,\n* `toolStrategy` works with any model that supports function calling, making it more\n* widely compatible across providers and model versions.\n*\n* The model will call a function with arguments matching your schema, and the agent will\n* extract and validate the structured output from the tool call. This approach is automatically\n* used when your model doesn't support native JSON schema output.\n*\n* @param responseFormat - The schema(s) to enforce. Can be a single Zod schema, an array of Zod schemas,\n*   a JSON schema object, or an array of JSON schema objects.\n* @param options - Optional configuration for the tool strategy\n* @param options.handleError - How to handle errors when the model calls multiple structured output tools\n*   or when the output doesn't match the schema. Defaults to `true` (auto-retry). Can be `false` (throw),\n*   a `string` (retry with message), or a `function` (custom handler).\n* @param options.toolMessageContent - Custom message content to include in conversation history\n*   when structured output is generated via tool call\n* @returns A `TypedToolStrategy` instance that can be used as the `responseFormat` in `createAgent`\n*\n* @example\n* ```ts\n* import { toolStrategy, createAgent } from \"langchain\";\n* import { z } from \"zod\";\n*\n* const agent = createAgent({\n*   model: \"claude-haiku-4-5\",\n*   responseFormat: toolStrategy(\n*     z.object({\n*       answer: z.string(),\n*       confidence: z.number().min(0).max(1),\n*     })\n*   ),\n* });\n* ```\n*\n* @example\n* ```ts\n* // Multiple schemas - model can choose which one to use\n* const agent = createAgent({\n*   model: \"claude-haiku-4-5\",\n*   responseFormat: toolStrategy([\n*     z.object({ name: z.string(), age: z.number() }),\n*     z.object({ email: z.string(), phone: z.string() }),\n*   ]),\n* });\n* ```\n*/\nfunction toolStrategy(responseFormat, options) {\n\treturn transformResponseFormat(responseFormat, options);\n}\nfunction providerStrategy(responseFormat) {\n\t/**\n\t* Handle options object format\n\t*/\n\tif (typeof responseFormat === \"object\" && responseFormat !== null && \"schema\" in responseFormat && !(0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_2__.isInteropZodSchema)(responseFormat) && !(\"type\" in responseFormat)) {\n\t\tconst { schema, strict: strictFlag } = responseFormat;\n\t\treturn ProviderStrategy.fromSchema(schema, strictFlag);\n\t}\n\t/**\n\t* Handle direct schema format\n\t*/\n\treturn ProviderStrategy.fromSchema(responseFormat);\n}\nconst CHAT_MODELS_THAT_SUPPORT_JSON_SCHEMA_OUTPUT = [\"ChatOpenAI\", \"ChatXAI\"];\nconst MODEL_NAMES_THAT_SUPPORT_JSON_SCHEMA_OUTPUT = [\n\t\"grok\",\n\t\"gpt-5\",\n\t\"gpt-4.1\",\n\t\"gpt-4o\",\n\t\"gpt-oss\",\n\t\"o3-pro\",\n\t\"o3-mini\"\n];\n/**\n* Identifies the models that support JSON schema output\n* @param model - The model to check\n* @returns True if the model supports JSON schema output, false otherwise\n*/\nfunction hasSupportForJsonSchemaOutput(model) {\n\tif (!model) return false;\n\tif (typeof model === \"string\") {\n\t\tconst modelName = model.split(\":\").pop();\n\t\treturn MODEL_NAMES_THAT_SUPPORT_JSON_SCHEMA_OUTPUT.some((modelNameSnippet) => modelName.includes(modelNameSnippet));\n\t}\n\tif ((0,_model_js__WEBPACK_IMPORTED_MODULE_0__.isConfigurableModel)(model)) return hasSupportForJsonSchemaOutput(model._defaultConfig.model);\n\tif (!(0,_model_js__WEBPACK_IMPORTED_MODULE_0__.isBaseChatModel)(model)) return false;\n\tconst chatModelClass = model.getName();\n\t/**\n\t* for testing purposes only\n\t*/\n\tif (chatModelClass === \"FakeToolCallingChatModel\") return true;\n\tif (CHAT_MODELS_THAT_SUPPORT_JSON_SCHEMA_OUTPUT.includes(chatModelClass) && (\"model\" in model && MODEL_NAMES_THAT_SUPPORT_JSON_SCHEMA_OUTPUT.some((modelNameSnippet) => typeof model.model === \"string\" && model.model.includes(modelNameSnippet)) || chatModelClass === \"FakeToolCallingModel\" && \"structuredResponse\" in model)) return true;\n\treturn false;\n}\n\n//#endregion\n\n//# sourceMappingURL=responses.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvcmVzcG9uc2VzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFrRTtBQUNQO0FBQzBCO0FBQ1Q7O0FBRTVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixvQkFBb0I7QUFDakQ7QUFDQSxNQUFNLCtFQUFrQjtBQUN4Qix3QkFBd0IsK0VBQVk7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLCtFQUFZO0FBQ3RDO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDhCQUE4QjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix3RUFBUztBQUM5QiwrQkFBK0Isb0VBQTRCO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLCtFQUFZO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0VBQVM7QUFDckI7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLCtFQUFrQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQSxtRkFBbUYsK0VBQWtCO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSywrRUFBa0I7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsdUJBQXVCO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyw0QkFBNEI7QUFDdkMsV0FBVyxJQUFJO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixtQ0FBbUM7QUFDcEQsaUJBQWlCLHNDQUFzQztBQUN2RDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxR0FBcUcsK0VBQWtCO0FBQ3ZILFVBQVUsNkJBQTZCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw4REFBbUI7QUFDeEIsTUFBTSwwREFBZTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ21HO0FBQ25HIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL3Jlc3BvbnNlcy5qcz9mMjM2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzQmFzZUNoYXRNb2RlbCwgaXNDb25maWd1cmFibGVNb2RlbCB9IGZyb20gXCIuL21vZGVsLmpzXCI7XG5pbXBvcnQgeyBTdHJ1Y3R1cmVkT3V0cHV0UGFyc2luZ0Vycm9yIH0gZnJvbSBcIi4vZXJyb3JzLmpzXCI7XG5pbXBvcnQgeyBpc0ludGVyb3Bab2RPYmplY3QsIGlzSW50ZXJvcFpvZFNjaGVtYSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvdXRpbHMvdHlwZXNcIjtcbmltcG9ydCB7IFZhbGlkYXRvciwgdG9Kc29uU2NoZW1hIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS91dGlscy9qc29uX3NjaGVtYVwiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy9yZXNwb25zZXMudHNcbi8qKlxuKiBEZWZhdWx0IHZhbHVlIGZvciBzdHJpY3QgbW9kZSBpbiBwcm92aWRlclN0cmF0ZWd5LlxuKlxuKiBXaGVuIHVzaW5nIHByb3ZpZGVyU3RyYXRlZ3kgd2l0aCBqc29uX3NjaGVtYSByZXNwb25zZSBmb3JtYXQsIE9wZW5BSSdzIHBhcnNlKCkgbWV0aG9kXG4qIHJlcXVpcmVzIGFsbCBmdW5jdGlvbiB0b29scyB0byBoYXZlIHN0cmljdDogdHJ1ZS4gVGhpcyBlbnN1cmVzIHRoZSBtb2RlbCdzIG91dHB1dFxuKiBleGFjdGx5IG1hdGNoZXMgdGhlIHByb3ZpZGVkIEpTT04gc2NoZW1hLlxuKlxuKiBAc2VlIGh0dHBzOi8vcGxhdGZvcm0ub3BlbmFpLmNvbS9kb2NzL2d1aWRlcy9zdHJ1Y3R1cmVkLW91dHB1dHNcbiovXG5jb25zdCBQUk9WSURFUl9TVFJBVEVHWV9ERUZBVUxUX1NUUklDVCA9IHRydWU7XG4vKipcbiogVGhpcyBpcyBhIGdsb2JhbCBjb3VudGVyIGZvciBnZW5lcmF0aW5nIHVuaXF1ZSBuYW1lcyBmb3IgdG9vbHMuXG4qL1xubGV0IGJpbmRpbmdJZGVudGlmaWVyID0gMDtcbi8qKlxuKiBJbmZvcm1hdGlvbiBmb3IgdHJhY2tpbmcgc3RydWN0dXJlZCBvdXRwdXQgdG9vbCBtZXRhZGF0YS5cbiogVGhpcyBjb250YWlucyBhbGwgbmVjZXNzYXJ5IGluZm9ybWF0aW9uIHRvIGhhbmRsZSBzdHJ1Y3R1cmVkIHJlc3BvbnNlcyBnZW5lcmF0ZWRcbiogdmlhIHRvb2wgY2FsbHMsIGluY2x1ZGluZyB0aGUgb3JpZ2luYWwgc2NoZW1hLCBpdHMgdHlwZSBjbGFzc2lmaWNhdGlvbiwgYW5kIHRoZVxuKiBjb3JyZXNwb25kaW5nIHRvb2wgaW1wbGVtZW50YXRpb24gdXNlZCBieSB0aGUgdG9vbHMgc3RyYXRlZ3kuXG4qL1xudmFyIFRvb2xTdHJhdGVneSA9IGNsYXNzIFRvb2xTdHJhdGVneSB7XG5cdGNvbnN0cnVjdG9yKHNjaGVtYSwgdG9vbCwgb3B0aW9ucykge1xuXHRcdHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuXHRcdHRoaXMudG9vbCA9IHRvb2w7XG5cdFx0dGhpcy5vcHRpb25zID0gb3B0aW9ucztcblx0fVxuXHRnZXQgbmFtZSgpIHtcblx0XHRyZXR1cm4gdGhpcy50b29sLmZ1bmN0aW9uLm5hbWU7XG5cdH1cblx0c3RhdGljIGZyb21TY2hlbWEoc2NoZW1hLCBvdXRwdXRPcHRpb25zKSB7XG5cdFx0LyoqXG5cdFx0KiBJdCBpcyByZXF1aXJlZCBmb3IgdG9vbHMgdG8gaGF2ZSBhIG5hbWUgc28gd2UgY2FuIG1hcCB0aGUgdG9vbCBjYWxsIHRvIHRoZSBjb3JyZWN0IHRvb2xcblx0XHQqIHdoZW4gcGFyc2luZyB0aGUgcmVzcG9uc2UuXG5cdFx0Ki9cblx0XHRmdW5jdGlvbiBnZXRGdW5jdGlvbk5hbWUobmFtZSkge1xuXHRcdFx0cmV0dXJuIG5hbWUgPz8gYGV4dHJhY3QtJHsrK2JpbmRpbmdJZGVudGlmaWVyfWA7XG5cdFx0fVxuXHRcdGlmIChpc0ludGVyb3Bab2RTY2hlbWEoc2NoZW1hKSkge1xuXHRcdFx0Y29uc3QgYXNKc29uU2NoZW1hID0gdG9Kc29uU2NoZW1hKHNjaGVtYSk7XG5cdFx0XHRyZXR1cm4gbmV3IFRvb2xTdHJhdGVneShhc0pzb25TY2hlbWEsIHtcblx0XHRcdFx0dHlwZTogXCJmdW5jdGlvblwiLFxuXHRcdFx0XHRmdW5jdGlvbjoge1xuXHRcdFx0XHRcdG5hbWU6IGdldEZ1bmN0aW9uTmFtZShhc0pzb25TY2hlbWEudGl0bGUpLFxuXHRcdFx0XHRcdHN0cmljdDogZmFsc2UsXG5cdFx0XHRcdFx0ZGVzY3JpcHRpb246IGFzSnNvblNjaGVtYS5kZXNjcmlwdGlvbiA/PyBcIlRvb2wgZm9yIGV4dHJhY3Rpbmcgc3RydWN0dXJlZCBvdXRwdXQgZnJvbSB0aGUgbW9kZWwncyByZXNwb25zZS5cIixcblx0XHRcdFx0XHRwYXJhbWV0ZXJzOiBhc0pzb25TY2hlbWFcblx0XHRcdFx0fVxuXHRcdFx0fSwgb3V0cHV0T3B0aW9ucyk7XG5cdFx0fVxuXHRcdGxldCBmdW5jdGlvbkRlZmluaXRpb247XG5cdFx0aWYgKHR5cGVvZiBzY2hlbWEubmFtZSA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2Ygc2NoZW1hLnBhcmFtZXRlcnMgPT09IFwib2JqZWN0XCIgJiYgc2NoZW1hLnBhcmFtZXRlcnMgIT0gbnVsbCkgZnVuY3Rpb25EZWZpbml0aW9uID0gc2NoZW1hO1xuXHRcdGVsc2UgZnVuY3Rpb25EZWZpbml0aW9uID0ge1xuXHRcdFx0bmFtZTogZ2V0RnVuY3Rpb25OYW1lKHNjaGVtYS50aXRsZSksXG5cdFx0XHRkZXNjcmlwdGlvbjogc2NoZW1hLmRlc2NyaXB0aW9uID8/IFwiXCIsXG5cdFx0XHRwYXJhbWV0ZXJzOiBzY2hlbWEuc2NoZW1hIHx8IHNjaGVtYVxuXHRcdH07XG5cdFx0cmV0dXJuIG5ldyBUb29sU3RyYXRlZ3kodG9Kc29uU2NoZW1hKHNjaGVtYSksIHtcblx0XHRcdHR5cGU6IFwiZnVuY3Rpb25cIixcblx0XHRcdGZ1bmN0aW9uOiBmdW5jdGlvbkRlZmluaXRpb25cblx0XHR9LCBvdXRwdXRPcHRpb25zKTtcblx0fVxuXHQvKipcblx0KiBQYXJzZSB0b29sIGFyZ3VtZW50cyBhY2NvcmRpbmcgdG8gdGhlIHNjaGVtYS5cblx0KlxuXHQqIEB0aHJvd3Mge1N0cnVjdHVyZWRPdXRwdXRQYXJzaW5nRXJyb3J9IGlmIHRoZSByZXNwb25zZSBpcyBub3QgdmFsaWRcblx0KiBAcGFyYW0gdG9vbEFyZ3MgLSBUaGUgYXJndW1lbnRzIGZyb20gdGhlIHRvb2wgY2FsbFxuXHQqIEByZXR1cm5zIFRoZSBwYXJzZWQgcmVzcG9uc2UgYWNjb3JkaW5nIHRvIHRoZSBzY2hlbWEgdHlwZVxuXHQqL1xuXHRwYXJzZSh0b29sQXJncykge1xuXHRcdGNvbnN0IHJlc3VsdCA9IG5ldyBWYWxpZGF0b3IodGhpcy5zY2hlbWEpLnZhbGlkYXRlKHRvb2xBcmdzKTtcblx0XHRpZiAoIXJlc3VsdC52YWxpZCkgdGhyb3cgbmV3IFN0cnVjdHVyZWRPdXRwdXRQYXJzaW5nRXJyb3IodGhpcy5uYW1lLCByZXN1bHQuZXJyb3JzLm1hcCgoZSkgPT4gZS5lcnJvcikpO1xuXHRcdHJldHVybiB0b29sQXJncztcblx0fVxufTtcbnZhciBQcm92aWRlclN0cmF0ZWd5ID0gY2xhc3MgUHJvdmlkZXJTdHJhdGVneSB7XG5cdF9zY2hlbWFUeXBlO1xuXHQvKipcblx0KiBUaGUgc2NoZW1hIHRvIHVzZSBmb3IgdGhlIHByb3ZpZGVyIHN0cmF0ZWd5XG5cdCovXG5cdHNjaGVtYTtcblx0LyoqXG5cdCogV2hldGhlciB0byB1c2Ugc3RyaWN0IG1vZGUgZm9yIHRoZSBwcm92aWRlciBzdHJhdGVneVxuXHQqL1xuXHRzdHJpY3Q7XG5cdGNvbnN0cnVjdG9yKHNjaGVtYU9yT3B0aW9ucywgc3RyaWN0KSB7XG5cdFx0aWYgKFwic2NoZW1hXCIgaW4gc2NoZW1hT3JPcHRpb25zICYmIHR5cGVvZiBzY2hlbWFPck9wdGlvbnMuc2NoZW1hID09PSBcIm9iamVjdFwiICYmIHNjaGVtYU9yT3B0aW9ucy5zY2hlbWEgIT09IG51bGwgJiYgIShcInR5cGVcIiBpbiBzY2hlbWFPck9wdGlvbnMpKSB7XG5cdFx0XHRjb25zdCBvcHRpb25zID0gc2NoZW1hT3JPcHRpb25zO1xuXHRcdFx0dGhpcy5zY2hlbWEgPSBvcHRpb25zLnNjaGVtYTtcblx0XHRcdHRoaXMuc3RyaWN0ID0gb3B0aW9ucy5zdHJpY3QgPz8gUFJPVklERVJfU1RSQVRFR1lfREVGQVVMVF9TVFJJQ1Q7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc2NoZW1hID0gc2NoZW1hT3JPcHRpb25zO1xuXHRcdFx0dGhpcy5zdHJpY3QgPSBzdHJpY3QgPz8gUFJPVklERVJfU1RSQVRFR1lfREVGQVVMVF9TVFJJQ1Q7XG5cdFx0fVxuXHR9XG5cdHN0YXRpYyBmcm9tU2NoZW1hKHNjaGVtYSwgc3RyaWN0KSB7XG5cdFx0cmV0dXJuIG5ldyBQcm92aWRlclN0cmF0ZWd5KHRvSnNvblNjaGVtYShzY2hlbWEpLCBzdHJpY3QpO1xuXHR9XG5cdC8qKlxuXHQqIFBhcnNlIHRvb2wgYXJndW1lbnRzIGFjY29yZGluZyB0byB0aGUgc2NoZW1hLiBJZiB0aGUgcmVzcG9uc2UgaXMgbm90IHZhbGlkLCByZXR1cm4gdW5kZWZpbmVkLlxuXHQqXG5cdCogQHBhcmFtIHJlc3BvbnNlIC0gVGhlIEFJIG1lc3NhZ2UgcmVzcG9uc2UgdG8gcGFyc2Vcblx0KiBAcmV0dXJucyBUaGUgcGFyc2VkIHJlc3BvbnNlIGFjY29yZGluZyB0byB0aGUgc2NoZW1hIHR5cGVcblx0Ki9cblx0cGFyc2UocmVzcG9uc2UpIHtcblx0XHQvKipcblx0XHQqIEV4dHJhY3QgdGV4dCBjb250ZW50IGZyb20gdGhlIHJlc3BvbnNlLlxuXHRcdCogSGFuZGxlcyBib3RoIHN0cmluZyBjb250ZW50IGFuZCBhcnJheSBjb250ZW50IChlLmcuLCBmcm9tIHRoaW5raW5nIG1vZGVscykuXG5cdFx0Ki9cblx0XHRsZXQgdGV4dENvbnRlbnQ7XG5cdFx0aWYgKHR5cGVvZiByZXNwb25zZS5jb250ZW50ID09PSBcInN0cmluZ1wiKSB0ZXh0Q29udGVudCA9IHJlc3BvbnNlLmNvbnRlbnQ7XG5cdFx0ZWxzZSBpZiAoQXJyYXkuaXNBcnJheShyZXNwb25zZS5jb250ZW50KSkge1xuXHRcdFx0LyoqXG5cdFx0XHQqIEZvciB0aGlua2luZyBtb2RlbHMsIGNvbnRlbnQgaXMgYW4gYXJyYXkgd2l0aCB0aGlua2luZyBibG9ja3MgYW5kIHRleHQgYmxvY2tzLlxuXHRcdFx0KiBFeHRyYWN0IHRoZSB0ZXh0IGZyb20gdGV4dCBibG9ja3MuXG5cdFx0XHQqL1xuXHRcdFx0Zm9yIChjb25zdCBibG9jayBvZiByZXNwb25zZS5jb250ZW50KSBpZiAodHlwZW9mIGJsb2NrID09PSBcIm9iamVjdFwiICYmIGJsb2NrICE9PSBudWxsICYmIFwidHlwZVwiIGluIGJsb2NrICYmIGJsb2NrLnR5cGUgPT09IFwidGV4dFwiICYmIFwidGV4dFwiIGluIGJsb2NrICYmIHR5cGVvZiBibG9jay50ZXh0ID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRcdHRleHRDb250ZW50ID0gYmxvY2sudGV4dDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmICghdGV4dENvbnRlbnQgfHwgdGV4dENvbnRlbnQgPT09IFwiXCIpIHJldHVybjtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgY29udGVudCA9IEpTT04ucGFyc2UodGV4dENvbnRlbnQpO1xuXHRcdFx0aWYgKCFuZXcgVmFsaWRhdG9yKHRoaXMuc2NoZW1hKS52YWxpZGF0ZShjb250ZW50KS52YWxpZCkgcmV0dXJuO1xuXHRcdFx0cmV0dXJuIGNvbnRlbnQ7XG5cdFx0fSBjYXRjaCB7fVxuXHR9XG59O1xuLyoqXG4qIEhhbmRsZSB1c2VyIGlucHV0IGZvciBgcmVzcG9uc2VGb3JtYXRgIHBhcmFtZXRlciBvZiBgQ3JlYXRlQWdlbnRQYXJhbXNgLlxuKiBUaGlzIGZ1bmN0aW9uIGRlZmluZXMgdGhlIGRlZmF1bHQgYmVoYXZpb3IgZm9yIHRoZSBgcmVzcG9uc2VGb3JtYXRgIHBhcmFtZXRlciwgd2hpY2ggaXM6XG4qXG4qIC0gaWYgdmFsdWUgaXMgYSBab2Qgc2NoZW1hLCBkZWZhdWx0IHRvIHN0cnVjdHVyZWQgb3V0cHV0IHZpYSB0b29sIGNhbGxpbmdcbiogLSBpZiB2YWx1ZSBpcyBhIEpTT04gc2NoZW1hLCBkZWZhdWx0IHRvIHN0cnVjdHVyZWQgb3V0cHV0IHZpYSB0b29sIGNhbGxpbmdcbiogLSBpZiB2YWx1ZSBpcyBhIGN1c3RvbSByZXNwb25zZSBmb3JtYXQsIHJldHVybiBpdCBhcyBpc1xuKiAtIGlmIHZhbHVlIGlzIGFuIGFycmF5LCBlbnN1cmUgYWxsIGFycmF5IGVsZW1lbnRzIGFyZSBpbnN0YW5jZSBvZiBgVG9vbFN0cmF0ZWd5YFxuKiBAcGFyYW0gcmVzcG9uc2VGb3JtYXQgLSBUaGUgcmVzcG9uc2UgZm9ybWF0IHRvIHRyYW5zZm9ybSwgcHJvdmlkZWQgYnkgdGhlIHVzZXJcbiogQHBhcmFtIG9wdGlvbnMgLSBUaGUgcmVzcG9uc2UgZm9ybWF0IG9wdGlvbnMgZm9yIHRvb2wgc3RyYXRlZ3lcbiogQHBhcmFtIG1vZGVsIC0gVGhlIG1vZGVsIHRvIGNoZWNrIGlmIGl0IHN1cHBvcnRzIEpTT04gc2NoZW1hIG91dHB1dFxuKiBAcmV0dXJuc1xuKi9cbmZ1bmN0aW9uIHRyYW5zZm9ybVJlc3BvbnNlRm9ybWF0KHJlc3BvbnNlRm9ybWF0LCBvcHRpb25zLCBtb2RlbCkge1xuXHRpZiAoIXJlc3BvbnNlRm9ybWF0KSByZXR1cm4gW107XG5cdGlmICh0eXBlb2YgcmVzcG9uc2VGb3JtYXQgPT09IFwib2JqZWN0XCIgJiYgcmVzcG9uc2VGb3JtYXQgIT09IG51bGwgJiYgXCJfX3Jlc3BvbnNlRm9ybWF0VW5kZWZpbmVkXCIgaW4gcmVzcG9uc2VGb3JtYXQpIHJldHVybiBbXTtcblx0LyoqXG5cdCogSWYgdXNlcnMgcHJvdmlkZSBhbiBhcnJheSwgaXQgc2hvdWxkIG9ubHkgY29udGFpbiByYXcgc2NoZW1hcyAoWm9kIG9yIEpTT04gc2NoZW1hKSxcblx0KiBub3QgVG9vbFN0cmF0ZWd5IG9yIFByb3ZpZGVyU3RyYXRlZ3kgaW5zdGFuY2VzLlxuXHQqL1xuXHRpZiAoQXJyYXkuaXNBcnJheShyZXNwb25zZUZvcm1hdCkpIHtcblx0XHQvKipcblx0XHQqIGlmIGV2ZXJ5IGVudHJ5IGlzIGEgVG9vbFN0cmF0ZWd5IG9yIFByb3ZpZGVyU3RyYXRlZ3kgaW5zdGFuY2UsIHJldHVybiB0aGUgYXJyYXkgYXMgaXNcblx0XHQqL1xuXHRcdGlmIChyZXNwb25zZUZvcm1hdC5ldmVyeSgoaXRlbSkgPT4gaXRlbSBpbnN0YW5jZW9mIFRvb2xTdHJhdGVneSB8fCBpdGVtIGluc3RhbmNlb2YgUHJvdmlkZXJTdHJhdGVneSkpIHJldHVybiByZXNwb25zZUZvcm1hdDtcblx0XHQvKipcblx0XHQqIENoZWNrIGlmIGFsbCBpdGVtcyBhcmUgWm9kIHNjaGVtYXNcblx0XHQqL1xuXHRcdGlmIChyZXNwb25zZUZvcm1hdC5ldmVyeSgoaXRlbSkgPT4gaXNJbnRlcm9wWm9kT2JqZWN0KGl0ZW0pKSkgcmV0dXJuIHJlc3BvbnNlRm9ybWF0Lm1hcCgoaXRlbSkgPT4gVG9vbFN0cmF0ZWd5LmZyb21TY2hlbWEoaXRlbSwgb3B0aW9ucykpO1xuXHRcdC8qKlxuXHRcdCogQ2hlY2sgaWYgYWxsIGl0ZW1zIGFyZSBwbGFpbiBvYmplY3RzIChKU09OIHNjaGVtYSlcblx0XHQqL1xuXHRcdGlmIChyZXNwb25zZUZvcm1hdC5ldmVyeSgoaXRlbSkgPT4gdHlwZW9mIGl0ZW0gPT09IFwib2JqZWN0XCIgJiYgaXRlbSAhPT0gbnVsbCAmJiAhaXNJbnRlcm9wWm9kT2JqZWN0KGl0ZW0pKSkgcmV0dXJuIHJlc3BvbnNlRm9ybWF0Lm1hcCgoaXRlbSkgPT4gVG9vbFN0cmF0ZWd5LmZyb21TY2hlbWEoaXRlbSwgb3B0aW9ucykpO1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcmVzcG9uc2UgZm9ybWF0OiBsaXN0IGNvbnRhaW5zIG1peGVkIHR5cGVzLlxcbkFsbCBpdGVtcyBtdXN0IGJlIGVpdGhlciBJbnRlcm9wWm9kT2JqZWN0IG9yIHBsYWluIEpTT04gc2NoZW1hIG9iamVjdHMuXCIpO1xuXHR9XG5cdGlmIChyZXNwb25zZUZvcm1hdCBpbnN0YW5jZW9mIFRvb2xTdHJhdGVneSB8fCByZXNwb25zZUZvcm1hdCBpbnN0YW5jZW9mIFByb3ZpZGVyU3RyYXRlZ3kpIHJldHVybiBbcmVzcG9uc2VGb3JtYXRdO1xuXHRjb25zdCB1c2VQcm92aWRlclN0cmF0ZWd5ID0gaGFzU3VwcG9ydEZvckpzb25TY2hlbWFPdXRwdXQobW9kZWwpO1xuXHQvKipcblx0KiBgcmVzcG9uc2VGb3JtYXRgIGlzIGEgWm9kIHNjaGVtYVxuXHQqL1xuXHRpZiAoaXNJbnRlcm9wWm9kT2JqZWN0KHJlc3BvbnNlRm9ybWF0KSkgcmV0dXJuIHVzZVByb3ZpZGVyU3RyYXRlZ3kgPyBbUHJvdmlkZXJTdHJhdGVneS5mcm9tU2NoZW1hKHJlc3BvbnNlRm9ybWF0KV0gOiBbVG9vbFN0cmF0ZWd5LmZyb21TY2hlbWEocmVzcG9uc2VGb3JtYXQsIG9wdGlvbnMpXTtcblx0LyoqXG5cdCogSGFuZGxlIHBsYWluIG9iamVjdCAoSlNPTiBzY2hlbWEpXG5cdCovXG5cdGlmICh0eXBlb2YgcmVzcG9uc2VGb3JtYXQgPT09IFwib2JqZWN0XCIgJiYgcmVzcG9uc2VGb3JtYXQgIT09IG51bGwgJiYgXCJwcm9wZXJ0aWVzXCIgaW4gcmVzcG9uc2VGb3JtYXQpIHJldHVybiB1c2VQcm92aWRlclN0cmF0ZWd5ID8gW1Byb3ZpZGVyU3RyYXRlZ3kuZnJvbVNjaGVtYShyZXNwb25zZUZvcm1hdCldIDogW1Rvb2xTdHJhdGVneS5mcm9tU2NoZW1hKHJlc3BvbnNlRm9ybWF0LCBvcHRpb25zKV07XG5cdHRocm93IG5ldyBFcnJvcihgSW52YWxpZCByZXNwb25zZSBmb3JtYXQ6ICR7U3RyaW5nKHJlc3BvbnNlRm9ybWF0KX1gKTtcbn1cbi8qKlxuKiBDcmVhdGVzIGEgdG9vbCBzdHJhdGVneSBmb3Igc3RydWN0dXJlZCBvdXRwdXQgdXNpbmcgZnVuY3Rpb24gY2FsbGluZy5cbipcbiogVGhpcyBmdW5jdGlvbiBjb25maWd1cmVzIHN0cnVjdHVyZWQgb3V0cHV0IGJ5IGNvbnZlcnRpbmcgc2NoZW1hcyBpbnRvIGZ1bmN0aW9uIHRvb2xzIHRoYXRcbiogdGhlIG1vZGVsIGNhbGxzLiBVbmxpa2UgYHByb3ZpZGVyU3RyYXRlZ3lgLCB3aGljaCB1c2VzIG5hdGl2ZSBKU09OIHNjaGVtYSBzdXBwb3J0LFxuKiBgdG9vbFN0cmF0ZWd5YCB3b3JrcyB3aXRoIGFueSBtb2RlbCB0aGF0IHN1cHBvcnRzIGZ1bmN0aW9uIGNhbGxpbmcsIG1ha2luZyBpdCBtb3JlXG4qIHdpZGVseSBjb21wYXRpYmxlIGFjcm9zcyBwcm92aWRlcnMgYW5kIG1vZGVsIHZlcnNpb25zLlxuKlxuKiBUaGUgbW9kZWwgd2lsbCBjYWxsIGEgZnVuY3Rpb24gd2l0aCBhcmd1bWVudHMgbWF0Y2hpbmcgeW91ciBzY2hlbWEsIGFuZCB0aGUgYWdlbnQgd2lsbFxuKiBleHRyYWN0IGFuZCB2YWxpZGF0ZSB0aGUgc3RydWN0dXJlZCBvdXRwdXQgZnJvbSB0aGUgdG9vbCBjYWxsLiBUaGlzIGFwcHJvYWNoIGlzIGF1dG9tYXRpY2FsbHlcbiogdXNlZCB3aGVuIHlvdXIgbW9kZWwgZG9lc24ndCBzdXBwb3J0IG5hdGl2ZSBKU09OIHNjaGVtYSBvdXRwdXQuXG4qXG4qIEBwYXJhbSByZXNwb25zZUZvcm1hdCAtIFRoZSBzY2hlbWEocykgdG8gZW5mb3JjZS4gQ2FuIGJlIGEgc2luZ2xlIFpvZCBzY2hlbWEsIGFuIGFycmF5IG9mIFpvZCBzY2hlbWFzLFxuKiAgIGEgSlNPTiBzY2hlbWEgb2JqZWN0LCBvciBhbiBhcnJheSBvZiBKU09OIHNjaGVtYSBvYmplY3RzLlxuKiBAcGFyYW0gb3B0aW9ucyAtIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb24gZm9yIHRoZSB0b29sIHN0cmF0ZWd5XG4qIEBwYXJhbSBvcHRpb25zLmhhbmRsZUVycm9yIC0gSG93IHRvIGhhbmRsZSBlcnJvcnMgd2hlbiB0aGUgbW9kZWwgY2FsbHMgbXVsdGlwbGUgc3RydWN0dXJlZCBvdXRwdXQgdG9vbHNcbiogICBvciB3aGVuIHRoZSBvdXRwdXQgZG9lc24ndCBtYXRjaCB0aGUgc2NoZW1hLiBEZWZhdWx0cyB0byBgdHJ1ZWAgKGF1dG8tcmV0cnkpLiBDYW4gYmUgYGZhbHNlYCAodGhyb3cpLFxuKiAgIGEgYHN0cmluZ2AgKHJldHJ5IHdpdGggbWVzc2FnZSksIG9yIGEgYGZ1bmN0aW9uYCAoY3VzdG9tIGhhbmRsZXIpLlxuKiBAcGFyYW0gb3B0aW9ucy50b29sTWVzc2FnZUNvbnRlbnQgLSBDdXN0b20gbWVzc2FnZSBjb250ZW50IHRvIGluY2x1ZGUgaW4gY29udmVyc2F0aW9uIGhpc3RvcnlcbiogICB3aGVuIHN0cnVjdHVyZWQgb3V0cHV0IGlzIGdlbmVyYXRlZCB2aWEgdG9vbCBjYWxsXG4qIEByZXR1cm5zIEEgYFR5cGVkVG9vbFN0cmF0ZWd5YCBpbnN0YW5jZSB0aGF0IGNhbiBiZSB1c2VkIGFzIHRoZSBgcmVzcG9uc2VGb3JtYXRgIGluIGBjcmVhdGVBZ2VudGBcbipcbiogQGV4YW1wbGVcbiogYGBgdHNcbiogaW1wb3J0IHsgdG9vbFN0cmF0ZWd5LCBjcmVhdGVBZ2VudCB9IGZyb20gXCJsYW5nY2hhaW5cIjtcbiogaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcbipcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwiY2xhdWRlLWhhaWt1LTQtNVwiLFxuKiAgIHJlc3BvbnNlRm9ybWF0OiB0b29sU3RyYXRlZ3koXG4qICAgICB6Lm9iamVjdCh7XG4qICAgICAgIGFuc3dlcjogei5zdHJpbmcoKSxcbiogICAgICAgY29uZmlkZW5jZTogei5udW1iZXIoKS5taW4oMCkubWF4KDEpLFxuKiAgICAgfSlcbiogICApLFxuKiB9KTtcbiogYGBgXG4qXG4qIEBleGFtcGxlXG4qIGBgYHRzXG4qIC8vIE11bHRpcGxlIHNjaGVtYXMgLSBtb2RlbCBjYW4gY2hvb3NlIHdoaWNoIG9uZSB0byB1c2VcbiogY29uc3QgYWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4qICAgbW9kZWw6IFwiY2xhdWRlLWhhaWt1LTQtNVwiLFxuKiAgIHJlc3BvbnNlRm9ybWF0OiB0b29sU3RyYXRlZ3koW1xuKiAgICAgei5vYmplY3QoeyBuYW1lOiB6LnN0cmluZygpLCBhZ2U6IHoubnVtYmVyKCkgfSksXG4qICAgICB6Lm9iamVjdCh7IGVtYWlsOiB6LnN0cmluZygpLCBwaG9uZTogei5zdHJpbmcoKSB9KSxcbiogICBdKSxcbiogfSk7XG4qIGBgYFxuKi9cbmZ1bmN0aW9uIHRvb2xTdHJhdGVneShyZXNwb25zZUZvcm1hdCwgb3B0aW9ucykge1xuXHRyZXR1cm4gdHJhbnNmb3JtUmVzcG9uc2VGb3JtYXQocmVzcG9uc2VGb3JtYXQsIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gcHJvdmlkZXJTdHJhdGVneShyZXNwb25zZUZvcm1hdCkge1xuXHQvKipcblx0KiBIYW5kbGUgb3B0aW9ucyBvYmplY3QgZm9ybWF0XG5cdCovXG5cdGlmICh0eXBlb2YgcmVzcG9uc2VGb3JtYXQgPT09IFwib2JqZWN0XCIgJiYgcmVzcG9uc2VGb3JtYXQgIT09IG51bGwgJiYgXCJzY2hlbWFcIiBpbiByZXNwb25zZUZvcm1hdCAmJiAhaXNJbnRlcm9wWm9kU2NoZW1hKHJlc3BvbnNlRm9ybWF0KSAmJiAhKFwidHlwZVwiIGluIHJlc3BvbnNlRm9ybWF0KSkge1xuXHRcdGNvbnN0IHsgc2NoZW1hLCBzdHJpY3Q6IHN0cmljdEZsYWcgfSA9IHJlc3BvbnNlRm9ybWF0O1xuXHRcdHJldHVybiBQcm92aWRlclN0cmF0ZWd5LmZyb21TY2hlbWEoc2NoZW1hLCBzdHJpY3RGbGFnKTtcblx0fVxuXHQvKipcblx0KiBIYW5kbGUgZGlyZWN0IHNjaGVtYSBmb3JtYXRcblx0Ki9cblx0cmV0dXJuIFByb3ZpZGVyU3RyYXRlZ3kuZnJvbVNjaGVtYShyZXNwb25zZUZvcm1hdCk7XG59XG5jb25zdCBDSEFUX01PREVMU19USEFUX1NVUFBPUlRfSlNPTl9TQ0hFTUFfT1VUUFVUID0gW1wiQ2hhdE9wZW5BSVwiLCBcIkNoYXRYQUlcIl07XG5jb25zdCBNT0RFTF9OQU1FU19USEFUX1NVUFBPUlRfSlNPTl9TQ0hFTUFfT1VUUFVUID0gW1xuXHRcImdyb2tcIixcblx0XCJncHQtNVwiLFxuXHRcImdwdC00LjFcIixcblx0XCJncHQtNG9cIixcblx0XCJncHQtb3NzXCIsXG5cdFwibzMtcHJvXCIsXG5cdFwibzMtbWluaVwiXG5dO1xuLyoqXG4qIElkZW50aWZpZXMgdGhlIG1vZGVscyB0aGF0IHN1cHBvcnQgSlNPTiBzY2hlbWEgb3V0cHV0XG4qIEBwYXJhbSBtb2RlbCAtIFRoZSBtb2RlbCB0byBjaGVja1xuKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBtb2RlbCBzdXBwb3J0cyBKU09OIHNjaGVtYSBvdXRwdXQsIGZhbHNlIG90aGVyd2lzZVxuKi9cbmZ1bmN0aW9uIGhhc1N1cHBvcnRGb3JKc29uU2NoZW1hT3V0cHV0KG1vZGVsKSB7XG5cdGlmICghbW9kZWwpIHJldHVybiBmYWxzZTtcblx0aWYgKHR5cGVvZiBtb2RlbCA9PT0gXCJzdHJpbmdcIikge1xuXHRcdGNvbnN0IG1vZGVsTmFtZSA9IG1vZGVsLnNwbGl0KFwiOlwiKS5wb3AoKTtcblx0XHRyZXR1cm4gTU9ERUxfTkFNRVNfVEhBVF9TVVBQT1JUX0pTT05fU0NIRU1BX09VVFBVVC5zb21lKChtb2RlbE5hbWVTbmlwcGV0KSA9PiBtb2RlbE5hbWUuaW5jbHVkZXMobW9kZWxOYW1lU25pcHBldCkpO1xuXHR9XG5cdGlmIChpc0NvbmZpZ3VyYWJsZU1vZGVsKG1vZGVsKSkgcmV0dXJuIGhhc1N1cHBvcnRGb3JKc29uU2NoZW1hT3V0cHV0KG1vZGVsLl9kZWZhdWx0Q29uZmlnLm1vZGVsKTtcblx0aWYgKCFpc0Jhc2VDaGF0TW9kZWwobW9kZWwpKSByZXR1cm4gZmFsc2U7XG5cdGNvbnN0IGNoYXRNb2RlbENsYXNzID0gbW9kZWwuZ2V0TmFtZSgpO1xuXHQvKipcblx0KiBmb3IgdGVzdGluZyBwdXJwb3NlcyBvbmx5XG5cdCovXG5cdGlmIChjaGF0TW9kZWxDbGFzcyA9PT0gXCJGYWtlVG9vbENhbGxpbmdDaGF0TW9kZWxcIikgcmV0dXJuIHRydWU7XG5cdGlmIChDSEFUX01PREVMU19USEFUX1NVUFBPUlRfSlNPTl9TQ0hFTUFfT1VUUFVULmluY2x1ZGVzKGNoYXRNb2RlbENsYXNzKSAmJiAoXCJtb2RlbFwiIGluIG1vZGVsICYmIE1PREVMX05BTUVTX1RIQVRfU1VQUE9SVF9KU09OX1NDSEVNQV9PVVRQVVQuc29tZSgobW9kZWxOYW1lU25pcHBldCkgPT4gdHlwZW9mIG1vZGVsLm1vZGVsID09PSBcInN0cmluZ1wiICYmIG1vZGVsLm1vZGVsLmluY2x1ZGVzKG1vZGVsTmFtZVNuaXBwZXQpKSB8fCBjaGF0TW9kZWxDbGFzcyA9PT0gXCJGYWtlVG9vbENhbGxpbmdNb2RlbFwiICYmIFwic3RydWN0dXJlZFJlc3BvbnNlXCIgaW4gbW9kZWwpKSByZXR1cm4gdHJ1ZTtcblx0cmV0dXJuIGZhbHNlO1xufVxuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IFByb3ZpZGVyU3RyYXRlZ3ksIFRvb2xTdHJhdGVneSwgcHJvdmlkZXJTdHJhdGVneSwgdG9vbFN0cmF0ZWd5LCB0cmFuc2Zvcm1SZXNwb25zZUZvcm1hdCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmVzcG9uc2VzLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/responses.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/state.js":
/*!*************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/state.js ***!
  \*************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StateManager: () => (/* binding */ StateManager)\n/* harmony export */ });\n//#region src/agents/state.ts\n/**\n* The StateManager is responsible for managing the state of the agent.\n* The `createAgent` maintains different nodes with their own state. For the user\n* however, they only see the combined state of all nodes. This class is helps\n* to share the state between different nodes.\n*\n* @internal\n*/\nvar StateManager = class {\n\t#nodes = /* @__PURE__ */ new Map();\n\t/**\n\t* Add node to middleware group.\n\t* @param name - The name of the middleware group.\n\t* @param node - The node to add.\n\t*/\n\taddNode(middleware, node) {\n\t\tthis.#nodes.set(middleware.name, [...this.#nodes.get(middleware.name) ?? [], node]);\n\t}\n\t/**\n\t* Get the state of a middleware group.\n\t* @param name - The name of the middleware group.\n\t* @returns The state of the middleware group.\n\t*/\n\tgetState(name) {\n\t\tconst state = (this.#nodes.get(name) ?? []).reduce((prev, node) => {\n\t\t\treturn {\n\t\t\t\t...prev,\n\t\t\t\t...node.getState() ?? {}\n\t\t\t};\n\t\t}, {});\n\t\t/**\n\t\t* we internally reset the jumpTo property and shouldn't propagate this value\n\t\t* to the middleware hooks.\n\t\t*/\n\t\tdelete state.jumpTo;\n\t\treturn state;\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=state.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvc3RhdGUuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsSUFBSTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDd0I7QUFDeEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvc3RhdGUuanM/ZjkxZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyNyZWdpb24gc3JjL2FnZW50cy9zdGF0ZS50c1xuLyoqXG4qIFRoZSBTdGF0ZU1hbmFnZXIgaXMgcmVzcG9uc2libGUgZm9yIG1hbmFnaW5nIHRoZSBzdGF0ZSBvZiB0aGUgYWdlbnQuXG4qIFRoZSBgY3JlYXRlQWdlbnRgIG1haW50YWlucyBkaWZmZXJlbnQgbm9kZXMgd2l0aCB0aGVpciBvd24gc3RhdGUuIEZvciB0aGUgdXNlclxuKiBob3dldmVyLCB0aGV5IG9ubHkgc2VlIHRoZSBjb21iaW5lZCBzdGF0ZSBvZiBhbGwgbm9kZXMuIFRoaXMgY2xhc3MgaXMgaGVscHNcbiogdG8gc2hhcmUgdGhlIHN0YXRlIGJldHdlZW4gZGlmZmVyZW50IG5vZGVzLlxuKlxuKiBAaW50ZXJuYWxcbiovXG52YXIgU3RhdGVNYW5hZ2VyID0gY2xhc3Mge1xuXHQjbm9kZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuXHQvKipcblx0KiBBZGQgbm9kZSB0byBtaWRkbGV3YXJlIGdyb3VwLlxuXHQqIEBwYXJhbSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhlIG1pZGRsZXdhcmUgZ3JvdXAuXG5cdCogQHBhcmFtIG5vZGUgLSBUaGUgbm9kZSB0byBhZGQuXG5cdCovXG5cdGFkZE5vZGUobWlkZGxld2FyZSwgbm9kZSkge1xuXHRcdHRoaXMuI25vZGVzLnNldChtaWRkbGV3YXJlLm5hbWUsIFsuLi50aGlzLiNub2Rlcy5nZXQobWlkZGxld2FyZS5uYW1lKSA/PyBbXSwgbm9kZV0pO1xuXHR9XG5cdC8qKlxuXHQqIEdldCB0aGUgc3RhdGUgb2YgYSBtaWRkbGV3YXJlIGdyb3VwLlxuXHQqIEBwYXJhbSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhlIG1pZGRsZXdhcmUgZ3JvdXAuXG5cdCogQHJldHVybnMgVGhlIHN0YXRlIG9mIHRoZSBtaWRkbGV3YXJlIGdyb3VwLlxuXHQqL1xuXHRnZXRTdGF0ZShuYW1lKSB7XG5cdFx0Y29uc3Qgc3RhdGUgPSAodGhpcy4jbm9kZXMuZ2V0KG5hbWUpID8/IFtdKS5yZWR1Y2UoKHByZXYsIG5vZGUpID0+IHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdC4uLnByZXYsXG5cdFx0XHRcdC4uLm5vZGUuZ2V0U3RhdGUoKSA/PyB7fVxuXHRcdFx0fTtcblx0XHR9LCB7fSk7XG5cdFx0LyoqXG5cdFx0KiB3ZSBpbnRlcm5hbGx5IHJlc2V0IHRoZSBqdW1wVG8gcHJvcGVydHkgYW5kIHNob3VsZG4ndCBwcm9wYWdhdGUgdGhpcyB2YWx1ZVxuXHRcdCogdG8gdGhlIG1pZGRsZXdhcmUgaG9va3MuXG5cdFx0Ki9cblx0XHRkZWxldGUgc3RhdGUuanVtcFRvO1xuXHRcdHJldHVybiBzdGF0ZTtcblx0fVxufTtcblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyBTdGF0ZU1hbmFnZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0YXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/state.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/tests/utils.js":
/*!*******************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/tests/utils.js ***!
  \*******************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FakeToolCallingModel: () => (/* binding */ FakeToolCallingModel)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_core_language_models_chat_models__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/language_models/chat_models */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/language_models/chat_models.js\");\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/runnables/index.js\");\n/* harmony import */ var _langchain_core_tools__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/tools */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/tools/index.js\");\n/* harmony import */ var _langchain_langgraph_checkpoint__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/langgraph-checkpoint */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph-checkpoint@1.0.0_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6__/node_modules/@langchain/langgraph-checkpoint/dist/index.js\");\n/* harmony import */ var zod_v3__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod/v3 */ \"(rsc)/./node_modules/.pnpm/zod@4.3.6/node_modules/zod/v3/index.js\");\n\n\n\n\n\n\n\n//#region src/agents/tests/utils.ts\n/**\n* Fake chat model for testing tool calling functionality\n*/\nvar FakeToolCallingModel = class FakeToolCallingModel extends _langchain_core_language_models_chat_models__WEBPACK_IMPORTED_MODULE_1__.BaseChatModel {\n\ttoolCalls;\n\ttoolStyle;\n\tindexRef;\n\tstructuredResponse;\n\ttools = [];\n\tconstructor({ toolCalls = [], toolStyle = \"openai\", index = 0, structuredResponse, indexRef, ...rest } = {}) {\n\t\tsuper(rest);\n\t\tthis.toolCalls = toolCalls;\n\t\tthis.toolStyle = toolStyle;\n\t\tthis.indexRef = indexRef ?? { current: index };\n\t\tthis.structuredResponse = structuredResponse;\n\t}\n\tget index() {\n\t\treturn this.indexRef.current;\n\t}\n\tset index(value) {\n\t\tthis.indexRef.current = value;\n\t}\n\t_llmType() {\n\t\treturn \"fake-tool-calling\";\n\t}\n\t_combineLLMOutput() {\n\t\treturn [];\n\t}\n\tbindTools(tools) {\n\t\tconst newInstance = new FakeToolCallingModel({\n\t\t\ttoolCalls: this.toolCalls,\n\t\t\ttoolStyle: this.toolStyle,\n\t\t\tstructuredResponse: this.structuredResponse,\n\t\t\tindexRef: this.indexRef\n\t\t});\n\t\tnewInstance.tools = [...this.tools, ...tools];\n\t\treturn newInstance;\n\t}\n\twithStructuredOutput(_schema) {\n\t\treturn new _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.RunnableLambda({ func: async () => {\n\t\t\treturn this.structuredResponse;\n\t\t} });\n\t}\n\tasync _generate(messages, _options, _runManager) {\n\t\tlet content = messages[messages.length - 1].content;\n\t\tif (messages.length > 1) content = messages.map((m) => m.content).filter(Boolean).map((part) => {\n\t\t\tif (typeof part === \"string\") return part;\n\t\t\telse if (typeof part === \"object\" && \"text\" in part) return part.text;\n\t\t\telse if (Array.isArray(part)) return part.map((p) => {\n\t\t\t\tif (typeof p === \"string\") return p;\n\t\t\t\telse if (typeof p === \"object\" && \"text\" in p) return p.text;\n\t\t\t\treturn \"\";\n\t\t\t}).join(\"-\");\n\t\t\telse return JSON.stringify(part);\n\t\t}).join(\"-\");\n\t\tif ((messages.length === 1 || messages.length === 2 && messages.every(_langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage.isInstance)) && this.index !== 0) this.index = 0;\n\t\tconst currentToolCalls = this.toolCalls[this.index] || [];\n\t\tconst messageId = this.index.toString();\n\t\tthis.index = (this.index + 1) % Math.max(1, this.toolCalls.length);\n\t\tconst message = new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage({\n\t\t\tcontent,\n\t\t\tid: messageId,\n\t\t\ttool_calls: currentToolCalls.length > 0 ? currentToolCalls.map((tc) => ({\n\t\t\t\t...tc,\n\t\t\t\ttype: \"tool_call\"\n\t\t\t})) : void 0\n\t\t});\n\t\treturn {\n\t\t\tgenerations: [{\n\t\t\t\ttext: content,\n\t\t\t\tmessage\n\t\t\t}],\n\t\t\tllmOutput: {}\n\t\t};\n\t}\n};\n\n//#endregion\n\n//# sourceMappingURL=utils.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvdGVzdHMvdXRpbHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFnRjtBQUNKO0FBQ2pCO0FBQ0o7QUFDZDtBQUNkOztBQUUzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCxzRkFBYTtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx5RkFBeUYsSUFBSTtBQUM1RztBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEscUVBQWMsR0FBRztBQUM5QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLEdBQUc7QUFDSCx3RUFBd0Usa0VBQVk7QUFDcEY7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLCtEQUFTO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ2dDO0FBQ2hDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL3Rlc3RzL3V0aWxzLmpzPzljMDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQUlNZXNzYWdlLCBIdW1hbk1lc3NhZ2UsIFRvb2xNZXNzYWdlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9tZXNzYWdlc1wiO1xuaW1wb3J0IHsgQmFzZUNoYXRNb2RlbCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbGFuZ3VhZ2VfbW9kZWxzL2NoYXRfbW9kZWxzXCI7XG5pbXBvcnQgeyBSdW5uYWJsZUxhbWJkYSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvcnVubmFibGVzXCI7XG5pbXBvcnQgeyBTdHJ1Y3R1cmVkVG9vbCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvdG9vbHNcIjtcbmltcG9ydCBcIkBsYW5nY2hhaW4vbGFuZ2dyYXBoLWNoZWNrcG9pbnRcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kL3YzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvYWdlbnRzL3Rlc3RzL3V0aWxzLnRzXG4vKipcbiogRmFrZSBjaGF0IG1vZGVsIGZvciB0ZXN0aW5nIHRvb2wgY2FsbGluZyBmdW5jdGlvbmFsaXR5XG4qL1xudmFyIEZha2VUb29sQ2FsbGluZ01vZGVsID0gY2xhc3MgRmFrZVRvb2xDYWxsaW5nTW9kZWwgZXh0ZW5kcyBCYXNlQ2hhdE1vZGVsIHtcblx0dG9vbENhbGxzO1xuXHR0b29sU3R5bGU7XG5cdGluZGV4UmVmO1xuXHRzdHJ1Y3R1cmVkUmVzcG9uc2U7XG5cdHRvb2xzID0gW107XG5cdGNvbnN0cnVjdG9yKHsgdG9vbENhbGxzID0gW10sIHRvb2xTdHlsZSA9IFwib3BlbmFpXCIsIGluZGV4ID0gMCwgc3RydWN0dXJlZFJlc3BvbnNlLCBpbmRleFJlZiwgLi4ucmVzdCB9ID0ge30pIHtcblx0XHRzdXBlcihyZXN0KTtcblx0XHR0aGlzLnRvb2xDYWxscyA9IHRvb2xDYWxscztcblx0XHR0aGlzLnRvb2xTdHlsZSA9IHRvb2xTdHlsZTtcblx0XHR0aGlzLmluZGV4UmVmID0gaW5kZXhSZWYgPz8geyBjdXJyZW50OiBpbmRleCB9O1xuXHRcdHRoaXMuc3RydWN0dXJlZFJlc3BvbnNlID0gc3RydWN0dXJlZFJlc3BvbnNlO1xuXHR9XG5cdGdldCBpbmRleCgpIHtcblx0XHRyZXR1cm4gdGhpcy5pbmRleFJlZi5jdXJyZW50O1xuXHR9XG5cdHNldCBpbmRleCh2YWx1ZSkge1xuXHRcdHRoaXMuaW5kZXhSZWYuY3VycmVudCA9IHZhbHVlO1xuXHR9XG5cdF9sbG1UeXBlKCkge1xuXHRcdHJldHVybiBcImZha2UtdG9vbC1jYWxsaW5nXCI7XG5cdH1cblx0X2NvbWJpbmVMTE1PdXRwdXQoKSB7XG5cdFx0cmV0dXJuIFtdO1xuXHR9XG5cdGJpbmRUb29scyh0b29scykge1xuXHRcdGNvbnN0IG5ld0luc3RhbmNlID0gbmV3IEZha2VUb29sQ2FsbGluZ01vZGVsKHtcblx0XHRcdHRvb2xDYWxsczogdGhpcy50b29sQ2FsbHMsXG5cdFx0XHR0b29sU3R5bGU6IHRoaXMudG9vbFN0eWxlLFxuXHRcdFx0c3RydWN0dXJlZFJlc3BvbnNlOiB0aGlzLnN0cnVjdHVyZWRSZXNwb25zZSxcblx0XHRcdGluZGV4UmVmOiB0aGlzLmluZGV4UmVmXG5cdFx0fSk7XG5cdFx0bmV3SW5zdGFuY2UudG9vbHMgPSBbLi4udGhpcy50b29scywgLi4udG9vbHNdO1xuXHRcdHJldHVybiBuZXdJbnN0YW5jZTtcblx0fVxuXHR3aXRoU3RydWN0dXJlZE91dHB1dChfc2NoZW1hKSB7XG5cdFx0cmV0dXJuIG5ldyBSdW5uYWJsZUxhbWJkYSh7IGZ1bmM6IGFzeW5jICgpID0+IHtcblx0XHRcdHJldHVybiB0aGlzLnN0cnVjdHVyZWRSZXNwb25zZTtcblx0XHR9IH0pO1xuXHR9XG5cdGFzeW5jIF9nZW5lcmF0ZShtZXNzYWdlcywgX29wdGlvbnMsIF9ydW5NYW5hZ2VyKSB7XG5cdFx0bGV0IGNvbnRlbnQgPSBtZXNzYWdlc1ttZXNzYWdlcy5sZW5ndGggLSAxXS5jb250ZW50O1xuXHRcdGlmIChtZXNzYWdlcy5sZW5ndGggPiAxKSBjb250ZW50ID0gbWVzc2FnZXMubWFwKChtKSA9PiBtLmNvbnRlbnQpLmZpbHRlcihCb29sZWFuKS5tYXAoKHBhcnQpID0+IHtcblx0XHRcdGlmICh0eXBlb2YgcGFydCA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHBhcnQ7XG5cdFx0XHRlbHNlIGlmICh0eXBlb2YgcGFydCA9PT0gXCJvYmplY3RcIiAmJiBcInRleHRcIiBpbiBwYXJ0KSByZXR1cm4gcGFydC50ZXh0O1xuXHRcdFx0ZWxzZSBpZiAoQXJyYXkuaXNBcnJheShwYXJ0KSkgcmV0dXJuIHBhcnQubWFwKChwKSA9PiB7XG5cdFx0XHRcdGlmICh0eXBlb2YgcCA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHA7XG5cdFx0XHRcdGVsc2UgaWYgKHR5cGVvZiBwID09PSBcIm9iamVjdFwiICYmIFwidGV4dFwiIGluIHApIHJldHVybiBwLnRleHQ7XG5cdFx0XHRcdHJldHVybiBcIlwiO1xuXHRcdFx0fSkuam9pbihcIi1cIik7XG5cdFx0XHRlbHNlIHJldHVybiBKU09OLnN0cmluZ2lmeShwYXJ0KTtcblx0XHR9KS5qb2luKFwiLVwiKTtcblx0XHRpZiAoKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMSB8fCBtZXNzYWdlcy5sZW5ndGggPT09IDIgJiYgbWVzc2FnZXMuZXZlcnkoSHVtYW5NZXNzYWdlLmlzSW5zdGFuY2UpKSAmJiB0aGlzLmluZGV4ICE9PSAwKSB0aGlzLmluZGV4ID0gMDtcblx0XHRjb25zdCBjdXJyZW50VG9vbENhbGxzID0gdGhpcy50b29sQ2FsbHNbdGhpcy5pbmRleF0gfHwgW107XG5cdFx0Y29uc3QgbWVzc2FnZUlkID0gdGhpcy5pbmRleC50b1N0cmluZygpO1xuXHRcdHRoaXMuaW5kZXggPSAodGhpcy5pbmRleCArIDEpICUgTWF0aC5tYXgoMSwgdGhpcy50b29sQ2FsbHMubGVuZ3RoKTtcblx0XHRjb25zdCBtZXNzYWdlID0gbmV3IEFJTWVzc2FnZSh7XG5cdFx0XHRjb250ZW50LFxuXHRcdFx0aWQ6IG1lc3NhZ2VJZCxcblx0XHRcdHRvb2xfY2FsbHM6IGN1cnJlbnRUb29sQ2FsbHMubGVuZ3RoID4gMCA/IGN1cnJlbnRUb29sQ2FsbHMubWFwKCh0YykgPT4gKHtcblx0XHRcdFx0Li4udGMsXG5cdFx0XHRcdHR5cGU6IFwidG9vbF9jYWxsXCJcblx0XHRcdH0pKSA6IHZvaWQgMFxuXHRcdH0pO1xuXHRcdHJldHVybiB7XG5cdFx0XHRnZW5lcmF0aW9uczogW3tcblx0XHRcdFx0dGV4dDogY29udGVudCxcblx0XHRcdFx0bWVzc2FnZVxuXHRcdFx0fV0sXG5cdFx0XHRsbG1PdXRwdXQ6IHt9XG5cdFx0fTtcblx0fVxufTtcblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyBGYWtlVG9vbENhbGxpbmdNb2RlbCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/tests/utils.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/utils.js":
/*!*************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/utils.js ***!
  \*************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _addInlineAgentName: () => (/* binding */ _addInlineAgentName),\n/* harmony export */   _removeInlineAgentName: () => (/* binding */ _removeInlineAgentName),\n/* harmony export */   bindTools: () => (/* binding */ bindTools),\n/* harmony export */   hasToolCalls: () => (/* binding */ hasToolCalls),\n/* harmony export */   isClientTool: () => (/* binding */ isClientTool),\n/* harmony export */   normalizeSystemPrompt: () => (/* binding */ normalizeSystemPrompt),\n/* harmony export */   validateLLMHasNoBoundTools: () => (/* binding */ validateLLMHasNoBoundTools),\n/* harmony export */   wrapToolCall: () => (/* binding */ wrapToolCall)\n/* harmony export */ });\n/* harmony import */ var _model_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./model.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/model.js\");\n/* harmony import */ var _errors_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./errors.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/errors.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/runnables/index.js\");\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.1.5_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___react-dom@18.3.1__ua5rjj7v3gc5zltkp2tahvl6ry/node_modules/@langchain/langgraph/dist/index.js\");\n/* harmony import */ var _langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @langchain/core/utils/types */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/types/index.js\");\n\n\n\n\n\n\n\n//#region src/agents/utils.ts\nconst NAME_PATTERN = /<name>(.*?)<\\/name>/s;\nconst CONTENT_PATTERN = /<content>(.*?)<\\/content>/s;\n/**\n* Parse middleware state from the full agent state based on the middleware's stateSchema.\n*\n* Handles two types of state schemas:\n* 1. Zod schemas (v3 or v4) - parsed using interopParse\n* 2. LangGraph StateSchema - extracts only the keys defined in `fields`\n*\n* @param stateSchema - The middleware's state schema (Zod or LangGraph StateSchema)\n* @param state - The full agent state to parse from\n* @returns Parsed state containing only the keys defined in the schema\n*/\nfunction parseMiddlewareState(stateSchema, state) {\n\tif (_langchain_langgraph__WEBPACK_IMPORTED_MODULE_4__.StateSchema.isInstance(stateSchema)) {\n\t\tconst result = {};\n\t\tfor (const key of Object.keys(stateSchema.fields)) if (key in state) result[key] = state[key];\n\t\treturn result;\n\t}\n\tif ((0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_5__.isInteropZodSchema)(stateSchema)) return (0,_langchain_core_utils_types__WEBPACK_IMPORTED_MODULE_5__.interopParse)(stateSchema, state);\n\tthrow new Error(`Invalid state schema type: ${typeof stateSchema}`);\n}\n/**\n* Attach formatted agent names to the messages passed to and from a language model.\n*\n* This is useful for making a message history with multiple agents more coherent.\n*\n* NOTE: agent name is consumed from the message.name field.\n* If you're using an agent built with createAgent, name is automatically set.\n* If you're building a custom agent, make sure to set the name on the AI message returned by the LLM.\n*\n* @param message - Message to add agent name formatting to\n* @returns Message with agent name formatting\n*\n* @internal\n*/\nfunction _addInlineAgentName(message) {\n\tif (!_langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage.isInstance(message) || _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessageChunk.isInstance(message)) return message;\n\tif (!message.name) return message;\n\tconst { name } = message;\n\tif (typeof message.content === \"string\") return new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage({\n\t\t...message.lc_kwargs,\n\t\tcontent: `<name>${name}</name><content>${message.content}</content>`,\n\t\tname: void 0\n\t});\n\tconst updatedContent = [];\n\tlet textBlockCount = 0;\n\tfor (const contentBlock of message.content) if (typeof contentBlock === \"string\") {\n\t\ttextBlockCount += 1;\n\t\tupdatedContent.push(`<name>${name}</name><content>${contentBlock}</content>`);\n\t} else if (typeof contentBlock === \"object\" && \"type\" in contentBlock && contentBlock.type === \"text\") {\n\t\ttextBlockCount += 1;\n\t\tupdatedContent.push({\n\t\t\t...contentBlock,\n\t\t\ttext: `<name>${name}</name><content>${contentBlock.text}</content>`\n\t\t});\n\t} else updatedContent.push(contentBlock);\n\tif (!textBlockCount) updatedContent.unshift({\n\t\ttype: \"text\",\n\t\ttext: `<name>${name}</name><content></content>`\n\t});\n\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage({\n\t\t...message.lc_kwargs,\n\t\tcontent: updatedContent,\n\t\tname: void 0\n\t});\n}\n/**\n* Remove explicit name and content XML tags from the AI message content.\n*\n* Examples:\n*\n* @example\n* ```typescript\n* removeInlineAgentName(new AIMessage({ content: \"<name>assistant</name><content>Hello</content>\", name: \"assistant\" }))\n* // AIMessage with content: \"Hello\"\n*\n* removeInlineAgentName(new AIMessage({ content: [{type: \"text\", text: \"<name>assistant</name><content>Hello</content>\"}], name: \"assistant\" }))\n* // AIMessage with content: [{type: \"text\", text: \"Hello\"}]\n* ```\n*\n* @internal\n*/\nfunction _removeInlineAgentName(message) {\n\tif (!_langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage.isInstance(message) || !message.content) return message;\n\tlet updatedContent = [];\n\tlet updatedName;\n\tif (Array.isArray(message.content)) updatedContent = message.content.filter((block) => {\n\t\tif (block.type === \"text\" && typeof block.text === \"string\") {\n\t\t\tconst nameMatch = block.text.match(NAME_PATTERN);\n\t\t\tconst contentMatch = block.text.match(CONTENT_PATTERN);\n\t\t\tif (nameMatch && (!contentMatch || contentMatch[1] === \"\")) {\n\t\t\t\tupdatedName = nameMatch[1];\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn true;\n\t}).map((block) => {\n\t\tif (block.type === \"text\" && typeof block.text === \"string\") {\n\t\t\tconst nameMatch = block.text.match(NAME_PATTERN);\n\t\t\tconst contentMatch = block.text.match(CONTENT_PATTERN);\n\t\t\tif (!nameMatch || !contentMatch) return block;\n\t\t\tupdatedName = nameMatch[1];\n\t\t\treturn {\n\t\t\t\t...block,\n\t\t\t\ttext: contentMatch[1]\n\t\t\t};\n\t\t}\n\t\treturn block;\n\t});\n\telse {\n\t\tconst content = message.content;\n\t\tconst nameMatch = content.match(NAME_PATTERN);\n\t\tconst contentMatch = content.match(CONTENT_PATTERN);\n\t\tif (!nameMatch || !contentMatch) return message;\n\t\tupdatedName = nameMatch[1];\n\t\tupdatedContent = contentMatch[1];\n\t}\n\treturn new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage({\n\t\t...Object.keys(message.lc_kwargs ?? {}).length > 0 ? message.lc_kwargs : message,\n\t\tcontent: updatedContent,\n\t\tname: updatedName\n\t});\n}\nfunction isClientTool(tool) {\n\treturn _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.Runnable.isRunnable(tool);\n}\n/**\n* Helper function to check if a language model has a bindTools method.\n* @param llm - The language model to check if it has a bindTools method.\n* @returns True if the language model has a bindTools method, false otherwise.\n*/\nfunction _isChatModelWithBindTools(llm) {\n\tif (!(0,_model_js__WEBPACK_IMPORTED_MODULE_0__.isBaseChatModel)(llm)) return false;\n\treturn \"bindTools\" in llm && typeof llm.bindTools === \"function\";\n}\n/**\n* Helper function to bind tools to a language model.\n* @param llm - The language model to bind tools to.\n* @param toolClasses - The tools to bind to the language model.\n* @param options - The options to pass to the language model.\n* @returns The language model with the tools bound to it.\n*/\nconst _simpleBindTools = (llm, toolClasses, options = {}) => {\n\tif (_isChatModelWithBindTools(llm)) return llm.bindTools(toolClasses, options);\n\tif (_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableBinding.isRunnableBinding(llm) && _isChatModelWithBindTools(llm.bound)) {\n\t\tconst newBound = llm.bound.bindTools(toolClasses, options);\n\t\tif (_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableBinding.isRunnableBinding(newBound)) return new _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableBinding({\n\t\t\tbound: newBound.bound,\n\t\t\tconfig: {\n\t\t\t\t...llm.config,\n\t\t\t\t...newBound.config\n\t\t\t},\n\t\t\tkwargs: {\n\t\t\t\t...llm.kwargs,\n\t\t\t\t...newBound.kwargs\n\t\t\t},\n\t\t\tconfigFactories: newBound.configFactories ?? llm.configFactories\n\t\t});\n\t\treturn new _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableBinding({\n\t\t\tbound: newBound,\n\t\t\tconfig: llm.config,\n\t\t\tkwargs: llm.kwargs,\n\t\t\tconfigFactories: llm.configFactories\n\t\t});\n\t}\n\treturn null;\n};\n/**\n* Check if the LLM already has bound tools and throw if it does.\n*\n* @param llm - The LLM to check.\n* @returns void\n*/\nfunction validateLLMHasNoBoundTools(llm) {\n\t/**\n\t* If llm is a function, we can't validate until runtime, so skip\n\t*/\n\tif (typeof llm === \"function\") return;\n\tlet model = llm;\n\t/**\n\t* If model is a RunnableSequence, find a RunnableBinding in its steps\n\t*/\n\tif (_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableSequence.isRunnableSequence(model)) model = model.steps.find((step) => _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableBinding.isRunnableBinding(step)) || model;\n\t/**\n\t* If model is configurable, get the underlying model\n\t*/\n\tif ((0,_model_js__WEBPACK_IMPORTED_MODULE_0__.isConfigurableModel)(model))\n /**\n\t* Can't validate async model retrieval in constructor\n\t*/\n\treturn;\n\t/**\n\t* Check if model is a RunnableBinding with bound tools\n\t*/\n\tif (_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableBinding.isRunnableBinding(model)) {\n\t\tconst hasToolsInKwargs = model.kwargs != null && typeof model.kwargs === \"object\" && \"tools\" in model.kwargs && Array.isArray(model.kwargs.tools) && model.kwargs.tools.length > 0;\n\t\tconst hasToolsInConfig = model.config != null && typeof model.config === \"object\" && \"tools\" in model.config && Array.isArray(model.config.tools) && model.config.tools.length > 0;\n\t\tif (hasToolsInKwargs || hasToolsInConfig) throw new _errors_js__WEBPACK_IMPORTED_MODULE_1__.MultipleToolsBoundError();\n\t}\n\t/**\n\t* Also check if model has tools property directly (e.g., FakeToolCallingModel)\n\t*/\n\tif (\"tools\" in model && model.tools !== void 0 && Array.isArray(model.tools) && model.tools.length > 0) throw new _errors_js__WEBPACK_IMPORTED_MODULE_1__.MultipleToolsBoundError();\n}\n/**\n* Check if the last message in the messages array has tool calls.\n*\n* @param messages - The messages to check.\n* @returns True if the last message has tool calls, false otherwise.\n*/\nfunction hasToolCalls(message) {\n\treturn Boolean(_langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.AIMessage.isInstance(message) && message.tool_calls && message.tool_calls.length > 0);\n}\n/**\n* Normalizes a system prompt to a SystemMessage object.\n* If it's already a SystemMessage, returns it as-is.\n* If it's a string, converts it to a SystemMessage.\n* If it's undefined, creates an empty system message so it is easier to append to it later.\n*/\nfunction normalizeSystemPrompt(systemPrompt) {\n\tif (systemPrompt == null) return new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.SystemMessage(\"\");\n\tif (_langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.SystemMessage.isInstance(systemPrompt)) return systemPrompt;\n\tif (typeof systemPrompt === \"string\") return new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.SystemMessage({ content: [{\n\t\ttype: \"text\",\n\t\ttext: systemPrompt\n\t}] });\n\tthrow new Error(`Invalid systemPrompt type: expected string or SystemMessage, got ${typeof systemPrompt}`);\n}\n/**\n* Helper function to bind tools to a language model.\n* @param llm - The language model to bind tools to.\n* @param toolClasses - The tools to bind to the language model.\n* @param options - The options to pass to the language model.\n* @returns The language model with the tools bound to it.\n*/\nasync function bindTools(llm, toolClasses, options = {}) {\n\tconst model = _simpleBindTools(llm, toolClasses, options);\n\tif (model) return model;\n\tif ((0,_model_js__WEBPACK_IMPORTED_MODULE_0__.isConfigurableModel)(llm)) {\n\t\tconst model = _simpleBindTools(await llm._getModelInstance(), toolClasses, options);\n\t\tif (model) return model;\n\t}\n\tif (_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableSequence.isRunnableSequence(llm)) {\n\t\tconst modelStep = llm.steps.findIndex((step) => _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableBinding.isRunnableBinding(step) || (0,_model_js__WEBPACK_IMPORTED_MODULE_0__.isBaseChatModel)(step) || (0,_model_js__WEBPACK_IMPORTED_MODULE_0__.isConfigurableModel)(step));\n\t\tif (modelStep >= 0) {\n\t\t\tconst model = _simpleBindTools(llm.steps[modelStep], toolClasses, options);\n\t\t\tif (model) {\n\t\t\t\tconst nextSteps = llm.steps.slice();\n\t\t\t\tnextSteps.splice(modelStep, 1, model);\n\t\t\t\treturn _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_3__.RunnableSequence.from(nextSteps);\n\t\t\t}\n\t\t}\n\t}\n\tthrow new Error(`llm ${llm} must define bindTools method.`);\n}\n/**\n* Compose multiple wrapToolCall handlers into a single middleware stack.\n*\n* Composes handlers so the first in the list becomes the outermost layer.\n* Each handler receives a handler callback to execute inner layers.\n*\n* @param handlers - List of handlers. First handler wraps all others.\n* @returns Composed handler, or undefined if handlers array is empty.\n*\n* @example\n* ```typescript\n* // handlers=[auth, retry] means: auth wraps retry\n* // Flow: auth calls retry, retry calls base handler\n* const auth: ToolCallWrapper = async (request, handler) => {\n*   try {\n*     return await handler(request);\n*   } catch (error) {\n*     if (error.message === \"Unauthorized\") {\n*       await refreshToken();\n*       return await handler(request);\n*     }\n*     throw error;\n*   }\n* };\n*\n* const retry: ToolCallWrapper = async (request, handler) => {\n*   for (let attempt = 0; attempt < 3; attempt++) {\n*     try {\n*       return await handler(request);\n*     } catch (error) {\n*       if (attempt === 2) throw error;\n*     }\n*   }\n*   throw new Error(\"Unreachable\");\n* };\n*\n* const composedHandler = chainToolCallHandlers([auth, retry]);\n* ```\n*/\nfunction chainToolCallHandlers(handlers) {\n\tif (handlers.length === 0) return;\n\tif (handlers.length === 1) return handlers[0];\n\tfunction composeTwo(outer, inner) {\n\t\treturn async (request, handler) => {\n\t\t\tconst innerHandler = async (passedRequest) => {\n\t\t\t\treturn inner(passedRequest, handler);\n\t\t\t};\n\t\t\treturn outer(request, innerHandler);\n\t\t};\n\t}\n\tlet result = handlers[handlers.length - 1];\n\tfor (let i = handlers.length - 2; i >= 0; i--) result = composeTwo(handlers[i], result);\n\treturn result;\n}\n/**\n* Wrapping `wrapToolCall` invocation so we can inject middleware name into\n* the error message.\n*\n* @param middleware list of middleware passed to the agent\n* @param state state of the agent\n* @returns single wrap function\n*/\nfunction wrapToolCall(middleware) {\n\tconst middlewareWithWrapToolCall = middleware.filter((m) => m.wrapToolCall);\n\tif (middlewareWithWrapToolCall.length === 0) return;\n\treturn chainToolCallHandlers(middlewareWithWrapToolCall.map((m) => {\n\t\tconst originalHandler = m.wrapToolCall;\n\t\t/**\n\t\t* Wrap with error handling and validation\n\t\t*/\n\t\tconst wrappedHandler = async (request, handler) => {\n\t\t\t/**\n\t\t\t* Capture the original state for this middleware's schema parsing.\n\t\t\t* This is important because the request may be modified (via override)\n\t\t\t* as it passes through the middleware chain, but each middleware\n\t\t\t* should always see the full original state for its schema parsing.\n\t\t\t*/\n\t\t\tconst originalState = request.state;\n\t\t\t/**\n\t\t\t* Create a handler that preserves state parsing for this middleware\n\t\t\t* while allowing tool/toolCall/state modifications from inner middleware\n\t\t\t*/\n\t\t\tconst wrappedInnerHandler = async (passedRequest) => {\n\t\t\t\t/**\n\t\t\t\t* Merge the passed request with the original state for parsing.\n\t\t\t\t* This ensures middleware can override tool/toolCall while\n\t\t\t\t* maintaining proper state parsing for each middleware in the chain.\n\t\t\t\t*/\n\t\t\t\tconst mergedState = {\n\t\t\t\t\t...originalState,\n\t\t\t\t\t...passedRequest.state\n\t\t\t\t};\n\t\t\t\treturn handler({\n\t\t\t\t\t...passedRequest,\n\t\t\t\t\tstate: mergedState\n\t\t\t\t});\n\t\t\t};\n\t\t\ttry {\n\t\t\t\tconst result = await originalHandler({\n\t\t\t\t\t...request,\n\t\t\t\t\tstate: {\n\t\t\t\t\t\tmessages: originalState.messages,\n\t\t\t\t\t\t...m.stateSchema ? parseMiddlewareState(m.stateSchema, { ...originalState }) : {}\n\t\t\t\t\t}\n\t\t\t\t}, wrappedInnerHandler);\n\t\t\t\t/**\n\t\t\t\t* Validate return type\n\t\t\t\t*/\n\t\t\t\tif (!_langchain_core_messages__WEBPACK_IMPORTED_MODULE_2__.ToolMessage.isInstance(result) && !(0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_4__.isCommand)(result)) throw new Error(`Invalid response from \"wrapToolCall\" in middleware \"${m.name}\": expected ToolMessage or Command, got ${typeof result}`);\n\t\t\t\treturn result;\n\t\t\t} catch (error) {\n\t\t\t\tthrow _errors_js__WEBPACK_IMPORTED_MODULE_1__.MiddlewareError.wrap(error, m.name);\n\t\t\t}\n\t\t};\n\t\treturn wrappedHandler;\n\t}));\n}\n\n//#endregion\n\n//# sourceMappingURL=utils.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvdXRpbHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBa0U7QUFDSztBQUMwQjtBQUNUO0FBQzFCO0FBQ2lCOztBQUUvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLDZEQUFXO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSywrRUFBa0Isc0JBQXNCLHlFQUFZO0FBQ3pELCtDQUErQyxtQkFBbUI7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLCtEQUFTLHdCQUF3QixvRUFBYztBQUNyRDtBQUNBLFNBQVMsT0FBTztBQUNoQixxREFBcUQsK0RBQVM7QUFDOUQ7QUFDQSxvQkFBb0IsS0FBSyxrQkFBa0IsZ0JBQWdCO0FBQzNEO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLEtBQUssa0JBQWtCLGFBQWE7QUFDbkUsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixLQUFLLGtCQUFrQixrQkFBa0I7QUFDM0QsR0FBRztBQUNILEdBQUc7QUFDSDtBQUNBO0FBQ0EsaUJBQWlCLEtBQUs7QUFDdEIsRUFBRTtBQUNGLFlBQVksK0RBQVM7QUFDckI7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsOEVBQThFO0FBQ3RIO0FBQ0E7QUFDQSx3Q0FBd0MsV0FBVyxxRUFBcUUsc0JBQXNCO0FBQzlJLCtCQUErQiw0QkFBNEI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sK0RBQVM7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLCtEQUFTO0FBQ3JCLHdDQUF3QztBQUN4QztBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxRQUFRLCtEQUFRO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSwwREFBZTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Q7QUFDeEQ7QUFDQSxLQUFLLHNFQUFlO0FBQ3BCO0FBQ0EsTUFBTSxzRUFBZSx5Q0FBeUMsc0VBQWU7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsR0FBRztBQUNILGFBQWEsc0VBQWU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyx1RUFBZ0IsK0RBQStELHNFQUFlO0FBQ25HO0FBQ0E7QUFDQTtBQUNBLEtBQUssOERBQW1CO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxzRUFBZTtBQUNwQjtBQUNBO0FBQ0Esc0RBQXNELCtEQUF1QjtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1IQUFtSCwrREFBdUI7QUFDMUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwrREFBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLG1FQUFhO0FBQ25ELEtBQUssbUVBQWE7QUFDbEIsa0RBQWtELG1FQUFhLEdBQUc7QUFDbEU7QUFDQTtBQUNBLEVBQUUsR0FBRztBQUNMLHFGQUFxRixvQkFBb0I7QUFDekc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RDtBQUN2RDtBQUNBO0FBQ0EsS0FBSyw4REFBbUI7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsS0FBSyx1RUFBZ0I7QUFDckIsa0RBQWtELHNFQUFlLDRCQUE0QiwwREFBZSxVQUFVLDhEQUFtQjtBQUN6STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx1RUFBZ0I7QUFDM0I7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLEtBQUs7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsYUFBYTtBQUN2QztBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxRQUFRO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCxrQkFBa0I7QUFDakY7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUyxpRUFBVyx3QkFBd0IsK0RBQVMsaUZBQWlGLE9BQU8sMENBQTBDLGNBQWM7QUFDck07QUFDQSxLQUFLO0FBQ0wsVUFBVSx1REFBZTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDK0o7QUFDL0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvdXRpbHMuanM/M2JhZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc0Jhc2VDaGF0TW9kZWwsIGlzQ29uZmlndXJhYmxlTW9kZWwgfSBmcm9tIFwiLi9tb2RlbC5qc1wiO1xuaW1wb3J0IHsgTWlkZGxld2FyZUVycm9yLCBNdWx0aXBsZVRvb2xzQm91bmRFcnJvciB9IGZyb20gXCIuL2Vycm9ycy5qc1wiO1xuaW1wb3J0IHsgQUlNZXNzYWdlLCBBSU1lc3NhZ2VDaHVuaywgU3lzdGVtTWVzc2FnZSwgVG9vbE1lc3NhZ2UgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL21lc3NhZ2VzXCI7XG5pbXBvcnQgeyBSdW5uYWJsZSwgUnVubmFibGVCaW5kaW5nLCBSdW5uYWJsZVNlcXVlbmNlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9ydW5uYWJsZXNcIjtcbmltcG9ydCB7IFN0YXRlU2NoZW1hLCBpc0NvbW1hbmQgfSBmcm9tIFwiQGxhbmdjaGFpbi9sYW5nZ3JhcGhcIjtcbmltcG9ydCB7IGludGVyb3BQYXJzZSwgaXNJbnRlcm9wWm9kU2NoZW1hIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS91dGlscy90eXBlc1wiO1xuXG4vLyNyZWdpb24gc3JjL2FnZW50cy91dGlscy50c1xuY29uc3QgTkFNRV9QQVRURVJOID0gLzxuYW1lPiguKj8pPFxcL25hbWU+L3M7XG5jb25zdCBDT05URU5UX1BBVFRFUk4gPSAvPGNvbnRlbnQ+KC4qPyk8XFwvY29udGVudD4vcztcbi8qKlxuKiBQYXJzZSBtaWRkbGV3YXJlIHN0YXRlIGZyb20gdGhlIGZ1bGwgYWdlbnQgc3RhdGUgYmFzZWQgb24gdGhlIG1pZGRsZXdhcmUncyBzdGF0ZVNjaGVtYS5cbipcbiogSGFuZGxlcyB0d28gdHlwZXMgb2Ygc3RhdGUgc2NoZW1hczpcbiogMS4gWm9kIHNjaGVtYXMgKHYzIG9yIHY0KSAtIHBhcnNlZCB1c2luZyBpbnRlcm9wUGFyc2VcbiogMi4gTGFuZ0dyYXBoIFN0YXRlU2NoZW1hIC0gZXh0cmFjdHMgb25seSB0aGUga2V5cyBkZWZpbmVkIGluIGBmaWVsZHNgXG4qXG4qIEBwYXJhbSBzdGF0ZVNjaGVtYSAtIFRoZSBtaWRkbGV3YXJlJ3Mgc3RhdGUgc2NoZW1hIChab2Qgb3IgTGFuZ0dyYXBoIFN0YXRlU2NoZW1hKVxuKiBAcGFyYW0gc3RhdGUgLSBUaGUgZnVsbCBhZ2VudCBzdGF0ZSB0byBwYXJzZSBmcm9tXG4qIEByZXR1cm5zIFBhcnNlZCBzdGF0ZSBjb250YWluaW5nIG9ubHkgdGhlIGtleXMgZGVmaW5lZCBpbiB0aGUgc2NoZW1hXG4qL1xuZnVuY3Rpb24gcGFyc2VNaWRkbGV3YXJlU3RhdGUoc3RhdGVTY2hlbWEsIHN0YXRlKSB7XG5cdGlmIChTdGF0ZVNjaGVtYS5pc0luc3RhbmNlKHN0YXRlU2NoZW1hKSkge1xuXHRcdGNvbnN0IHJlc3VsdCA9IHt9O1xuXHRcdGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHN0YXRlU2NoZW1hLmZpZWxkcykpIGlmIChrZXkgaW4gc3RhdGUpIHJlc3VsdFtrZXldID0gc3RhdGVba2V5XTtcblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9XG5cdGlmIChpc0ludGVyb3Bab2RTY2hlbWEoc3RhdGVTY2hlbWEpKSByZXR1cm4gaW50ZXJvcFBhcnNlKHN0YXRlU2NoZW1hLCBzdGF0ZSk7XG5cdHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBzdGF0ZSBzY2hlbWEgdHlwZTogJHt0eXBlb2Ygc3RhdGVTY2hlbWF9YCk7XG59XG4vKipcbiogQXR0YWNoIGZvcm1hdHRlZCBhZ2VudCBuYW1lcyB0byB0aGUgbWVzc2FnZXMgcGFzc2VkIHRvIGFuZCBmcm9tIGEgbGFuZ3VhZ2UgbW9kZWwuXG4qXG4qIFRoaXMgaXMgdXNlZnVsIGZvciBtYWtpbmcgYSBtZXNzYWdlIGhpc3Rvcnkgd2l0aCBtdWx0aXBsZSBhZ2VudHMgbW9yZSBjb2hlcmVudC5cbipcbiogTk9URTogYWdlbnQgbmFtZSBpcyBjb25zdW1lZCBmcm9tIHRoZSBtZXNzYWdlLm5hbWUgZmllbGQuXG4qIElmIHlvdSdyZSB1c2luZyBhbiBhZ2VudCBidWlsdCB3aXRoIGNyZWF0ZUFnZW50LCBuYW1lIGlzIGF1dG9tYXRpY2FsbHkgc2V0LlxuKiBJZiB5b3UncmUgYnVpbGRpbmcgYSBjdXN0b20gYWdlbnQsIG1ha2Ugc3VyZSB0byBzZXQgdGhlIG5hbWUgb24gdGhlIEFJIG1lc3NhZ2UgcmV0dXJuZWQgYnkgdGhlIExMTS5cbipcbiogQHBhcmFtIG1lc3NhZ2UgLSBNZXNzYWdlIHRvIGFkZCBhZ2VudCBuYW1lIGZvcm1hdHRpbmcgdG9cbiogQHJldHVybnMgTWVzc2FnZSB3aXRoIGFnZW50IG5hbWUgZm9ybWF0dGluZ1xuKlxuKiBAaW50ZXJuYWxcbiovXG5mdW5jdGlvbiBfYWRkSW5saW5lQWdlbnROYW1lKG1lc3NhZ2UpIHtcblx0aWYgKCFBSU1lc3NhZ2UuaXNJbnN0YW5jZShtZXNzYWdlKSB8fCBBSU1lc3NhZ2VDaHVuay5pc0luc3RhbmNlKG1lc3NhZ2UpKSByZXR1cm4gbWVzc2FnZTtcblx0aWYgKCFtZXNzYWdlLm5hbWUpIHJldHVybiBtZXNzYWdlO1xuXHRjb25zdCB7IG5hbWUgfSA9IG1lc3NhZ2U7XG5cdGlmICh0eXBlb2YgbWVzc2FnZS5jb250ZW50ID09PSBcInN0cmluZ1wiKSByZXR1cm4gbmV3IEFJTWVzc2FnZSh7XG5cdFx0Li4ubWVzc2FnZS5sY19rd2FyZ3MsXG5cdFx0Y29udGVudDogYDxuYW1lPiR7bmFtZX08L25hbWU+PGNvbnRlbnQ+JHttZXNzYWdlLmNvbnRlbnR9PC9jb250ZW50PmAsXG5cdFx0bmFtZTogdm9pZCAwXG5cdH0pO1xuXHRjb25zdCB1cGRhdGVkQ29udGVudCA9IFtdO1xuXHRsZXQgdGV4dEJsb2NrQ291bnQgPSAwO1xuXHRmb3IgKGNvbnN0IGNvbnRlbnRCbG9jayBvZiBtZXNzYWdlLmNvbnRlbnQpIGlmICh0eXBlb2YgY29udGVudEJsb2NrID09PSBcInN0cmluZ1wiKSB7XG5cdFx0dGV4dEJsb2NrQ291bnQgKz0gMTtcblx0XHR1cGRhdGVkQ29udGVudC5wdXNoKGA8bmFtZT4ke25hbWV9PC9uYW1lPjxjb250ZW50PiR7Y29udGVudEJsb2NrfTwvY29udGVudD5gKTtcblx0fSBlbHNlIGlmICh0eXBlb2YgY29udGVudEJsb2NrID09PSBcIm9iamVjdFwiICYmIFwidHlwZVwiIGluIGNvbnRlbnRCbG9jayAmJiBjb250ZW50QmxvY2sudHlwZSA9PT0gXCJ0ZXh0XCIpIHtcblx0XHR0ZXh0QmxvY2tDb3VudCArPSAxO1xuXHRcdHVwZGF0ZWRDb250ZW50LnB1c2goe1xuXHRcdFx0Li4uY29udGVudEJsb2NrLFxuXHRcdFx0dGV4dDogYDxuYW1lPiR7bmFtZX08L25hbWU+PGNvbnRlbnQ+JHtjb250ZW50QmxvY2sudGV4dH08L2NvbnRlbnQ+YFxuXHRcdH0pO1xuXHR9IGVsc2UgdXBkYXRlZENvbnRlbnQucHVzaChjb250ZW50QmxvY2spO1xuXHRpZiAoIXRleHRCbG9ja0NvdW50KSB1cGRhdGVkQ29udGVudC51bnNoaWZ0KHtcblx0XHR0eXBlOiBcInRleHRcIixcblx0XHR0ZXh0OiBgPG5hbWU+JHtuYW1lfTwvbmFtZT48Y29udGVudD48L2NvbnRlbnQ+YFxuXHR9KTtcblx0cmV0dXJuIG5ldyBBSU1lc3NhZ2Uoe1xuXHRcdC4uLm1lc3NhZ2UubGNfa3dhcmdzLFxuXHRcdGNvbnRlbnQ6IHVwZGF0ZWRDb250ZW50LFxuXHRcdG5hbWU6IHZvaWQgMFxuXHR9KTtcbn1cbi8qKlxuKiBSZW1vdmUgZXhwbGljaXQgbmFtZSBhbmQgY29udGVudCBYTUwgdGFncyBmcm9tIHRoZSBBSSBtZXNzYWdlIGNvbnRlbnQuXG4qXG4qIEV4YW1wbGVzOlxuKlxuKiBAZXhhbXBsZVxuKiBgYGB0eXBlc2NyaXB0XG4qIHJlbW92ZUlubGluZUFnZW50TmFtZShuZXcgQUlNZXNzYWdlKHsgY29udGVudDogXCI8bmFtZT5hc3Npc3RhbnQ8L25hbWU+PGNvbnRlbnQ+SGVsbG88L2NvbnRlbnQ+XCIsIG5hbWU6IFwiYXNzaXN0YW50XCIgfSkpXG4qIC8vIEFJTWVzc2FnZSB3aXRoIGNvbnRlbnQ6IFwiSGVsbG9cIlxuKlxuKiByZW1vdmVJbmxpbmVBZ2VudE5hbWUobmV3IEFJTWVzc2FnZSh7IGNvbnRlbnQ6IFt7dHlwZTogXCJ0ZXh0XCIsIHRleHQ6IFwiPG5hbWU+YXNzaXN0YW50PC9uYW1lPjxjb250ZW50PkhlbGxvPC9jb250ZW50PlwifV0sIG5hbWU6IFwiYXNzaXN0YW50XCIgfSkpXG4qIC8vIEFJTWVzc2FnZSB3aXRoIGNvbnRlbnQ6IFt7dHlwZTogXCJ0ZXh0XCIsIHRleHQ6IFwiSGVsbG9cIn1dXG4qIGBgYFxuKlxuKiBAaW50ZXJuYWxcbiovXG5mdW5jdGlvbiBfcmVtb3ZlSW5saW5lQWdlbnROYW1lKG1lc3NhZ2UpIHtcblx0aWYgKCFBSU1lc3NhZ2UuaXNJbnN0YW5jZShtZXNzYWdlKSB8fCAhbWVzc2FnZS5jb250ZW50KSByZXR1cm4gbWVzc2FnZTtcblx0bGV0IHVwZGF0ZWRDb250ZW50ID0gW107XG5cdGxldCB1cGRhdGVkTmFtZTtcblx0aWYgKEFycmF5LmlzQXJyYXkobWVzc2FnZS5jb250ZW50KSkgdXBkYXRlZENvbnRlbnQgPSBtZXNzYWdlLmNvbnRlbnQuZmlsdGVyKChibG9jaykgPT4ge1xuXHRcdGlmIChibG9jay50eXBlID09PSBcInRleHRcIiAmJiB0eXBlb2YgYmxvY2sudGV4dCA9PT0gXCJzdHJpbmdcIikge1xuXHRcdFx0Y29uc3QgbmFtZU1hdGNoID0gYmxvY2sudGV4dC5tYXRjaChOQU1FX1BBVFRFUk4pO1xuXHRcdFx0Y29uc3QgY29udGVudE1hdGNoID0gYmxvY2sudGV4dC5tYXRjaChDT05URU5UX1BBVFRFUk4pO1xuXHRcdFx0aWYgKG5hbWVNYXRjaCAmJiAoIWNvbnRlbnRNYXRjaCB8fCBjb250ZW50TWF0Y2hbMV0gPT09IFwiXCIpKSB7XG5cdFx0XHRcdHVwZGF0ZWROYW1lID0gbmFtZU1hdGNoWzFdO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0pLm1hcCgoYmxvY2spID0+IHtcblx0XHRpZiAoYmxvY2sudHlwZSA9PT0gXCJ0ZXh0XCIgJiYgdHlwZW9mIGJsb2NrLnRleHQgPT09IFwic3RyaW5nXCIpIHtcblx0XHRcdGNvbnN0IG5hbWVNYXRjaCA9IGJsb2NrLnRleHQubWF0Y2goTkFNRV9QQVRURVJOKTtcblx0XHRcdGNvbnN0IGNvbnRlbnRNYXRjaCA9IGJsb2NrLnRleHQubWF0Y2goQ09OVEVOVF9QQVRURVJOKTtcblx0XHRcdGlmICghbmFtZU1hdGNoIHx8ICFjb250ZW50TWF0Y2gpIHJldHVybiBibG9jaztcblx0XHRcdHVwZGF0ZWROYW1lID0gbmFtZU1hdGNoWzFdO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0Li4uYmxvY2ssXG5cdFx0XHRcdHRleHQ6IGNvbnRlbnRNYXRjaFsxXVxuXHRcdFx0fTtcblx0XHR9XG5cdFx0cmV0dXJuIGJsb2NrO1xuXHR9KTtcblx0ZWxzZSB7XG5cdFx0Y29uc3QgY29udGVudCA9IG1lc3NhZ2UuY29udGVudDtcblx0XHRjb25zdCBuYW1lTWF0Y2ggPSBjb250ZW50Lm1hdGNoKE5BTUVfUEFUVEVSTik7XG5cdFx0Y29uc3QgY29udGVudE1hdGNoID0gY29udGVudC5tYXRjaChDT05URU5UX1BBVFRFUk4pO1xuXHRcdGlmICghbmFtZU1hdGNoIHx8ICFjb250ZW50TWF0Y2gpIHJldHVybiBtZXNzYWdlO1xuXHRcdHVwZGF0ZWROYW1lID0gbmFtZU1hdGNoWzFdO1xuXHRcdHVwZGF0ZWRDb250ZW50ID0gY29udGVudE1hdGNoWzFdO1xuXHR9XG5cdHJldHVybiBuZXcgQUlNZXNzYWdlKHtcblx0XHQuLi5PYmplY3Qua2V5cyhtZXNzYWdlLmxjX2t3YXJncyA/PyB7fSkubGVuZ3RoID4gMCA/IG1lc3NhZ2UubGNfa3dhcmdzIDogbWVzc2FnZSxcblx0XHRjb250ZW50OiB1cGRhdGVkQ29udGVudCxcblx0XHRuYW1lOiB1cGRhdGVkTmFtZVxuXHR9KTtcbn1cbmZ1bmN0aW9uIGlzQ2xpZW50VG9vbCh0b29sKSB7XG5cdHJldHVybiBSdW5uYWJsZS5pc1J1bm5hYmxlKHRvb2wpO1xufVxuLyoqXG4qIEhlbHBlciBmdW5jdGlvbiB0byBjaGVjayBpZiBhIGxhbmd1YWdlIG1vZGVsIGhhcyBhIGJpbmRUb29scyBtZXRob2QuXG4qIEBwYXJhbSBsbG0gLSBUaGUgbGFuZ3VhZ2UgbW9kZWwgdG8gY2hlY2sgaWYgaXQgaGFzIGEgYmluZFRvb2xzIG1ldGhvZC5cbiogQHJldHVybnMgVHJ1ZSBpZiB0aGUgbGFuZ3VhZ2UgbW9kZWwgaGFzIGEgYmluZFRvb2xzIG1ldGhvZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuKi9cbmZ1bmN0aW9uIF9pc0NoYXRNb2RlbFdpdGhCaW5kVG9vbHMobGxtKSB7XG5cdGlmICghaXNCYXNlQ2hhdE1vZGVsKGxsbSkpIHJldHVybiBmYWxzZTtcblx0cmV0dXJuIFwiYmluZFRvb2xzXCIgaW4gbGxtICYmIHR5cGVvZiBsbG0uYmluZFRvb2xzID09PSBcImZ1bmN0aW9uXCI7XG59XG4vKipcbiogSGVscGVyIGZ1bmN0aW9uIHRvIGJpbmQgdG9vbHMgdG8gYSBsYW5ndWFnZSBtb2RlbC5cbiogQHBhcmFtIGxsbSAtIFRoZSBsYW5ndWFnZSBtb2RlbCB0byBiaW5kIHRvb2xzIHRvLlxuKiBAcGFyYW0gdG9vbENsYXNzZXMgLSBUaGUgdG9vbHMgdG8gYmluZCB0byB0aGUgbGFuZ3VhZ2UgbW9kZWwuXG4qIEBwYXJhbSBvcHRpb25zIC0gVGhlIG9wdGlvbnMgdG8gcGFzcyB0byB0aGUgbGFuZ3VhZ2UgbW9kZWwuXG4qIEByZXR1cm5zIFRoZSBsYW5ndWFnZSBtb2RlbCB3aXRoIHRoZSB0b29scyBib3VuZCB0byBpdC5cbiovXG5jb25zdCBfc2ltcGxlQmluZFRvb2xzID0gKGxsbSwgdG9vbENsYXNzZXMsIG9wdGlvbnMgPSB7fSkgPT4ge1xuXHRpZiAoX2lzQ2hhdE1vZGVsV2l0aEJpbmRUb29scyhsbG0pKSByZXR1cm4gbGxtLmJpbmRUb29scyh0b29sQ2xhc3Nlcywgb3B0aW9ucyk7XG5cdGlmIChSdW5uYWJsZUJpbmRpbmcuaXNSdW5uYWJsZUJpbmRpbmcobGxtKSAmJiBfaXNDaGF0TW9kZWxXaXRoQmluZFRvb2xzKGxsbS5ib3VuZCkpIHtcblx0XHRjb25zdCBuZXdCb3VuZCA9IGxsbS5ib3VuZC5iaW5kVG9vbHModG9vbENsYXNzZXMsIG9wdGlvbnMpO1xuXHRcdGlmIChSdW5uYWJsZUJpbmRpbmcuaXNSdW5uYWJsZUJpbmRpbmcobmV3Qm91bmQpKSByZXR1cm4gbmV3IFJ1bm5hYmxlQmluZGluZyh7XG5cdFx0XHRib3VuZDogbmV3Qm91bmQuYm91bmQsXG5cdFx0XHRjb25maWc6IHtcblx0XHRcdFx0Li4ubGxtLmNvbmZpZyxcblx0XHRcdFx0Li4ubmV3Qm91bmQuY29uZmlnXG5cdFx0XHR9LFxuXHRcdFx0a3dhcmdzOiB7XG5cdFx0XHRcdC4uLmxsbS5rd2FyZ3MsXG5cdFx0XHRcdC4uLm5ld0JvdW5kLmt3YXJnc1xuXHRcdFx0fSxcblx0XHRcdGNvbmZpZ0ZhY3RvcmllczogbmV3Qm91bmQuY29uZmlnRmFjdG9yaWVzID8/IGxsbS5jb25maWdGYWN0b3JpZXNcblx0XHR9KTtcblx0XHRyZXR1cm4gbmV3IFJ1bm5hYmxlQmluZGluZyh7XG5cdFx0XHRib3VuZDogbmV3Qm91bmQsXG5cdFx0XHRjb25maWc6IGxsbS5jb25maWcsXG5cdFx0XHRrd2FyZ3M6IGxsbS5rd2FyZ3MsXG5cdFx0XHRjb25maWdGYWN0b3JpZXM6IGxsbS5jb25maWdGYWN0b3JpZXNcblx0XHR9KTtcblx0fVxuXHRyZXR1cm4gbnVsbDtcbn07XG4vKipcbiogQ2hlY2sgaWYgdGhlIExMTSBhbHJlYWR5IGhhcyBib3VuZCB0b29scyBhbmQgdGhyb3cgaWYgaXQgZG9lcy5cbipcbiogQHBhcmFtIGxsbSAtIFRoZSBMTE0gdG8gY2hlY2suXG4qIEByZXR1cm5zIHZvaWRcbiovXG5mdW5jdGlvbiB2YWxpZGF0ZUxMTUhhc05vQm91bmRUb29scyhsbG0pIHtcblx0LyoqXG5cdCogSWYgbGxtIGlzIGEgZnVuY3Rpb24sIHdlIGNhbid0IHZhbGlkYXRlIHVudGlsIHJ1bnRpbWUsIHNvIHNraXBcblx0Ki9cblx0aWYgKHR5cGVvZiBsbG0gPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuO1xuXHRsZXQgbW9kZWwgPSBsbG07XG5cdC8qKlxuXHQqIElmIG1vZGVsIGlzIGEgUnVubmFibGVTZXF1ZW5jZSwgZmluZCBhIFJ1bm5hYmxlQmluZGluZyBpbiBpdHMgc3RlcHNcblx0Ki9cblx0aWYgKFJ1bm5hYmxlU2VxdWVuY2UuaXNSdW5uYWJsZVNlcXVlbmNlKG1vZGVsKSkgbW9kZWwgPSBtb2RlbC5zdGVwcy5maW5kKChzdGVwKSA9PiBSdW5uYWJsZUJpbmRpbmcuaXNSdW5uYWJsZUJpbmRpbmcoc3RlcCkpIHx8IG1vZGVsO1xuXHQvKipcblx0KiBJZiBtb2RlbCBpcyBjb25maWd1cmFibGUsIGdldCB0aGUgdW5kZXJseWluZyBtb2RlbFxuXHQqL1xuXHRpZiAoaXNDb25maWd1cmFibGVNb2RlbChtb2RlbCkpXG4gLyoqXG5cdCogQ2FuJ3QgdmFsaWRhdGUgYXN5bmMgbW9kZWwgcmV0cmlldmFsIGluIGNvbnN0cnVjdG9yXG5cdCovXG5cdHJldHVybjtcblx0LyoqXG5cdCogQ2hlY2sgaWYgbW9kZWwgaXMgYSBSdW5uYWJsZUJpbmRpbmcgd2l0aCBib3VuZCB0b29sc1xuXHQqL1xuXHRpZiAoUnVubmFibGVCaW5kaW5nLmlzUnVubmFibGVCaW5kaW5nKG1vZGVsKSkge1xuXHRcdGNvbnN0IGhhc1Rvb2xzSW5Ld2FyZ3MgPSBtb2RlbC5rd2FyZ3MgIT0gbnVsbCAmJiB0eXBlb2YgbW9kZWwua3dhcmdzID09PSBcIm9iamVjdFwiICYmIFwidG9vbHNcIiBpbiBtb2RlbC5rd2FyZ3MgJiYgQXJyYXkuaXNBcnJheShtb2RlbC5rd2FyZ3MudG9vbHMpICYmIG1vZGVsLmt3YXJncy50b29scy5sZW5ndGggPiAwO1xuXHRcdGNvbnN0IGhhc1Rvb2xzSW5Db25maWcgPSBtb2RlbC5jb25maWcgIT0gbnVsbCAmJiB0eXBlb2YgbW9kZWwuY29uZmlnID09PSBcIm9iamVjdFwiICYmIFwidG9vbHNcIiBpbiBtb2RlbC5jb25maWcgJiYgQXJyYXkuaXNBcnJheShtb2RlbC5jb25maWcudG9vbHMpICYmIG1vZGVsLmNvbmZpZy50b29scy5sZW5ndGggPiAwO1xuXHRcdGlmIChoYXNUb29sc0luS3dhcmdzIHx8IGhhc1Rvb2xzSW5Db25maWcpIHRocm93IG5ldyBNdWx0aXBsZVRvb2xzQm91bmRFcnJvcigpO1xuXHR9XG5cdC8qKlxuXHQqIEFsc28gY2hlY2sgaWYgbW9kZWwgaGFzIHRvb2xzIHByb3BlcnR5IGRpcmVjdGx5IChlLmcuLCBGYWtlVG9vbENhbGxpbmdNb2RlbClcblx0Ki9cblx0aWYgKFwidG9vbHNcIiBpbiBtb2RlbCAmJiBtb2RlbC50b29scyAhPT0gdm9pZCAwICYmIEFycmF5LmlzQXJyYXkobW9kZWwudG9vbHMpICYmIG1vZGVsLnRvb2xzLmxlbmd0aCA+IDApIHRocm93IG5ldyBNdWx0aXBsZVRvb2xzQm91bmRFcnJvcigpO1xufVxuLyoqXG4qIENoZWNrIGlmIHRoZSBsYXN0IG1lc3NhZ2UgaW4gdGhlIG1lc3NhZ2VzIGFycmF5IGhhcyB0b29sIGNhbGxzLlxuKlxuKiBAcGFyYW0gbWVzc2FnZXMgLSBUaGUgbWVzc2FnZXMgdG8gY2hlY2suXG4qIEByZXR1cm5zIFRydWUgaWYgdGhlIGxhc3QgbWVzc2FnZSBoYXMgdG9vbCBjYWxscywgZmFsc2Ugb3RoZXJ3aXNlLlxuKi9cbmZ1bmN0aW9uIGhhc1Rvb2xDYWxscyhtZXNzYWdlKSB7XG5cdHJldHVybiBCb29sZWFuKEFJTWVzc2FnZS5pc0luc3RhbmNlKG1lc3NhZ2UpICYmIG1lc3NhZ2UudG9vbF9jYWxscyAmJiBtZXNzYWdlLnRvb2xfY2FsbHMubGVuZ3RoID4gMCk7XG59XG4vKipcbiogTm9ybWFsaXplcyBhIHN5c3RlbSBwcm9tcHQgdG8gYSBTeXN0ZW1NZXNzYWdlIG9iamVjdC5cbiogSWYgaXQncyBhbHJlYWR5IGEgU3lzdGVtTWVzc2FnZSwgcmV0dXJucyBpdCBhcy1pcy5cbiogSWYgaXQncyBhIHN0cmluZywgY29udmVydHMgaXQgdG8gYSBTeXN0ZW1NZXNzYWdlLlxuKiBJZiBpdCdzIHVuZGVmaW5lZCwgY3JlYXRlcyBhbiBlbXB0eSBzeXN0ZW0gbWVzc2FnZSBzbyBpdCBpcyBlYXNpZXIgdG8gYXBwZW5kIHRvIGl0IGxhdGVyLlxuKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZVN5c3RlbVByb21wdChzeXN0ZW1Qcm9tcHQpIHtcblx0aWYgKHN5c3RlbVByb21wdCA9PSBudWxsKSByZXR1cm4gbmV3IFN5c3RlbU1lc3NhZ2UoXCJcIik7XG5cdGlmIChTeXN0ZW1NZXNzYWdlLmlzSW5zdGFuY2Uoc3lzdGVtUHJvbXB0KSkgcmV0dXJuIHN5c3RlbVByb21wdDtcblx0aWYgKHR5cGVvZiBzeXN0ZW1Qcm9tcHQgPT09IFwic3RyaW5nXCIpIHJldHVybiBuZXcgU3lzdGVtTWVzc2FnZSh7IGNvbnRlbnQ6IFt7XG5cdFx0dHlwZTogXCJ0ZXh0XCIsXG5cdFx0dGV4dDogc3lzdGVtUHJvbXB0XG5cdH1dIH0pO1xuXHR0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc3lzdGVtUHJvbXB0IHR5cGU6IGV4cGVjdGVkIHN0cmluZyBvciBTeXN0ZW1NZXNzYWdlLCBnb3QgJHt0eXBlb2Ygc3lzdGVtUHJvbXB0fWApO1xufVxuLyoqXG4qIEhlbHBlciBmdW5jdGlvbiB0byBiaW5kIHRvb2xzIHRvIGEgbGFuZ3VhZ2UgbW9kZWwuXG4qIEBwYXJhbSBsbG0gLSBUaGUgbGFuZ3VhZ2UgbW9kZWwgdG8gYmluZCB0b29scyB0by5cbiogQHBhcmFtIHRvb2xDbGFzc2VzIC0gVGhlIHRvb2xzIHRvIGJpbmQgdG8gdGhlIGxhbmd1YWdlIG1vZGVsLlxuKiBAcGFyYW0gb3B0aW9ucyAtIFRoZSBvcHRpb25zIHRvIHBhc3MgdG8gdGhlIGxhbmd1YWdlIG1vZGVsLlxuKiBAcmV0dXJucyBUaGUgbGFuZ3VhZ2UgbW9kZWwgd2l0aCB0aGUgdG9vbHMgYm91bmQgdG8gaXQuXG4qL1xuYXN5bmMgZnVuY3Rpb24gYmluZFRvb2xzKGxsbSwgdG9vbENsYXNzZXMsIG9wdGlvbnMgPSB7fSkge1xuXHRjb25zdCBtb2RlbCA9IF9zaW1wbGVCaW5kVG9vbHMobGxtLCB0b29sQ2xhc3Nlcywgb3B0aW9ucyk7XG5cdGlmIChtb2RlbCkgcmV0dXJuIG1vZGVsO1xuXHRpZiAoaXNDb25maWd1cmFibGVNb2RlbChsbG0pKSB7XG5cdFx0Y29uc3QgbW9kZWwgPSBfc2ltcGxlQmluZFRvb2xzKGF3YWl0IGxsbS5fZ2V0TW9kZWxJbnN0YW5jZSgpLCB0b29sQ2xhc3Nlcywgb3B0aW9ucyk7XG5cdFx0aWYgKG1vZGVsKSByZXR1cm4gbW9kZWw7XG5cdH1cblx0aWYgKFJ1bm5hYmxlU2VxdWVuY2UuaXNSdW5uYWJsZVNlcXVlbmNlKGxsbSkpIHtcblx0XHRjb25zdCBtb2RlbFN0ZXAgPSBsbG0uc3RlcHMuZmluZEluZGV4KChzdGVwKSA9PiBSdW5uYWJsZUJpbmRpbmcuaXNSdW5uYWJsZUJpbmRpbmcoc3RlcCkgfHwgaXNCYXNlQ2hhdE1vZGVsKHN0ZXApIHx8IGlzQ29uZmlndXJhYmxlTW9kZWwoc3RlcCkpO1xuXHRcdGlmIChtb2RlbFN0ZXAgPj0gMCkge1xuXHRcdFx0Y29uc3QgbW9kZWwgPSBfc2ltcGxlQmluZFRvb2xzKGxsbS5zdGVwc1ttb2RlbFN0ZXBdLCB0b29sQ2xhc3Nlcywgb3B0aW9ucyk7XG5cdFx0XHRpZiAobW9kZWwpIHtcblx0XHRcdFx0Y29uc3QgbmV4dFN0ZXBzID0gbGxtLnN0ZXBzLnNsaWNlKCk7XG5cdFx0XHRcdG5leHRTdGVwcy5zcGxpY2UobW9kZWxTdGVwLCAxLCBtb2RlbCk7XG5cdFx0XHRcdHJldHVybiBSdW5uYWJsZVNlcXVlbmNlLmZyb20obmV4dFN0ZXBzKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0dGhyb3cgbmV3IEVycm9yKGBsbG0gJHtsbG19IG11c3QgZGVmaW5lIGJpbmRUb29scyBtZXRob2QuYCk7XG59XG4vKipcbiogQ29tcG9zZSBtdWx0aXBsZSB3cmFwVG9vbENhbGwgaGFuZGxlcnMgaW50byBhIHNpbmdsZSBtaWRkbGV3YXJlIHN0YWNrLlxuKlxuKiBDb21wb3NlcyBoYW5kbGVycyBzbyB0aGUgZmlyc3QgaW4gdGhlIGxpc3QgYmVjb21lcyB0aGUgb3V0ZXJtb3N0IGxheWVyLlxuKiBFYWNoIGhhbmRsZXIgcmVjZWl2ZXMgYSBoYW5kbGVyIGNhbGxiYWNrIHRvIGV4ZWN1dGUgaW5uZXIgbGF5ZXJzLlxuKlxuKiBAcGFyYW0gaGFuZGxlcnMgLSBMaXN0IG9mIGhhbmRsZXJzLiBGaXJzdCBoYW5kbGVyIHdyYXBzIGFsbCBvdGhlcnMuXG4qIEByZXR1cm5zIENvbXBvc2VkIGhhbmRsZXIsIG9yIHVuZGVmaW5lZCBpZiBoYW5kbGVycyBhcnJheSBpcyBlbXB0eS5cbipcbiogQGV4YW1wbGVcbiogYGBgdHlwZXNjcmlwdFxuKiAvLyBoYW5kbGVycz1bYXV0aCwgcmV0cnldIG1lYW5zOiBhdXRoIHdyYXBzIHJldHJ5XG4qIC8vIEZsb3c6IGF1dGggY2FsbHMgcmV0cnksIHJldHJ5IGNhbGxzIGJhc2UgaGFuZGxlclxuKiBjb25zdCBhdXRoOiBUb29sQ2FsbFdyYXBwZXIgPSBhc3luYyAocmVxdWVzdCwgaGFuZGxlcikgPT4ge1xuKiAgIHRyeSB7XG4qICAgICByZXR1cm4gYXdhaXQgaGFuZGxlcihyZXF1ZXN0KTtcbiogICB9IGNhdGNoIChlcnJvcikge1xuKiAgICAgaWYgKGVycm9yLm1lc3NhZ2UgPT09IFwiVW5hdXRob3JpemVkXCIpIHtcbiogICAgICAgYXdhaXQgcmVmcmVzaFRva2VuKCk7XG4qICAgICAgIHJldHVybiBhd2FpdCBoYW5kbGVyKHJlcXVlc3QpO1xuKiAgICAgfVxuKiAgICAgdGhyb3cgZXJyb3I7XG4qICAgfVxuKiB9O1xuKlxuKiBjb25zdCByZXRyeTogVG9vbENhbGxXcmFwcGVyID0gYXN5bmMgKHJlcXVlc3QsIGhhbmRsZXIpID0+IHtcbiogICBmb3IgKGxldCBhdHRlbXB0ID0gMDsgYXR0ZW1wdCA8IDM7IGF0dGVtcHQrKykge1xuKiAgICAgdHJ5IHtcbiogICAgICAgcmV0dXJuIGF3YWl0IGhhbmRsZXIocmVxdWVzdCk7XG4qICAgICB9IGNhdGNoIChlcnJvcikge1xuKiAgICAgICBpZiAoYXR0ZW1wdCA9PT0gMikgdGhyb3cgZXJyb3I7XG4qICAgICB9XG4qICAgfVxuKiAgIHRocm93IG5ldyBFcnJvcihcIlVucmVhY2hhYmxlXCIpO1xuKiB9O1xuKlxuKiBjb25zdCBjb21wb3NlZEhhbmRsZXIgPSBjaGFpblRvb2xDYWxsSGFuZGxlcnMoW2F1dGgsIHJldHJ5XSk7XG4qIGBgYFxuKi9cbmZ1bmN0aW9uIGNoYWluVG9vbENhbGxIYW5kbGVycyhoYW5kbGVycykge1xuXHRpZiAoaGFuZGxlcnMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cdGlmIChoYW5kbGVycy5sZW5ndGggPT09IDEpIHJldHVybiBoYW5kbGVyc1swXTtcblx0ZnVuY3Rpb24gY29tcG9zZVR3byhvdXRlciwgaW5uZXIpIHtcblx0XHRyZXR1cm4gYXN5bmMgKHJlcXVlc3QsIGhhbmRsZXIpID0+IHtcblx0XHRcdGNvbnN0IGlubmVySGFuZGxlciA9IGFzeW5jIChwYXNzZWRSZXF1ZXN0KSA9PiB7XG5cdFx0XHRcdHJldHVybiBpbm5lcihwYXNzZWRSZXF1ZXN0LCBoYW5kbGVyKTtcblx0XHRcdH07XG5cdFx0XHRyZXR1cm4gb3V0ZXIocmVxdWVzdCwgaW5uZXJIYW5kbGVyKTtcblx0XHR9O1xuXHR9XG5cdGxldCByZXN1bHQgPSBoYW5kbGVyc1toYW5kbGVycy5sZW5ndGggLSAxXTtcblx0Zm9yIChsZXQgaSA9IGhhbmRsZXJzLmxlbmd0aCAtIDI7IGkgPj0gMDsgaS0tKSByZXN1bHQgPSBjb21wb3NlVHdvKGhhbmRsZXJzW2ldLCByZXN1bHQpO1xuXHRyZXR1cm4gcmVzdWx0O1xufVxuLyoqXG4qIFdyYXBwaW5nIGB3cmFwVG9vbENhbGxgIGludm9jYXRpb24gc28gd2UgY2FuIGluamVjdCBtaWRkbGV3YXJlIG5hbWUgaW50b1xuKiB0aGUgZXJyb3IgbWVzc2FnZS5cbipcbiogQHBhcmFtIG1pZGRsZXdhcmUgbGlzdCBvZiBtaWRkbGV3YXJlIHBhc3NlZCB0byB0aGUgYWdlbnRcbiogQHBhcmFtIHN0YXRlIHN0YXRlIG9mIHRoZSBhZ2VudFxuKiBAcmV0dXJucyBzaW5nbGUgd3JhcCBmdW5jdGlvblxuKi9cbmZ1bmN0aW9uIHdyYXBUb29sQ2FsbChtaWRkbGV3YXJlKSB7XG5cdGNvbnN0IG1pZGRsZXdhcmVXaXRoV3JhcFRvb2xDYWxsID0gbWlkZGxld2FyZS5maWx0ZXIoKG0pID0+IG0ud3JhcFRvb2xDYWxsKTtcblx0aWYgKG1pZGRsZXdhcmVXaXRoV3JhcFRvb2xDYWxsLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXHRyZXR1cm4gY2hhaW5Ub29sQ2FsbEhhbmRsZXJzKG1pZGRsZXdhcmVXaXRoV3JhcFRvb2xDYWxsLm1hcCgobSkgPT4ge1xuXHRcdGNvbnN0IG9yaWdpbmFsSGFuZGxlciA9IG0ud3JhcFRvb2xDYWxsO1xuXHRcdC8qKlxuXHRcdCogV3JhcCB3aXRoIGVycm9yIGhhbmRsaW5nIGFuZCB2YWxpZGF0aW9uXG5cdFx0Ki9cblx0XHRjb25zdCB3cmFwcGVkSGFuZGxlciA9IGFzeW5jIChyZXF1ZXN0LCBoYW5kbGVyKSA9PiB7XG5cdFx0XHQvKipcblx0XHRcdCogQ2FwdHVyZSB0aGUgb3JpZ2luYWwgc3RhdGUgZm9yIHRoaXMgbWlkZGxld2FyZSdzIHNjaGVtYSBwYXJzaW5nLlxuXHRcdFx0KiBUaGlzIGlzIGltcG9ydGFudCBiZWNhdXNlIHRoZSByZXF1ZXN0IG1heSBiZSBtb2RpZmllZCAodmlhIG92ZXJyaWRlKVxuXHRcdFx0KiBhcyBpdCBwYXNzZXMgdGhyb3VnaCB0aGUgbWlkZGxld2FyZSBjaGFpbiwgYnV0IGVhY2ggbWlkZGxld2FyZVxuXHRcdFx0KiBzaG91bGQgYWx3YXlzIHNlZSB0aGUgZnVsbCBvcmlnaW5hbCBzdGF0ZSBmb3IgaXRzIHNjaGVtYSBwYXJzaW5nLlxuXHRcdFx0Ki9cblx0XHRcdGNvbnN0IG9yaWdpbmFsU3RhdGUgPSByZXF1ZXN0LnN0YXRlO1xuXHRcdFx0LyoqXG5cdFx0XHQqIENyZWF0ZSBhIGhhbmRsZXIgdGhhdCBwcmVzZXJ2ZXMgc3RhdGUgcGFyc2luZyBmb3IgdGhpcyBtaWRkbGV3YXJlXG5cdFx0XHQqIHdoaWxlIGFsbG93aW5nIHRvb2wvdG9vbENhbGwvc3RhdGUgbW9kaWZpY2F0aW9ucyBmcm9tIGlubmVyIG1pZGRsZXdhcmVcblx0XHRcdCovXG5cdFx0XHRjb25zdCB3cmFwcGVkSW5uZXJIYW5kbGVyID0gYXN5bmMgKHBhc3NlZFJlcXVlc3QpID0+IHtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCogTWVyZ2UgdGhlIHBhc3NlZCByZXF1ZXN0IHdpdGggdGhlIG9yaWdpbmFsIHN0YXRlIGZvciBwYXJzaW5nLlxuXHRcdFx0XHQqIFRoaXMgZW5zdXJlcyBtaWRkbGV3YXJlIGNhbiBvdmVycmlkZSB0b29sL3Rvb2xDYWxsIHdoaWxlXG5cdFx0XHRcdCogbWFpbnRhaW5pbmcgcHJvcGVyIHN0YXRlIHBhcnNpbmcgZm9yIGVhY2ggbWlkZGxld2FyZSBpbiB0aGUgY2hhaW4uXG5cdFx0XHRcdCovXG5cdFx0XHRcdGNvbnN0IG1lcmdlZFN0YXRlID0ge1xuXHRcdFx0XHRcdC4uLm9yaWdpbmFsU3RhdGUsXG5cdFx0XHRcdFx0Li4ucGFzc2VkUmVxdWVzdC5zdGF0ZVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRyZXR1cm4gaGFuZGxlcih7XG5cdFx0XHRcdFx0Li4ucGFzc2VkUmVxdWVzdCxcblx0XHRcdFx0XHRzdGF0ZTogbWVyZ2VkU3RhdGVcblx0XHRcdFx0fSk7XG5cdFx0XHR9O1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgb3JpZ2luYWxIYW5kbGVyKHtcblx0XHRcdFx0XHQuLi5yZXF1ZXN0LFxuXHRcdFx0XHRcdHN0YXRlOiB7XG5cdFx0XHRcdFx0XHRtZXNzYWdlczogb3JpZ2luYWxTdGF0ZS5tZXNzYWdlcyxcblx0XHRcdFx0XHRcdC4uLm0uc3RhdGVTY2hlbWEgPyBwYXJzZU1pZGRsZXdhcmVTdGF0ZShtLnN0YXRlU2NoZW1hLCB7IC4uLm9yaWdpbmFsU3RhdGUgfSkgOiB7fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSwgd3JhcHBlZElubmVySGFuZGxlcik7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQqIFZhbGlkYXRlIHJldHVybiB0eXBlXG5cdFx0XHRcdCovXG5cdFx0XHRcdGlmICghVG9vbE1lc3NhZ2UuaXNJbnN0YW5jZShyZXN1bHQpICYmICFpc0NvbW1hbmQocmVzdWx0KSkgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHJlc3BvbnNlIGZyb20gXCJ3cmFwVG9vbENhbGxcIiBpbiBtaWRkbGV3YXJlIFwiJHttLm5hbWV9XCI6IGV4cGVjdGVkIFRvb2xNZXNzYWdlIG9yIENvbW1hbmQsIGdvdCAke3R5cGVvZiByZXN1bHR9YCk7XG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHR0aHJvdyBNaWRkbGV3YXJlRXJyb3Iud3JhcChlcnJvciwgbS5uYW1lKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHJldHVybiB3cmFwcGVkSGFuZGxlcjtcblx0fSkpO1xufVxuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IF9hZGRJbmxpbmVBZ2VudE5hbWUsIF9yZW1vdmVJbmxpbmVBZ2VudE5hbWUsIGJpbmRUb29scywgaGFzVG9vbENhbGxzLCBpc0NsaWVudFRvb2wsIG5vcm1hbGl6ZVN5c3RlbVByb21wdCwgdmFsaWRhdGVMTE1IYXNOb0JvdW5kVG9vbHMsIHdyYXBUb29sQ2FsbCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/utils.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/withAgentName.js":
/*!*********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/withAgentName.js ***!
  \*********************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withAgentName: () => (/* binding */ withAgentName)\n/* harmony export */ });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/utils.js\");\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/runnables/index.js\");\n\n\n\n//#region src/agents/withAgentName.ts\n/**\n* Attach formatted agent names to the messages passed to and from a language model.\n*\n* This is useful for making a message history with multiple agents more coherent.\n*\n* NOTE: agent name is consumed from the message.name field.\n* If you're using an agent built with createAgent, name is automatically set.\n* If you're building a custom agent, make sure to set the name on the AI message returned by the LLM.\n*\n* @param model - Language model to add agent name formatting to\n* @param agentNameMode - How to expose the agent name to the LLM\n*   - \"inline\": Add the agent name directly into the content field of the AI message using XML-style tags.\n*     Example: \"How can I help you\" -> \"<name>agent_name</name><content>How can I help you?</content>\".\n*/\nfunction withAgentName(model, agentNameMode) {\n\tlet processInputMessage;\n\tlet processOutputMessage;\n\tif (agentNameMode === \"inline\") {\n\t\tprocessInputMessage = _utils_js__WEBPACK_IMPORTED_MODULE_0__._addInlineAgentName;\n\t\tprocessOutputMessage = _utils_js__WEBPACK_IMPORTED_MODULE_0__._removeInlineAgentName;\n\t} else throw new Error(`Invalid agent name mode: ${agentNameMode}. Needs to be one of: \"inline\"`);\n\tfunction processInputMessages(messages) {\n\t\treturn messages.map(processInputMessage);\n\t}\n\treturn _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_1__.RunnableSequence.from([\n\t\t_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_1__.RunnableLambda.from(processInputMessages),\n\t\tmodel,\n\t\t_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_1__.RunnableLambda.from(processOutputMessage)\n\t]);\n}\n\n//#endregion\n\n//# sourceMappingURL=withAgentName.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9hZ2VudHMvd2l0aEFnZW50TmFtZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBeUU7QUFDSTs7QUFFN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMERBQW1CO0FBQzNDLHlCQUF5Qiw2REFBc0I7QUFDL0MsR0FBRyxpREFBaUQsY0FBYztBQUNsRTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVFQUFnQjtBQUN4QixFQUFFLHFFQUFjO0FBQ2hCO0FBQ0EsRUFBRSxxRUFBYztBQUNoQjtBQUNBOztBQUVBO0FBQ3lCO0FBQ3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvYWdlbnRzL3dpdGhBZ2VudE5hbWUuanM/ODJhZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfYWRkSW5saW5lQWdlbnROYW1lLCBfcmVtb3ZlSW5saW5lQWdlbnROYW1lIH0gZnJvbSBcIi4vdXRpbHMuanNcIjtcbmltcG9ydCB7IFJ1bm5hYmxlTGFtYmRhLCBSdW5uYWJsZVNlcXVlbmNlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS9ydW5uYWJsZXNcIjtcblxuLy8jcmVnaW9uIHNyYy9hZ2VudHMvd2l0aEFnZW50TmFtZS50c1xuLyoqXG4qIEF0dGFjaCBmb3JtYXR0ZWQgYWdlbnQgbmFtZXMgdG8gdGhlIG1lc3NhZ2VzIHBhc3NlZCB0byBhbmQgZnJvbSBhIGxhbmd1YWdlIG1vZGVsLlxuKlxuKiBUaGlzIGlzIHVzZWZ1bCBmb3IgbWFraW5nIGEgbWVzc2FnZSBoaXN0b3J5IHdpdGggbXVsdGlwbGUgYWdlbnRzIG1vcmUgY29oZXJlbnQuXG4qXG4qIE5PVEU6IGFnZW50IG5hbWUgaXMgY29uc3VtZWQgZnJvbSB0aGUgbWVzc2FnZS5uYW1lIGZpZWxkLlxuKiBJZiB5b3UncmUgdXNpbmcgYW4gYWdlbnQgYnVpbHQgd2l0aCBjcmVhdGVBZ2VudCwgbmFtZSBpcyBhdXRvbWF0aWNhbGx5IHNldC5cbiogSWYgeW91J3JlIGJ1aWxkaW5nIGEgY3VzdG9tIGFnZW50LCBtYWtlIHN1cmUgdG8gc2V0IHRoZSBuYW1lIG9uIHRoZSBBSSBtZXNzYWdlIHJldHVybmVkIGJ5IHRoZSBMTE0uXG4qXG4qIEBwYXJhbSBtb2RlbCAtIExhbmd1YWdlIG1vZGVsIHRvIGFkZCBhZ2VudCBuYW1lIGZvcm1hdHRpbmcgdG9cbiogQHBhcmFtIGFnZW50TmFtZU1vZGUgLSBIb3cgdG8gZXhwb3NlIHRoZSBhZ2VudCBuYW1lIHRvIHRoZSBMTE1cbiogICAtIFwiaW5saW5lXCI6IEFkZCB0aGUgYWdlbnQgbmFtZSBkaXJlY3RseSBpbnRvIHRoZSBjb250ZW50IGZpZWxkIG9mIHRoZSBBSSBtZXNzYWdlIHVzaW5nIFhNTC1zdHlsZSB0YWdzLlxuKiAgICAgRXhhbXBsZTogXCJIb3cgY2FuIEkgaGVscCB5b3VcIiAtPiBcIjxuYW1lPmFnZW50X25hbWU8L25hbWU+PGNvbnRlbnQ+SG93IGNhbiBJIGhlbHAgeW91PzwvY29udGVudD5cIi5cbiovXG5mdW5jdGlvbiB3aXRoQWdlbnROYW1lKG1vZGVsLCBhZ2VudE5hbWVNb2RlKSB7XG5cdGxldCBwcm9jZXNzSW5wdXRNZXNzYWdlO1xuXHRsZXQgcHJvY2Vzc091dHB1dE1lc3NhZ2U7XG5cdGlmIChhZ2VudE5hbWVNb2RlID09PSBcImlubGluZVwiKSB7XG5cdFx0cHJvY2Vzc0lucHV0TWVzc2FnZSA9IF9hZGRJbmxpbmVBZ2VudE5hbWU7XG5cdFx0cHJvY2Vzc091dHB1dE1lc3NhZ2UgPSBfcmVtb3ZlSW5saW5lQWdlbnROYW1lO1xuXHR9IGVsc2UgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGFnZW50IG5hbWUgbW9kZTogJHthZ2VudE5hbWVNb2RlfS4gTmVlZHMgdG8gYmUgb25lIG9mOiBcImlubGluZVwiYCk7XG5cdGZ1bmN0aW9uIHByb2Nlc3NJbnB1dE1lc3NhZ2VzKG1lc3NhZ2VzKSB7XG5cdFx0cmV0dXJuIG1lc3NhZ2VzLm1hcChwcm9jZXNzSW5wdXRNZXNzYWdlKTtcblx0fVxuXHRyZXR1cm4gUnVubmFibGVTZXF1ZW5jZS5mcm9tKFtcblx0XHRSdW5uYWJsZUxhbWJkYS5mcm9tKHByb2Nlc3NJbnB1dE1lc3NhZ2VzKSxcblx0XHRtb2RlbCxcblx0XHRSdW5uYWJsZUxhbWJkYS5mcm9tKHByb2Nlc3NPdXRwdXRNZXNzYWdlKVxuXHRdKTtcbn1cblxuLy8jZW5kcmVnaW9uXG5leHBvcnQgeyB3aXRoQWdlbnROYW1lIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD13aXRoQWdlbnROYW1lLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/withAgentName.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js":
/*!**********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js ***!
  \**********************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ConfigurableModel: () => (/* binding */ ConfigurableModel),\n/* harmony export */   MODEL_PROVIDER_CONFIG: () => (/* binding */ MODEL_PROVIDER_CONFIG),\n/* harmony export */   _inferModelProvider: () => (/* binding */ _inferModelProvider),\n/* harmony export */   getChatModelByClassName: () => (/* binding */ getChatModelByClassName),\n/* harmony export */   initChatModel: () => (/* binding */ initChatModel),\n/* harmony export */   universal_exports: () => (/* binding */ universal_exports)\n/* harmony export */ });\n/* harmony import */ var _virtual_rolldown_runtime_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../_virtual/_rolldown/runtime.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/_virtual/_rolldown/runtime.js\");\n/* harmony import */ var _langchain_core_language_models_chat_models__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/language_models/chat_models */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/language_models/chat_models.js\");\n/* harmony import */ var _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/runnables */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/runnables/index.js\");\n/* harmony import */ var _langchain_core_utils_stream__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/core/utils/stream */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/stream.js\");\n\n\n\n\n\n//#region src/chat_models/universal.ts\nvar universal_exports = /* @__PURE__ */ (0,_virtual_rolldown_runtime_js__WEBPACK_IMPORTED_MODULE_0__.__exportAll)({\n\tConfigurableModel: () => ConfigurableModel,\n\tMODEL_PROVIDER_CONFIG: () => MODEL_PROVIDER_CONFIG,\n\t_inferModelProvider: () => _inferModelProvider,\n\tgetChatModelByClassName: () => getChatModelByClassName,\n\tinitChatModel: () => initChatModel\n});\nconst MODEL_PROVIDER_CONFIG = {\n\topenai: {\n\t\tpackage: \"@langchain/openai\",\n\t\tclassName: \"ChatOpenAI\"\n\t},\n\tanthropic: {\n\t\tpackage: \"@langchain/anthropic\",\n\t\tclassName: \"ChatAnthropic\"\n\t},\n\tazure_openai: {\n\t\tpackage: \"@langchain/openai\",\n\t\tclassName: \"AzureChatOpenAI\"\n\t},\n\tcohere: {\n\t\tpackage: \"@langchain/cohere\",\n\t\tclassName: \"ChatCohere\"\n\t},\n\t\"google-vertexai\": {\n\t\tpackage: \"@langchain/google-vertexai\",\n\t\tclassName: \"ChatVertexAI\"\n\t},\n\t\"google-vertexai-web\": {\n\t\tpackage: \"@langchain/google-vertexai-web\",\n\t\tclassName: \"ChatVertexAI\"\n\t},\n\t\"google-genai\": {\n\t\tpackage: \"@langchain/google-genai\",\n\t\tclassName: \"ChatGoogleGenerativeAI\"\n\t},\n\tollama: {\n\t\tpackage: \"@langchain/ollama\",\n\t\tclassName: \"ChatOllama\"\n\t},\n\tmistralai: {\n\t\tpackage: \"@langchain/mistralai\",\n\t\tclassName: \"ChatMistralAI\"\n\t},\n\tmistral: {\n\t\tpackage: \"@langchain/mistralai\",\n\t\tclassName: \"ChatMistralAI\"\n\t},\n\tgroq: {\n\t\tpackage: \"@langchain/groq\",\n\t\tclassName: \"ChatGroq\"\n\t},\n\tcerebras: {\n\t\tpackage: \"@langchain/cerebras\",\n\t\tclassName: \"ChatCerebras\"\n\t},\n\tbedrock: {\n\t\tpackage: \"@langchain/aws\",\n\t\tclassName: \"ChatBedrockConverse\"\n\t},\n\tdeepseek: {\n\t\tpackage: \"@langchain/deepseek\",\n\t\tclassName: \"ChatDeepSeek\"\n\t},\n\txai: {\n\t\tpackage: \"@langchain/xai\",\n\t\tclassName: \"ChatXAI\"\n\t},\n\tfireworks: {\n\t\tpackage: \"@langchain/community/chat_models/fireworks\",\n\t\tclassName: \"ChatFireworks\",\n\t\thasCircularDependency: true\n\t},\n\ttogether: {\n\t\tpackage: \"@langchain/community/chat_models/togetherai\",\n\t\tclassName: \"ChatTogetherAI\",\n\t\thasCircularDependency: true\n\t},\n\tperplexity: {\n\t\tpackage: \"@langchain/community/chat_models/perplexity\",\n\t\tclassName: \"ChatPerplexity\",\n\t\thasCircularDependency: true\n\t}\n};\nconst SUPPORTED_PROVIDERS = Object.keys(MODEL_PROVIDER_CONFIG);\n/**\n* Helper function to get a chat model class by its class name or model provider.\n* @param className The class name (e.g., \"ChatOpenAI\", \"ChatAnthropic\")\n* @param modelProvider Optional model provider key for direct lookup (e.g., \"google-vertexai-web\").\n*                      When provided, uses direct lookup to avoid className collision issues.\n* @returns The imported model class or undefined if not found\n*/\nasync function getChatModelByClassName(className, modelProvider) {\n\tlet config;\n\tif (modelProvider) config = MODEL_PROVIDER_CONFIG[modelProvider];\n\telse {\n\t\tconst providerEntry = Object.entries(MODEL_PROVIDER_CONFIG).find(([, c]) => c.className === className);\n\t\tconfig = providerEntry ? providerEntry[1] : void 0;\n\t}\n\tif (!config) return;\n\ttry {\n\t\treturn (await __webpack_require__(\"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models lazy recursive\")(config.package))[config.className];\n\t} catch (e) {\n\t\tconst err = e;\n\t\tif (\"code\" in err && err.code?.toString().includes(\"ERR_MODULE_NOT_FOUND\") && \"message\" in err && typeof err.message === \"string\") {\n\t\t\tconst attemptedPackage = (err.message.startsWith(\"Error: \") ? err.message.slice(7) : err.message).split(\"Cannot find package '\")[1].split(\"'\")[0];\n\t\t\tthrow new Error(`Unable to import ${attemptedPackage}. Please install with \\`npm install ${attemptedPackage}\\` or \\`pnpm install ${attemptedPackage}\\``);\n\t\t}\n\t\tthrow e;\n\t}\n}\nasync function _initChatModelHelper(model, modelProvider, params = {}) {\n\tconst modelProviderCopy = modelProvider || _inferModelProvider(model);\n\tif (!modelProviderCopy) throw new Error(`Unable to infer model provider for { model: ${model} }, please specify modelProvider directly.`);\n\tconst config = MODEL_PROVIDER_CONFIG[modelProviderCopy];\n\tif (!config) {\n\t\tconst supported = SUPPORTED_PROVIDERS.join(\", \");\n\t\tthrow new Error(`Unsupported { modelProvider: ${modelProviderCopy} }.\\n\\nSupported model providers are: ${supported}`);\n\t}\n\tconst { modelProvider: _unused, ...passedParams } = params;\n\treturn new (await (getChatModelByClassName(config.className, modelProviderCopy)))({\n\t\tmodel,\n\t\t...passedParams\n\t});\n}\n/**\n* Attempts to infer the model provider based on the given model name.\n*\n* @param {string} modelName - The name of the model to infer the provider for.\n* @returns {string | undefined} The inferred model provider name, or undefined if unable to infer.\n*\n* @example\n* _inferModelProvider(\"gpt-4\"); // returns \"openai\"\n* _inferModelProvider(\"claude-2\"); // returns \"anthropic\"\n* _inferModelProvider(\"unknown-model\"); // returns undefined\n*/\nfunction _inferModelProvider(modelName) {\n\tif (modelName.startsWith(\"gpt-3\") || modelName.startsWith(\"gpt-4\") || modelName.startsWith(\"gpt-5\") || modelName.startsWith(\"o1\") || modelName.startsWith(\"o3\") || modelName.startsWith(\"o4\")) return \"openai\";\n\telse if (modelName.startsWith(\"claude\")) return \"anthropic\";\n\telse if (modelName.startsWith(\"command\")) return \"cohere\";\n\telse if (modelName.startsWith(\"accounts/fireworks\")) return \"fireworks\";\n\telse if (modelName.startsWith(\"gemini\")) return \"google-vertexai\";\n\telse if (modelName.startsWith(\"amazon.\")) return \"bedrock\";\n\telse if (modelName.startsWith(\"mistral\")) return \"mistralai\";\n\telse if (modelName.startsWith(\"sonar\") || modelName.startsWith(\"pplx\")) return \"perplexity\";\n\telse return;\n}\n/**\n* Internal class used to create chat models.\n*\n* @internal\n*/\nvar ConfigurableModel = class ConfigurableModel extends _langchain_core_language_models_chat_models__WEBPACK_IMPORTED_MODULE_1__.BaseChatModel {\n\t_llmType() {\n\t\treturn \"chat_model\";\n\t}\n\tlc_namespace = [\"langchain\", \"chat_models\"];\n\t_defaultConfig = {};\n\t/**\n\t* @default \"any\"\n\t*/\n\t_configurableFields = \"any\";\n\t/**\n\t* @default \"\"\n\t*/\n\t_configPrefix;\n\t/**\n\t* Methods which should be called after the model is initialized.\n\t* The key will be the method name, and the value will be the arguments.\n\t*/\n\t_queuedMethodOperations = {};\n\t/** @internal */\n\t_modelInstanceCache = /* @__PURE__ */ new Map();\n\t/** @internal */\n\t_profile;\n\tconstructor(fields) {\n\t\tsuper(fields);\n\t\tthis._defaultConfig = fields.defaultConfig ?? {};\n\t\tif (fields.configurableFields === \"any\") this._configurableFields = \"any\";\n\t\telse this._configurableFields = fields.configurableFields ?? [\"model\", \"modelProvider\"];\n\t\tif (fields.configPrefix) this._configPrefix = fields.configPrefix.endsWith(\"_\") ? fields.configPrefix : `${fields.configPrefix}_`;\n\t\telse this._configPrefix = \"\";\n\t\tthis._queuedMethodOperations = fields.queuedMethodOperations ?? this._queuedMethodOperations;\n\t\tthis._profile = fields.profile ?? void 0;\n\t}\n\tasync _getModelInstance(config) {\n\t\tconst cacheKey = this._getCacheKey(config);\n\t\tconst cachedModel = this._modelInstanceCache.get(cacheKey);\n\t\tif (cachedModel) return cachedModel;\n\t\tconst params = {\n\t\t\t...this._defaultConfig,\n\t\t\t...this._modelParams(config)\n\t\t};\n\t\tlet initializedModel = await _initChatModelHelper(params.model, params.modelProvider, params);\n\t\tfor (const [method, args] of Object.entries(this._queuedMethodOperations)) if (method in initializedModel && typeof initializedModel[method] === \"function\") initializedModel = await initializedModel[method](...args);\n\t\tthis._modelInstanceCache.set(cacheKey, initializedModel);\n\t\treturn initializedModel;\n\t}\n\tasync _generate(messages, options, runManager) {\n\t\treturn (await this._getModelInstance(options))._generate(messages, options ?? {}, runManager);\n\t}\n\tbindTools(tools, params) {\n\t\tconst newQueuedOperations = { ...this._queuedMethodOperations };\n\t\tnewQueuedOperations.bindTools = [tools, params];\n\t\treturn new ConfigurableModel({\n\t\t\tdefaultConfig: this._defaultConfig,\n\t\t\tconfigurableFields: this._configurableFields,\n\t\t\tconfigPrefix: this._configPrefix,\n\t\t\tqueuedMethodOperations: newQueuedOperations\n\t\t});\n\t}\n\twithStructuredOutput = (schema, ...args) => {\n\t\tconst newQueuedOperations = { ...this._queuedMethodOperations };\n\t\tnewQueuedOperations.withStructuredOutput = [schema, ...args];\n\t\treturn new ConfigurableModel({\n\t\t\tdefaultConfig: this._defaultConfig,\n\t\t\tconfigurableFields: this._configurableFields,\n\t\t\tconfigPrefix: this._configPrefix,\n\t\t\tqueuedMethodOperations: newQueuedOperations\n\t\t});\n\t};\n\t_modelParams(config) {\n\t\tconst configurable = config?.configurable ?? {};\n\t\tlet modelParams = {};\n\t\tfor (const [key, value] of Object.entries(configurable)) if (key.startsWith(this._configPrefix)) {\n\t\t\tconst strippedKey = this._removePrefix(key, this._configPrefix);\n\t\t\tmodelParams[strippedKey] = value;\n\t\t}\n\t\tif (this._configurableFields !== \"any\") modelParams = Object.fromEntries(Object.entries(modelParams).filter(([key]) => this._configurableFields.includes(key)));\n\t\treturn modelParams;\n\t}\n\t_removePrefix(str, prefix) {\n\t\treturn str.startsWith(prefix) ? str.slice(prefix.length) : str;\n\t}\n\t/**\n\t* Bind config to a Runnable, returning a new Runnable.\n\t* @param {RunnableConfig | undefined} [config] - The config to bind.\n\t* @returns {RunnableBinding<RunInput, RunOutput, CallOptions>} A new RunnableBinding with the bound config.\n\t*/\n\twithConfig(config) {\n\t\tconst mergedConfig = { ...config || {} };\n\t\tconst modelParams = this._modelParams(mergedConfig);\n\t\tconst remainingConfig = Object.fromEntries(Object.entries(mergedConfig).filter(([k]) => k !== \"configurable\"));\n\t\tremainingConfig.configurable = Object.fromEntries(Object.entries(mergedConfig.configurable || {}).filter(([k]) => this._configPrefix && !Object.keys(modelParams).includes(this._removePrefix(k, this._configPrefix))));\n\t\treturn new _langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.RunnableBinding({\n\t\t\tconfig: mergedConfig,\n\t\t\tbound: new ConfigurableModel({\n\t\t\t\tdefaultConfig: {\n\t\t\t\t\t...this._defaultConfig,\n\t\t\t\t\t...modelParams\n\t\t\t\t},\n\t\t\t\tconfigurableFields: Array.isArray(this._configurableFields) ? [...this._configurableFields] : this._configurableFields,\n\t\t\t\tconfigPrefix: this._configPrefix,\n\t\t\t\tqueuedMethodOperations: this._queuedMethodOperations\n\t\t\t})\n\t\t});\n\t}\n\tasync invoke(input, options) {\n\t\tconst model = await this._getModelInstance(options);\n\t\tconst config = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.ensureConfig)(options);\n\t\treturn model.invoke(input, config);\n\t}\n\tasync stream(input, options) {\n\t\tconst wrappedGenerator = new _langchain_core_utils_stream__WEBPACK_IMPORTED_MODULE_3__.AsyncGeneratorWithSetup({\n\t\t\tgenerator: await (await this._getModelInstance(options)).stream(input, options),\n\t\t\tconfig: options\n\t\t});\n\t\tawait wrappedGenerator.setup;\n\t\treturn _langchain_core_utils_stream__WEBPACK_IMPORTED_MODULE_3__.IterableReadableStream.fromAsyncGenerator(wrappedGenerator);\n\t}\n\tasync batch(inputs, options, batchOptions) {\n\t\treturn super.batch(inputs, options, batchOptions);\n\t}\n\tasync *transform(generator, options) {\n\t\tconst model = await this._getModelInstance(options);\n\t\tconst config = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.ensureConfig)(options);\n\t\tyield* model.transform(generator, config);\n\t}\n\tasync *streamLog(input, options, streamOptions) {\n\t\tconst model = await this._getModelInstance(options);\n\t\tconst config = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.ensureConfig)(options);\n\t\tyield* model.streamLog(input, config, {\n\t\t\t...streamOptions,\n\t\t\t_schemaFormat: \"original\",\n\t\t\tincludeNames: streamOptions?.includeNames,\n\t\t\tincludeTypes: streamOptions?.includeTypes,\n\t\t\tincludeTags: streamOptions?.includeTags,\n\t\t\texcludeNames: streamOptions?.excludeNames,\n\t\t\texcludeTypes: streamOptions?.excludeTypes,\n\t\t\texcludeTags: streamOptions?.excludeTags\n\t\t});\n\t}\n\tstreamEvents(input, options, streamOptions) {\n\t\tconst outerThis = this;\n\t\tasync function* wrappedGenerator() {\n\t\t\tconst model = await outerThis._getModelInstance(options);\n\t\t\tconst config = (0,_langchain_core_runnables__WEBPACK_IMPORTED_MODULE_2__.ensureConfig)(options);\n\t\t\tconst eventStream = model.streamEvents(input, config, streamOptions);\n\t\t\tfor await (const chunk of eventStream) yield chunk;\n\t\t}\n\t\treturn _langchain_core_utils_stream__WEBPACK_IMPORTED_MODULE_3__.IterableReadableStream.fromAsyncGenerator(wrappedGenerator());\n\t}\n\t/**\n\t* Return profiling information for the model.\n\t*\n\t* @returns {ModelProfile} An object describing the model's capabilities and constraints\n\t*/\n\tget profile() {\n\t\tif (this._profile) return this._profile;\n\t\tconst cacheKey = this._getCacheKey({});\n\t\treturn this._modelInstanceCache.get(cacheKey)?.profile ?? {};\n\t}\n\t/** @internal */\n\t_getCacheKey(config) {\n\t\tlet toStringify = config ?? {};\n\t\tif (toStringify.configurable) {\n\t\t\tconst { configurable } = toStringify;\n\t\t\tconst filtered = {};\n\t\t\tfor (const [k, v] of Object.entries(configurable)) if (!k.startsWith(\"__pregel_\")) filtered[k] = v;\n\t\t\ttoStringify = {\n\t\t\t\t...toStringify,\n\t\t\t\tconfigurable: filtered\n\t\t\t};\n\t\t}\n\t\treturn JSON.stringify(toStringify);\n\t}\n};\n/**\n* Initialize a ChatModel from the model name and provider.\n* Must have the integration package corresponding to the model provider installed.\n*\n* @template {extends BaseLanguageModelInput = BaseLanguageModelInput} RunInput - The input type for the model.\n* @template {extends ConfigurableChatModelCallOptions = ConfigurableChatModelCallOptions} CallOptions - Call options for the model.\n*\n* @param {string | ChatModelProvider} [model] - The name of the model, e.g. \"gpt-4\", \"claude-3-opus-20240229\".\n*   Can be prefixed with the model provider, e.g. \"openai:gpt-4\", \"anthropic:claude-3-opus-20240229\".\n* @param {Object} [fields] - Additional configuration options.\n* @param {string} [fields.modelProvider] - The model provider. Supported values include:\n*   - openai (@langchain/openai)\n*   - anthropic (@langchain/anthropic)\n*   - azure_openai (@langchain/openai)\n*   - google-vertexai (@langchain/google-vertexai)\n*   - google-vertexai-web (@langchain/google-vertexai-web)\n*   - google-genai (@langchain/google-genai)\n*   - bedrock (@langchain/aws)\n*   - cohere (@langchain/cohere)\n*   - fireworks (@langchain/community/chat_models/fireworks)\n*   - together (@langchain/community/chat_models/togetherai)\n*   - mistralai (@langchain/mistralai)\n*   - groq (@langchain/groq)\n*   - ollama (@langchain/ollama)\n*   - perplexity (@langchain/community/chat_models/perplexity)\n*   - cerebras (@langchain/cerebras)\n*   - deepseek (@langchain/deepseek)\n*   - xai (@langchain/xai)\n* @param {string[] | \"any\"} [fields.configurableFields] - Which model parameters are configurable:\n*   - undefined: No configurable fields.\n*   - \"any\": All fields are configurable. (See Security Note in description)\n*   - string[]: Specified fields are configurable.\n* @param {string} [fields.configPrefix] - Prefix for configurable fields at runtime.\n* @param {ModelProfile} [fields.profile] - Overrides the profiling information for the model. If not provided,\n*   the profile will be inferred from the inner model instance.\n* @param {Record<string, any>} [fields.params] - Additional keyword args to pass to the ChatModel constructor.\n* @returns {Promise<ConfigurableModel<RunInput, CallOptions>>} A class which extends BaseChatModel.\n* @throws {Error} If modelProvider cannot be inferred or isn't supported.\n* @throws {Error} If the model provider integration package is not installed.\n*\n* @example Initialize non-configurable models\n* ```typescript\n* import { initChatModel } from \"langchain/chat_models/universal\";\n*\n* const gpt4 = await initChatModel(\"openai:gpt-4\", {\n*   temperature: 0.25,\n* });\n* const gpt4Result = await gpt4.invoke(\"what's your name\");\n*\n* const claude = await initChatModel(\"anthropic:claude-3-opus-20240229\", {\n*   temperature: 0.25,\n* });\n* const claudeResult = await claude.invoke(\"what's your name\");\n*\n* const gemini = await initChatModel(\"gemini-1.5-pro\", {\n*   modelProvider: \"google-vertexai\",\n*   temperature: 0.25,\n* });\n* const geminiResult = await gemini.invoke(\"what's your name\");\n* ```\n*\n* @example Create a partially configurable model with no default model\n* ```typescript\n* import { initChatModel } from \"langchain/chat_models/universal\";\n*\n* const configurableModel = await initChatModel(undefined, {\n*   temperature: 0,\n*   configurableFields: [\"model\", \"apiKey\"],\n* });\n*\n* const gpt4Result = await configurableModel.invoke(\"what's your name\", {\n*   configurable: {\n*     model: \"gpt-4\",\n*   },\n* });\n*\n* const claudeResult = await configurableModel.invoke(\"what's your name\", {\n*   configurable: {\n*     model: \"claude-sonnet-4-5-20250929\",\n*   },\n* });\n* ```\n*\n* @example Create a fully configurable model with a default model and a config prefix\n* ```typescript\n* import { initChatModel } from \"langchain/chat_models/universal\";\n*\n* const configurableModelWithDefault = await initChatModel(\"gpt-4\", {\n*   modelProvider: \"openai\",\n*   configurableFields: \"any\",\n*   configPrefix: \"foo\",\n*   temperature: 0,\n* });\n*\n* const openaiResult = await configurableModelWithDefault.invoke(\n*   \"what's your name\",\n*   {\n*     configurable: {\n*       foo_apiKey: process.env.OPENAI_API_KEY,\n*     },\n*   }\n* );\n*\n* const claudeResult = await configurableModelWithDefault.invoke(\n*   \"what's your name\",\n*   {\n*     configurable: {\n*       foo_model: \"claude-sonnet-4-5-20250929\",\n*       foo_modelProvider: \"anthropic\",\n*       foo_temperature: 0.6,\n*       foo_apiKey: process.env.ANTHROPIC_API_KEY,\n*     },\n*   }\n* );\n* ```\n*\n* @example Bind tools to a configurable model:\n* ```typescript\n* import { initChatModel } from \"langchain/chat_models/universal\";\n* import { z } from \"zod/v3\";\n* import { tool } from \"@langchain/core/tools\";\n*\n* const getWeatherTool = tool(\n*   (input) => {\n*     // Do something with the input\n*     return JSON.stringify(input);\n*   },\n*   {\n*     schema: z\n*       .object({\n*         location: z\n*           .string()\n*           .describe(\"The city and state, e.g. San Francisco, CA\"),\n*       })\n*       .describe(\"Get the current weather in a given location\"),\n*     name: \"GetWeather\",\n*     description: \"Get the current weather in a given location\",\n*   }\n* );\n*\n* const getPopulationTool = tool(\n*   (input) => {\n*     // Do something with the input\n*     return JSON.stringify(input);\n*   },\n*   {\n*     schema: z\n*       .object({\n*         location: z\n*           .string()\n*           .describe(\"The city and state, e.g. San Francisco, CA\"),\n*       })\n*       .describe(\"Get the current population in a given location\"),\n*     name: \"GetPopulation\",\n*     description: \"Get the current population in a given location\",\n*   }\n* );\n*\n* const configurableModel = await initChatModel(\"gpt-4\", {\n*   configurableFields: [\"model\", \"modelProvider\", \"apiKey\"],\n*   temperature: 0,\n* });\n*\n* const configurableModelWithTools = configurableModel.bindTools([\n*   getWeatherTool,\n*   getPopulationTool,\n* ]);\n*\n* const configurableToolResult = await configurableModelWithTools.invoke(\n*   \"Which city is hotter today and which is bigger: LA or NY?\",\n*   {\n*     configurable: {\n*       apiKey: process.env.OPENAI_API_KEY,\n*     },\n*   }\n* );\n*\n* const configurableToolResult2 = await configurableModelWithTools.invoke(\n*   \"Which city is hotter today and which is bigger: LA or NY?\",\n*   {\n*     configurable: {\n*       model: \"claude-sonnet-4-5-20250929\",\n*       apiKey: process.env.ANTHROPIC_API_KEY,\n*     },\n*   }\n* );\n* ```\n*\n* @example Initialize a model with a custom profile\n* ```typescript\n* import { initChatModel } from \"langchain/chat_models/universal\";\n*\n* const model = await initChatModel(\"gpt-4o-mini\", {\n*   profile: {\n*     maxInputTokens: 100000,\n*   },\n* });\n*\n* @description\n* This function initializes a ChatModel based on the provided model name and provider.\n* It supports various model providers and allows for runtime configuration of model parameters.\n*\n* Security Note: Setting `configurableFields` to \"any\" means fields like apiKey, baseUrl, etc.\n* can be altered at runtime, potentially redirecting model requests to a different service/user.\n* Make sure that if you're accepting untrusted configurations, you enumerate the\n* `configurableFields` explicitly.\n*\n* The function will attempt to infer the model provider from the model name if not specified.\n* Certain model name prefixes are associated with specific providers:\n* - gpt-3... or gpt-4... -> openai\n* - claude... -> anthropic\n* - amazon.... -> bedrock\n* - gemini... -> google-vertexai\n* - command... -> cohere\n* - accounts/fireworks... -> fireworks\n*\n* @since 0.2.11\n* @version 0.2.11\n*/\nasync function initChatModel(model, fields) {\n\tlet { configurableFields, configPrefix, modelProvider, profile, ...params } = {\n\t\tconfigPrefix: \"\",\n\t\t...fields ?? {}\n\t};\n\tif (modelProvider === void 0 && model?.includes(\":\")) {\n\t\tconst [provider, ...remainingParts] = model.split(\":\");\n\t\tconst modelComponents = remainingParts.length === 0 ? [provider] : [provider, remainingParts.join(\":\")];\n\t\tif (SUPPORTED_PROVIDERS.includes(modelComponents[0])) [modelProvider, model] = modelComponents;\n\t}\n\tlet configurableFieldsCopy = Array.isArray(configurableFields) ? [...configurableFields] : configurableFields;\n\tif (!model && configurableFieldsCopy === void 0) configurableFieldsCopy = [\"model\", \"modelProvider\"];\n\tif (configPrefix && configurableFieldsCopy === void 0) console.warn(`{ configPrefix: ${configPrefix} } has been set but no fields are configurable. Set { configurableFields: [...] } to specify the model params that are configurable.`);\n\tconst paramsCopy = { ...params };\n\tlet configurableModel;\n\tif (configurableFieldsCopy === void 0) configurableModel = new ConfigurableModel({\n\t\tdefaultConfig: {\n\t\t\t...paramsCopy,\n\t\t\tmodel,\n\t\t\tmodelProvider\n\t\t},\n\t\tconfigPrefix,\n\t\tprofile\n\t});\n\telse {\n\t\tif (model) paramsCopy.model = model;\n\t\tif (modelProvider) paramsCopy.modelProvider = modelProvider;\n\t\tconfigurableModel = new ConfigurableModel({\n\t\t\tdefaultConfig: paramsCopy,\n\t\t\tconfigPrefix,\n\t\t\tconfigurableFields: configurableFieldsCopy,\n\t\t\tprofile\n\t\t});\n\t}\n\tawait configurableModel._getModelInstance();\n\treturn configurableModel;\n}\n\n//#endregion\n\n//# sourceMappingURL=universal.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9jaGF0X21vZGVscy91bml2ZXJzYWwuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUErRDtBQUNhO0FBQ0Y7QUFDcUI7O0FBRS9GO0FBQ0Esd0NBQXdDLHlFQUFXO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGtPQUFPLGNBQWMsQ0FBQztBQUN0QyxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLGlCQUFpQixzQ0FBc0MsaUJBQWlCLHVCQUF1QixpQkFBaUI7QUFDdko7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUU7QUFDckU7QUFDQSwrRUFBK0UsU0FBUyxRQUFRO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxpQkFBaUIsb0JBQW9CLHNDQUFzQyxVQUFVO0FBQ3RIO0FBQ0EsU0FBUywwQ0FBMEM7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxRQUFRO0FBQ2xCLFlBQVksb0JBQW9CO0FBQ2hDO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEMsbUNBQW1DO0FBQ25DLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELHNGQUFhO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZHQUE2RyxvQkFBb0I7QUFDakk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0ZBQWtGO0FBQ2xGO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyw0QkFBNEI7QUFDdkMsYUFBYSxtREFBbUQ7QUFDaEU7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0Esa0dBQWtHO0FBQ2xHLGFBQWEsc0VBQWU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix1RUFBWTtBQUM3QjtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsaUZBQXVCO0FBQ3REO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxTQUFTLGdGQUFzQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsdUVBQVk7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsdUVBQVk7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsdUVBQVk7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsU0FBUyxnRkFBc0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGNBQWM7QUFDM0I7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsZUFBZTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx5REFBeUQ7QUFDdEUsYUFBYSw2RUFBNkU7QUFDMUY7QUFDQSxVQUFVLDRCQUE0QjtBQUN0QztBQUNBLFVBQVUsUUFBUTtBQUNsQixVQUFVLFFBQVE7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsa0JBQWtCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLFVBQVUsUUFBUTtBQUNsQixVQUFVLGNBQWM7QUFDeEI7QUFDQSxVQUFVLHFCQUFxQjtBQUMvQixZQUFZLG1EQUFtRDtBQUMvRCxXQUFXLE9BQU87QUFDbEIsV0FBVyxPQUFPO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLFdBQVcsZ0JBQWdCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGdCQUFnQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxnQkFBZ0I7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsZ0JBQWdCO0FBQzNCLFdBQVcsSUFBSTtBQUNmLFdBQVcsT0FBTztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsZ0JBQWdCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxzRUFBc0U7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0UsZ0JBQWdCLGdCQUFnQixtREFBbUQsNEJBQTRCO0FBQ3ZMLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ29JO0FBQ3BJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3Rvcnl0ZWxsaW5nLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xhbmdjaGFpbkAxLjIuMjZfQGxhbmdjaGFpbitjb3JlQDEuMS4yOF9vcGVuYWlANi4yNS4wX3pvZEA0LjMuNl9fX29wZW5haUA2LjI1LjBfem9kQDQuMy42X19yZV9leDJiNXkzdHpmN2gyY3htbXVpNXFvaWFzeS9ub2RlX21vZHVsZXMvbGFuZ2NoYWluL2Rpc3QvY2hhdF9tb2RlbHMvdW5pdmVyc2FsLmpzP2U4NDkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgX19leHBvcnRBbGwgfSBmcm9tIFwiLi4vX3ZpcnR1YWwvX3JvbGxkb3duL3J1bnRpbWUuanNcIjtcbmltcG9ydCB7IEJhc2VDaGF0TW9kZWwgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL2xhbmd1YWdlX21vZGVscy9jaGF0X21vZGVsc1wiO1xuaW1wb3J0IHsgUnVubmFibGVCaW5kaW5nLCBlbnN1cmVDb25maWcgfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3J1bm5hYmxlc1wiO1xuaW1wb3J0IHsgQXN5bmNHZW5lcmF0b3JXaXRoU2V0dXAsIEl0ZXJhYmxlUmVhZGFibGVTdHJlYW0gfSBmcm9tIFwiQGxhbmdjaGFpbi9jb3JlL3V0aWxzL3N0cmVhbVwiO1xuXG4vLyNyZWdpb24gc3JjL2NoYXRfbW9kZWxzL3VuaXZlcnNhbC50c1xudmFyIHVuaXZlcnNhbF9leHBvcnRzID0gLyogQF9fUFVSRV9fICovIF9fZXhwb3J0QWxsKHtcblx0Q29uZmlndXJhYmxlTW9kZWw6ICgpID0+IENvbmZpZ3VyYWJsZU1vZGVsLFxuXHRNT0RFTF9QUk9WSURFUl9DT05GSUc6ICgpID0+IE1PREVMX1BST1ZJREVSX0NPTkZJRyxcblx0X2luZmVyTW9kZWxQcm92aWRlcjogKCkgPT4gX2luZmVyTW9kZWxQcm92aWRlcixcblx0Z2V0Q2hhdE1vZGVsQnlDbGFzc05hbWU6ICgpID0+IGdldENoYXRNb2RlbEJ5Q2xhc3NOYW1lLFxuXHRpbml0Q2hhdE1vZGVsOiAoKSA9PiBpbml0Q2hhdE1vZGVsXG59KTtcbmNvbnN0IE1PREVMX1BST1ZJREVSX0NPTkZJRyA9IHtcblx0b3BlbmFpOiB7XG5cdFx0cGFja2FnZTogXCJAbGFuZ2NoYWluL29wZW5haVwiLFxuXHRcdGNsYXNzTmFtZTogXCJDaGF0T3BlbkFJXCJcblx0fSxcblx0YW50aHJvcGljOiB7XG5cdFx0cGFja2FnZTogXCJAbGFuZ2NoYWluL2FudGhyb3BpY1wiLFxuXHRcdGNsYXNzTmFtZTogXCJDaGF0QW50aHJvcGljXCJcblx0fSxcblx0YXp1cmVfb3BlbmFpOiB7XG5cdFx0cGFja2FnZTogXCJAbGFuZ2NoYWluL29wZW5haVwiLFxuXHRcdGNsYXNzTmFtZTogXCJBenVyZUNoYXRPcGVuQUlcIlxuXHR9LFxuXHRjb2hlcmU6IHtcblx0XHRwYWNrYWdlOiBcIkBsYW5nY2hhaW4vY29oZXJlXCIsXG5cdFx0Y2xhc3NOYW1lOiBcIkNoYXRDb2hlcmVcIlxuXHR9LFxuXHRcImdvb2dsZS12ZXJ0ZXhhaVwiOiB7XG5cdFx0cGFja2FnZTogXCJAbGFuZ2NoYWluL2dvb2dsZS12ZXJ0ZXhhaVwiLFxuXHRcdGNsYXNzTmFtZTogXCJDaGF0VmVydGV4QUlcIlxuXHR9LFxuXHRcImdvb2dsZS12ZXJ0ZXhhaS13ZWJcIjoge1xuXHRcdHBhY2thZ2U6IFwiQGxhbmdjaGFpbi9nb29nbGUtdmVydGV4YWktd2ViXCIsXG5cdFx0Y2xhc3NOYW1lOiBcIkNoYXRWZXJ0ZXhBSVwiXG5cdH0sXG5cdFwiZ29vZ2xlLWdlbmFpXCI6IHtcblx0XHRwYWNrYWdlOiBcIkBsYW5nY2hhaW4vZ29vZ2xlLWdlbmFpXCIsXG5cdFx0Y2xhc3NOYW1lOiBcIkNoYXRHb29nbGVHZW5lcmF0aXZlQUlcIlxuXHR9LFxuXHRvbGxhbWE6IHtcblx0XHRwYWNrYWdlOiBcIkBsYW5nY2hhaW4vb2xsYW1hXCIsXG5cdFx0Y2xhc3NOYW1lOiBcIkNoYXRPbGxhbWFcIlxuXHR9LFxuXHRtaXN0cmFsYWk6IHtcblx0XHRwYWNrYWdlOiBcIkBsYW5nY2hhaW4vbWlzdHJhbGFpXCIsXG5cdFx0Y2xhc3NOYW1lOiBcIkNoYXRNaXN0cmFsQUlcIlxuXHR9LFxuXHRtaXN0cmFsOiB7XG5cdFx0cGFja2FnZTogXCJAbGFuZ2NoYWluL21pc3RyYWxhaVwiLFxuXHRcdGNsYXNzTmFtZTogXCJDaGF0TWlzdHJhbEFJXCJcblx0fSxcblx0Z3JvcToge1xuXHRcdHBhY2thZ2U6IFwiQGxhbmdjaGFpbi9ncm9xXCIsXG5cdFx0Y2xhc3NOYW1lOiBcIkNoYXRHcm9xXCJcblx0fSxcblx0Y2VyZWJyYXM6IHtcblx0XHRwYWNrYWdlOiBcIkBsYW5nY2hhaW4vY2VyZWJyYXNcIixcblx0XHRjbGFzc05hbWU6IFwiQ2hhdENlcmVicmFzXCJcblx0fSxcblx0YmVkcm9jazoge1xuXHRcdHBhY2thZ2U6IFwiQGxhbmdjaGFpbi9hd3NcIixcblx0XHRjbGFzc05hbWU6IFwiQ2hhdEJlZHJvY2tDb252ZXJzZVwiXG5cdH0sXG5cdGRlZXBzZWVrOiB7XG5cdFx0cGFja2FnZTogXCJAbGFuZ2NoYWluL2RlZXBzZWVrXCIsXG5cdFx0Y2xhc3NOYW1lOiBcIkNoYXREZWVwU2Vla1wiXG5cdH0sXG5cdHhhaToge1xuXHRcdHBhY2thZ2U6IFwiQGxhbmdjaGFpbi94YWlcIixcblx0XHRjbGFzc05hbWU6IFwiQ2hhdFhBSVwiXG5cdH0sXG5cdGZpcmV3b3Jrczoge1xuXHRcdHBhY2thZ2U6IFwiQGxhbmdjaGFpbi9jb21tdW5pdHkvY2hhdF9tb2RlbHMvZmlyZXdvcmtzXCIsXG5cdFx0Y2xhc3NOYW1lOiBcIkNoYXRGaXJld29ya3NcIixcblx0XHRoYXNDaXJjdWxhckRlcGVuZGVuY3k6IHRydWVcblx0fSxcblx0dG9nZXRoZXI6IHtcblx0XHRwYWNrYWdlOiBcIkBsYW5nY2hhaW4vY29tbXVuaXR5L2NoYXRfbW9kZWxzL3RvZ2V0aGVyYWlcIixcblx0XHRjbGFzc05hbWU6IFwiQ2hhdFRvZ2V0aGVyQUlcIixcblx0XHRoYXNDaXJjdWxhckRlcGVuZGVuY3k6IHRydWVcblx0fSxcblx0cGVycGxleGl0eToge1xuXHRcdHBhY2thZ2U6IFwiQGxhbmdjaGFpbi9jb21tdW5pdHkvY2hhdF9tb2RlbHMvcGVycGxleGl0eVwiLFxuXHRcdGNsYXNzTmFtZTogXCJDaGF0UGVycGxleGl0eVwiLFxuXHRcdGhhc0NpcmN1bGFyRGVwZW5kZW5jeTogdHJ1ZVxuXHR9XG59O1xuY29uc3QgU1VQUE9SVEVEX1BST1ZJREVSUyA9IE9iamVjdC5rZXlzKE1PREVMX1BST1ZJREVSX0NPTkZJRyk7XG4vKipcbiogSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBhIGNoYXQgbW9kZWwgY2xhc3MgYnkgaXRzIGNsYXNzIG5hbWUgb3IgbW9kZWwgcHJvdmlkZXIuXG4qIEBwYXJhbSBjbGFzc05hbWUgVGhlIGNsYXNzIG5hbWUgKGUuZy4sIFwiQ2hhdE9wZW5BSVwiLCBcIkNoYXRBbnRocm9waWNcIilcbiogQHBhcmFtIG1vZGVsUHJvdmlkZXIgT3B0aW9uYWwgbW9kZWwgcHJvdmlkZXIga2V5IGZvciBkaXJlY3QgbG9va3VwIChlLmcuLCBcImdvb2dsZS12ZXJ0ZXhhaS13ZWJcIikuXG4qICAgICAgICAgICAgICAgICAgICAgIFdoZW4gcHJvdmlkZWQsIHVzZXMgZGlyZWN0IGxvb2t1cCB0byBhdm9pZCBjbGFzc05hbWUgY29sbGlzaW9uIGlzc3Vlcy5cbiogQHJldHVybnMgVGhlIGltcG9ydGVkIG1vZGVsIGNsYXNzIG9yIHVuZGVmaW5lZCBpZiBub3QgZm91bmRcbiovXG5hc3luYyBmdW5jdGlvbiBnZXRDaGF0TW9kZWxCeUNsYXNzTmFtZShjbGFzc05hbWUsIG1vZGVsUHJvdmlkZXIpIHtcblx0bGV0IGNvbmZpZztcblx0aWYgKG1vZGVsUHJvdmlkZXIpIGNvbmZpZyA9IE1PREVMX1BST1ZJREVSX0NPTkZJR1ttb2RlbFByb3ZpZGVyXTtcblx0ZWxzZSB7XG5cdFx0Y29uc3QgcHJvdmlkZXJFbnRyeSA9IE9iamVjdC5lbnRyaWVzKE1PREVMX1BST1ZJREVSX0NPTkZJRykuZmluZCgoWywgY10pID0+IGMuY2xhc3NOYW1lID09PSBjbGFzc05hbWUpO1xuXHRcdGNvbmZpZyA9IHByb3ZpZGVyRW50cnkgPyBwcm92aWRlckVudHJ5WzFdIDogdm9pZCAwO1xuXHR9XG5cdGlmICghY29uZmlnKSByZXR1cm47XG5cdHRyeSB7XG5cdFx0cmV0dXJuIChhd2FpdCBpbXBvcnQoY29uZmlnLnBhY2thZ2UpKVtjb25maWcuY2xhc3NOYW1lXTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGNvbnN0IGVyciA9IGU7XG5cdFx0aWYgKFwiY29kZVwiIGluIGVyciAmJiBlcnIuY29kZT8udG9TdHJpbmcoKS5pbmNsdWRlcyhcIkVSUl9NT0RVTEVfTk9UX0ZPVU5EXCIpICYmIFwibWVzc2FnZVwiIGluIGVyciAmJiB0eXBlb2YgZXJyLm1lc3NhZ2UgPT09IFwic3RyaW5nXCIpIHtcblx0XHRcdGNvbnN0IGF0dGVtcHRlZFBhY2thZ2UgPSAoZXJyLm1lc3NhZ2Uuc3RhcnRzV2l0aChcIkVycm9yOiBcIikgPyBlcnIubWVzc2FnZS5zbGljZSg3KSA6IGVyci5tZXNzYWdlKS5zcGxpdChcIkNhbm5vdCBmaW5kIHBhY2thZ2UgJ1wiKVsxXS5zcGxpdChcIidcIilbMF07XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFVuYWJsZSB0byBpbXBvcnQgJHthdHRlbXB0ZWRQYWNrYWdlfS4gUGxlYXNlIGluc3RhbGwgd2l0aCBcXGBucG0gaW5zdGFsbCAke2F0dGVtcHRlZFBhY2thZ2V9XFxgIG9yIFxcYHBucG0gaW5zdGFsbCAke2F0dGVtcHRlZFBhY2thZ2V9XFxgYCk7XG5cdFx0fVxuXHRcdHRocm93IGU7XG5cdH1cbn1cbmFzeW5jIGZ1bmN0aW9uIF9pbml0Q2hhdE1vZGVsSGVscGVyKG1vZGVsLCBtb2RlbFByb3ZpZGVyLCBwYXJhbXMgPSB7fSkge1xuXHRjb25zdCBtb2RlbFByb3ZpZGVyQ29weSA9IG1vZGVsUHJvdmlkZXIgfHwgX2luZmVyTW9kZWxQcm92aWRlcihtb2RlbCk7XG5cdGlmICghbW9kZWxQcm92aWRlckNvcHkpIHRocm93IG5ldyBFcnJvcihgVW5hYmxlIHRvIGluZmVyIG1vZGVsIHByb3ZpZGVyIGZvciB7IG1vZGVsOiAke21vZGVsfSB9LCBwbGVhc2Ugc3BlY2lmeSBtb2RlbFByb3ZpZGVyIGRpcmVjdGx5LmApO1xuXHRjb25zdCBjb25maWcgPSBNT0RFTF9QUk9WSURFUl9DT05GSUdbbW9kZWxQcm92aWRlckNvcHldO1xuXHRpZiAoIWNvbmZpZykge1xuXHRcdGNvbnN0IHN1cHBvcnRlZCA9IFNVUFBPUlRFRF9QUk9WSURFUlMuam9pbihcIiwgXCIpO1xuXHRcdHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgeyBtb2RlbFByb3ZpZGVyOiAke21vZGVsUHJvdmlkZXJDb3B5fSB9LlxcblxcblN1cHBvcnRlZCBtb2RlbCBwcm92aWRlcnMgYXJlOiAke3N1cHBvcnRlZH1gKTtcblx0fVxuXHRjb25zdCB7IG1vZGVsUHJvdmlkZXI6IF91bnVzZWQsIC4uLnBhc3NlZFBhcmFtcyB9ID0gcGFyYW1zO1xuXHRyZXR1cm4gbmV3IChhd2FpdCAoZ2V0Q2hhdE1vZGVsQnlDbGFzc05hbWUoY29uZmlnLmNsYXNzTmFtZSwgbW9kZWxQcm92aWRlckNvcHkpKSkoe1xuXHRcdG1vZGVsLFxuXHRcdC4uLnBhc3NlZFBhcmFtc1xuXHR9KTtcbn1cbi8qKlxuKiBBdHRlbXB0cyB0byBpbmZlciB0aGUgbW9kZWwgcHJvdmlkZXIgYmFzZWQgb24gdGhlIGdpdmVuIG1vZGVsIG5hbWUuXG4qXG4qIEBwYXJhbSB7c3RyaW5nfSBtb2RlbE5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgbW9kZWwgdG8gaW5mZXIgdGhlIHByb3ZpZGVyIGZvci5cbiogQHJldHVybnMge3N0cmluZyB8IHVuZGVmaW5lZH0gVGhlIGluZmVycmVkIG1vZGVsIHByb3ZpZGVyIG5hbWUsIG9yIHVuZGVmaW5lZCBpZiB1bmFibGUgdG8gaW5mZXIuXG4qXG4qIEBleGFtcGxlXG4qIF9pbmZlck1vZGVsUHJvdmlkZXIoXCJncHQtNFwiKTsgLy8gcmV0dXJucyBcIm9wZW5haVwiXG4qIF9pbmZlck1vZGVsUHJvdmlkZXIoXCJjbGF1ZGUtMlwiKTsgLy8gcmV0dXJucyBcImFudGhyb3BpY1wiXG4qIF9pbmZlck1vZGVsUHJvdmlkZXIoXCJ1bmtub3duLW1vZGVsXCIpOyAvLyByZXR1cm5zIHVuZGVmaW5lZFxuKi9cbmZ1bmN0aW9uIF9pbmZlck1vZGVsUHJvdmlkZXIobW9kZWxOYW1lKSB7XG5cdGlmIChtb2RlbE5hbWUuc3RhcnRzV2l0aChcImdwdC0zXCIpIHx8IG1vZGVsTmFtZS5zdGFydHNXaXRoKFwiZ3B0LTRcIikgfHwgbW9kZWxOYW1lLnN0YXJ0c1dpdGgoXCJncHQtNVwiKSB8fCBtb2RlbE5hbWUuc3RhcnRzV2l0aChcIm8xXCIpIHx8IG1vZGVsTmFtZS5zdGFydHNXaXRoKFwibzNcIikgfHwgbW9kZWxOYW1lLnN0YXJ0c1dpdGgoXCJvNFwiKSkgcmV0dXJuIFwib3BlbmFpXCI7XG5cdGVsc2UgaWYgKG1vZGVsTmFtZS5zdGFydHNXaXRoKFwiY2xhdWRlXCIpKSByZXR1cm4gXCJhbnRocm9waWNcIjtcblx0ZWxzZSBpZiAobW9kZWxOYW1lLnN0YXJ0c1dpdGgoXCJjb21tYW5kXCIpKSByZXR1cm4gXCJjb2hlcmVcIjtcblx0ZWxzZSBpZiAobW9kZWxOYW1lLnN0YXJ0c1dpdGgoXCJhY2NvdW50cy9maXJld29ya3NcIikpIHJldHVybiBcImZpcmV3b3Jrc1wiO1xuXHRlbHNlIGlmIChtb2RlbE5hbWUuc3RhcnRzV2l0aChcImdlbWluaVwiKSkgcmV0dXJuIFwiZ29vZ2xlLXZlcnRleGFpXCI7XG5cdGVsc2UgaWYgKG1vZGVsTmFtZS5zdGFydHNXaXRoKFwiYW1hem9uLlwiKSkgcmV0dXJuIFwiYmVkcm9ja1wiO1xuXHRlbHNlIGlmIChtb2RlbE5hbWUuc3RhcnRzV2l0aChcIm1pc3RyYWxcIikpIHJldHVybiBcIm1pc3RyYWxhaVwiO1xuXHRlbHNlIGlmIChtb2RlbE5hbWUuc3RhcnRzV2l0aChcInNvbmFyXCIpIHx8IG1vZGVsTmFtZS5zdGFydHNXaXRoKFwicHBseFwiKSkgcmV0dXJuIFwicGVycGxleGl0eVwiO1xuXHRlbHNlIHJldHVybjtcbn1cbi8qKlxuKiBJbnRlcm5hbCBjbGFzcyB1c2VkIHRvIGNyZWF0ZSBjaGF0IG1vZGVscy5cbipcbiogQGludGVybmFsXG4qL1xudmFyIENvbmZpZ3VyYWJsZU1vZGVsID0gY2xhc3MgQ29uZmlndXJhYmxlTW9kZWwgZXh0ZW5kcyBCYXNlQ2hhdE1vZGVsIHtcblx0X2xsbVR5cGUoKSB7XG5cdFx0cmV0dXJuIFwiY2hhdF9tb2RlbFwiO1xuXHR9XG5cdGxjX25hbWVzcGFjZSA9IFtcImxhbmdjaGFpblwiLCBcImNoYXRfbW9kZWxzXCJdO1xuXHRfZGVmYXVsdENvbmZpZyA9IHt9O1xuXHQvKipcblx0KiBAZGVmYXVsdCBcImFueVwiXG5cdCovXG5cdF9jb25maWd1cmFibGVGaWVsZHMgPSBcImFueVwiO1xuXHQvKipcblx0KiBAZGVmYXVsdCBcIlwiXG5cdCovXG5cdF9jb25maWdQcmVmaXg7XG5cdC8qKlxuXHQqIE1ldGhvZHMgd2hpY2ggc2hvdWxkIGJlIGNhbGxlZCBhZnRlciB0aGUgbW9kZWwgaXMgaW5pdGlhbGl6ZWQuXG5cdCogVGhlIGtleSB3aWxsIGJlIHRoZSBtZXRob2QgbmFtZSwgYW5kIHRoZSB2YWx1ZSB3aWxsIGJlIHRoZSBhcmd1bWVudHMuXG5cdCovXG5cdF9xdWV1ZWRNZXRob2RPcGVyYXRpb25zID0ge307XG5cdC8qKiBAaW50ZXJuYWwgKi9cblx0X21vZGVsSW5zdGFuY2VDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG5cdC8qKiBAaW50ZXJuYWwgKi9cblx0X3Byb2ZpbGU7XG5cdGNvbnN0cnVjdG9yKGZpZWxkcykge1xuXHRcdHN1cGVyKGZpZWxkcyk7XG5cdFx0dGhpcy5fZGVmYXVsdENvbmZpZyA9IGZpZWxkcy5kZWZhdWx0Q29uZmlnID8/IHt9O1xuXHRcdGlmIChmaWVsZHMuY29uZmlndXJhYmxlRmllbGRzID09PSBcImFueVwiKSB0aGlzLl9jb25maWd1cmFibGVGaWVsZHMgPSBcImFueVwiO1xuXHRcdGVsc2UgdGhpcy5fY29uZmlndXJhYmxlRmllbGRzID0gZmllbGRzLmNvbmZpZ3VyYWJsZUZpZWxkcyA/PyBbXCJtb2RlbFwiLCBcIm1vZGVsUHJvdmlkZXJcIl07XG5cdFx0aWYgKGZpZWxkcy5jb25maWdQcmVmaXgpIHRoaXMuX2NvbmZpZ1ByZWZpeCA9IGZpZWxkcy5jb25maWdQcmVmaXguZW5kc1dpdGgoXCJfXCIpID8gZmllbGRzLmNvbmZpZ1ByZWZpeCA6IGAke2ZpZWxkcy5jb25maWdQcmVmaXh9X2A7XG5cdFx0ZWxzZSB0aGlzLl9jb25maWdQcmVmaXggPSBcIlwiO1xuXHRcdHRoaXMuX3F1ZXVlZE1ldGhvZE9wZXJhdGlvbnMgPSBmaWVsZHMucXVldWVkTWV0aG9kT3BlcmF0aW9ucyA/PyB0aGlzLl9xdWV1ZWRNZXRob2RPcGVyYXRpb25zO1xuXHRcdHRoaXMuX3Byb2ZpbGUgPSBmaWVsZHMucHJvZmlsZSA/PyB2b2lkIDA7XG5cdH1cblx0YXN5bmMgX2dldE1vZGVsSW5zdGFuY2UoY29uZmlnKSB7XG5cdFx0Y29uc3QgY2FjaGVLZXkgPSB0aGlzLl9nZXRDYWNoZUtleShjb25maWcpO1xuXHRcdGNvbnN0IGNhY2hlZE1vZGVsID0gdGhpcy5fbW9kZWxJbnN0YW5jZUNhY2hlLmdldChjYWNoZUtleSk7XG5cdFx0aWYgKGNhY2hlZE1vZGVsKSByZXR1cm4gY2FjaGVkTW9kZWw7XG5cdFx0Y29uc3QgcGFyYW1zID0ge1xuXHRcdFx0Li4udGhpcy5fZGVmYXVsdENvbmZpZyxcblx0XHRcdC4uLnRoaXMuX21vZGVsUGFyYW1zKGNvbmZpZylcblx0XHR9O1xuXHRcdGxldCBpbml0aWFsaXplZE1vZGVsID0gYXdhaXQgX2luaXRDaGF0TW9kZWxIZWxwZXIocGFyYW1zLm1vZGVsLCBwYXJhbXMubW9kZWxQcm92aWRlciwgcGFyYW1zKTtcblx0XHRmb3IgKGNvbnN0IFttZXRob2QsIGFyZ3NdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuX3F1ZXVlZE1ldGhvZE9wZXJhdGlvbnMpKSBpZiAobWV0aG9kIGluIGluaXRpYWxpemVkTW9kZWwgJiYgdHlwZW9mIGluaXRpYWxpemVkTW9kZWxbbWV0aG9kXSA9PT0gXCJmdW5jdGlvblwiKSBpbml0aWFsaXplZE1vZGVsID0gYXdhaXQgaW5pdGlhbGl6ZWRNb2RlbFttZXRob2RdKC4uLmFyZ3MpO1xuXHRcdHRoaXMuX21vZGVsSW5zdGFuY2VDYWNoZS5zZXQoY2FjaGVLZXksIGluaXRpYWxpemVkTW9kZWwpO1xuXHRcdHJldHVybiBpbml0aWFsaXplZE1vZGVsO1xuXHR9XG5cdGFzeW5jIF9nZW5lcmF0ZShtZXNzYWdlcywgb3B0aW9ucywgcnVuTWFuYWdlcikge1xuXHRcdHJldHVybiAoYXdhaXQgdGhpcy5fZ2V0TW9kZWxJbnN0YW5jZShvcHRpb25zKSkuX2dlbmVyYXRlKG1lc3NhZ2VzLCBvcHRpb25zID8/IHt9LCBydW5NYW5hZ2VyKTtcblx0fVxuXHRiaW5kVG9vbHModG9vbHMsIHBhcmFtcykge1xuXHRcdGNvbnN0IG5ld1F1ZXVlZE9wZXJhdGlvbnMgPSB7IC4uLnRoaXMuX3F1ZXVlZE1ldGhvZE9wZXJhdGlvbnMgfTtcblx0XHRuZXdRdWV1ZWRPcGVyYXRpb25zLmJpbmRUb29scyA9IFt0b29scywgcGFyYW1zXTtcblx0XHRyZXR1cm4gbmV3IENvbmZpZ3VyYWJsZU1vZGVsKHtcblx0XHRcdGRlZmF1bHRDb25maWc6IHRoaXMuX2RlZmF1bHRDb25maWcsXG5cdFx0XHRjb25maWd1cmFibGVGaWVsZHM6IHRoaXMuX2NvbmZpZ3VyYWJsZUZpZWxkcyxcblx0XHRcdGNvbmZpZ1ByZWZpeDogdGhpcy5fY29uZmlnUHJlZml4LFxuXHRcdFx0cXVldWVkTWV0aG9kT3BlcmF0aW9uczogbmV3UXVldWVkT3BlcmF0aW9uc1xuXHRcdH0pO1xuXHR9XG5cdHdpdGhTdHJ1Y3R1cmVkT3V0cHV0ID0gKHNjaGVtYSwgLi4uYXJncykgPT4ge1xuXHRcdGNvbnN0IG5ld1F1ZXVlZE9wZXJhdGlvbnMgPSB7IC4uLnRoaXMuX3F1ZXVlZE1ldGhvZE9wZXJhdGlvbnMgfTtcblx0XHRuZXdRdWV1ZWRPcGVyYXRpb25zLndpdGhTdHJ1Y3R1cmVkT3V0cHV0ID0gW3NjaGVtYSwgLi4uYXJnc107XG5cdFx0cmV0dXJuIG5ldyBDb25maWd1cmFibGVNb2RlbCh7XG5cdFx0XHRkZWZhdWx0Q29uZmlnOiB0aGlzLl9kZWZhdWx0Q29uZmlnLFxuXHRcdFx0Y29uZmlndXJhYmxlRmllbGRzOiB0aGlzLl9jb25maWd1cmFibGVGaWVsZHMsXG5cdFx0XHRjb25maWdQcmVmaXg6IHRoaXMuX2NvbmZpZ1ByZWZpeCxcblx0XHRcdHF1ZXVlZE1ldGhvZE9wZXJhdGlvbnM6IG5ld1F1ZXVlZE9wZXJhdGlvbnNcblx0XHR9KTtcblx0fTtcblx0X21vZGVsUGFyYW1zKGNvbmZpZykge1xuXHRcdGNvbnN0IGNvbmZpZ3VyYWJsZSA9IGNvbmZpZz8uY29uZmlndXJhYmxlID8/IHt9O1xuXHRcdGxldCBtb2RlbFBhcmFtcyA9IHt9O1xuXHRcdGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGNvbmZpZ3VyYWJsZSkpIGlmIChrZXkuc3RhcnRzV2l0aCh0aGlzLl9jb25maWdQcmVmaXgpKSB7XG5cdFx0XHRjb25zdCBzdHJpcHBlZEtleSA9IHRoaXMuX3JlbW92ZVByZWZpeChrZXksIHRoaXMuX2NvbmZpZ1ByZWZpeCk7XG5cdFx0XHRtb2RlbFBhcmFtc1tzdHJpcHBlZEtleV0gPSB2YWx1ZTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuX2NvbmZpZ3VyYWJsZUZpZWxkcyAhPT0gXCJhbnlcIikgbW9kZWxQYXJhbXMgPSBPYmplY3QuZnJvbUVudHJpZXMoT2JqZWN0LmVudHJpZXMobW9kZWxQYXJhbXMpLmZpbHRlcigoW2tleV0pID0+IHRoaXMuX2NvbmZpZ3VyYWJsZUZpZWxkcy5pbmNsdWRlcyhrZXkpKSk7XG5cdFx0cmV0dXJuIG1vZGVsUGFyYW1zO1xuXHR9XG5cdF9yZW1vdmVQcmVmaXgoc3RyLCBwcmVmaXgpIHtcblx0XHRyZXR1cm4gc3RyLnN0YXJ0c1dpdGgocHJlZml4KSA/IHN0ci5zbGljZShwcmVmaXgubGVuZ3RoKSA6IHN0cjtcblx0fVxuXHQvKipcblx0KiBCaW5kIGNvbmZpZyB0byBhIFJ1bm5hYmxlLCByZXR1cm5pbmcgYSBuZXcgUnVubmFibGUuXG5cdCogQHBhcmFtIHtSdW5uYWJsZUNvbmZpZyB8IHVuZGVmaW5lZH0gW2NvbmZpZ10gLSBUaGUgY29uZmlnIHRvIGJpbmQuXG5cdCogQHJldHVybnMge1J1bm5hYmxlQmluZGluZzxSdW5JbnB1dCwgUnVuT3V0cHV0LCBDYWxsT3B0aW9ucz59IEEgbmV3IFJ1bm5hYmxlQmluZGluZyB3aXRoIHRoZSBib3VuZCBjb25maWcuXG5cdCovXG5cdHdpdGhDb25maWcoY29uZmlnKSB7XG5cdFx0Y29uc3QgbWVyZ2VkQ29uZmlnID0geyAuLi5jb25maWcgfHwge30gfTtcblx0XHRjb25zdCBtb2RlbFBhcmFtcyA9IHRoaXMuX21vZGVsUGFyYW1zKG1lcmdlZENvbmZpZyk7XG5cdFx0Y29uc3QgcmVtYWluaW5nQ29uZmlnID0gT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5lbnRyaWVzKG1lcmdlZENvbmZpZykuZmlsdGVyKChba10pID0+IGsgIT09IFwiY29uZmlndXJhYmxlXCIpKTtcblx0XHRyZW1haW5pbmdDb25maWcuY29uZmlndXJhYmxlID0gT2JqZWN0LmZyb21FbnRyaWVzKE9iamVjdC5lbnRyaWVzKG1lcmdlZENvbmZpZy5jb25maWd1cmFibGUgfHwge30pLmZpbHRlcigoW2tdKSA9PiB0aGlzLl9jb25maWdQcmVmaXggJiYgIU9iamVjdC5rZXlzKG1vZGVsUGFyYW1zKS5pbmNsdWRlcyh0aGlzLl9yZW1vdmVQcmVmaXgoaywgdGhpcy5fY29uZmlnUHJlZml4KSkpKTtcblx0XHRyZXR1cm4gbmV3IFJ1bm5hYmxlQmluZGluZyh7XG5cdFx0XHRjb25maWc6IG1lcmdlZENvbmZpZyxcblx0XHRcdGJvdW5kOiBuZXcgQ29uZmlndXJhYmxlTW9kZWwoe1xuXHRcdFx0XHRkZWZhdWx0Q29uZmlnOiB7XG5cdFx0XHRcdFx0Li4udGhpcy5fZGVmYXVsdENvbmZpZyxcblx0XHRcdFx0XHQuLi5tb2RlbFBhcmFtc1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRjb25maWd1cmFibGVGaWVsZHM6IEFycmF5LmlzQXJyYXkodGhpcy5fY29uZmlndXJhYmxlRmllbGRzKSA/IFsuLi50aGlzLl9jb25maWd1cmFibGVGaWVsZHNdIDogdGhpcy5fY29uZmlndXJhYmxlRmllbGRzLFxuXHRcdFx0XHRjb25maWdQcmVmaXg6IHRoaXMuX2NvbmZpZ1ByZWZpeCxcblx0XHRcdFx0cXVldWVkTWV0aG9kT3BlcmF0aW9uczogdGhpcy5fcXVldWVkTWV0aG9kT3BlcmF0aW9uc1xuXHRcdFx0fSlcblx0XHR9KTtcblx0fVxuXHRhc3luYyBpbnZva2UoaW5wdXQsIG9wdGlvbnMpIHtcblx0XHRjb25zdCBtb2RlbCA9IGF3YWl0IHRoaXMuX2dldE1vZGVsSW5zdGFuY2Uob3B0aW9ucyk7XG5cdFx0Y29uc3QgY29uZmlnID0gZW5zdXJlQ29uZmlnKG9wdGlvbnMpO1xuXHRcdHJldHVybiBtb2RlbC5pbnZva2UoaW5wdXQsIGNvbmZpZyk7XG5cdH1cblx0YXN5bmMgc3RyZWFtKGlucHV0LCBvcHRpb25zKSB7XG5cdFx0Y29uc3Qgd3JhcHBlZEdlbmVyYXRvciA9IG5ldyBBc3luY0dlbmVyYXRvcldpdGhTZXR1cCh7XG5cdFx0XHRnZW5lcmF0b3I6IGF3YWl0IChhd2FpdCB0aGlzLl9nZXRNb2RlbEluc3RhbmNlKG9wdGlvbnMpKS5zdHJlYW0oaW5wdXQsIG9wdGlvbnMpLFxuXHRcdFx0Y29uZmlnOiBvcHRpb25zXG5cdFx0fSk7XG5cdFx0YXdhaXQgd3JhcHBlZEdlbmVyYXRvci5zZXR1cDtcblx0XHRyZXR1cm4gSXRlcmFibGVSZWFkYWJsZVN0cmVhbS5mcm9tQXN5bmNHZW5lcmF0b3Iod3JhcHBlZEdlbmVyYXRvcik7XG5cdH1cblx0YXN5bmMgYmF0Y2goaW5wdXRzLCBvcHRpb25zLCBiYXRjaE9wdGlvbnMpIHtcblx0XHRyZXR1cm4gc3VwZXIuYmF0Y2goaW5wdXRzLCBvcHRpb25zLCBiYXRjaE9wdGlvbnMpO1xuXHR9XG5cdGFzeW5jICp0cmFuc2Zvcm0oZ2VuZXJhdG9yLCBvcHRpb25zKSB7XG5cdFx0Y29uc3QgbW9kZWwgPSBhd2FpdCB0aGlzLl9nZXRNb2RlbEluc3RhbmNlKG9wdGlvbnMpO1xuXHRcdGNvbnN0IGNvbmZpZyA9IGVuc3VyZUNvbmZpZyhvcHRpb25zKTtcblx0XHR5aWVsZCogbW9kZWwudHJhbnNmb3JtKGdlbmVyYXRvciwgY29uZmlnKTtcblx0fVxuXHRhc3luYyAqc3RyZWFtTG9nKGlucHV0LCBvcHRpb25zLCBzdHJlYW1PcHRpb25zKSB7XG5cdFx0Y29uc3QgbW9kZWwgPSBhd2FpdCB0aGlzLl9nZXRNb2RlbEluc3RhbmNlKG9wdGlvbnMpO1xuXHRcdGNvbnN0IGNvbmZpZyA9IGVuc3VyZUNvbmZpZyhvcHRpb25zKTtcblx0XHR5aWVsZCogbW9kZWwuc3RyZWFtTG9nKGlucHV0LCBjb25maWcsIHtcblx0XHRcdC4uLnN0cmVhbU9wdGlvbnMsXG5cdFx0XHRfc2NoZW1hRm9ybWF0OiBcIm9yaWdpbmFsXCIsXG5cdFx0XHRpbmNsdWRlTmFtZXM6IHN0cmVhbU9wdGlvbnM/LmluY2x1ZGVOYW1lcyxcblx0XHRcdGluY2x1ZGVUeXBlczogc3RyZWFtT3B0aW9ucz8uaW5jbHVkZVR5cGVzLFxuXHRcdFx0aW5jbHVkZVRhZ3M6IHN0cmVhbU9wdGlvbnM/LmluY2x1ZGVUYWdzLFxuXHRcdFx0ZXhjbHVkZU5hbWVzOiBzdHJlYW1PcHRpb25zPy5leGNsdWRlTmFtZXMsXG5cdFx0XHRleGNsdWRlVHlwZXM6IHN0cmVhbU9wdGlvbnM/LmV4Y2x1ZGVUeXBlcyxcblx0XHRcdGV4Y2x1ZGVUYWdzOiBzdHJlYW1PcHRpb25zPy5leGNsdWRlVGFnc1xuXHRcdH0pO1xuXHR9XG5cdHN0cmVhbUV2ZW50cyhpbnB1dCwgb3B0aW9ucywgc3RyZWFtT3B0aW9ucykge1xuXHRcdGNvbnN0IG91dGVyVGhpcyA9IHRoaXM7XG5cdFx0YXN5bmMgZnVuY3Rpb24qIHdyYXBwZWRHZW5lcmF0b3IoKSB7XG5cdFx0XHRjb25zdCBtb2RlbCA9IGF3YWl0IG91dGVyVGhpcy5fZ2V0TW9kZWxJbnN0YW5jZShvcHRpb25zKTtcblx0XHRcdGNvbnN0IGNvbmZpZyA9IGVuc3VyZUNvbmZpZyhvcHRpb25zKTtcblx0XHRcdGNvbnN0IGV2ZW50U3RyZWFtID0gbW9kZWwuc3RyZWFtRXZlbnRzKGlucHV0LCBjb25maWcsIHN0cmVhbU9wdGlvbnMpO1xuXHRcdFx0Zm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiBldmVudFN0cmVhbSkgeWllbGQgY2h1bms7XG5cdFx0fVxuXHRcdHJldHVybiBJdGVyYWJsZVJlYWRhYmxlU3RyZWFtLmZyb21Bc3luY0dlbmVyYXRvcih3cmFwcGVkR2VuZXJhdG9yKCkpO1xuXHR9XG5cdC8qKlxuXHQqIFJldHVybiBwcm9maWxpbmcgaW5mb3JtYXRpb24gZm9yIHRoZSBtb2RlbC5cblx0KlxuXHQqIEByZXR1cm5zIHtNb2RlbFByb2ZpbGV9IEFuIG9iamVjdCBkZXNjcmliaW5nIHRoZSBtb2RlbCdzIGNhcGFiaWxpdGllcyBhbmQgY29uc3RyYWludHNcblx0Ki9cblx0Z2V0IHByb2ZpbGUoKSB7XG5cdFx0aWYgKHRoaXMuX3Byb2ZpbGUpIHJldHVybiB0aGlzLl9wcm9maWxlO1xuXHRcdGNvbnN0IGNhY2hlS2V5ID0gdGhpcy5fZ2V0Q2FjaGVLZXkoe30pO1xuXHRcdHJldHVybiB0aGlzLl9tb2RlbEluc3RhbmNlQ2FjaGUuZ2V0KGNhY2hlS2V5KT8ucHJvZmlsZSA/PyB7fTtcblx0fVxuXHQvKiogQGludGVybmFsICovXG5cdF9nZXRDYWNoZUtleShjb25maWcpIHtcblx0XHRsZXQgdG9TdHJpbmdpZnkgPSBjb25maWcgPz8ge307XG5cdFx0aWYgKHRvU3RyaW5naWZ5LmNvbmZpZ3VyYWJsZSkge1xuXHRcdFx0Y29uc3QgeyBjb25maWd1cmFibGUgfSA9IHRvU3RyaW5naWZ5O1xuXHRcdFx0Y29uc3QgZmlsdGVyZWQgPSB7fTtcblx0XHRcdGZvciAoY29uc3QgW2ssIHZdIG9mIE9iamVjdC5lbnRyaWVzKGNvbmZpZ3VyYWJsZSkpIGlmICghay5zdGFydHNXaXRoKFwiX19wcmVnZWxfXCIpKSBmaWx0ZXJlZFtrXSA9IHY7XG5cdFx0XHR0b1N0cmluZ2lmeSA9IHtcblx0XHRcdFx0Li4udG9TdHJpbmdpZnksXG5cdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmlsdGVyZWRcblx0XHRcdH07XG5cdFx0fVxuXHRcdHJldHVybiBKU09OLnN0cmluZ2lmeSh0b1N0cmluZ2lmeSk7XG5cdH1cbn07XG4vKipcbiogSW5pdGlhbGl6ZSBhIENoYXRNb2RlbCBmcm9tIHRoZSBtb2RlbCBuYW1lIGFuZCBwcm92aWRlci5cbiogTXVzdCBoYXZlIHRoZSBpbnRlZ3JhdGlvbiBwYWNrYWdlIGNvcnJlc3BvbmRpbmcgdG8gdGhlIG1vZGVsIHByb3ZpZGVyIGluc3RhbGxlZC5cbipcbiogQHRlbXBsYXRlIHtleHRlbmRzIEJhc2VMYW5ndWFnZU1vZGVsSW5wdXQgPSBCYXNlTGFuZ3VhZ2VNb2RlbElucHV0fSBSdW5JbnB1dCAtIFRoZSBpbnB1dCB0eXBlIGZvciB0aGUgbW9kZWwuXG4qIEB0ZW1wbGF0ZSB7ZXh0ZW5kcyBDb25maWd1cmFibGVDaGF0TW9kZWxDYWxsT3B0aW9ucyA9IENvbmZpZ3VyYWJsZUNoYXRNb2RlbENhbGxPcHRpb25zfSBDYWxsT3B0aW9ucyAtIENhbGwgb3B0aW9ucyBmb3IgdGhlIG1vZGVsLlxuKlxuKiBAcGFyYW0ge3N0cmluZyB8IENoYXRNb2RlbFByb3ZpZGVyfSBbbW9kZWxdIC0gVGhlIG5hbWUgb2YgdGhlIG1vZGVsLCBlLmcuIFwiZ3B0LTRcIiwgXCJjbGF1ZGUtMy1vcHVzLTIwMjQwMjI5XCIuXG4qICAgQ2FuIGJlIHByZWZpeGVkIHdpdGggdGhlIG1vZGVsIHByb3ZpZGVyLCBlLmcuIFwib3BlbmFpOmdwdC00XCIsIFwiYW50aHJvcGljOmNsYXVkZS0zLW9wdXMtMjAyNDAyMjlcIi5cbiogQHBhcmFtIHtPYmplY3R9IFtmaWVsZHNdIC0gQWRkaXRpb25hbCBjb25maWd1cmF0aW9uIG9wdGlvbnMuXG4qIEBwYXJhbSB7c3RyaW5nfSBbZmllbGRzLm1vZGVsUHJvdmlkZXJdIC0gVGhlIG1vZGVsIHByb3ZpZGVyLiBTdXBwb3J0ZWQgdmFsdWVzIGluY2x1ZGU6XG4qICAgLSBvcGVuYWkgKEBsYW5nY2hhaW4vb3BlbmFpKVxuKiAgIC0gYW50aHJvcGljIChAbGFuZ2NoYWluL2FudGhyb3BpYylcbiogICAtIGF6dXJlX29wZW5haSAoQGxhbmdjaGFpbi9vcGVuYWkpXG4qICAgLSBnb29nbGUtdmVydGV4YWkgKEBsYW5nY2hhaW4vZ29vZ2xlLXZlcnRleGFpKVxuKiAgIC0gZ29vZ2xlLXZlcnRleGFpLXdlYiAoQGxhbmdjaGFpbi9nb29nbGUtdmVydGV4YWktd2ViKVxuKiAgIC0gZ29vZ2xlLWdlbmFpIChAbGFuZ2NoYWluL2dvb2dsZS1nZW5haSlcbiogICAtIGJlZHJvY2sgKEBsYW5nY2hhaW4vYXdzKVxuKiAgIC0gY29oZXJlIChAbGFuZ2NoYWluL2NvaGVyZSlcbiogICAtIGZpcmV3b3JrcyAoQGxhbmdjaGFpbi9jb21tdW5pdHkvY2hhdF9tb2RlbHMvZmlyZXdvcmtzKVxuKiAgIC0gdG9nZXRoZXIgKEBsYW5nY2hhaW4vY29tbXVuaXR5L2NoYXRfbW9kZWxzL3RvZ2V0aGVyYWkpXG4qICAgLSBtaXN0cmFsYWkgKEBsYW5nY2hhaW4vbWlzdHJhbGFpKVxuKiAgIC0gZ3JvcSAoQGxhbmdjaGFpbi9ncm9xKVxuKiAgIC0gb2xsYW1hIChAbGFuZ2NoYWluL29sbGFtYSlcbiogICAtIHBlcnBsZXhpdHkgKEBsYW5nY2hhaW4vY29tbXVuaXR5L2NoYXRfbW9kZWxzL3BlcnBsZXhpdHkpXG4qICAgLSBjZXJlYnJhcyAoQGxhbmdjaGFpbi9jZXJlYnJhcylcbiogICAtIGRlZXBzZWVrIChAbGFuZ2NoYWluL2RlZXBzZWVrKVxuKiAgIC0geGFpIChAbGFuZ2NoYWluL3hhaSlcbiogQHBhcmFtIHtzdHJpbmdbXSB8IFwiYW55XCJ9IFtmaWVsZHMuY29uZmlndXJhYmxlRmllbGRzXSAtIFdoaWNoIG1vZGVsIHBhcmFtZXRlcnMgYXJlIGNvbmZpZ3VyYWJsZTpcbiogICAtIHVuZGVmaW5lZDogTm8gY29uZmlndXJhYmxlIGZpZWxkcy5cbiogICAtIFwiYW55XCI6IEFsbCBmaWVsZHMgYXJlIGNvbmZpZ3VyYWJsZS4gKFNlZSBTZWN1cml0eSBOb3RlIGluIGRlc2NyaXB0aW9uKVxuKiAgIC0gc3RyaW5nW106IFNwZWNpZmllZCBmaWVsZHMgYXJlIGNvbmZpZ3VyYWJsZS5cbiogQHBhcmFtIHtzdHJpbmd9IFtmaWVsZHMuY29uZmlnUHJlZml4XSAtIFByZWZpeCBmb3IgY29uZmlndXJhYmxlIGZpZWxkcyBhdCBydW50aW1lLlxuKiBAcGFyYW0ge01vZGVsUHJvZmlsZX0gW2ZpZWxkcy5wcm9maWxlXSAtIE92ZXJyaWRlcyB0aGUgcHJvZmlsaW5nIGluZm9ybWF0aW9uIGZvciB0aGUgbW9kZWwuIElmIG5vdCBwcm92aWRlZCxcbiogICB0aGUgcHJvZmlsZSB3aWxsIGJlIGluZmVycmVkIGZyb20gdGhlIGlubmVyIG1vZGVsIGluc3RhbmNlLlxuKiBAcGFyYW0ge1JlY29yZDxzdHJpbmcsIGFueT59IFtmaWVsZHMucGFyYW1zXSAtIEFkZGl0aW9uYWwga2V5d29yZCBhcmdzIHRvIHBhc3MgdG8gdGhlIENoYXRNb2RlbCBjb25zdHJ1Y3Rvci5cbiogQHJldHVybnMge1Byb21pc2U8Q29uZmlndXJhYmxlTW9kZWw8UnVuSW5wdXQsIENhbGxPcHRpb25zPj59IEEgY2xhc3Mgd2hpY2ggZXh0ZW5kcyBCYXNlQ2hhdE1vZGVsLlxuKiBAdGhyb3dzIHtFcnJvcn0gSWYgbW9kZWxQcm92aWRlciBjYW5ub3QgYmUgaW5mZXJyZWQgb3IgaXNuJ3Qgc3VwcG9ydGVkLlxuKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIG1vZGVsIHByb3ZpZGVyIGludGVncmF0aW9uIHBhY2thZ2UgaXMgbm90IGluc3RhbGxlZC5cbipcbiogQGV4YW1wbGUgSW5pdGlhbGl6ZSBub24tY29uZmlndXJhYmxlIG1vZGVsc1xuKiBgYGB0eXBlc2NyaXB0XG4qIGltcG9ydCB7IGluaXRDaGF0TW9kZWwgfSBmcm9tIFwibGFuZ2NoYWluL2NoYXRfbW9kZWxzL3VuaXZlcnNhbFwiO1xuKlxuKiBjb25zdCBncHQ0ID0gYXdhaXQgaW5pdENoYXRNb2RlbChcIm9wZW5haTpncHQtNFwiLCB7XG4qICAgdGVtcGVyYXR1cmU6IDAuMjUsXG4qIH0pO1xuKiBjb25zdCBncHQ0UmVzdWx0ID0gYXdhaXQgZ3B0NC5pbnZva2UoXCJ3aGF0J3MgeW91ciBuYW1lXCIpO1xuKlxuKiBjb25zdCBjbGF1ZGUgPSBhd2FpdCBpbml0Q2hhdE1vZGVsKFwiYW50aHJvcGljOmNsYXVkZS0zLW9wdXMtMjAyNDAyMjlcIiwge1xuKiAgIHRlbXBlcmF0dXJlOiAwLjI1LFxuKiB9KTtcbiogY29uc3QgY2xhdWRlUmVzdWx0ID0gYXdhaXQgY2xhdWRlLmludm9rZShcIndoYXQncyB5b3VyIG5hbWVcIik7XG4qXG4qIGNvbnN0IGdlbWluaSA9IGF3YWl0IGluaXRDaGF0TW9kZWwoXCJnZW1pbmktMS41LXByb1wiLCB7XG4qICAgbW9kZWxQcm92aWRlcjogXCJnb29nbGUtdmVydGV4YWlcIixcbiogICB0ZW1wZXJhdHVyZTogMC4yNSxcbiogfSk7XG4qIGNvbnN0IGdlbWluaVJlc3VsdCA9IGF3YWl0IGdlbWluaS5pbnZva2UoXCJ3aGF0J3MgeW91ciBuYW1lXCIpO1xuKiBgYGBcbipcbiogQGV4YW1wbGUgQ3JlYXRlIGEgcGFydGlhbGx5IGNvbmZpZ3VyYWJsZSBtb2RlbCB3aXRoIG5vIGRlZmF1bHQgbW9kZWxcbiogYGBgdHlwZXNjcmlwdFxuKiBpbXBvcnQgeyBpbml0Q2hhdE1vZGVsIH0gZnJvbSBcImxhbmdjaGFpbi9jaGF0X21vZGVscy91bml2ZXJzYWxcIjtcbipcbiogY29uc3QgY29uZmlndXJhYmxlTW9kZWwgPSBhd2FpdCBpbml0Q2hhdE1vZGVsKHVuZGVmaW5lZCwge1xuKiAgIHRlbXBlcmF0dXJlOiAwLFxuKiAgIGNvbmZpZ3VyYWJsZUZpZWxkczogW1wibW9kZWxcIiwgXCJhcGlLZXlcIl0sXG4qIH0pO1xuKlxuKiBjb25zdCBncHQ0UmVzdWx0ID0gYXdhaXQgY29uZmlndXJhYmxlTW9kZWwuaW52b2tlKFwid2hhdCdzIHlvdXIgbmFtZVwiLCB7XG4qICAgY29uZmlndXJhYmxlOiB7XG4qICAgICBtb2RlbDogXCJncHQtNFwiLFxuKiAgIH0sXG4qIH0pO1xuKlxuKiBjb25zdCBjbGF1ZGVSZXN1bHQgPSBhd2FpdCBjb25maWd1cmFibGVNb2RlbC5pbnZva2UoXCJ3aGF0J3MgeW91ciBuYW1lXCIsIHtcbiogICBjb25maWd1cmFibGU6IHtcbiogICAgIG1vZGVsOiBcImNsYXVkZS1zb25uZXQtNC01LTIwMjUwOTI5XCIsXG4qICAgfSxcbiogfSk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBDcmVhdGUgYSBmdWxseSBjb25maWd1cmFibGUgbW9kZWwgd2l0aCBhIGRlZmF1bHQgbW9kZWwgYW5kIGEgY29uZmlnIHByZWZpeFxuKiBgYGB0eXBlc2NyaXB0XG4qIGltcG9ydCB7IGluaXRDaGF0TW9kZWwgfSBmcm9tIFwibGFuZ2NoYWluL2NoYXRfbW9kZWxzL3VuaXZlcnNhbFwiO1xuKlxuKiBjb25zdCBjb25maWd1cmFibGVNb2RlbFdpdGhEZWZhdWx0ID0gYXdhaXQgaW5pdENoYXRNb2RlbChcImdwdC00XCIsIHtcbiogICBtb2RlbFByb3ZpZGVyOiBcIm9wZW5haVwiLFxuKiAgIGNvbmZpZ3VyYWJsZUZpZWxkczogXCJhbnlcIixcbiogICBjb25maWdQcmVmaXg6IFwiZm9vXCIsXG4qICAgdGVtcGVyYXR1cmU6IDAsXG4qIH0pO1xuKlxuKiBjb25zdCBvcGVuYWlSZXN1bHQgPSBhd2FpdCBjb25maWd1cmFibGVNb2RlbFdpdGhEZWZhdWx0Lmludm9rZShcbiogICBcIndoYXQncyB5b3VyIG5hbWVcIixcbiogICB7XG4qICAgICBjb25maWd1cmFibGU6IHtcbiogICAgICAgZm9vX2FwaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVksXG4qICAgICB9LFxuKiAgIH1cbiogKTtcbipcbiogY29uc3QgY2xhdWRlUmVzdWx0ID0gYXdhaXQgY29uZmlndXJhYmxlTW9kZWxXaXRoRGVmYXVsdC5pbnZva2UoXG4qICAgXCJ3aGF0J3MgeW91ciBuYW1lXCIsXG4qICAge1xuKiAgICAgY29uZmlndXJhYmxlOiB7XG4qICAgICAgIGZvb19tb2RlbDogXCJjbGF1ZGUtc29ubmV0LTQtNS0yMDI1MDkyOVwiLFxuKiAgICAgICBmb29fbW9kZWxQcm92aWRlcjogXCJhbnRocm9waWNcIixcbiogICAgICAgZm9vX3RlbXBlcmF0dXJlOiAwLjYsXG4qICAgICAgIGZvb19hcGlLZXk6IHByb2Nlc3MuZW52LkFOVEhST1BJQ19BUElfS0VZLFxuKiAgICAgfSxcbiogICB9XG4qICk7XG4qIGBgYFxuKlxuKiBAZXhhbXBsZSBCaW5kIHRvb2xzIHRvIGEgY29uZmlndXJhYmxlIG1vZGVsOlxuKiBgYGB0eXBlc2NyaXB0XG4qIGltcG9ydCB7IGluaXRDaGF0TW9kZWwgfSBmcm9tIFwibGFuZ2NoYWluL2NoYXRfbW9kZWxzL3VuaXZlcnNhbFwiO1xuKiBpbXBvcnQgeyB6IH0gZnJvbSBcInpvZC92M1wiO1xuKiBpbXBvcnQgeyB0b29sIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS90b29sc1wiO1xuKlxuKiBjb25zdCBnZXRXZWF0aGVyVG9vbCA9IHRvb2woXG4qICAgKGlucHV0KSA9PiB7XG4qICAgICAvLyBEbyBzb21ldGhpbmcgd2l0aCB0aGUgaW5wdXRcbiogICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShpbnB1dCk7XG4qICAgfSxcbiogICB7XG4qICAgICBzY2hlbWE6IHpcbiogICAgICAgLm9iamVjdCh7XG4qICAgICAgICAgbG9jYXRpb246IHpcbiogICAgICAgICAgIC5zdHJpbmcoKVxuKiAgICAgICAgICAgLmRlc2NyaWJlKFwiVGhlIGNpdHkgYW5kIHN0YXRlLCBlLmcuIFNhbiBGcmFuY2lzY28sIENBXCIpLFxuKiAgICAgICB9KVxuKiAgICAgICAuZGVzY3JpYmUoXCJHZXQgdGhlIGN1cnJlbnQgd2VhdGhlciBpbiBhIGdpdmVuIGxvY2F0aW9uXCIpLFxuKiAgICAgbmFtZTogXCJHZXRXZWF0aGVyXCIsXG4qICAgICBkZXNjcmlwdGlvbjogXCJHZXQgdGhlIGN1cnJlbnQgd2VhdGhlciBpbiBhIGdpdmVuIGxvY2F0aW9uXCIsXG4qICAgfVxuKiApO1xuKlxuKiBjb25zdCBnZXRQb3B1bGF0aW9uVG9vbCA9IHRvb2woXG4qICAgKGlucHV0KSA9PiB7XG4qICAgICAvLyBEbyBzb21ldGhpbmcgd2l0aCB0aGUgaW5wdXRcbiogICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShpbnB1dCk7XG4qICAgfSxcbiogICB7XG4qICAgICBzY2hlbWE6IHpcbiogICAgICAgLm9iamVjdCh7XG4qICAgICAgICAgbG9jYXRpb246IHpcbiogICAgICAgICAgIC5zdHJpbmcoKVxuKiAgICAgICAgICAgLmRlc2NyaWJlKFwiVGhlIGNpdHkgYW5kIHN0YXRlLCBlLmcuIFNhbiBGcmFuY2lzY28sIENBXCIpLFxuKiAgICAgICB9KVxuKiAgICAgICAuZGVzY3JpYmUoXCJHZXQgdGhlIGN1cnJlbnQgcG9wdWxhdGlvbiBpbiBhIGdpdmVuIGxvY2F0aW9uXCIpLFxuKiAgICAgbmFtZTogXCJHZXRQb3B1bGF0aW9uXCIsXG4qICAgICBkZXNjcmlwdGlvbjogXCJHZXQgdGhlIGN1cnJlbnQgcG9wdWxhdGlvbiBpbiBhIGdpdmVuIGxvY2F0aW9uXCIsXG4qICAgfVxuKiApO1xuKlxuKiBjb25zdCBjb25maWd1cmFibGVNb2RlbCA9IGF3YWl0IGluaXRDaGF0TW9kZWwoXCJncHQtNFwiLCB7XG4qICAgY29uZmlndXJhYmxlRmllbGRzOiBbXCJtb2RlbFwiLCBcIm1vZGVsUHJvdmlkZXJcIiwgXCJhcGlLZXlcIl0sXG4qICAgdGVtcGVyYXR1cmU6IDAsXG4qIH0pO1xuKlxuKiBjb25zdCBjb25maWd1cmFibGVNb2RlbFdpdGhUb29scyA9IGNvbmZpZ3VyYWJsZU1vZGVsLmJpbmRUb29scyhbXG4qICAgZ2V0V2VhdGhlclRvb2wsXG4qICAgZ2V0UG9wdWxhdGlvblRvb2wsXG4qIF0pO1xuKlxuKiBjb25zdCBjb25maWd1cmFibGVUb29sUmVzdWx0ID0gYXdhaXQgY29uZmlndXJhYmxlTW9kZWxXaXRoVG9vbHMuaW52b2tlKFxuKiAgIFwiV2hpY2ggY2l0eSBpcyBob3R0ZXIgdG9kYXkgYW5kIHdoaWNoIGlzIGJpZ2dlcjogTEEgb3IgTlk/XCIsXG4qICAge1xuKiAgICAgY29uZmlndXJhYmxlOiB7XG4qICAgICAgIGFwaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVksXG4qICAgICB9LFxuKiAgIH1cbiogKTtcbipcbiogY29uc3QgY29uZmlndXJhYmxlVG9vbFJlc3VsdDIgPSBhd2FpdCBjb25maWd1cmFibGVNb2RlbFdpdGhUb29scy5pbnZva2UoXG4qICAgXCJXaGljaCBjaXR5IGlzIGhvdHRlciB0b2RheSBhbmQgd2hpY2ggaXMgYmlnZ2VyOiBMQSBvciBOWT9cIixcbiogICB7XG4qICAgICBjb25maWd1cmFibGU6IHtcbiogICAgICAgbW9kZWw6IFwiY2xhdWRlLXNvbm5ldC00LTUtMjAyNTA5MjlcIixcbiogICAgICAgYXBpS2V5OiBwcm9jZXNzLmVudi5BTlRIUk9QSUNfQVBJX0tFWSxcbiogICAgIH0sXG4qICAgfVxuKiApO1xuKiBgYGBcbipcbiogQGV4YW1wbGUgSW5pdGlhbGl6ZSBhIG1vZGVsIHdpdGggYSBjdXN0b20gcHJvZmlsZVxuKiBgYGB0eXBlc2NyaXB0XG4qIGltcG9ydCB7IGluaXRDaGF0TW9kZWwgfSBmcm9tIFwibGFuZ2NoYWluL2NoYXRfbW9kZWxzL3VuaXZlcnNhbFwiO1xuKlxuKiBjb25zdCBtb2RlbCA9IGF3YWl0IGluaXRDaGF0TW9kZWwoXCJncHQtNG8tbWluaVwiLCB7XG4qICAgcHJvZmlsZToge1xuKiAgICAgbWF4SW5wdXRUb2tlbnM6IDEwMDAwMCxcbiogICB9LFxuKiB9KTtcbipcbiogQGRlc2NyaXB0aW9uXG4qIFRoaXMgZnVuY3Rpb24gaW5pdGlhbGl6ZXMgYSBDaGF0TW9kZWwgYmFzZWQgb24gdGhlIHByb3ZpZGVkIG1vZGVsIG5hbWUgYW5kIHByb3ZpZGVyLlxuKiBJdCBzdXBwb3J0cyB2YXJpb3VzIG1vZGVsIHByb3ZpZGVycyBhbmQgYWxsb3dzIGZvciBydW50aW1lIGNvbmZpZ3VyYXRpb24gb2YgbW9kZWwgcGFyYW1ldGVycy5cbipcbiogU2VjdXJpdHkgTm90ZTogU2V0dGluZyBgY29uZmlndXJhYmxlRmllbGRzYCB0byBcImFueVwiIG1lYW5zIGZpZWxkcyBsaWtlIGFwaUtleSwgYmFzZVVybCwgZXRjLlxuKiBjYW4gYmUgYWx0ZXJlZCBhdCBydW50aW1lLCBwb3RlbnRpYWxseSByZWRpcmVjdGluZyBtb2RlbCByZXF1ZXN0cyB0byBhIGRpZmZlcmVudCBzZXJ2aWNlL3VzZXIuXG4qIE1ha2Ugc3VyZSB0aGF0IGlmIHlvdSdyZSBhY2NlcHRpbmcgdW50cnVzdGVkIGNvbmZpZ3VyYXRpb25zLCB5b3UgZW51bWVyYXRlIHRoZVxuKiBgY29uZmlndXJhYmxlRmllbGRzYCBleHBsaWNpdGx5LlxuKlxuKiBUaGUgZnVuY3Rpb24gd2lsbCBhdHRlbXB0IHRvIGluZmVyIHRoZSBtb2RlbCBwcm92aWRlciBmcm9tIHRoZSBtb2RlbCBuYW1lIGlmIG5vdCBzcGVjaWZpZWQuXG4qIENlcnRhaW4gbW9kZWwgbmFtZSBwcmVmaXhlcyBhcmUgYXNzb2NpYXRlZCB3aXRoIHNwZWNpZmljIHByb3ZpZGVyczpcbiogLSBncHQtMy4uLiBvciBncHQtNC4uLiAtPiBvcGVuYWlcbiogLSBjbGF1ZGUuLi4gLT4gYW50aHJvcGljXG4qIC0gYW1hem9uLi4uLiAtPiBiZWRyb2NrXG4qIC0gZ2VtaW5pLi4uIC0+IGdvb2dsZS12ZXJ0ZXhhaVxuKiAtIGNvbW1hbmQuLi4gLT4gY29oZXJlXG4qIC0gYWNjb3VudHMvZmlyZXdvcmtzLi4uIC0+IGZpcmV3b3Jrc1xuKlxuKiBAc2luY2UgMC4yLjExXG4qIEB2ZXJzaW9uIDAuMi4xMVxuKi9cbmFzeW5jIGZ1bmN0aW9uIGluaXRDaGF0TW9kZWwobW9kZWwsIGZpZWxkcykge1xuXHRsZXQgeyBjb25maWd1cmFibGVGaWVsZHMsIGNvbmZpZ1ByZWZpeCwgbW9kZWxQcm92aWRlciwgcHJvZmlsZSwgLi4ucGFyYW1zIH0gPSB7XG5cdFx0Y29uZmlnUHJlZml4OiBcIlwiLFxuXHRcdC4uLmZpZWxkcyA/PyB7fVxuXHR9O1xuXHRpZiAobW9kZWxQcm92aWRlciA9PT0gdm9pZCAwICYmIG1vZGVsPy5pbmNsdWRlcyhcIjpcIikpIHtcblx0XHRjb25zdCBbcHJvdmlkZXIsIC4uLnJlbWFpbmluZ1BhcnRzXSA9IG1vZGVsLnNwbGl0KFwiOlwiKTtcblx0XHRjb25zdCBtb2RlbENvbXBvbmVudHMgPSByZW1haW5pbmdQYXJ0cy5sZW5ndGggPT09IDAgPyBbcHJvdmlkZXJdIDogW3Byb3ZpZGVyLCByZW1haW5pbmdQYXJ0cy5qb2luKFwiOlwiKV07XG5cdFx0aWYgKFNVUFBPUlRFRF9QUk9WSURFUlMuaW5jbHVkZXMobW9kZWxDb21wb25lbnRzWzBdKSkgW21vZGVsUHJvdmlkZXIsIG1vZGVsXSA9IG1vZGVsQ29tcG9uZW50cztcblx0fVxuXHRsZXQgY29uZmlndXJhYmxlRmllbGRzQ29weSA9IEFycmF5LmlzQXJyYXkoY29uZmlndXJhYmxlRmllbGRzKSA/IFsuLi5jb25maWd1cmFibGVGaWVsZHNdIDogY29uZmlndXJhYmxlRmllbGRzO1xuXHRpZiAoIW1vZGVsICYmIGNvbmZpZ3VyYWJsZUZpZWxkc0NvcHkgPT09IHZvaWQgMCkgY29uZmlndXJhYmxlRmllbGRzQ29weSA9IFtcIm1vZGVsXCIsIFwibW9kZWxQcm92aWRlclwiXTtcblx0aWYgKGNvbmZpZ1ByZWZpeCAmJiBjb25maWd1cmFibGVGaWVsZHNDb3B5ID09PSB2b2lkIDApIGNvbnNvbGUud2FybihgeyBjb25maWdQcmVmaXg6ICR7Y29uZmlnUHJlZml4fSB9IGhhcyBiZWVuIHNldCBidXQgbm8gZmllbGRzIGFyZSBjb25maWd1cmFibGUuIFNldCB7IGNvbmZpZ3VyYWJsZUZpZWxkczogWy4uLl0gfSB0byBzcGVjaWZ5IHRoZSBtb2RlbCBwYXJhbXMgdGhhdCBhcmUgY29uZmlndXJhYmxlLmApO1xuXHRjb25zdCBwYXJhbXNDb3B5ID0geyAuLi5wYXJhbXMgfTtcblx0bGV0IGNvbmZpZ3VyYWJsZU1vZGVsO1xuXHRpZiAoY29uZmlndXJhYmxlRmllbGRzQ29weSA9PT0gdm9pZCAwKSBjb25maWd1cmFibGVNb2RlbCA9IG5ldyBDb25maWd1cmFibGVNb2RlbCh7XG5cdFx0ZGVmYXVsdENvbmZpZzoge1xuXHRcdFx0Li4ucGFyYW1zQ29weSxcblx0XHRcdG1vZGVsLFxuXHRcdFx0bW9kZWxQcm92aWRlclxuXHRcdH0sXG5cdFx0Y29uZmlnUHJlZml4LFxuXHRcdHByb2ZpbGVcblx0fSk7XG5cdGVsc2Uge1xuXHRcdGlmIChtb2RlbCkgcGFyYW1zQ29weS5tb2RlbCA9IG1vZGVsO1xuXHRcdGlmIChtb2RlbFByb3ZpZGVyKSBwYXJhbXNDb3B5Lm1vZGVsUHJvdmlkZXIgPSBtb2RlbFByb3ZpZGVyO1xuXHRcdGNvbmZpZ3VyYWJsZU1vZGVsID0gbmV3IENvbmZpZ3VyYWJsZU1vZGVsKHtcblx0XHRcdGRlZmF1bHRDb25maWc6IHBhcmFtc0NvcHksXG5cdFx0XHRjb25maWdQcmVmaXgsXG5cdFx0XHRjb25maWd1cmFibGVGaWVsZHM6IGNvbmZpZ3VyYWJsZUZpZWxkc0NvcHksXG5cdFx0XHRwcm9maWxlXG5cdFx0fSk7XG5cdH1cblx0YXdhaXQgY29uZmlndXJhYmxlTW9kZWwuX2dldE1vZGVsSW5zdGFuY2UoKTtcblx0cmV0dXJuIGNvbmZpZ3VyYWJsZU1vZGVsO1xufVxuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IENvbmZpZ3VyYWJsZU1vZGVsLCBNT0RFTF9QUk9WSURFUl9DT05GSUcsIF9pbmZlck1vZGVsUHJvdmlkZXIsIGdldENoYXRNb2RlbEJ5Q2xhc3NOYW1lLCBpbml0Q2hhdE1vZGVsLCB1bml2ZXJzYWxfZXhwb3J0cyB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dW5pdmVyc2FsLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js":
/*!******************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js ***!
  \******************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AIMessage: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.AIMessage),\n/* harmony export */   AIMessageChunk: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.AIMessageChunk),\n/* harmony export */   BaseMessage: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.BaseMessage),\n/* harmony export */   BaseMessageChunk: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.BaseMessageChunk),\n/* harmony export */   ClearToolUsesEdit: () => (/* reexport safe */ _agents_middleware_contextEditing_js__WEBPACK_IMPORTED_MODULE_15__.ClearToolUsesEdit),\n/* harmony export */   Document: () => (/* reexport safe */ _langchain_core_documents__WEBPACK_IMPORTED_MODULE_30__.Document),\n/* harmony export */   DynamicStructuredTool: () => (/* reexport safe */ _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.DynamicStructuredTool),\n/* harmony export */   DynamicTool: () => (/* reexport safe */ _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.DynamicTool),\n/* harmony export */   FakeToolCallingModel: () => (/* reexport safe */ _agents_tests_utils_js__WEBPACK_IMPORTED_MODULE_7__.FakeToolCallingModel),\n/* harmony export */   HumanMessage: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.HumanMessage),\n/* harmony export */   HumanMessageChunk: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.HumanMessageChunk),\n/* harmony export */   InMemoryStore: () => (/* reexport safe */ _langchain_core_stores__WEBPACK_IMPORTED_MODULE_29__.InMemoryStore),\n/* harmony export */   MIDDLEWARE_BRAND: () => (/* reexport safe */ _agents_middleware_types_js__WEBPACK_IMPORTED_MODULE_5__.MIDDLEWARE_BRAND),\n/* harmony export */   MiddlewareError: () => (/* reexport safe */ _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.MiddlewareError),\n/* harmony export */   MultipleStructuredOutputsError: () => (/* reexport safe */ _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.MultipleStructuredOutputsError),\n/* harmony export */   MultipleToolsBoundError: () => (/* reexport safe */ _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.MultipleToolsBoundError),\n/* harmony export */   PIIDetectionError: () => (/* reexport safe */ _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.PIIDetectionError),\n/* harmony export */   ProviderStrategy: () => (/* reexport safe */ _agents_responses_js__WEBPACK_IMPORTED_MODULE_3__.ProviderStrategy),\n/* harmony export */   StructuredOutputParsingError: () => (/* reexport safe */ _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.StructuredOutputParsingError),\n/* harmony export */   StructuredTool: () => (/* reexport safe */ _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.StructuredTool),\n/* harmony export */   SystemMessage: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.SystemMessage),\n/* harmony export */   SystemMessageChunk: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.SystemMessageChunk),\n/* harmony export */   TODO_LIST_MIDDLEWARE_SYSTEM_PROMPT: () => (/* reexport safe */ _agents_middleware_todoListMiddleware_js__WEBPACK_IMPORTED_MODULE_17__.TODO_LIST_MIDDLEWARE_SYSTEM_PROMPT),\n/* harmony export */   Tool: () => (/* reexport safe */ _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.Tool),\n/* harmony export */   ToolCallLimitExceededError: () => (/* reexport safe */ _agents_middleware_toolCallLimit_js__WEBPACK_IMPORTED_MODULE_16__.ToolCallLimitExceededError),\n/* harmony export */   ToolInvocationError: () => (/* reexport safe */ _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.ToolInvocationError),\n/* harmony export */   ToolMessage: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.ToolMessage),\n/* harmony export */   ToolMessageChunk: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.ToolMessageChunk),\n/* harmony export */   ToolStrategy: () => (/* reexport safe */ _agents_responses_js__WEBPACK_IMPORTED_MODULE_3__.ToolStrategy),\n/* harmony export */   anthropicPromptCachingMiddleware: () => (/* reexport safe */ _agents_middleware_provider_anthropic_promptCaching_js__WEBPACK_IMPORTED_MODULE_24__.anthropicPromptCachingMiddleware),\n/* harmony export */   applyStrategy: () => (/* reexport safe */ _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.applyStrategy),\n/* harmony export */   context: () => (/* reexport safe */ _langchain_core_utils_context__WEBPACK_IMPORTED_MODULE_28__.context),\n/* harmony export */   contextEditingMiddleware: () => (/* reexport safe */ _agents_middleware_contextEditing_js__WEBPACK_IMPORTED_MODULE_15__.contextEditingMiddleware),\n/* harmony export */   countTokensApproximately: () => (/* reexport safe */ _agents_middleware_utils_js__WEBPACK_IMPORTED_MODULE_4__.countTokensApproximately),\n/* harmony export */   createAgent: () => (/* reexport safe */ _agents_index_js__WEBPACK_IMPORTED_MODULE_8__.createAgent),\n/* harmony export */   createMiddleware: () => (/* reexport safe */ _agents_middleware_js__WEBPACK_IMPORTED_MODULE_6__.createMiddleware),\n/* harmony export */   detectCreditCard: () => (/* reexport safe */ _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectCreditCard),\n/* harmony export */   detectEmail: () => (/* reexport safe */ _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectEmail),\n/* harmony export */   detectIP: () => (/* reexport safe */ _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectIP),\n/* harmony export */   detectMacAddress: () => (/* reexport safe */ _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectMacAddress),\n/* harmony export */   detectUrl: () => (/* reexport safe */ _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectUrl),\n/* harmony export */   dynamicSystemPromptMiddleware: () => (/* reexport safe */ _agents_middleware_dynamicSystemPrompt_js__WEBPACK_IMPORTED_MODULE_11__.dynamicSystemPromptMiddleware),\n/* harmony export */   filterMessages: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.filterMessages),\n/* harmony export */   humanInTheLoopMiddleware: () => (/* reexport safe */ _agents_middleware_hitl_js__WEBPACK_IMPORTED_MODULE_9__.humanInTheLoopMiddleware),\n/* harmony export */   initChatModel: () => (/* reexport safe */ _chat_models_universal_js__WEBPACK_IMPORTED_MODULE_1__.initChatModel),\n/* harmony export */   llmToolSelectorMiddleware: () => (/* reexport safe */ _agents_middleware_llmToolSelector_js__WEBPACK_IMPORTED_MODULE_12__.llmToolSelectorMiddleware),\n/* harmony export */   modelCallLimitMiddleware: () => (/* reexport safe */ _agents_middleware_modelCallLimit_js__WEBPACK_IMPORTED_MODULE_18__.modelCallLimitMiddleware),\n/* harmony export */   modelFallbackMiddleware: () => (/* reexport safe */ _agents_middleware_modelFallback_js__WEBPACK_IMPORTED_MODULE_19__.modelFallbackMiddleware),\n/* harmony export */   modelRetryMiddleware: () => (/* reexport safe */ _agents_middleware_modelRetry_js__WEBPACK_IMPORTED_MODULE_20__.modelRetryMiddleware),\n/* harmony export */   openAIModerationMiddleware: () => (/* reexport safe */ _agents_middleware_provider_openai_moderation_js__WEBPACK_IMPORTED_MODULE_23__.openAIModerationMiddleware),\n/* harmony export */   piiMiddleware: () => (/* reexport safe */ _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.piiMiddleware),\n/* harmony export */   piiRedactionMiddleware: () => (/* reexport safe */ _agents_middleware_piiRedaction_js__WEBPACK_IMPORTED_MODULE_14__.piiRedactionMiddleware),\n/* harmony export */   providerStrategy: () => (/* reexport safe */ _agents_responses_js__WEBPACK_IMPORTED_MODULE_3__.providerStrategy),\n/* harmony export */   resolveRedactionRule: () => (/* reexport safe */ _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.resolveRedactionRule),\n/* harmony export */   src_exports: () => (/* binding */ src_exports),\n/* harmony export */   summarizationMiddleware: () => (/* reexport safe */ _agents_middleware_summarization_js__WEBPACK_IMPORTED_MODULE_10__.summarizationMiddleware),\n/* harmony export */   todoListMiddleware: () => (/* reexport safe */ _agents_middleware_todoListMiddleware_js__WEBPACK_IMPORTED_MODULE_17__.todoListMiddleware),\n/* harmony export */   tool: () => (/* reexport safe */ _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.tool),\n/* harmony export */   toolCallLimitMiddleware: () => (/* reexport safe */ _agents_middleware_toolCallLimit_js__WEBPACK_IMPORTED_MODULE_16__.toolCallLimitMiddleware),\n/* harmony export */   toolEmulatorMiddleware: () => (/* reexport safe */ _agents_middleware_toolEmulator_js__WEBPACK_IMPORTED_MODULE_22__.toolEmulatorMiddleware),\n/* harmony export */   toolRetryMiddleware: () => (/* reexport safe */ _agents_middleware_toolRetry_js__WEBPACK_IMPORTED_MODULE_21__.toolRetryMiddleware),\n/* harmony export */   toolStrategy: () => (/* reexport safe */ _agents_responses_js__WEBPACK_IMPORTED_MODULE_3__.toolStrategy),\n/* harmony export */   trimMessages: () => (/* reexport safe */ _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.trimMessages)\n/* harmony export */ });\n/* harmony import */ var _virtual_rolldown_runtime_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_virtual/_rolldown/runtime.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/_virtual/_rolldown/runtime.js\");\n/* harmony import */ var _chat_models_universal_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chat_models/universal.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/chat_models/universal.js\");\n/* harmony import */ var _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./agents/errors.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/errors.js\");\n/* harmony import */ var _agents_responses_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./agents/responses.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/responses.js\");\n/* harmony import */ var _agents_middleware_utils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./agents/middleware/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/utils.js\");\n/* harmony import */ var _agents_middleware_types_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./agents/middleware/types.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/types.js\");\n/* harmony import */ var _agents_middleware_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./agents/middleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware.js\");\n/* harmony import */ var _agents_tests_utils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./agents/tests/utils.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/tests/utils.js\");\n/* harmony import */ var _agents_index_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./agents/index.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/index.js\");\n/* harmony import */ var _agents_middleware_hitl_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./agents/middleware/hitl.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/hitl.js\");\n/* harmony import */ var _agents_middleware_summarization_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./agents/middleware/summarization.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/summarization.js\");\n/* harmony import */ var _agents_middleware_dynamicSystemPrompt_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./agents/middleware/dynamicSystemPrompt.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/dynamicSystemPrompt.js\");\n/* harmony import */ var _agents_middleware_llmToolSelector_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./agents/middleware/llmToolSelector.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/llmToolSelector.js\");\n/* harmony import */ var _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./agents/middleware/pii.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/pii.js\");\n/* harmony import */ var _agents_middleware_piiRedaction_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./agents/middleware/piiRedaction.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/piiRedaction.js\");\n/* harmony import */ var _agents_middleware_contextEditing_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./agents/middleware/contextEditing.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/contextEditing.js\");\n/* harmony import */ var _agents_middleware_toolCallLimit_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./agents/middleware/toolCallLimit.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolCallLimit.js\");\n/* harmony import */ var _agents_middleware_todoListMiddleware_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./agents/middleware/todoListMiddleware.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/todoListMiddleware.js\");\n/* harmony import */ var _agents_middleware_modelCallLimit_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./agents/middleware/modelCallLimit.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelCallLimit.js\");\n/* harmony import */ var _agents_middleware_modelFallback_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./agents/middleware/modelFallback.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelFallback.js\");\n/* harmony import */ var _agents_middleware_modelRetry_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./agents/middleware/modelRetry.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/modelRetry.js\");\n/* harmony import */ var _agents_middleware_toolRetry_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./agents/middleware/toolRetry.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolRetry.js\");\n/* harmony import */ var _agents_middleware_toolEmulator_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./agents/middleware/toolEmulator.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/toolEmulator.js\");\n/* harmony import */ var _agents_middleware_provider_openai_moderation_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./agents/middleware/provider/openai/moderation.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/openai/moderation.js\");\n/* harmony import */ var _agents_middleware_provider_anthropic_promptCaching_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./agents/middleware/provider/anthropic/promptCaching.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/provider/anthropic/promptCaching.js\");\n/* harmony import */ var _agents_middleware_index_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./agents/middleware/index.js */ \"(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/agents/middleware/index.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! @langchain/core/tools */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/tools/index.js\");\n/* harmony import */ var _langchain_core_utils_context__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! @langchain/core/utils/context */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/utils/context.js\");\n/* harmony import */ var _langchain_core_stores__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! @langchain/core/stores */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/stores.js\");\n/* harmony import */ var _langchain_core_documents__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! @langchain/core/documents */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6_/node_modules/@langchain/core/dist/documents/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//#region src/index.ts\nvar src_exports = /* @__PURE__ */ (0,_virtual_rolldown_runtime_js__WEBPACK_IMPORTED_MODULE_0__.__exportAll)({\n\tAIMessage: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.AIMessage,\n\tAIMessageChunk: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.AIMessageChunk,\n\tBaseMessage: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.BaseMessage,\n\tBaseMessageChunk: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.BaseMessageChunk,\n\tClearToolUsesEdit: () => _agents_middleware_contextEditing_js__WEBPACK_IMPORTED_MODULE_15__.ClearToolUsesEdit,\n\tDocument: () => _langchain_core_documents__WEBPACK_IMPORTED_MODULE_30__.Document,\n\tDynamicStructuredTool: () => _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.DynamicStructuredTool,\n\tDynamicTool: () => _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.DynamicTool,\n\tFakeToolCallingModel: () => _agents_tests_utils_js__WEBPACK_IMPORTED_MODULE_7__.FakeToolCallingModel,\n\tHumanMessage: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.HumanMessage,\n\tHumanMessageChunk: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.HumanMessageChunk,\n\tInMemoryStore: () => _langchain_core_stores__WEBPACK_IMPORTED_MODULE_29__.InMemoryStore,\n\tMIDDLEWARE_BRAND: () => _agents_middleware_types_js__WEBPACK_IMPORTED_MODULE_5__.MIDDLEWARE_BRAND,\n\tMiddlewareError: () => _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.MiddlewareError,\n\tMultipleStructuredOutputsError: () => _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.MultipleStructuredOutputsError,\n\tMultipleToolsBoundError: () => _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.MultipleToolsBoundError,\n\tPIIDetectionError: () => _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.PIIDetectionError,\n\tProviderStrategy: () => _agents_responses_js__WEBPACK_IMPORTED_MODULE_3__.ProviderStrategy,\n\tStructuredOutputParsingError: () => _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.StructuredOutputParsingError,\n\tStructuredTool: () => _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.StructuredTool,\n\tSystemMessage: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.SystemMessage,\n\tSystemMessageChunk: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.SystemMessageChunk,\n\tTODO_LIST_MIDDLEWARE_SYSTEM_PROMPT: () => _agents_middleware_todoListMiddleware_js__WEBPACK_IMPORTED_MODULE_17__.TODO_LIST_MIDDLEWARE_SYSTEM_PROMPT,\n\tTool: () => _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.Tool,\n\tToolCallLimitExceededError: () => _agents_middleware_toolCallLimit_js__WEBPACK_IMPORTED_MODULE_16__.ToolCallLimitExceededError,\n\tToolInvocationError: () => _agents_errors_js__WEBPACK_IMPORTED_MODULE_2__.ToolInvocationError,\n\tToolMessage: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.ToolMessage,\n\tToolMessageChunk: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.ToolMessageChunk,\n\tToolStrategy: () => _agents_responses_js__WEBPACK_IMPORTED_MODULE_3__.ToolStrategy,\n\tanthropicPromptCachingMiddleware: () => _agents_middleware_provider_anthropic_promptCaching_js__WEBPACK_IMPORTED_MODULE_24__.anthropicPromptCachingMiddleware,\n\tapplyStrategy: () => _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.applyStrategy,\n\tcontext: () => _langchain_core_utils_context__WEBPACK_IMPORTED_MODULE_28__.context,\n\tcontextEditingMiddleware: () => _agents_middleware_contextEditing_js__WEBPACK_IMPORTED_MODULE_15__.contextEditingMiddleware,\n\tcountTokensApproximately: () => _agents_middleware_utils_js__WEBPACK_IMPORTED_MODULE_4__.countTokensApproximately,\n\tcreateAgent: () => _agents_index_js__WEBPACK_IMPORTED_MODULE_8__.createAgent,\n\tcreateMiddleware: () => _agents_middleware_js__WEBPACK_IMPORTED_MODULE_6__.createMiddleware,\n\tdetectCreditCard: () => _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectCreditCard,\n\tdetectEmail: () => _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectEmail,\n\tdetectIP: () => _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectIP,\n\tdetectMacAddress: () => _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectMacAddress,\n\tdetectUrl: () => _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.detectUrl,\n\tdynamicSystemPromptMiddleware: () => _agents_middleware_dynamicSystemPrompt_js__WEBPACK_IMPORTED_MODULE_11__.dynamicSystemPromptMiddleware,\n\tfilterMessages: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.filterMessages,\n\thumanInTheLoopMiddleware: () => _agents_middleware_hitl_js__WEBPACK_IMPORTED_MODULE_9__.humanInTheLoopMiddleware,\n\tinitChatModel: () => _chat_models_universal_js__WEBPACK_IMPORTED_MODULE_1__.initChatModel,\n\tllmToolSelectorMiddleware: () => _agents_middleware_llmToolSelector_js__WEBPACK_IMPORTED_MODULE_12__.llmToolSelectorMiddleware,\n\tmodelCallLimitMiddleware: () => _agents_middleware_modelCallLimit_js__WEBPACK_IMPORTED_MODULE_18__.modelCallLimitMiddleware,\n\tmodelFallbackMiddleware: () => _agents_middleware_modelFallback_js__WEBPACK_IMPORTED_MODULE_19__.modelFallbackMiddleware,\n\tmodelRetryMiddleware: () => _agents_middleware_modelRetry_js__WEBPACK_IMPORTED_MODULE_20__.modelRetryMiddleware,\n\topenAIModerationMiddleware: () => _agents_middleware_provider_openai_moderation_js__WEBPACK_IMPORTED_MODULE_23__.openAIModerationMiddleware,\n\tpiiMiddleware: () => _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.piiMiddleware,\n\tpiiRedactionMiddleware: () => _agents_middleware_piiRedaction_js__WEBPACK_IMPORTED_MODULE_14__.piiRedactionMiddleware,\n\tproviderStrategy: () => _agents_responses_js__WEBPACK_IMPORTED_MODULE_3__.providerStrategy,\n\tresolveRedactionRule: () => _agents_middleware_pii_js__WEBPACK_IMPORTED_MODULE_13__.resolveRedactionRule,\n\tsummarizationMiddleware: () => _agents_middleware_summarization_js__WEBPACK_IMPORTED_MODULE_10__.summarizationMiddleware,\n\ttodoListMiddleware: () => _agents_middleware_todoListMiddleware_js__WEBPACK_IMPORTED_MODULE_17__.todoListMiddleware,\n\ttool: () => _langchain_core_tools__WEBPACK_IMPORTED_MODULE_27__.tool,\n\ttoolCallLimitMiddleware: () => _agents_middleware_toolCallLimit_js__WEBPACK_IMPORTED_MODULE_16__.toolCallLimitMiddleware,\n\ttoolEmulatorMiddleware: () => _agents_middleware_toolEmulator_js__WEBPACK_IMPORTED_MODULE_22__.toolEmulatorMiddleware,\n\ttoolRetryMiddleware: () => _agents_middleware_toolRetry_js__WEBPACK_IMPORTED_MODULE_21__.toolRetryMiddleware,\n\ttoolStrategy: () => _agents_responses_js__WEBPACK_IMPORTED_MODULE_3__.toolStrategy,\n\ttrimMessages: () => _langchain_core_messages__WEBPACK_IMPORTED_MODULE_26__.trimMessages\n});\n\n//#endregion\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQThEO0FBQ0g7QUFDc0c7QUFDMUQ7QUFDL0I7QUFDUjtBQUNOO0FBQ0s7QUFDZjtBQUN1QjtBQUNRO0FBQ1k7QUFDUjtBQUNzRztBQUM1RztBQUN1QjtBQUNPO0FBQ1E7QUFDbEM7QUFDRjtBQUNOO0FBQ0Y7QUFDTTtBQUNrQjtBQUNZO0FBQ3JFO0FBQytMO0FBQzlIO0FBQy9DO0FBQ0Q7QUFDRjs7QUFFckQ7QUFDQSxrQ0FBa0MseUVBQVc7QUFDN0Msa0JBQWtCLGdFQUFTO0FBQzNCLHVCQUF1QixxRUFBYztBQUNyQyxvQkFBb0Isa0VBQVc7QUFDL0IseUJBQXlCLHVFQUFnQjtBQUN6QywwQkFBMEIsb0ZBQWlCO0FBQzNDLGlCQUFpQixnRUFBUTtBQUN6Qiw4QkFBOEIseUVBQXFCO0FBQ25ELG9CQUFvQiwrREFBVztBQUMvQiw2QkFBNkIsd0VBQW9CO0FBQ2pELHFCQUFxQixtRUFBWTtBQUNqQywwQkFBMEIsd0VBQWlCO0FBQzNDLHNCQUFzQixrRUFBYTtBQUNuQyx5QkFBeUIseUVBQWdCO0FBQ3pDLHdCQUF3Qiw4REFBZTtBQUN2Qyx1Q0FBdUMsNkVBQThCO0FBQ3JFLGdDQUFnQyxzRUFBdUI7QUFDdkQsMEJBQTBCLHlFQUFpQjtBQUMzQyx5QkFBeUIsa0VBQWdCO0FBQ3pDLHFDQUFxQywyRUFBNEI7QUFDakUsdUJBQXVCLGtFQUFjO0FBQ3JDLHNCQUFzQixvRUFBYTtBQUNuQywyQkFBMkIseUVBQWtCO0FBQzdDLDJDQUEyQyx5R0FBa0M7QUFDN0UsYUFBYSx3REFBSTtBQUNqQixtQ0FBbUMsNEZBQTBCO0FBQzdELDRCQUE0QixrRUFBbUI7QUFDL0Msb0JBQW9CLGtFQUFXO0FBQy9CLHlCQUF5Qix1RUFBZ0I7QUFDekMscUJBQXFCLDhEQUFZO0FBQ2pDLHlDQUF5QyxxSEFBZ0M7QUFDekUsc0JBQXNCLHFFQUFhO0FBQ25DLGdCQUFnQixtRUFBTztBQUN2QixpQ0FBaUMsMkZBQXdCO0FBQ3pELGlDQUFpQyxpRkFBd0I7QUFDekQsb0JBQW9CLHlEQUFXO0FBQy9CLHlCQUF5QixtRUFBZ0I7QUFDekMseUJBQXlCLHdFQUFnQjtBQUN6QyxvQkFBb0IsbUVBQVc7QUFDL0IsaUJBQWlCLGdFQUFRO0FBQ3pCLHlCQUF5Qix3RUFBZ0I7QUFDekMsa0JBQWtCLGlFQUFTO0FBQzNCLHNDQUFzQyxxR0FBNkI7QUFDbkUsdUJBQXVCLHFFQUFjO0FBQ3JDLGlDQUFpQyxnRkFBd0I7QUFDekQsc0JBQXNCLG9FQUFhO0FBQ25DLGtDQUFrQyw2RkFBeUI7QUFDM0QsaUNBQWlDLDJGQUF3QjtBQUN6RCxnQ0FBZ0MseUZBQXVCO0FBQ3ZELDZCQUE2QixtRkFBb0I7QUFDakQsbUNBQW1DLHlHQUEwQjtBQUM3RCxzQkFBc0IscUVBQWE7QUFDbkMsK0JBQStCLHVGQUFzQjtBQUNyRCx5QkFBeUIsa0VBQWdCO0FBQ3pDLDZCQUE2Qiw0RUFBb0I7QUFDakQsZ0NBQWdDLHlGQUF1QjtBQUN2RCwyQkFBMkIseUZBQWtCO0FBQzdDLGFBQWEsd0RBQUk7QUFDakIsZ0NBQWdDLHlGQUF1QjtBQUN2RCwrQkFBK0IsdUZBQXNCO0FBQ3JELDRCQUE0QixpRkFBbUI7QUFDL0MscUJBQXFCLDhEQUFZO0FBQ2pDLHFCQUFxQixtRUFBWTtBQUNqQyxDQUFDOztBQUVEO0FBQ2lzQztBQUNqc0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdG9yeXRlbGxpbmcvLi9ub2RlX21vZHVsZXMvLnBucG0vbGFuZ2NoYWluQDEuMi4yNl9AbGFuZ2NoYWluK2NvcmVAMS4xLjI4X29wZW5haUA2LjI1LjBfem9kQDQuMy42X19fb3BlbmFpQDYuMjUuMF96b2RANC4zLjZfX3JlX2V4MmI1eTN0emY3aDJjeG1tdWk1cW9pYXN5L25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9pbmRleC5qcz8zOWUzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IF9fZXhwb3J0QWxsIH0gZnJvbSBcIi4vX3ZpcnR1YWwvX3JvbGxkb3duL3J1bnRpbWUuanNcIjtcbmltcG9ydCB7IGluaXRDaGF0TW9kZWwgfSBmcm9tIFwiLi9jaGF0X21vZGVscy91bml2ZXJzYWwuanNcIjtcbmltcG9ydCB7IE1pZGRsZXdhcmVFcnJvciwgTXVsdGlwbGVTdHJ1Y3R1cmVkT3V0cHV0c0Vycm9yLCBNdWx0aXBsZVRvb2xzQm91bmRFcnJvciwgU3RydWN0dXJlZE91dHB1dFBhcnNpbmdFcnJvciwgVG9vbEludm9jYXRpb25FcnJvciB9IGZyb20gXCIuL2FnZW50cy9lcnJvcnMuanNcIjtcbmltcG9ydCB7IFByb3ZpZGVyU3RyYXRlZ3ksIFRvb2xTdHJhdGVneSwgcHJvdmlkZXJTdHJhdGVneSwgdG9vbFN0cmF0ZWd5IH0gZnJvbSBcIi4vYWdlbnRzL3Jlc3BvbnNlcy5qc1wiO1xuaW1wb3J0IHsgY291bnRUb2tlbnNBcHByb3hpbWF0ZWx5IH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvdXRpbHMuanNcIjtcbmltcG9ydCB7IE1JRERMRVdBUkVfQlJBTkQgfSBmcm9tIFwiLi9hZ2VudHMvbWlkZGxld2FyZS90eXBlcy5qc1wiO1xuaW1wb3J0IHsgY3JlYXRlTWlkZGxld2FyZSB9IGZyb20gXCIuL2FnZW50cy9taWRkbGV3YXJlLmpzXCI7XG5pbXBvcnQgeyBGYWtlVG9vbENhbGxpbmdNb2RlbCB9IGZyb20gXCIuL2FnZW50cy90ZXN0cy91dGlscy5qc1wiO1xuaW1wb3J0IHsgY3JlYXRlQWdlbnQgfSBmcm9tIFwiLi9hZ2VudHMvaW5kZXguanNcIjtcbmltcG9ydCB7IGh1bWFuSW5UaGVMb29wTWlkZGxld2FyZSB9IGZyb20gXCIuL2FnZW50cy9taWRkbGV3YXJlL2hpdGwuanNcIjtcbmltcG9ydCB7IHN1bW1hcml6YXRpb25NaWRkbGV3YXJlIH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvc3VtbWFyaXphdGlvbi5qc1wiO1xuaW1wb3J0IHsgZHluYW1pY1N5c3RlbVByb21wdE1pZGRsZXdhcmUgfSBmcm9tIFwiLi9hZ2VudHMvbWlkZGxld2FyZS9keW5hbWljU3lzdGVtUHJvbXB0LmpzXCI7XG5pbXBvcnQgeyBsbG1Ub29sU2VsZWN0b3JNaWRkbGV3YXJlIH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvbGxtVG9vbFNlbGVjdG9yLmpzXCI7XG5pbXBvcnQgeyBQSUlEZXRlY3Rpb25FcnJvciwgYXBwbHlTdHJhdGVneSwgZGV0ZWN0Q3JlZGl0Q2FyZCwgZGV0ZWN0RW1haWwsIGRldGVjdElQLCBkZXRlY3RNYWNBZGRyZXNzLCBkZXRlY3RVcmwsIHBpaU1pZGRsZXdhcmUsIHJlc29sdmVSZWRhY3Rpb25SdWxlIH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvcGlpLmpzXCI7XG5pbXBvcnQgeyBwaWlSZWRhY3Rpb25NaWRkbGV3YXJlIH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvcGlpUmVkYWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBDbGVhclRvb2xVc2VzRWRpdCwgY29udGV4dEVkaXRpbmdNaWRkbGV3YXJlIH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvY29udGV4dEVkaXRpbmcuanNcIjtcbmltcG9ydCB7IFRvb2xDYWxsTGltaXRFeGNlZWRlZEVycm9yLCB0b29sQ2FsbExpbWl0TWlkZGxld2FyZSB9IGZyb20gXCIuL2FnZW50cy9taWRkbGV3YXJlL3Rvb2xDYWxsTGltaXQuanNcIjtcbmltcG9ydCB7IFRPRE9fTElTVF9NSURETEVXQVJFX1NZU1RFTV9QUk9NUFQsIHRvZG9MaXN0TWlkZGxld2FyZSB9IGZyb20gXCIuL2FnZW50cy9taWRkbGV3YXJlL3RvZG9MaXN0TWlkZGxld2FyZS5qc1wiO1xuaW1wb3J0IHsgbW9kZWxDYWxsTGltaXRNaWRkbGV3YXJlIH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvbW9kZWxDYWxsTGltaXQuanNcIjtcbmltcG9ydCB7IG1vZGVsRmFsbGJhY2tNaWRkbGV3YXJlIH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvbW9kZWxGYWxsYmFjay5qc1wiO1xuaW1wb3J0IHsgbW9kZWxSZXRyeU1pZGRsZXdhcmUgfSBmcm9tIFwiLi9hZ2VudHMvbWlkZGxld2FyZS9tb2RlbFJldHJ5LmpzXCI7XG5pbXBvcnQgeyB0b29sUmV0cnlNaWRkbGV3YXJlIH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvdG9vbFJldHJ5LmpzXCI7XG5pbXBvcnQgeyB0b29sRW11bGF0b3JNaWRkbGV3YXJlIH0gZnJvbSBcIi4vYWdlbnRzL21pZGRsZXdhcmUvdG9vbEVtdWxhdG9yLmpzXCI7XG5pbXBvcnQgeyBvcGVuQUlNb2RlcmF0aW9uTWlkZGxld2FyZSB9IGZyb20gXCIuL2FnZW50cy9taWRkbGV3YXJlL3Byb3ZpZGVyL29wZW5haS9tb2RlcmF0aW9uLmpzXCI7XG5pbXBvcnQgeyBhbnRocm9waWNQcm9tcHRDYWNoaW5nTWlkZGxld2FyZSB9IGZyb20gXCIuL2FnZW50cy9taWRkbGV3YXJlL3Byb3ZpZGVyL2FudGhyb3BpYy9wcm9tcHRDYWNoaW5nLmpzXCI7XG5pbXBvcnQgXCIuL2FnZW50cy9taWRkbGV3YXJlL2luZGV4LmpzXCI7XG5pbXBvcnQgeyBBSU1lc3NhZ2UsIEFJTWVzc2FnZUNodW5rLCBCYXNlTWVzc2FnZSwgQmFzZU1lc3NhZ2VDaHVuaywgSHVtYW5NZXNzYWdlLCBIdW1hbk1lc3NhZ2VDaHVuaywgU3lzdGVtTWVzc2FnZSwgU3lzdGVtTWVzc2FnZUNodW5rLCBUb29sTWVzc2FnZSwgVG9vbE1lc3NhZ2VDaHVuaywgZmlsdGVyTWVzc2FnZXMsIHRyaW1NZXNzYWdlcyB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXNcIjtcbmltcG9ydCB7IER5bmFtaWNTdHJ1Y3R1cmVkVG9vbCwgRHluYW1pY1Rvb2wsIFN0cnVjdHVyZWRUb29sLCBUb29sLCB0b29sIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29yZS90b29sc1wiO1xuaW1wb3J0IHsgY29udGV4dCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvdXRpbHMvY29udGV4dFwiO1xuaW1wb3J0IHsgSW5NZW1vcnlTdG9yZSB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvc3RvcmVzXCI7XG5pbXBvcnQgeyBEb2N1bWVudCB9IGZyb20gXCJAbGFuZ2NoYWluL2NvcmUvZG9jdW1lbnRzXCI7XG5cbi8vI3JlZ2lvbiBzcmMvaW5kZXgudHNcbnZhciBzcmNfZXhwb3J0cyA9IC8qIEBfX1BVUkVfXyAqLyBfX2V4cG9ydEFsbCh7XG5cdEFJTWVzc2FnZTogKCkgPT4gQUlNZXNzYWdlLFxuXHRBSU1lc3NhZ2VDaHVuazogKCkgPT4gQUlNZXNzYWdlQ2h1bmssXG5cdEJhc2VNZXNzYWdlOiAoKSA9PiBCYXNlTWVzc2FnZSxcblx0QmFzZU1lc3NhZ2VDaHVuazogKCkgPT4gQmFzZU1lc3NhZ2VDaHVuayxcblx0Q2xlYXJUb29sVXNlc0VkaXQ6ICgpID0+IENsZWFyVG9vbFVzZXNFZGl0LFxuXHREb2N1bWVudDogKCkgPT4gRG9jdW1lbnQsXG5cdER5bmFtaWNTdHJ1Y3R1cmVkVG9vbDogKCkgPT4gRHluYW1pY1N0cnVjdHVyZWRUb29sLFxuXHREeW5hbWljVG9vbDogKCkgPT4gRHluYW1pY1Rvb2wsXG5cdEZha2VUb29sQ2FsbGluZ01vZGVsOiAoKSA9PiBGYWtlVG9vbENhbGxpbmdNb2RlbCxcblx0SHVtYW5NZXNzYWdlOiAoKSA9PiBIdW1hbk1lc3NhZ2UsXG5cdEh1bWFuTWVzc2FnZUNodW5rOiAoKSA9PiBIdW1hbk1lc3NhZ2VDaHVuayxcblx0SW5NZW1vcnlTdG9yZTogKCkgPT4gSW5NZW1vcnlTdG9yZSxcblx0TUlERExFV0FSRV9CUkFORDogKCkgPT4gTUlERExFV0FSRV9CUkFORCxcblx0TWlkZGxld2FyZUVycm9yOiAoKSA9PiBNaWRkbGV3YXJlRXJyb3IsXG5cdE11bHRpcGxlU3RydWN0dXJlZE91dHB1dHNFcnJvcjogKCkgPT4gTXVsdGlwbGVTdHJ1Y3R1cmVkT3V0cHV0c0Vycm9yLFxuXHRNdWx0aXBsZVRvb2xzQm91bmRFcnJvcjogKCkgPT4gTXVsdGlwbGVUb29sc0JvdW5kRXJyb3IsXG5cdFBJSURldGVjdGlvbkVycm9yOiAoKSA9PiBQSUlEZXRlY3Rpb25FcnJvcixcblx0UHJvdmlkZXJTdHJhdGVneTogKCkgPT4gUHJvdmlkZXJTdHJhdGVneSxcblx0U3RydWN0dXJlZE91dHB1dFBhcnNpbmdFcnJvcjogKCkgPT4gU3RydWN0dXJlZE91dHB1dFBhcnNpbmdFcnJvcixcblx0U3RydWN0dXJlZFRvb2w6ICgpID0+IFN0cnVjdHVyZWRUb29sLFxuXHRTeXN0ZW1NZXNzYWdlOiAoKSA9PiBTeXN0ZW1NZXNzYWdlLFxuXHRTeXN0ZW1NZXNzYWdlQ2h1bms6ICgpID0+IFN5c3RlbU1lc3NhZ2VDaHVuayxcblx0VE9ET19MSVNUX01JRERMRVdBUkVfU1lTVEVNX1BST01QVDogKCkgPT4gVE9ET19MSVNUX01JRERMRVdBUkVfU1lTVEVNX1BST01QVCxcblx0VG9vbDogKCkgPT4gVG9vbCxcblx0VG9vbENhbGxMaW1pdEV4Y2VlZGVkRXJyb3I6ICgpID0+IFRvb2xDYWxsTGltaXRFeGNlZWRlZEVycm9yLFxuXHRUb29sSW52b2NhdGlvbkVycm9yOiAoKSA9PiBUb29sSW52b2NhdGlvbkVycm9yLFxuXHRUb29sTWVzc2FnZTogKCkgPT4gVG9vbE1lc3NhZ2UsXG5cdFRvb2xNZXNzYWdlQ2h1bms6ICgpID0+IFRvb2xNZXNzYWdlQ2h1bmssXG5cdFRvb2xTdHJhdGVneTogKCkgPT4gVG9vbFN0cmF0ZWd5LFxuXHRhbnRocm9waWNQcm9tcHRDYWNoaW5nTWlkZGxld2FyZTogKCkgPT4gYW50aHJvcGljUHJvbXB0Q2FjaGluZ01pZGRsZXdhcmUsXG5cdGFwcGx5U3RyYXRlZ3k6ICgpID0+IGFwcGx5U3RyYXRlZ3ksXG5cdGNvbnRleHQ6ICgpID0+IGNvbnRleHQsXG5cdGNvbnRleHRFZGl0aW5nTWlkZGxld2FyZTogKCkgPT4gY29udGV4dEVkaXRpbmdNaWRkbGV3YXJlLFxuXHRjb3VudFRva2Vuc0FwcHJveGltYXRlbHk6ICgpID0+IGNvdW50VG9rZW5zQXBwcm94aW1hdGVseSxcblx0Y3JlYXRlQWdlbnQ6ICgpID0+IGNyZWF0ZUFnZW50LFxuXHRjcmVhdGVNaWRkbGV3YXJlOiAoKSA9PiBjcmVhdGVNaWRkbGV3YXJlLFxuXHRkZXRlY3RDcmVkaXRDYXJkOiAoKSA9PiBkZXRlY3RDcmVkaXRDYXJkLFxuXHRkZXRlY3RFbWFpbDogKCkgPT4gZGV0ZWN0RW1haWwsXG5cdGRldGVjdElQOiAoKSA9PiBkZXRlY3RJUCxcblx0ZGV0ZWN0TWFjQWRkcmVzczogKCkgPT4gZGV0ZWN0TWFjQWRkcmVzcyxcblx0ZGV0ZWN0VXJsOiAoKSA9PiBkZXRlY3RVcmwsXG5cdGR5bmFtaWNTeXN0ZW1Qcm9tcHRNaWRkbGV3YXJlOiAoKSA9PiBkeW5hbWljU3lzdGVtUHJvbXB0TWlkZGxld2FyZSxcblx0ZmlsdGVyTWVzc2FnZXM6ICgpID0+IGZpbHRlck1lc3NhZ2VzLFxuXHRodW1hbkluVGhlTG9vcE1pZGRsZXdhcmU6ICgpID0+IGh1bWFuSW5UaGVMb29wTWlkZGxld2FyZSxcblx0aW5pdENoYXRNb2RlbDogKCkgPT4gaW5pdENoYXRNb2RlbCxcblx0bGxtVG9vbFNlbGVjdG9yTWlkZGxld2FyZTogKCkgPT4gbGxtVG9vbFNlbGVjdG9yTWlkZGxld2FyZSxcblx0bW9kZWxDYWxsTGltaXRNaWRkbGV3YXJlOiAoKSA9PiBtb2RlbENhbGxMaW1pdE1pZGRsZXdhcmUsXG5cdG1vZGVsRmFsbGJhY2tNaWRkbGV3YXJlOiAoKSA9PiBtb2RlbEZhbGxiYWNrTWlkZGxld2FyZSxcblx0bW9kZWxSZXRyeU1pZGRsZXdhcmU6ICgpID0+IG1vZGVsUmV0cnlNaWRkbGV3YXJlLFxuXHRvcGVuQUlNb2RlcmF0aW9uTWlkZGxld2FyZTogKCkgPT4gb3BlbkFJTW9kZXJhdGlvbk1pZGRsZXdhcmUsXG5cdHBpaU1pZGRsZXdhcmU6ICgpID0+IHBpaU1pZGRsZXdhcmUsXG5cdHBpaVJlZGFjdGlvbk1pZGRsZXdhcmU6ICgpID0+IHBpaVJlZGFjdGlvbk1pZGRsZXdhcmUsXG5cdHByb3ZpZGVyU3RyYXRlZ3k6ICgpID0+IHByb3ZpZGVyU3RyYXRlZ3ksXG5cdHJlc29sdmVSZWRhY3Rpb25SdWxlOiAoKSA9PiByZXNvbHZlUmVkYWN0aW9uUnVsZSxcblx0c3VtbWFyaXphdGlvbk1pZGRsZXdhcmU6ICgpID0+IHN1bW1hcml6YXRpb25NaWRkbGV3YXJlLFxuXHR0b2RvTGlzdE1pZGRsZXdhcmU6ICgpID0+IHRvZG9MaXN0TWlkZGxld2FyZSxcblx0dG9vbDogKCkgPT4gdG9vbCxcblx0dG9vbENhbGxMaW1pdE1pZGRsZXdhcmU6ICgpID0+IHRvb2xDYWxsTGltaXRNaWRkbGV3YXJlLFxuXHR0b29sRW11bGF0b3JNaWRkbGV3YXJlOiAoKSA9PiB0b29sRW11bGF0b3JNaWRkbGV3YXJlLFxuXHR0b29sUmV0cnlNaWRkbGV3YXJlOiAoKSA9PiB0b29sUmV0cnlNaWRkbGV3YXJlLFxuXHR0b29sU3RyYXRlZ3k6ICgpID0+IHRvb2xTdHJhdGVneSxcblx0dHJpbU1lc3NhZ2VzOiAoKSA9PiB0cmltTWVzc2FnZXNcbn0pO1xuXG4vLyNlbmRyZWdpb25cbmV4cG9ydCB7IEFJTWVzc2FnZSwgQUlNZXNzYWdlQ2h1bmssIEJhc2VNZXNzYWdlLCBCYXNlTWVzc2FnZUNodW5rLCBDbGVhclRvb2xVc2VzRWRpdCwgRG9jdW1lbnQsIER5bmFtaWNTdHJ1Y3R1cmVkVG9vbCwgRHluYW1pY1Rvb2wsIEZha2VUb29sQ2FsbGluZ01vZGVsLCBIdW1hbk1lc3NhZ2UsIEh1bWFuTWVzc2FnZUNodW5rLCBJbk1lbW9yeVN0b3JlLCBNSURETEVXQVJFX0JSQU5ELCBNaWRkbGV3YXJlRXJyb3IsIE11bHRpcGxlU3RydWN0dXJlZE91dHB1dHNFcnJvciwgTXVsdGlwbGVUb29sc0JvdW5kRXJyb3IsIFBJSURldGVjdGlvbkVycm9yLCBQcm92aWRlclN0cmF0ZWd5LCBTdHJ1Y3R1cmVkT3V0cHV0UGFyc2luZ0Vycm9yLCBTdHJ1Y3R1cmVkVG9vbCwgU3lzdGVtTWVzc2FnZSwgU3lzdGVtTWVzc2FnZUNodW5rLCBUT0RPX0xJU1RfTUlERExFV0FSRV9TWVNURU1fUFJPTVBULCBUb29sLCBUb29sQ2FsbExpbWl0RXhjZWVkZWRFcnJvciwgVG9vbEludm9jYXRpb25FcnJvciwgVG9vbE1lc3NhZ2UsIFRvb2xNZXNzYWdlQ2h1bmssIFRvb2xTdHJhdGVneSwgYW50aHJvcGljUHJvbXB0Q2FjaGluZ01pZGRsZXdhcmUsIGFwcGx5U3RyYXRlZ3ksIGNvbnRleHQsIGNvbnRleHRFZGl0aW5nTWlkZGxld2FyZSwgY291bnRUb2tlbnNBcHByb3hpbWF0ZWx5LCBjcmVhdGVBZ2VudCwgY3JlYXRlTWlkZGxld2FyZSwgZGV0ZWN0Q3JlZGl0Q2FyZCwgZGV0ZWN0RW1haWwsIGRldGVjdElQLCBkZXRlY3RNYWNBZGRyZXNzLCBkZXRlY3RVcmwsIGR5bmFtaWNTeXN0ZW1Qcm9tcHRNaWRkbGV3YXJlLCBmaWx0ZXJNZXNzYWdlcywgaHVtYW5JblRoZUxvb3BNaWRkbGV3YXJlLCBpbml0Q2hhdE1vZGVsLCBsbG1Ub29sU2VsZWN0b3JNaWRkbGV3YXJlLCBtb2RlbENhbGxMaW1pdE1pZGRsZXdhcmUsIG1vZGVsRmFsbGJhY2tNaWRkbGV3YXJlLCBtb2RlbFJldHJ5TWlkZGxld2FyZSwgb3BlbkFJTW9kZXJhdGlvbk1pZGRsZXdhcmUsIHBpaU1pZGRsZXdhcmUsIHBpaVJlZGFjdGlvbk1pZGRsZXdhcmUsIHByb3ZpZGVyU3RyYXRlZ3ksIHJlc29sdmVSZWRhY3Rpb25SdWxlLCBzcmNfZXhwb3J0cywgc3VtbWFyaXphdGlvbk1pZGRsZXdhcmUsIHRvZG9MaXN0TWlkZGxld2FyZSwgdG9vbCwgdG9vbENhbGxMaW1pdE1pZGRsZXdhcmUsIHRvb2xFbXVsYXRvck1pZGRsZXdhcmUsIHRvb2xSZXRyeU1pZGRsZXdhcmUsIHRvb2xTdHJhdGVneSwgdHJpbU1lc3NhZ2VzIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/langchain@1.2.26_@langchain+core@1.1.28_openai@6.25.0_zod@4.3.6___openai@6.25.0_zod@4.3.6__re_ex2b5y3tzf7h2cxmmui5qoiasy/node_modules/langchain/dist/index.js\n");

/***/ })

};
;